<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <title></title>
  <link rel="stylesheet" type="text/css" href="../stylesheets/jquery.mobile.flatui.min.css" />
  <link rel="stylesheet" href="../stylesheets/mobiscroll.custom-2.6.0.min.css">
  <!-- jQuery and jQuery Mobile -->
  <script src="../javascripts/jquery-1.8.2.min.js"></script>
  <script src="../javascripts/jquery.mobile-1.3.1.min.js"></script>
  <script src="../javascripts/mobiscroll.custom-2.6.0.min.js"></script>
  <style>
	html,body,p,a{font-family:"微软雅黑";padding:0;margin:0;}
	h3{font-weight:normal;}

	#plan .ui-select{display:none;}
  </style>
</head>
<body>
<!-- Home -->
<div data-role="page" id="plan">
    <div data-role="content" >
		<div data-role="fieldcontain">
			<label for="Destination">
				目的地：
			</label>
			<select id="Destination" data-native-menu="false" name="Destination">
				<option value="涵盖所有申根国家 All Schengen States">涵盖所有申根国家 All Schengen States</option>
				<option value="全球 Worldwide">全球 Worldwide</option>
			</select>
		</div>
		<div data-role="fieldcontain">
			<label for="PlanID">
				保险计划：
			</label>
			<select id="PlanID" name="PlanID">
				<option value="1">计划一</option>
				<option value="2">计划二</option>
			</select>
		</div>
		<div data-role="fieldcontain">
			<label for="DateStart">生效日期：</label>
			<input type="text" value="" id="DateStart" name="DateStart" />
		</div>
		<div data-role="fieldcontain">
			<label for="DateEnd">结束日期：</label>
			<input type="text" value="" id="DateEnd" name="DateEnd" />
		</div>
		<a id="save" data-theme="b" data-role="button">保存</a>
    </div>

	<script type="text/javascript">
		var now=new Date();
		var plan={"1":"计划一","2":"计划二"};
		var m=now.getMonth()+1,d=now.getDate();
		if(m<10){m = "0"+m;}
		if(d<10){d = "0"+d;}
		var nowStr=now.getFullYear()+"-"+m+"-"+d;
		var opts={
			theme: "ios",
			lang: "zh",
			display: "bottom",
			mode: "scroller",
			dateFormat:"yy-mm-dd",
			dateOrder: "yymmdd"
		};
		var selOpts={
			theme:'ios',
			mode:'scroller',
			lang:'zh',
			display: 'bottom'
		};
		var dts=$.extend({
			minDate:now,
			maxDate:new Date("2014/09/01"),
			onSelect:function(val){
				var newOpts={
					minDate:new Date(val.replace(/-/g,"/")),
					maxDate:new Date("2014/09/01")
				};
				$("#DateEnd").mobiscroll().date($.extend(newOpts,opts));
			}
		},opts);
		var dte=$.extend({
			minDate:now,
			maxDate:new Date("2014/09/01")
		},opts);
		
		$("#DateStart").val(nowStr);
		$("#DateEnd").val(nowStr);
		$("#DateStart").mobiscroll().date(dts);
		$("#DateEnd").mobiscroll().date(dte);
		$("#PlanID").mobiscroll().select(selOpts);
		$("#Destination").mobiscroll().select(selOpts);
		$("#save").bind("tap",function(){
			policy.Destination=$("#Destination").val();
			policy.PlanID=$("#PlanID").val();
			policy.DateStart=$("#DateStart").val();
			policy.DateEnd=$("#DateEnd").val();
			if(new Date(policy.DateEnd.replace(/-/g,"/")).getTime()<new Date(policy.DateStart.replace(/-/g,"/")).getTime()){
				alert("保险到期日不能小于生效日");
				return ;
			}
			localStorage.setItem("policy",JSON.stringify(policy))
			history.go(-1);
		});
		if(policy.Destination){
			$("#Destination").mobiscroll("setValue",policy.Destination);
			$("#Destination_dummy").val(policy.Destination);
		}
		if(policy.PlanID){
			$("#PlanID").mobiscroll("setValue",policy.PlanID);
			$("#PlanID_dummy").val(plan[policy.PlanID]);
		}
		policy.DateStart&&$("#DateStart").val(policy.DateStart);
		policy.DateEnd&&$("#DateEnd").val(policy.DateEnd);
	</script>
</div>
</body>
</html>


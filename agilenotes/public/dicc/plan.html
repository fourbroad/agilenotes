<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <title></title>
  <link rel="stylesheet" type="text/css" href="../stylesheets/jquery.mobile.flatui.min.css" />
  <link rel="stylesheet" href="../stylesheets/mobiscroll.custom-2.6.0.min.css">
  <!-- jQuery and jQuery Mobile -->
  <script src="../javascripts/jquery-1.8.2.min.js"></script>
  <script src="../javascripts/jquery.mobile-1.3.1.min.js"></script>
  <script src="../javascripts/mobiscroll.custom-2.6.0.min.js"></script>
  <style>
	html,body,p,a{font-family:"微软雅黑";padding:0;margin:0;}
	h3{font-weight:normal;}

	#plan .ui-select{display:none;}
	.ui-btn-up-c{border-color:#D7D7D7;}
	
	input{border:0 none !important;background:none !important;float:right;text-align:right;color:#1ca1d8;font-size:14px;}
	label{font-weight:normal !important;margin:0 !important;}
  </style>
</head>
<body>
<!-- Home -->
<div data-role="page" id="plan">
    <div data-role="content" >
		<ul class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
			<li class="ui-li ui-li-static ui-btn-up-c ui-first-child">
				<select data-role='nojs' id="Destination" data-native-menu="false" name="Destination">
					<option value="涵盖所有申根国家 All Schengen States">涵盖所有申根国家 All Schengen States</option>
					<option value="全球 Worldwide">全球 Worldwide</option>
				</select>
				<label data-role='none' for="Destination" style="float:left;">目的地：</label>
				<div style="clear:both;"></div>
			</li>
			<li class="ui-li ui-li-static ui-btn-up-c">
				<select data-role='nojs' id="PlanID" name="PlanID">
					<option value="1">计划一</option>
					<option value="2">计划二</option>
				</select>
				<label for="PlanID">保险计划：</label>
			</li>
			<li class="ui-li ui-li-static ui-btn-up-c">
				<input data-role='none' type="text" value="" id="DateStart" name="DateStart" />
				<label for="DateStart">生效日期：</label>
			</li>
			<li class="ui-li ui-li-static ui-btn-up-c ui-last-child">
				<input data-role='none' type="text" value="" id="DateEnd" name="DateEnd" />
				<label for="DateEnd">结束日期：</label>
			</li>
		</ul>
    </div>
	<div data-role="footer" data-theme="a" data-position="fixed" data-fullscreen="false" data-tap-toggle="false">
        <a id="savePlan" data-theme="d" data-role="button"  data-inline="false">保  存</a>
    </div>
	<script type="text/javascript">
		var now=new Date();
		var plan={"1":"计划一","2":"计划二"};
		var m=now.getMonth()+1,d=now.getDate();
		if(m<10){m = "0"+m;}
		if(d<10){d = "0"+d;}
		var nowStr=now.getFullYear()+"-"+m+"-"+d;
		var opts={
			theme: "ios",
			lang: "zh",
			display: "bottom",
			mode: "scroller",
			dateFormat:"yy-mm-dd",
			dateOrder: "yymmdd"
		};
		var selOpts={
			theme:'ios',
			mode:'scroller',
			lang:'zh',
			display: 'bottom'
		};
		var dts=$.extend({
			minDate:now,
			maxDate:new Date("2014/09/01"),
			onSelect:function(val){
				var newOpts={
					minDate:new Date(val.replace(/-/g,"/")),
					maxDate:new Date("2014/09/01")
				};
				$("#DateEnd").mobiscroll().date($.extend(newOpts,opts));
			}
		},opts);
		var dte=$.extend({
			minDate:now,
			maxDate:new Date("2014/09/01")
		},opts);
		
		$("#DateStart").val(nowStr);
		$("#DateEnd").val(nowStr);
		$("#DateStart").mobiscroll().date(dts);
		$("#DateEnd").mobiscroll().date(dte);
		$("#PlanID").mobiscroll().select(selOpts);
		$("#Destination").mobiscroll().select(selOpts);
		$("#savePlan").bind("tap",function(){
			policy.Destination=$("#Destination").val();
			policy.PlanID=$("#PlanID").val();
			policy.DateStart=$("#DateStart").val();
			policy.DateEnd=$("#DateEnd").val();
			if(new Date(policy.DateEnd.replace(/-/g,"/")).getTime()<new Date(policy.DateStart.replace(/-/g,"/")).getTime()){
				alert("保险到期日不能小于生效日");
				return ;
			}
			localStorage.setItem("policy",JSON.stringify(policy))
			history.go(-1);
		});
		if(policy.Destination){
			$("#Destination").val(policy.Destination);
			$("#Destination").mobiscroll("setValue",policy.Destination);
			$("#Destination_dummy").val(policy.Destination);
		}
		if(policy.PlanID){
			$("#PlanID").mobiscroll("setValue",policy.PlanID);
			$("#PlanID_dummy").val(plan[policy.PlanID]);
		}
		policy.DateStart&&$("#DateStart").val(policy.DateStart);
		policy.DateEnd&&$("#DateEnd").val(policy.DateEnd);

		setTimeout(function(){
			$("#Destination_dummy").removeClass();
			$("#Destination_dummy").parent().removeClass();
			$("#PlanID_dummy").removeClass();
			$("#PlanID_dummy").parent().removeClass();
		},200);
	</script>
</div>
</body>
</html>


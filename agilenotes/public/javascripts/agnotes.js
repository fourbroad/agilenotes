/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
 * This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
var Model={ADMINDBID:"000000000000000000000000",META:"000000000000000000000001",FORM:"000000000000000000000002",VIEW:"000000000000000000000003",PAGE:"000000000000000000000004",TASK:"000000000000000000000005",USER:"000000000000000000000006",OU:"000000000000000000000007",GROUP:"000000000000000000000008",ROLE:"000000000000000000000009",SIDE_VIEW:"00000000000000000000000a",VALIDATE_METHOD:"00000000000000000000000c",EXTENSION_POINT:"00000000000000000000000d",CATEGORY:"00000000000000000000000e",DATABASE:"00000000000000000000000f",META_ROOT:"0000000000000000000e0001",FORM_ROOT:"0000000000000000000e0002",VIEW_ROOT:"0000000000000000000e0003",PAGE_ROOT:"0000000000000000000e0004",TASK_ROOT:"0000000000000000000e0005",OU_ROOT:"0000000000000000000e0007",GROUP_ROOT:"0000000000000000000e0008",ROLE_ROOT:"0000000000000000000e0009",SIDE_VIEW_ROOT:"0000000000000000000e000a",EXTENSION_ROOT:"0000000000000000000e000b",DATABASE_ROOT:"0000000000000000000e000f",dbs:{},types:{},pages:{},views:{},sideViews:{},extension:{},rootId:function(a){if(a==this.META){return this.META_ROOT}else{if(a==this.FORM){return this.FORM_ROOT}else{if(a==this.VIEW){return this.VIEW_ROOT}else{if(a==this.PAGE){return this.PAGE_ROOT}else{if(a==this.TASK){return this.TASK_ROOT}else{if(a==this.OU||a==this.USER){return this.OU_ROOT}else{if(a==this.GROUP){return this.GROUP_ROOT}else{if(a==this.ROLE){return this.ROLE_ROOT}else{if(a==this.SIDE_VIEW){return this.SIDE_VIEW_ROOT}else{if(a==this.EXTENSION_POINT){return this.EXTENSION_ROOT}else{if(a==this.DATABASE){return this.DATABASE_ROOT}}}}}}}}}}}},getDb:function(b,e){if(this.dbs[b]){e(null,this.dbs[b])}else{var a=this;$.ans.getDB(b,null,function(g,f){if(f){a.dbs[b]=f}e(g,f)})}},getPages:function(h,a,k){var p=this,b={$or:[]},e=[],j;for(var i in a){j=this.pages[a[i]];if(j){e.push(j)}else{b.$or.push({_id:a[i]})}}function g(u,f){var t=[];if(f.length>0){for(var r in u){for(var q in f){if(f[q]._id==u[r]){var s=f[q].type;if(s==Model.PAGE||s==Model.FORM){t.push(f[q]);p.pages[f[q]._id]=f[q]}break}}}}return t}if(b.$or.length>0){$.ans.getDoc(h,null,{selector:b},function(f,q){k(f,g(a,e.concat(q.docs)))})}else{k(null,g(a,e))}},loadExtensions:function(b,g,h){var a=this,f={$or:[]},e={};$.each(g,function(){if(a.extension[b]&&a.extension[b][this]){e[this]=a.extension[b][this]}else{f.$or.push({extensionPoint:this})}});if(f.$or.length>0){$.ans.getDoc(b,null,{selector:f},function(i,j){if(j){$.each(j.docs,function(){a.extension[b]=a.extension[b]||{};a.extension[b][this.extensionPoint]=e[this.extensionPoint]=e[this.extensionPoint]||[];e[this.extensionPoint].push(this)})}h(i,e)})}else{h(null,e)}},newDocument:function(g,f,h,i){i=i||{};i.isNew=true;var e=this,b=Model.rootId(h),j=$.extend(true,{},i["default"],{_id:i.id||new ObjectId().toString(),type:h});if(j._path){j._path=j._path.replace(/[^,]+,$/,j._id+",")}else{if(b){j._path=b+","+j._id+","}}function a(k){if(k.type==e.FORM||k.type==e.PAGE){k.content=k.content||"";e._doOpenPage(g,f,k,$.extend(true,{mode:"design"},i))}else{if(k.type==e.VIEW){k.viewType=i.viewType;e._doOpenView(g,f,k,$.extend(true,{mode:"design"},i))}else{e._doOpenDocument(g,f,k,$.extend(true,{mode:"edit"},i))}}}if($.type(i.parent)=="string"){$.ans.getDoc(f,i.parent,null,function(k,q){if(k){console.log("Get parent document "+i.parent+" error:"+k)}else{if(q&&q._path){j._path=q._path+j._id+","}a(j)}})}else{if(i.parent&&i.parent._path){j._path=i.parent._path+j._id+","}a(j)}},_doOpenDocument:function(element,dbId,doc,opts){var optsx=$.extend(true,{title:opts.title||doc.title||doc.name||doc._id,dbId:dbId,document:doc,isDocumentEditor:true},opts),self=this;if(optsx.formIds){this.getPages(dbId,optsx.formIds,function(err,forms){if(err){console.log("Load forms "+optsx.formIds+" error: "+err)}else{optsx.forms=forms;element.editor(optsx);optsx.opened&&optsx.opened(element.data("editor"))}})}else{var type=this.types[doc.type];function openEditor(type){if(optsx.isNew){var obj=type.defaultValues||"{}";$.extend(true,optsx.document,eval("("+obj+")"))}self.getPages(dbId,(type.forms&&type.forms.split(","))||[],function(err,forms){if(err){console.log("Load forms "+type.forms+" error: "+err)}else{optsx.mobile=doc.mobile;optsx.forms=forms;element.editor(optsx);opts.opened&&opts.opened(element.data("editor"))}})}if(type){openEditor(type)}else{$.ans.getDoc(dbId,doc.type,null,function(err,type){if(err||!type){console.log("Load document type "+doc.type+" error: "+err)}else{self.types[doc.type]=type;openEditor(type)}})}}},openDocument:function(f,b,e,g){g=g||{};var a=this;if(!e&&g.document){this._doOpenDocument(f,b,g.document,g)}else{$.ans.getDoc(b,e,null,function(h,i){if(h){console.log("Load document "+e+" error: "+h)}else{a._doOpenDocument(f,b,i,g)}})}},_doOpenPage:function(element,dbId,page,opts){var self=this,title=opts.title||page.title||page.name||page._id,type=this.types[page.type];function openEditor(type){if(opts.mode=="design"){self.getPages(dbId,(type.forms&&type.forms.split(","))||[],function(err,forms){if(err){console.log("Load forms "+type.forms+" error: "+err)}else{if(opts.isNew){$.extend(true,page,eval("("+type.defaultValues+")"||"{}"))}element.editor($.extend(true,{title:title,dbId:dbId,document:page,forms:forms,design:true},$.extend(true,{},opts,{mode:"edit"})));opts.opened&&opts.opened(element.data("editor"))}})}else{if(page.type==Model.PAGE){if(opts.mobile){element.mpage($.extend(true,{title:title,dbId:dbId,page:page,mobile:true},opts));opts.opened&&opts.opened(element.data("mpage"))}else{element.page($.extend(true,{title:title,dbId:dbId,page:page},opts));opts.opened&&opts.opened(element.data("page"))}}else{if(page.type==Model.FORM){var doc={};if(opts.isNew){$.extend(true,doc,eval("("+type.defaultValues+")"||"{}"))}element.editor($.extend(true,{title:title,dbId:dbId,document:doc,forms:[page]},opts));opts.opened&&opts.opened(element.data("editor"))}}}}if(type){openEditor(type)}else{$.ans.getDoc(dbId,page.type,null,function(err,type){if(err){console.log("Load document type "+page.type+" error: "+err)}else{self.types[page.type]=type;openEditor(type)}})}},openPage:function(f,e,b,g){g=g||{};var a=this;if(this.pages[b]){g.mobile=this.pages[b].mobile;this._doOpenPage(f,e,this.pages[b],g)}else{$.ans.getDoc(e,b,null,function(h,i){if(h){console.log("Load page "+b+" error: "+h)}else{a.pages[b]=i;g.mobile=i.mobile;a._doOpenPage(f,e,i,g)}})}},_doOpenView:function(element,dbId,view,opts){var self=this;function openView(element,dbId,viewDoc,opts){var title=viewDoc.title||viewDoc.name||viewDoc._id,vt=viewDoc.viewType||"gridview";vt=vt.toLowerCase();if(opts.mode=="design"){function openEditor(type){if(opts.isNew){$.extend(true,viewDoc,eval("("+type.defaultValues+")"||"{}"))}self.getPages(dbId,(type.forms&&type.forms.split(","))||[],function(err,forms){if(err){console.log("Load forms "+type.forms+" error: "+err)}else{if(opts.mobile){var cb=viewDoc.viewType;if(cb=="mobilelistview"){element.mobilelistview({view:viewDoc,dbId:dbId,mode:"design"})}else{if(cb=="customview"){element.customview({view:viewDoc,dbId:dbId,mode:"design"})}else{element.view({view:viewDoc,dbId:dbId,mode:"design"})}}opts.opened&&opts.opened(element.data(cb))}else{element.editor($.extend(true,{title:title,dbId:dbId,document:viewDoc,forms:forms,design:true,isViewEditor:true},$.extend(true,{},opts,{mode:"edit"})));opts.opened&&opts.opened(element.data("editor"))}}})}var type=self.types[viewDoc.type];if(type){openEditor(type)}else{$.ans.getDoc(dbId,viewDoc.type,null,function(err,type){if(err){console.log("Load document type "+viewDoc.type+" error: "+err)}else{self.types[viewDoc.type]=type;openEditor(type)}})}}else{vt=(vt=="customizedview"?"view":vt);element[vt]($.extend(true,{title:title,dbId:dbId,view:viewDoc,isViewEditor:true},opts));opts.opened&&opts.opened(element.data(vt))}}if(view.viewType=="formView"){var form=this.pages[view.formId];if(form){opts.form=form;openView(element,dbId,view,opts)}else{$.ans.getDoc(dbId,view.formId,null,function(err,form){if(err){console.log("Load form "+view.formId+" error: "+err)}else{opts.form=self.pages[view.formId]=form;openView(element,dbId,view,opts)}})}}else{openView(element,dbId,view,opts)}},openView:function(g,f,a,h){h=h||{};var e=this,b=this.views[a];if(b){this._doOpenView(g,f,b,h)}else{$.ans.getDoc(f,a,null,function(j,i){if(j){console.log("Load view "+a+" error: "+j)}else{e.views[a]=i;e._doOpenView(g,f,i,h)}})}},_doOpenSideView:function(e,b,a,f){if(a){e.sideview($.extend(true,{dbId:b},a,f));f.opened&&f.opened(e.data("sideview"))}},openSideView:function(f,e,g,h){h=h||{};var b=this,a=this.sideViews[g];if(a){this._doOpenSideView(f,e,a,h)}else{$.ans.getDoc(e,g,null,function(j,i){if(j){console.log("Load side view "+g+" error: "+j)}else{b.sideViews[g]=i;b._doOpenSideView(f,e,i,h)}})}},postDocument:function(a,e,b,f){$.ans.postDoc(a,e,b,f)},updateDocument:function(b,e,a,f,g){this._cleanCache(e);$.ans.putDoc(b,e,a,f,g)},deleteDocument:function(a,e,b,f){this._cleanCache(e);$.ans.delDoc(a,e,b,f)},_cleanCache:function(a){delete this.types[a];delete this.pages[a];delete this.views[a];delete this.sideViews[a]}};function DocWrapper(doc,parseDot){this._doc=doc;this._parseDot=parseDot;this.setDoc=function(doc){var oldDoc=this._doc;this._doc=doc;$(this).trigger("docchanged",[doc,oldDoc])};this.getDoc=function(){return this._doc};this.prop=function(id,value,isTransient){if(!id){return null}if(value===undefined){try{return eval("this._doc."+id)}catch(e){}}else{var oldValue=this.prop(id);if(value==oldValue){return this}if(this._parseDot){var parts=id.split(".");function assign(doc,parts,val){var part=parts.shift(),r=part.match(/([a-zA-Z0-9_]+)\[([0-9]+)\]/);if(r){doc[r[1]]=doc[r[1]]||[];if(parts.length>0){doc[r[1]][r[2]]=doc[r[1]][r[2]]||{};assign(doc[r[1]][r[2]],parts,val)}else{doc[r[1]][r[2]]=val}}else{if(parts.length>0){doc[part]=doc[part]||{};assign(doc[part],parts,val)}else{doc[part]=val}}}assign(this._doc,parts,value)}else{this._doc[id]=value}$(this).trigger("propchanged",[id,value,oldValue,isTransient])}}}
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
Date.prototype.format=function(a){var e={"m+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"M+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in e){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(e[b]):(("00"+e[b]).substr((""+e[b]).length)))}}return a};Date.prototype.add=function(e){var h=this.getFullYear(),a=this.getMonth()+1,g=this.getDate(),f=0;if(typeof e!="object"){return this}for(var b in e){if(b=="year"){h+=e[b]}else{if(b=="month"){a+=e[b];if(a>12){h+=parseInt(a/12);a=a%12}if(a<1){h+=parseInt(a/12)-1;a=12+a%12}}else{if(b=="day"){f+=e[b]}}}}return new Date(new Date(h+"/"+a+"/"+g).getTime()+f*24*60*60*1000)};function emptyEqual(b,a){if(b===null&&a===null){return 1}else{if(b===null||a===null){return -1}}if(b===undefined&&a===undefined){return 1}else{if(b===undefined||a===undefined){return -1}}if(b===""&&a===""){return 1}else{if(b===""||a===""){return -1}}return 0}function isBothObject(b,a){if(typeof b==="object"&&typeof a==="object"){return 0}else{if(typeof b==="object"||typeof a==="object"){return -1}}return 1}function equals(f,b){var e=0;var a=true;e=emptyEqual(f,b);if(e==1){return true}else{if(e==-1){return false}}e=isBothObject(f,b);if(e==-1){return false}if(e==1){if(f===b){return true}else{return false}}else{for(var g in f){var h=arguments.callee(f[g],b[g]);if(!h){a=false;break}}for(var g in b){var h=arguments.callee(b[g],f[g]);if(!h){a=false;break}}}return a}function getUrlParam(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),e=window.location.search.substr(1).match(b);return e!=null?unescape(e[2]):null}function attributes(f){var b={},a=f.attributes;for(var e=0;e<a.length;e++){if(a[e].name!="metadata"){b[a[e].name]=a[e].value}}return b}function print(a){var b=$("body").children("iframe#printer");if(b.length==0){b=$("<iframe id='printer'>").hide().appendTo("body")}b.attr("src",a)}function showDialog(h,g,f){var b=window.database.local;f=f||{};var e=[];$.each(f.buttons||[],function(){var i=this;e.push({text:i.text,click:function(){i.handler&&i.handler($(this).data("dialog"))}})});var a="OK";if(b&&b!="en"){a=$.i18n.dialog.ok}if(e.length==0){e.push({text:a,click:function(){$(this).dialog("close")}})}$("<div/>").dialog({title:h,height:220,width:360,modal:true,create:function(i,j){$(this).html(g)},buttons:e,close:function(j,i){$(this).remove()}})}function openDialog(a,f,b,e){$("<div/>").dialog($.extend(true,{height:220,width:360,modal:true,create:function(g,h){Model[e]($(this),a,f,b)},buttons:[{text:"OK",click:function(){$(this).dialog("close")}}],close:function(h,g){$(this).remove()}},b))}function newDocument(a,b,e){openDialog(a,b,e,"newDocument")}function openDocument(a,b,e){openDialog(a,b,e,"openDocument")}var openPage,openView,openPage,openSideView;openForm=openPage=function(b,a,e){openDialog(b,a,e,"openPage")};openView=function(b,a,e){openDialog(b,a,e,"openView")};openSideView=function(b,a,e){openDialog(b,a,e,"openSideView")};var hexcase=0;function hex_md5(b){return rstr2hex(rstr_md5(str2rstr_utf8(b)))}function hex_hmac_md5(f,e){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(f),str2rstr_utf8(e)))}function md5_vm_test(){return hex_md5("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function rstr_md5(b){return binl2rstr(binl_md5(rstr2binl(b),b.length*8))}function rstr_hmac_md5(r,k){var p=rstr2binl(r);if(p.length>16){p=binl_md5(p,r.length*8)}var i=Array(16),q=Array(16);for(var h=0;h<16;h++){i[h]=p[h]^909522486;q[h]=p[h]^1549556828}var j=binl_md5(i.concat(rstr2binl(k)),512+k.length*8);return binl2rstr(binl_md5(q.concat(j),512+128))}function rstr2hex(p){try{hexcase}catch(i){hexcase=0}var j=hexcase?"0123456789ABCDEF":"0123456789abcdef";var e="";var h;for(var k=0;k<p.length;k++){h=p.charCodeAt(k);e+=j.charAt((h>>>4)&15)+j.charAt(h&15)}return e}function str2rstr_utf8(j){var f="";var i=-1;var g,h;while(++i<j.length){g=j.charCodeAt(i);h=i+1<j.length?j.charCodeAt(i+1):0;if(55296<=g&&g<=56319&&56320<=h&&h<=57343){g=65536+((g&1023)<<10)+(h&1023);i++}if(g<=127){f+=String.fromCharCode(g)}else{if(g<=2047){f+=String.fromCharCode(192|((g>>>6)&31),128|(g&63))}else{if(g<=65535){f+=String.fromCharCode(224|((g>>>12)&15),128|((g>>>6)&63),128|(g&63))}else{if(g<=2097151){f+=String.fromCharCode(240|((g>>>18)&7),128|((g>>>12)&63),128|((g>>>6)&63),128|(g&63))}}}}}return f}function rstr2binl(e){var f=Array(e.length>>2);for(var g=0;g<f.length;g++){f[g]=0}for(var g=0;g<e.length*8;g+=8){f[g>>5]|=(e.charCodeAt(g/8)&255)<<(g%32)}return f}function binl2rstr(e){var f="";for(var g=0;g<e.length*32;g+=8){f+=String.fromCharCode((e[g>>5]>>>(g%32))&255)}return f}function binl_md5(a,s){a[s>>5]|=128<<((s)%32);a[(((s+64)>>>9)<<4)+14]=s;var b=1732584193;var i=-271733879;var q=-1732584194;var r=271733878;for(var v=0;v<a.length;v+=16){var t=b;var u=i;var w=q;var x=r;b=md5_ff(b,i,q,r,a[v+0],7,-680876936);r=md5_ff(r,b,i,q,a[v+1],12,-389564586);q=md5_ff(q,r,b,i,a[v+2],17,606105819);i=md5_ff(i,q,r,b,a[v+3],22,-1044525330);b=md5_ff(b,i,q,r,a[v+4],7,-176418897);r=md5_ff(r,b,i,q,a[v+5],12,1200080426);q=md5_ff(q,r,b,i,a[v+6],17,-1473231341);i=md5_ff(i,q,r,b,a[v+7],22,-45705983);b=md5_ff(b,i,q,r,a[v+8],7,1770035416);r=md5_ff(r,b,i,q,a[v+9],12,-1958414417);q=md5_ff(q,r,b,i,a[v+10],17,-42063);i=md5_ff(i,q,r,b,a[v+11],22,-1990404162);b=md5_ff(b,i,q,r,a[v+12],7,1804603682);r=md5_ff(r,b,i,q,a[v+13],12,-40341101);q=md5_ff(q,r,b,i,a[v+14],17,-1502002290);i=md5_ff(i,q,r,b,a[v+15],22,1236535329);b=md5_gg(b,i,q,r,a[v+1],5,-165796510);r=md5_gg(r,b,i,q,a[v+6],9,-1069501632);q=md5_gg(q,r,b,i,a[v+11],14,643717713);i=md5_gg(i,q,r,b,a[v+0],20,-373897302);b=md5_gg(b,i,q,r,a[v+5],5,-701558691);r=md5_gg(r,b,i,q,a[v+10],9,38016083);q=md5_gg(q,r,b,i,a[v+15],14,-660478335);i=md5_gg(i,q,r,b,a[v+4],20,-405537848);b=md5_gg(b,i,q,r,a[v+9],5,568446438);r=md5_gg(r,b,i,q,a[v+14],9,-1019803690);q=md5_gg(q,r,b,i,a[v+3],14,-187363961);i=md5_gg(i,q,r,b,a[v+8],20,1163531501);b=md5_gg(b,i,q,r,a[v+13],5,-1444681467);r=md5_gg(r,b,i,q,a[v+2],9,-51403784);q=md5_gg(q,r,b,i,a[v+7],14,1735328473);i=md5_gg(i,q,r,b,a[v+12],20,-1926607734);b=md5_hh(b,i,q,r,a[v+5],4,-378558);r=md5_hh(r,b,i,q,a[v+8],11,-2022574463);q=md5_hh(q,r,b,i,a[v+11],16,1839030562);i=md5_hh(i,q,r,b,a[v+14],23,-35309556);b=md5_hh(b,i,q,r,a[v+1],4,-1530992060);r=md5_hh(r,b,i,q,a[v+4],11,1272893353);q=md5_hh(q,r,b,i,a[v+7],16,-155497632);i=md5_hh(i,q,r,b,a[v+10],23,-1094730640);b=md5_hh(b,i,q,r,a[v+13],4,681279174);r=md5_hh(r,b,i,q,a[v+0],11,-358537222);q=md5_hh(q,r,b,i,a[v+3],16,-722521979);i=md5_hh(i,q,r,b,a[v+6],23,76029189);b=md5_hh(b,i,q,r,a[v+9],4,-640364487);r=md5_hh(r,b,i,q,a[v+12],11,-421815835);q=md5_hh(q,r,b,i,a[v+15],16,530742520);i=md5_hh(i,q,r,b,a[v+2],23,-995338651);b=md5_ii(b,i,q,r,a[v+0],6,-198630844);r=md5_ii(r,b,i,q,a[v+7],10,1126891415);q=md5_ii(q,r,b,i,a[v+14],15,-1416354905);i=md5_ii(i,q,r,b,a[v+5],21,-57434055);b=md5_ii(b,i,q,r,a[v+12],6,1700485571);r=md5_ii(r,b,i,q,a[v+3],10,-1894986606);q=md5_ii(q,r,b,i,a[v+10],15,-1051523);i=md5_ii(i,q,r,b,a[v+1],21,-2054922799);b=md5_ii(b,i,q,r,a[v+8],6,1873313359);r=md5_ii(r,b,i,q,a[v+15],10,-30611744);q=md5_ii(q,r,b,i,a[v+6],15,-1560198380);i=md5_ii(i,q,r,b,a[v+13],21,1309151649);b=md5_ii(b,i,q,r,a[v+4],6,-145523070);r=md5_ii(r,b,i,q,a[v+11],10,-1120210379);q=md5_ii(q,r,b,i,a[v+2],15,718787259);i=md5_ii(i,q,r,b,a[v+9],21,-343485551);b=safe_add(b,t);i=safe_add(i,u);q=safe_add(q,w);r=safe_add(r,x)}return Array(b,i,q,r)}function md5_cmn(a,j,k,p,b,i){return safe_add(bit_rol(safe_add(safe_add(j,a),safe_add(p,i)),b),k)}function md5_ff(r,s,a,b,t,p,q){return md5_cmn((s&a)|((~s)&b),r,s,t,p,q)}function md5_gg(r,s,a,b,t,p,q){return md5_cmn((s&b)|(a&(~b)),r,s,t,p,q)}function md5_hh(r,s,a,b,t,p,q){return md5_cmn(s^a^b,r,s,t,p,q)}function md5_ii(r,s,a,b,t,p,q){return md5_cmn(a^(s|(~b)),r,s,t,p,q)}function safe_add(f,g){var h=(f&65535)+(g&65535);var e=(f>>16)+(g>>16)+(h>>16);return(e<<16)|(h&65535)}function bit_rol(f,e){return(f<<e)|(f>>>(32-e))}function md5(a){return hex_md5(a)}var ObjectId=(function(){var a=0;var b=Math.floor(Math.random()*(32767));var j=Math.floor(Math.random()*(16777216));if(localStorage&&typeof(localStorage)!="undefined"){var h=parseInt(localStorage.mongoMachineId);if(h>=0&&h<=16777215){j=Math.floor(localStorage.mongoMachineId)}localStorage.mongoMachineId=j;document.cookie="mongoMachineId="+j+";expires=Tue, 19 Jan 2038 05:00:00 GMT"}else{var e=document.cookie.split("; ");for(var g in e){var f=e[g].split("=");if(f[0]=="mongoMachineId"&&f[1]>=0&&f[1]<=16777215){j=f[1];break}}document.cookie="mongoMachineId="+j+";expires=Tue, 19 Jan 2038 05:00:00 GMT"}return function(){if(!(this instanceof ObjectId)){return new ObjectId(arguments[0],arguments[1],arguments[2],arguments[3]).toString()}if(typeof(arguments[0])=="object"){this.timestamp=arguments[0].timestamp;this.machine=arguments[0].machine;this.pid=arguments[0].pid;this.increment=arguments[0].increment}else{if(typeof(arguments[0])=="string"&&arguments[0].length==24){this.timestamp=Number("0x"+arguments[0].substr(0,8)),this.machine=Number("0x"+arguments[0].substr(8,6)),this.pid=Number("0x"+arguments[0].substr(14,4)),this.increment=Number("0x"+arguments[0].substr(18,6))}else{if(arguments.length==4&&arguments[0]!=null){this.timestamp=arguments[0];this.machine=arguments[1];this.pid=arguments[2];this.increment=arguments[3]}else{this.timestamp=Math.floor(new Date().valueOf()/1000);this.machine=j;this.pid=b;if(a>16777215){a=0}this.increment=a++}}}}})();ObjectId.prototype.getDate=function(){return new Date(this.timestamp*1000)};ObjectId.prototype.toString=function(){var f=this.timestamp.toString(16);var e=this.machine.toString(16);var b=this.pid.toString(16);var a=this.increment.toString(16);return"00000000".substr(0,6-f.length)+f+"000000".substr(0,6-e.length)+e+"0000".substr(0,4-b.length)+b+"000000".substr(0,6-a.length)+a};
/*
 * jQuery JavaScript Library v1.8.2
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: Thu Sep 20 2012 21:13:05 GMT-0400 (Eastern Daylight Time)
 */
(function(a9,aI){var D,am,u=a9.document,aP=a9.location,g=a9.navigator,bo=a9.jQuery,P=a9.$,au=Array.prototype.push,bb=Array.prototype.slice,aR=Array.prototype.indexOf,G=Object.prototype.toString,ac=Object.prototype.hasOwnProperty,aV=String.prototype.trim,bO=function(e,b7){return new bO.fn.init(e,b7,D)},bF=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,ah=/\S/,a2=/\s+/,J=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,bw=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,a=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,bn=/^[\],:{}\s]*$/,bq=/(?:^|:|,)(?:\s*\[)+/g,bL=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,a7=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,bX=/^-ms-/,a1=/-([\da-z])/gi,U=function(e,b7){return(b7+"").toUpperCase()},aM=function(){if(u.addEventListener){u.removeEventListener("DOMContentLoaded",aM,false);bO.ready()}else{if(u.readyState==="complete"){u.detachEvent("onreadystatechange",aM);bO.ready()}}},ag={};bO.fn=bO.prototype={constructor:bO,init:function(e,ca,b9){var b8,cb,b7,cc;if(!e){return this}if(e.nodeType){this.context=this[0]=e;this.length=1;return this}if(typeof e==="string"){if(e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3){b8=[null,e,null]}else{b8=bw.exec(e)}if(b8&&(b8[1]||!ca)){if(b8[1]){ca=ca instanceof bO?ca[0]:ca;cc=(ca&&ca.nodeType?ca.ownerDocument||ca:u);e=bO.parseHTML(b8[1],cc,true);if(a.test(b8[1])&&bO.isPlainObject(ca)){this.attr.call(e,ca,true)}return bO.merge(this,e)}else{cb=u.getElementById(b8[2]);if(cb&&cb.parentNode){if(cb.id!==b8[2]){return b9.find(e)}this.length=1;this[0]=cb}this.context=u;this.selector=e;return this}}else{if(!ca||ca.jquery){return(ca||b9).find(e)}else{return this.constructor(ca).find(e)}}}else{if(bO.isFunction(e)){return b9.ready(e)}}if(e.selector!==aI){this.selector=e.selector;this.context=e.context}return bO.makeArray(e,this)},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return bb.call(this)},get:function(e){return e==null?this.toArray():(e<0?this[this.length+e]:this[e])},pushStack:function(b7,b9,e){var b8=bO.merge(this.constructor(),b7);b8.prevObject=this;b8.context=this.context;if(b9==="find"){b8.selector=this.selector+(this.selector?" ":"")+e}else{if(b9){b8.selector=this.selector+"."+b9+"("+e+")"}}return b8},each:function(b7,e){return bO.each(this,b7,e)},ready:function(e){bO.ready.promise().done(e);return this},eq:function(e){e=+e;return e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(bb.apply(this,arguments),"slice",bb.call(arguments).join(","))},map:function(e){return this.pushStack(bO.map(this,function(b8,b7){return e.call(b8,b7,b8)}))},end:function(){return this.prevObject||this.constructor(null)},push:au,sort:[].sort,splice:[].splice};bO.fn.init.prototype=bO.fn;bO.extend=bO.fn.extend=function(){var cf,b8,e,b7,cc,cd,cb=arguments[0]||{},ca=1,b9=arguments.length,ce=false;if(typeof cb==="boolean"){ce=cb;cb=arguments[1]||{};ca=2}if(typeof cb!=="object"&&!bO.isFunction(cb)){cb={}}if(b9===ca){cb=this;--ca}for(;ca<b9;ca++){if((cf=arguments[ca])!=null){for(b8 in cf){e=cb[b8];b7=cf[b8];if(cb===b7){continue}if(ce&&b7&&(bO.isPlainObject(b7)||(cc=bO.isArray(b7)))){if(cc){cc=false;cd=e&&bO.isArray(e)?e:[]}else{cd=e&&bO.isPlainObject(e)?e:{}}cb[b8]=bO.extend(ce,cd,b7)}else{if(b7!==aI){cb[b8]=b7}}}}}return cb};bO.extend({noConflict:function(e){if(a9.$===bO){a9.$=P}if(e&&a9.jQuery===bO){a9.jQuery=bo}return bO},isReady:false,readyWait:1,holdReady:function(e){if(e){bO.readyWait++}else{bO.ready(true)}},ready:function(e){if(e===true?--bO.readyWait:bO.isReady){return}if(!u.body){return setTimeout(bO.ready,1)}bO.isReady=true;if(e!==true&&--bO.readyWait>0){return}am.resolveWith(u,[bO]);if(bO.fn.trigger){bO(u).trigger("ready").off("ready")}},isFunction:function(e){return bO.type(e)==="function"},isArray:Array.isArray||function(e){return bO.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return !isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):ag[G.call(e)]||"object"},isPlainObject:function(b9){if(!b9||bO.type(b9)!=="object"||b9.nodeType||bO.isWindow(b9)){return false}try{if(b9.constructor&&!ac.call(b9,"constructor")&&!ac.call(b9.constructor.prototype,"isPrototypeOf")){return false}}catch(b8){return false}var b7;for(b7 in b9){}return b7===aI||ac.call(b9,b7)},isEmptyObject:function(b7){var e;for(e in b7){return false}return true},error:function(e){throw new Error(e)},parseHTML:function(b9,b8,e){var b7;if(!b9||typeof b9!=="string"){return null}if(typeof b8==="boolean"){e=b8;b8=0}b8=b8||u;if((b7=a.exec(b9))){return[b8.createElement(b7[1])]}b7=bO.buildFragment([b9],b8,e?null:[]);return bO.merge([],(b7.cacheable?bO.clone(b7.fragment):b7.fragment).childNodes)},parseJSON:function(e){if(!e||typeof e!=="string"){return null}e=bO.trim(e);if(a9.JSON&&a9.JSON.parse){return a9.JSON.parse(e)}if(bn.test(e.replace(bL,"@").replace(a7,"]").replace(bq,""))){return(new Function("return "+e))()}bO.error("Invalid JSON: "+e)},parseXML:function(b9){var b7,b8;if(!b9||typeof b9!=="string"){return null}try{if(a9.DOMParser){b8=new DOMParser();b7=b8.parseFromString(b9,"text/xml")}else{b7=new ActiveXObject("Microsoft.XMLDOM");b7.async="false";b7.loadXML(b9)}}catch(ca){b7=aI}if(!b7||!b7.documentElement||b7.getElementsByTagName("parsererror").length){bO.error("Invalid XML: "+b9)}return b7},noop:function(){},globalEval:function(e){if(e&&ah.test(e)){(a9.execScript||function(b7){a9["eval"].call(a9,b7)})(e)}},camelCase:function(e){return e.replace(bX,"ms-").replace(a1,U)},nodeName:function(b7,e){return b7.nodeName&&b7.nodeName.toLowerCase()===e.toLowerCase()},each:function(cb,cc,b8){var b7,b9=0,ca=cb.length,e=ca===aI||bO.isFunction(cb);if(b8){if(e){for(b7 in cb){if(cc.apply(cb[b7],b8)===false){break}}}else{for(;b9<ca;){if(cc.apply(cb[b9++],b8)===false){break}}}}else{if(e){for(b7 in cb){if(cc.call(cb[b7],b7,cb[b7])===false){break}}}else{for(;b9<ca;){if(cc.call(cb[b9],b9,cb[b9++])===false){break}}}}return cb},trim:aV&&!aV.call("\uFEFF\xA0")?function(e){return e==null?"":aV.call(e)}:function(e){return e==null?"":(e+"").replace(J,"")},makeArray:function(e,b8){var b9,b7=b8||[];if(e!=null){b9=bO.type(e);if(e.length==null||b9==="string"||b9==="function"||b9==="regexp"||bO.isWindow(e)){au.call(b7,e)}else{bO.merge(b7,e)}}return b7},inArray:function(b9,b7,b8){var e;if(b7){if(aR){return aR.call(b7,b9,b8)}e=b7.length;b8=b8?b8<0?Math.max(0,e+b8):b8:0;for(;b8<e;b8++){if(b8 in b7&&b7[b8]===b9){return b8}}}return -1},merge:function(ca,b8){var e=b8.length,b9=ca.length,b7=0;if(typeof e==="number"){for(;b7<e;b7++){ca[b9++]=b8[b7]}}else{while(b8[b7]!==aI){ca[b9++]=b8[b7++]}}ca.length=b9;return ca},grep:function(b7,cc,e){var cb,b8=[],b9=0,ca=b7.length;e=!!e;for(;b9<ca;b9++){cb=!!cc(b7[b9],b9);if(e!==cb){b8.push(b7[b9])}}return b8},map:function(e,cd,ce){var cb,cc,ca=[],b8=0,b7=e.length,b9=e instanceof bO||b7!==aI&&typeof b7==="number"&&((b7>0&&e[0]&&e[b7-1])||b7===0||bO.isArray(e));if(b9){for(;b8<b7;b8++){cb=cd(e[b8],b8,ce);if(cb!=null){ca[ca.length]=cb}}}else{for(cc in e){cb=cd(e[cc],cc,ce);if(cb!=null){ca[ca.length]=cb}}}return ca.concat.apply([],ca)},guid:1,proxy:function(ca,b9){var b8,e,b7;if(typeof b9==="string"){b8=ca[b9];b9=ca;ca=b8}if(!bO.isFunction(ca)){return aI}e=bb.call(arguments,2);b7=function(){return ca.apply(b9,e.concat(bb.call(arguments)))};b7.guid=ca.guid=ca.guid||bO.guid++;return b7},access:function(e,cc,cf,cd,ca,cg,ce){var b8,cb=cf==null,b9=0,b7=e.length;if(cf&&typeof cf==="object"){for(b9 in cf){bO.access(e,cc,b9,cf[b9],1,cg,cd)}ca=1}else{if(cd!==aI){b8=ce===aI&&bO.isFunction(cd);if(cb){if(b8){b8=cc;cc=function(ci,ch,cj){return b8.call(bO(ci),cj)}}else{cc.call(e,cd);cc=null}}if(cc){for(;b9<b7;b9++){cc(e[b9],cf,b8?cd.call(e[b9],b9,cc(e[b9],cf)):cd,ce)}}ca=1}}return ca?e:cb?cc.call(e):b7?cc(e[0],cf):cg},now:function(){return(new Date()).getTime()}});bO.ready.promise=function(ca){if(!am){am=bO.Deferred();if(u.readyState==="complete"){setTimeout(bO.ready,1)}else{if(u.addEventListener){u.addEventListener("DOMContentLoaded",aM,false);a9.addEventListener("load",bO.ready,false)}else{u.attachEvent("onreadystatechange",aM);a9.attachEvent("onload",bO.ready);var b9=false;try{b9=a9.frameElement==null&&u.documentElement}catch(b8){}if(b9&&b9.doScroll){(function b7(){if(!bO.isReady){try{b9.doScroll("left")}catch(cb){return setTimeout(b7,50)}bO.ready()}})()}}}}return am.promise(ca)};bO.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(b7,e){ag["[object "+e+"]"]=e.toLowerCase()});D=bO(u);var b2={};function aj(b7){var e=b2[b7]={};bO.each(b7.split(a2),function(b9,b8){e[b8]=true});return e}bO.Callbacks=function(cg){cg=typeof cg==="string"?(b2[cg]||aj(cg)):bO.extend({},cg);var b9,e,ca,b8,cb,cc,cd=[],ce=!cg.once&&[],b7=function(ch){b9=cg.memory&&ch;e=true;cc=b8||0;b8=0;cb=cd.length;ca=true;for(;cd&&cc<cb;cc++){if(cd[cc].apply(ch[0],ch[1])===false&&cg.stopOnFalse){b9=false;break}}ca=false;if(cd){if(ce){if(ce.length){b7(ce.shift())}}else{if(b9){cd=[]}else{cf.disable()}}}},cf={add:function(){if(cd){var ci=cd.length;(function ch(cj){bO.each(cj,function(cl,ck){var cm=bO.type(ck);if(cm==="function"&&(!cg.unique||!cf.has(ck))){cd.push(ck)}else{if(ck&&ck.length&&cm!=="string"){ch(ck)}}})})(arguments);if(ca){cb=cd.length}else{if(b9){b8=ci;b7(b9)}}}return this},remove:function(){if(cd){bO.each(arguments,function(cj,ch){var ci;while((ci=bO.inArray(ch,cd,ci))>-1){cd.splice(ci,1);if(ca){if(ci<=cb){cb--}if(ci<=cc){cc--}}}})}return this},has:function(ch){return bO.inArray(ch,cd)>-1},empty:function(){cd=[];return this},disable:function(){cd=ce=b9=aI;return this},disabled:function(){return !cd},lock:function(){ce=aI;if(!b9){cf.disable()}return this},locked:function(){return !ce},fireWith:function(ci,ch){ch=ch||[];ch=[ci,ch.slice?ch.slice():ch];if(cd&&(!e||ce)){if(ca){ce.push(ch)}else{b7(ch)}}return this},fire:function(){cf.fireWith(this,arguments);return this},fired:function(){return !!e}};return cf};bO.extend({Deferred:function(b8){var b7=[["resolve","done",bO.Callbacks("once memory"),"resolved"],["reject","fail",bO.Callbacks("once memory"),"rejected"],["notify","progress",bO.Callbacks("memory")]],b9="pending",ca={state:function(){return b9},always:function(){e.done(arguments).fail(arguments);return this},then:function(){var cb=arguments;return bO.Deferred(function(cc){bO.each(b7,function(ce,cd){var cg=cd[0],cf=cb[ce];e[cd[1]](bO.isFunction(cf)?function(){var ch=cf.apply(this,arguments);if(ch&&bO.isFunction(ch.promise)){ch.promise().done(cc.resolve).fail(cc.reject).progress(cc.notify)}else{cc[cg+"With"](this===e?cc:this,[ch])}}:cc[cg])});cb=null}).promise()},promise:function(cb){return cb!=null?bO.extend(cb,ca):ca}},e={};ca.pipe=ca.then;bO.each(b7,function(cc,cb){var ce=cb[2],cd=cb[3];ca[cb[1]]=ce.add;if(cd){ce.add(function(){b9=cd},b7[cc^1][2].disable,b7[2][2].lock)}e[cb[0]]=ce.fire;e[cb[0]+"With"]=ce.fireWith});ca.promise(e);if(b8){b8.call(e,e)}return e},when:function(ca){var b8=0,cc=bb.call(arguments),e=cc.length,b7=e!==1||(ca&&bO.isFunction(ca.promise))?e:0,cf=b7===1?ca:bO.Deferred(),b9=function(ch,ci,cg){return function(cj){ci[ch]=this;cg[ch]=arguments.length>1?bb.call(arguments):cj;if(cg===ce){cf.notifyWith(ci,cg)}else{if(!(--b7)){cf.resolveWith(ci,cg)}}}},ce,cb,cd;if(e>1){ce=new Array(e);cb=new Array(e);cd=new Array(e);for(;b8<e;b8++){if(cc[b8]&&bO.isFunction(cc[b8].promise)){cc[b8].promise().done(b9(b8,cd,cc)).fail(cf.reject).progress(b9(b8,cb,ce))}else{--b7}}}if(!b7){cf.resolveWith(cd,cc)}return cf.promise()}});bO.support=(function(){var cj,ci,cg,ch,ca,cf,ce,cc,cb,b9,b7,b8=u.createElement("div");b8.setAttribute("className","t");b8.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";ci=b8.getElementsByTagName("*");cg=b8.getElementsByTagName("a")[0];cg.style.cssText="top:1px;float:left;opacity:.5";if(!ci||!ci.length){return{}}ch=u.createElement("select");ca=ch.appendChild(u.createElement("option"));cf=b8.getElementsByTagName("input")[0];cj={leadingWhitespace:(b8.firstChild.nodeType===3),tbody:!b8.getElementsByTagName("tbody").length,htmlSerialize:!!b8.getElementsByTagName("link").length,style:/top/.test(cg.getAttribute("style")),hrefNormalized:(cg.getAttribute("href")==="/a"),opacity:/^0.5/.test(cg.style.opacity),cssFloat:!!cg.style.cssFloat,checkOn:(cf.value==="on"),optSelected:ca.selected,getSetAttribute:b8.className!=="t",enctype:!!u.createElement("form").enctype,html5Clone:u.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",boxModel:(u.compatMode==="CSS1Compat"),submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true,boxSizingReliable:true,pixelPosition:false};cf.checked=true;cj.noCloneChecked=cf.cloneNode(true).checked;ch.disabled=true;cj.optDisabled=!ca.disabled;try{delete b8.test}catch(cd){cj.deleteExpando=false}if(!b8.addEventListener&&b8.attachEvent&&b8.fireEvent){b8.attachEvent("onclick",b7=function(){cj.noCloneEvent=false});b8.cloneNode(true).fireEvent("onclick");b8.detachEvent("onclick",b7)}cf=u.createElement("input");cf.value="t";cf.setAttribute("type","radio");cj.radioValue=cf.value==="t";cf.setAttribute("checked","checked");cf.setAttribute("name","t");b8.appendChild(cf);ce=u.createDocumentFragment();ce.appendChild(b8.lastChild);cj.checkClone=ce.cloneNode(true).cloneNode(true).lastChild.checked;cj.appendChecked=cf.checked;ce.removeChild(cf);ce.appendChild(b8);if(b8.attachEvent){for(cb in {submit:true,change:true,focusin:true}){cc="on"+cb;b9=(cc in b8);if(!b9){b8.setAttribute(cc,"return;");b9=(typeof b8[cc]==="function")}cj[cb+"Bubbles"]=b9}}bO(function(){var ck,co,cm,cn,cl="padding:0;margin:0;border:0;display:block;overflow:hidden;",e=u.getElementsByTagName("body")[0];if(!e){return}ck=u.createElement("div");ck.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px";e.insertBefore(ck,e.firstChild);co=u.createElement("div");ck.appendChild(co);co.innerHTML="<table><tr><td></td><td>t</td></tr></table>";cm=co.getElementsByTagName("td");cm[0].style.cssText="padding:0;margin:0;border:0;display:none";b9=(cm[0].offsetHeight===0);cm[0].style.display="";cm[1].style.display="none";cj.reliableHiddenOffsets=b9&&(cm[0].offsetHeight===0);co.innerHTML="";co.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";cj.boxSizing=(co.offsetWidth===4);cj.doesNotIncludeMarginInBodyOffset=(e.offsetTop!==1);if(a9.getComputedStyle){cj.pixelPosition=(a9.getComputedStyle(co,null)||{}).top!=="1%";cj.boxSizingReliable=(a9.getComputedStyle(co,null)||{width:"4px"}).width==="4px";cn=u.createElement("div");cn.style.cssText=co.style.cssText=cl;cn.style.marginRight=cn.style.width="0";co.style.width="1px";co.appendChild(cn);cj.reliableMarginRight=!parseFloat((a9.getComputedStyle(cn,null)||{}).marginRight)}if(typeof co.style.zoom!=="undefined"){co.innerHTML="";co.style.cssText=cl+"width:1px;padding:1px;display:inline;zoom:1";cj.inlineBlockNeedsLayout=(co.offsetWidth===3);co.style.display="block";co.style.overflow="visible";co.innerHTML="<div></div>";co.firstChild.style.width="5px";cj.shrinkWrapBlocks=(co.offsetWidth!==3);ck.style.zoom=1}e.removeChild(ck);ck=co=cm=cn=null});ce.removeChild(b8);ci=cg=ch=ca=cf=ce=b8=null;return cj})();var bB=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,aS=/([A-Z])/g;bO.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(bO.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(e){e=e.nodeType?bO.cache[e[bO.expando]]:e[bO.expando];return !!e&&!V(e)},data:function(b9,b7,cb,ca){if(!bO.acceptData(b9)){return}var cc,ce,cf=bO.expando,cd=typeof b7==="string",cg=b9.nodeType,e=cg?bO.cache:b9,b8=cg?b9[cf]:b9[cf]&&cf;if((!b8||!e[b8]||(!ca&&!e[b8].data))&&cd&&cb===aI){return}if(!b8){if(cg){b9[cf]=b8=bO.deletedIds.pop()||bO.guid++}else{b8=cf}}if(!e[b8]){e[b8]={};if(!cg){e[b8].toJSON=bO.noop}}if(typeof b7==="object"||typeof b7==="function"){if(ca){e[b8]=bO.extend(e[b8],b7)}else{e[b8].data=bO.extend(e[b8].data,b7)}}cc=e[b8];if(!ca){if(!cc.data){cc.data={}}cc=cc.data}if(cb!==aI){cc[bO.camelCase(b7)]=cb}if(cd){ce=cc[b7];if(ce==null){ce=cc[bO.camelCase(b7)]}}else{ce=cc}return ce},removeData:function(b9,b7,ca){if(!bO.acceptData(b9)){return}var cd,cc,cb,ce=b9.nodeType,e=ce?bO.cache:b9,b8=ce?b9[bO.expando]:bO.expando;if(!e[b8]){return}if(b7){cd=ca?e[b8]:e[b8].data;if(cd){if(!bO.isArray(b7)){if(b7 in cd){b7=[b7]}else{b7=bO.camelCase(b7);if(b7 in cd){b7=[b7]}else{b7=b7.split(" ")}}}for(cc=0,cb=b7.length;cc<cb;cc++){delete cd[b7[cc]]}if(!(ca?V:bO.isEmptyObject)(cd)){return}}}if(!ca){delete e[b8].data;if(!V(e[b8])){return}}if(ce){bO.cleanData([b9],true)}else{if(bO.support.deleteExpando||e!=e.window){delete e[b8]}else{e[b8]=null}}},_data:function(b7,e,b8){return bO.data(b7,e,b8,true)},acceptData:function(b7){var e=b7.nodeName&&bO.noData[b7.nodeName.toLowerCase()];return !e||e!==true&&b7.getAttribute("classid")===e}});bO.fn.extend({data:function(cf,ce){var ca,b7,cd,e,b9,b8=this[0],cc=0,cb=null;if(cf===aI){if(this.length){cb=bO.data(b8);if(b8.nodeType===1&&!bO._data(b8,"parsedAttrs")){cd=b8.attributes;for(b9=cd.length;cc<b9;cc++){e=cd[cc].name;if(!e.indexOf("data-")){e=bO.camelCase(e.substring(5));bD(b8,e,cb[e])}}bO._data(b8,"parsedAttrs",true)}}return cb}if(typeof cf==="object"){return this.each(function(){bO.data(this,cf)})}ca=cf.split(".",2);ca[1]=ca[1]?"."+ca[1]:"";b7=ca[1]+"!";return bO.access(this,function(cg){if(cg===aI){cb=this.triggerHandler("getData"+b7,[ca[0]]);if(cb===aI&&b8){cb=bO.data(b8,cf);cb=bD(b8,cf,cb)}return cb===aI&&ca[1]?this.data(ca[0]):cb}ca[1]=cg;this.each(function(){var ch=bO(this);ch.triggerHandler("setData"+b7,ca);bO.data(this,cf,cg);ch.triggerHandler("changeData"+b7,ca)})},null,ce,arguments.length>1,null,false)},removeData:function(e){return this.each(function(){bO.removeData(this,e)})}});function bD(b9,b8,ca){if(ca===aI&&b9.nodeType===1){var b7="data-"+b8.replace(aS,"-$1").toLowerCase();ca=b9.getAttribute(b7);if(typeof ca==="string"){try{ca=ca==="true"?true:ca==="false"?false:ca==="null"?null:+ca+""===ca?+ca:bB.test(ca)?bO.parseJSON(ca):ca}catch(cb){}bO.data(b9,b8,ca)}else{ca=aI}}return ca}function V(b7){var e;for(e in b7){if(e==="data"&&bO.isEmptyObject(b7[e])){continue}if(e!=="toJSON"){return false}}return true}bO.extend({queue:function(b8,b7,b9){var e;if(b8){b7=(b7||"fx")+"queue";e=bO._data(b8,b7);if(b9){if(!e||bO.isArray(b9)){e=bO._data(b8,b7,bO.makeArray(b9))}else{e.push(b9)}}return e||[]}},dequeue:function(cb,ca){ca=ca||"fx";var b7=bO.queue(cb,ca),cc=b7.length,b9=b7.shift(),e=bO._queueHooks(cb,ca),b8=function(){bO.dequeue(cb,ca)};if(b9==="inprogress"){b9=b7.shift();cc--}if(b9){if(ca==="fx"){b7.unshift("inprogress")}delete e.stop;b9.call(cb,b8,e)}if(!cc&&e){e.empty.fire()}},_queueHooks:function(b8,b7){var e=b7+"queueHooks";return bO._data(b8,e)||bO._data(b8,e,{empty:bO.Callbacks("once memory").add(function(){bO.removeData(b8,b7+"queue",true);bO.removeData(b8,e,true)})})}});bO.fn.extend({queue:function(e,b7){var b8=2;if(typeof e!=="string"){b7=e;e="fx";b8--}if(arguments.length<b8){return bO.queue(this[0],e)}return b7===aI?this:this.each(function(){var b9=bO.queue(this,e,b7);bO._queueHooks(this,e);if(e==="fx"&&b9[0]!=="inprogress"){bO.dequeue(this,e)}})},dequeue:function(e){return this.each(function(){bO.dequeue(this,e)})},delay:function(b7,e){b7=bO.fx?bO.fx.speeds[b7]||b7:b7;e=e||"fx";return this.queue(e,function(b9,b8){var ca=setTimeout(b9,b7);b8.stop=function(){clearTimeout(ca)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(b8,cc){var b7,b9=1,cd=bO.Deferred(),cb=this,e=this.length,ca=function(){if(!(--b9)){cd.resolveWith(cb,[cb])}};if(typeof b8!=="string"){cc=b8;b8=aI}b8=b8||"fx";while(e--){b7=bO._data(cb[e],b8+"queueHooks");if(b7&&b7.empty){b9++;b7.empty.add(ca)}}ca();return cd.promise(cc)}});var be,b3,t,bR=/[\t\r\n]/g,ap=/\r/g,p=/^(?:button|input)$/i,aH=/^(?:button|input|object|select|textarea)$/i,K=/^a(?:rea|)$/i,T=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,bT=bO.support.getSetAttribute;bO.fn.extend({attr:function(e,b7){return bO.access(this,bO.attr,e,b7,arguments.length>1)},removeAttr:function(e){return this.each(function(){bO.removeAttr(this,e)})},prop:function(e,b7){return bO.access(this,bO.prop,e,b7,arguments.length>1)},removeProp:function(e){e=bO.propFix[e]||e;return this.each(function(){try{this[e]=aI;delete this[e]}catch(b7){}})},addClass:function(ca){var cc,b8,b7,b9,cb,cd,e;if(bO.isFunction(ca)){return this.each(function(ce){bO(this).addClass(ca.call(this,ce,this.className))})}if(ca&&typeof ca==="string"){cc=ca.split(a2);for(b8=0,b7=this.length;b8<b7;b8++){b9=this[b8];if(b9.nodeType===1){if(!b9.className&&cc.length===1){b9.className=ca}else{cb=" "+b9.className+" ";for(cd=0,e=cc.length;cd<e;cd++){if(cb.indexOf(" "+cc[cd]+" ")<0){cb+=cc[cd]+" "}}b9.className=bO.trim(cb)}}}}return this},removeClass:function(cc){var b9,ca,cb,cd,b7,b8,e;if(bO.isFunction(cc)){return this.each(function(ce){bO(this).removeClass(cc.call(this,ce,this.className))})}if((cc&&typeof cc==="string")||cc===aI){b9=(cc||"").split(a2);for(b8=0,e=this.length;b8<e;b8++){cb=this[b8];if(cb.nodeType===1&&cb.className){ca=(" "+cb.className+" ").replace(bR," ");for(cd=0,b7=b9.length;cd<b7;cd++){while(ca.indexOf(" "+b9[cd]+" ")>=0){ca=ca.replace(" "+b9[cd]+" "," ")}}cb.className=cc?bO.trim(ca):""}}}return this},toggleClass:function(b9,b7){var b8=typeof b9,e=typeof b7==="boolean";if(bO.isFunction(b9)){return this.each(function(ca){bO(this).toggleClass(b9.call(this,ca,this.className,b7),b7)})}return this.each(function(){if(b8==="string"){var cc,cb=0,ca=bO(this),cd=b7,ce=b9.split(a2);while((cc=ce[cb++])){cd=e?cd:!ca.hasClass(cc);ca[cd?"addClass":"removeClass"](cc)}}else{if(b8==="undefined"||b8==="boolean"){if(this.className){bO._data(this,"__className__",this.className)}this.className=this.className||b9===false?"":bO._data(this,"__className__")||""}}})},hasClass:function(e){var b9=" "+e+" ",b8=0,b7=this.length;for(;b8<b7;b8++){if(this[b8].nodeType===1&&(" "+this[b8].className+" ").replace(bR," ").indexOf(b9)>=0){return true}}return false},val:function(b9){var e,b7,ca,b8=this[0];if(!arguments.length){if(b8){e=bO.valHooks[b8.type]||bO.valHooks[b8.nodeName.toLowerCase()];if(e&&"get" in e&&(b7=e.get(b8,"value"))!==aI){return b7}b7=b8.value;return typeof b7==="string"?b7.replace(ap,""):b7==null?"":b7}return}ca=bO.isFunction(b9);return this.each(function(cc){var cd,cb=bO(this);if(this.nodeType!==1){return}if(ca){cd=b9.call(this,cc,cb.val())}else{cd=b9}if(cd==null){cd=""}else{if(typeof cd==="number"){cd+=""}else{if(bO.isArray(cd)){cd=bO.map(cd,function(ce){return ce==null?"":ce+""})}}}e=bO.valHooks[this.type]||bO.valHooks[this.nodeName.toLowerCase()];if(!e||!("set" in e)||e.set(this,cd,"value")===aI){this.value=cd}})}});bO.extend({valHooks:{option:{get:function(e){var b7=e.attributes.value;return !b7||b7.specified?e.value:e.text}},select:{get:function(e){var cc,b7,cb,b9,ca=e.selectedIndex,cd=[],ce=e.options,b8=e.type==="select-one";if(ca<0){return null}b7=b8?ca:0;cb=b8?ca+1:ce.length;for(;b7<cb;b7++){b9=ce[b7];if(b9.selected&&(bO.support.optDisabled?!b9.disabled:b9.getAttribute("disabled")===null)&&(!b9.parentNode.disabled||!bO.nodeName(b9.parentNode,"optgroup"))){cc=bO(b9).val();if(b8){return cc}cd.push(cc)}}if(b8&&!cd.length&&ce.length){return bO(ce[ca]).val()}return cd},set:function(b7,b8){var e=bO.makeArray(b8);bO(b7).find("option").each(function(){this.selected=bO.inArray(bO(this).val(),e)>=0});if(!e.length){b7.selectedIndex=-1}return e}}},attrFn:{},attr:function(cc,b9,cd,cb){var b8,e,ca,b7=cc.nodeType;if(!cc||b7===3||b7===8||b7===2){return}if(cb&&bO.isFunction(bO.fn[b9])){return bO(cc)[b9](cd)}if(typeof cc.getAttribute==="undefined"){return bO.prop(cc,b9,cd)}ca=b7!==1||!bO.isXMLDoc(cc);if(ca){b9=b9.toLowerCase();e=bO.attrHooks[b9]||(T.test(b9)?b3:be)}if(cd!==aI){if(cd===null){bO.removeAttr(cc,b9);return}else{if(e&&"set" in e&&ca&&(b8=e.set(cc,cd,b9))!==aI){return b8}else{cc.setAttribute(b9,cd+"");return cd}}}else{if(e&&"get" in e&&ca&&(b8=e.get(cc,b9))!==null){return b8}else{b8=cc.getAttribute(b9);return b8===null?aI:b8}}},removeAttr:function(b9,cb){var ca,cc,b7,e,b8=0;if(cb&&b9.nodeType===1){cc=cb.split(a2);for(;b8<cc.length;b8++){b7=cc[b8];if(b7){ca=bO.propFix[b7]||b7;e=T.test(b7);if(!e){bO.attr(b9,b7,"")}b9.removeAttribute(bT?b7:ca);if(e&&ca in b9){b9[ca]=false}}}}},attrHooks:{type:{set:function(e,b7){if(p.test(e.nodeName)&&e.parentNode){bO.error("type property can't be changed")}else{if(!bO.support.radioValue&&b7==="radio"&&bO.nodeName(e,"input")){var b8=e.value;e.setAttribute("type",b7);if(b8){e.value=b8}return b7}}}},value:{get:function(b7,e){if(be&&bO.nodeName(b7,"button")){return be.get(b7,e)}return e in b7?b7.value:null},set:function(b7,b8,e){if(be&&bO.nodeName(b7,"button")){return be.set(b7,b8,e)}b7.value=b8}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(cb,b9,cc){var b8,e,ca,b7=cb.nodeType;if(!cb||b7===3||b7===8||b7===2){return}ca=b7!==1||!bO.isXMLDoc(cb);if(ca){b9=bO.propFix[b9]||b9;e=bO.propHooks[b9]}if(cc!==aI){if(e&&"set" in e&&(b8=e.set(cb,cc,b9))!==aI){return b8}else{return(cb[b9]=cc)}}else{if(e&&"get" in e&&(b8=e.get(cb,b9))!==null){return b8}else{return cb[b9]}}},propHooks:{tabIndex:{get:function(b7){var e=b7.getAttributeNode("tabindex");return e&&e.specified?parseInt(e.value,10):aH.test(b7.nodeName)||K.test(b7.nodeName)&&b7.href?0:aI}}}});b3={get:function(b7,e){var b9,b8=bO.prop(b7,e);return b8===true||typeof b8!=="boolean"&&(b9=b7.getAttributeNode(e))&&b9.nodeValue!==false?e.toLowerCase():aI},set:function(b7,b9,e){var b8;if(b9===false){bO.removeAttr(b7,e)}else{b8=bO.propFix[e]||e;if(b8 in b7){b7[b8]=true}b7.setAttribute(e,e.toLowerCase())}return e}};if(!bT){t={name:true,id:true,coords:true};be=bO.valHooks.button={get:function(b8,b7){var e;e=b8.getAttributeNode(b7);return e&&(t[b7]?e.value!=="":e.specified)?e.value:aI},set:function(b8,b9,b7){var e=b8.getAttributeNode(b7);if(!e){e=u.createAttribute(b7);b8.setAttributeNode(e)}return(e.value=b9+"")}};bO.each(["width","height"],function(b7,e){bO.attrHooks[e]=bO.extend(bO.attrHooks[e],{set:function(b8,b9){if(b9===""){b8.setAttribute(e,"auto");return b9}}})});bO.attrHooks.contenteditable={get:be.get,set:function(b7,b8,e){if(b8===""){b8="false"}be.set(b7,b8,e)}}}if(!bO.support.hrefNormalized){bO.each(["href","src","width","height"],function(b7,e){bO.attrHooks[e]=bO.extend(bO.attrHooks[e],{get:function(b9){var b8=b9.getAttribute(e,2);return b8===null?aI:b8}})})}if(!bO.support.style){bO.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||aI},set:function(e,b7){return(e.style.cssText=b7+"")}}}if(!bO.support.optSelected){bO.propHooks.selected=bO.extend(bO.propHooks.selected,{get:function(b7){var e=b7.parentNode;if(e){e.selectedIndex;if(e.parentNode){e.parentNode.selectedIndex}}return null}})}if(!bO.support.enctype){bO.propFix.enctype="encoding"}if(!bO.support.checkOn){bO.each(["radio","checkbox"],function(){bO.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}})}bO.each(["radio","checkbox"],function(){bO.valHooks[this]=bO.extend(bO.valHooks[this],{set:function(e,b7){if(bO.isArray(b7)){return(e.checked=bO.inArray(bO(e).val(),b7)>=0)}}})});var bM=/^(?:textarea|input|select)$/i,bz=/^([^\.]*|)(?:\.(.+)|)$/,bh=/(?:^|\s)hover(\.\S+|)\b/,ba=/^key/,bS=/^(?:mouse|contextmenu)|click/,bG=/^(?:focusinfocus|focusoutblur)$/,ay=function(e){return bO.event.special.hover?e:e.replace(bh,"mouseenter$1 mouseleave$1")};bO.event={add:function(b9,cd,ck,cb,ca){var ce,cc,cl,cj,ci,cg,e,ch,b7,b8,cf;if(b9.nodeType===3||b9.nodeType===8||!cd||!ck||!(ce=bO._data(b9))){return}if(ck.handler){b7=ck;ck=b7.handler;ca=b7.selector}if(!ck.guid){ck.guid=bO.guid++}cl=ce.events;if(!cl){ce.events=cl={}}cc=ce.handle;if(!cc){ce.handle=cc=function(cm){return typeof bO!=="undefined"&&(!cm||bO.event.triggered!==cm.type)?bO.event.dispatch.apply(cc.elem,arguments):aI};cc.elem=b9}cd=bO.trim(ay(cd)).split(" ");for(cj=0;cj<cd.length;cj++){ci=bz.exec(cd[cj])||[];cg=ci[1];e=(ci[2]||"").split(".").sort();cf=bO.event.special[cg]||{};cg=(ca?cf.delegateType:cf.bindType)||cg;cf=bO.event.special[cg]||{};ch=bO.extend({type:cg,origType:ci[1],data:cb,handler:ck,guid:ck.guid,selector:ca,needsContext:ca&&bO.expr.match.needsContext.test(ca),namespace:e.join(".")},b7);b8=cl[cg];if(!b8){b8=cl[cg]=[];b8.delegateCount=0;if(!cf.setup||cf.setup.call(b9,cb,e,cc)===false){if(b9.addEventListener){b9.addEventListener(cg,cc,false)}else{if(b9.attachEvent){b9.attachEvent("on"+cg,cc)}}}}if(cf.add){cf.add.call(b9,ch);if(!ch.handler.guid){ch.handler.guid=ck.guid}}if(ca){b8.splice(b8.delegateCount++,0,ch)}else{b8.push(ch)}bO.event.global[cg]=true}b9=null},global:{},remove:function(b9,ce,ck,ca,cd){var cl,cm,ch,b8,b7,cb,cc,cj,cg,e,ci,cf=bO.hasData(b9)&&bO._data(b9);if(!cf||!(cj=cf.events)){return}ce=bO.trim(ay(ce||"")).split(" ");for(cl=0;cl<ce.length;cl++){cm=bz.exec(ce[cl])||[];ch=b8=cm[1];b7=cm[2];if(!ch){for(ch in cj){bO.event.remove(b9,ch+ce[cl],ck,ca,true)}continue}cg=bO.event.special[ch]||{};ch=(ca?cg.delegateType:cg.bindType)||ch;e=cj[ch]||[];cb=e.length;b7=b7?new RegExp("(^|\\.)"+b7.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(cc=0;cc<e.length;cc++){ci=e[cc];if((cd||b8===ci.origType)&&(!ck||ck.guid===ci.guid)&&(!b7||b7.test(ci.namespace))&&(!ca||ca===ci.selector||ca==="**"&&ci.selector)){e.splice(cc--,1);if(ci.selector){e.delegateCount--}if(cg.remove){cg.remove.call(b9,ci)}}}if(e.length===0&&cb!==e.length){if(!cg.teardown||cg.teardown.call(b9,b7,cf.handle)===false){bO.removeEvent(b9,ch,cf.handle)}delete cj[ch]}}if(bO.isEmptyObject(cj)){delete cf.handle;bO.removeData(b9,"events",true)}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(b7,ce,cc,cl){if(cc&&(cc.nodeType===3||cc.nodeType===8)){return}var e,b9,cf,cj,cb,ca,ch,cg,cd,ck,ci=b7.type||b7,b8=[];if(bG.test(ci+bO.event.triggered)){return}if(ci.indexOf("!")>=0){ci=ci.slice(0,-1);b9=true}if(ci.indexOf(".")>=0){b8=ci.split(".");ci=b8.shift();b8.sort()}if((!cc||bO.event.customEvent[ci])&&!bO.event.global[ci]){return}b7=typeof b7==="object"?b7[bO.expando]?b7:new bO.Event(ci,b7):new bO.Event(ci);b7.type=ci;b7.isTrigger=true;b7.exclusive=b9;b7.namespace=b8.join(".");b7.namespace_re=b7.namespace?new RegExp("(^|\\.)"+b8.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;ca=ci.indexOf(":")<0?"on"+ci:"";if(!cc){e=bO.cache;for(cf in e){if(e[cf].events&&e[cf].events[ci]){bO.event.trigger(b7,ce,e[cf].handle.elem,true)}}return}b7.result=aI;if(!b7.target){b7.target=cc}ce=ce!=null?bO.makeArray(ce):[];ce.unshift(b7);ch=bO.event.special[ci]||{};if(ch.trigger&&ch.trigger.apply(cc,ce)===false){return}cd=[[cc,ch.bindType||ci]];if(!cl&&!ch.noBubble&&!bO.isWindow(cc)){ck=ch.delegateType||ci;cj=bG.test(ck+ci)?cc:cc.parentNode;for(cb=cc;cj;cj=cj.parentNode){cd.push([cj,ck]);cb=cj}if(cb===(cc.ownerDocument||u)){cd.push([cb.defaultView||cb.parentWindow||a9,ck])}}for(cf=0;cf<cd.length&&!b7.isPropagationStopped();cf++){cj=cd[cf][0];b7.type=cd[cf][1];cg=(bO._data(cj,"events")||{})[b7.type]&&bO._data(cj,"handle");if(cg){cg.apply(cj,ce)}cg=ca&&cj[ca];if(cg&&bO.acceptData(cj)&&cg.apply&&cg.apply(cj,ce)===false){b7.preventDefault()}}b7.type=ci;if(!cl&&!b7.isDefaultPrevented()){if((!ch._default||ch._default.apply(cc.ownerDocument,ce)===false)&&!(ci==="click"&&bO.nodeName(cc,"a"))&&bO.acceptData(cc)){if(ca&&cc[ci]&&((ci!=="focus"&&ci!=="blur")||b7.target.offsetWidth!==0)&&!bO.isWindow(cc)){cb=cc[ca];if(cb){cc[ca]=null}bO.event.triggered=ci;cc[ci]();bO.event.triggered=aI;if(cb){cc[ca]=cb}}}}return b7.result},dispatch:function(e){e=bO.event.fix(e||a9.event);var cd,cc,cm,cg,cf,b7,ce,ck,b9,cl,ca=((bO._data(this,"events")||{})[e.type]||[]),cb=ca.delegateCount,ci=bb.call(arguments),b8=!e.exclusive&&!e.namespace,ch=bO.event.special[e.type]||{},cj=[];ci[0]=e;e.delegateTarget=this;if(ch.preDispatch&&ch.preDispatch.call(this,e)===false){return}if(cb&&!(e.button&&e.type==="click")){for(cm=e.target;cm!=this;cm=cm.parentNode||this){if(cm.disabled!==true||e.type!=="click"){cf={};ce=[];for(cd=0;cd<cb;cd++){ck=ca[cd];b9=ck.selector;if(cf[b9]===aI){cf[b9]=ck.needsContext?bO(b9,this).index(cm)>=0:bO.find(b9,this,null,[cm]).length}if(cf[b9]){ce.push(ck)}}if(ce.length){cj.push({elem:cm,matches:ce})}}}}if(ca.length>cb){cj.push({elem:this,matches:ca.slice(cb)})}for(cd=0;cd<cj.length&&!e.isPropagationStopped();cd++){b7=cj[cd];e.currentTarget=b7.elem;for(cc=0;cc<b7.matches.length&&!e.isImmediatePropagationStopped();cc++){ck=b7.matches[cc];if(b8||(!e.namespace&&!ck.namespace)||e.namespace_re&&e.namespace_re.test(ck.namespace)){e.data=ck.data;e.handleObj=ck;cg=((bO.event.special[ck.origType]||{}).handle||ck.handler).apply(b7.elem,ci);if(cg!==aI){e.result=cg;if(cg===false){e.preventDefault();e.stopPropagation()}}}}}if(ch.postDispatch){ch.postDispatch.call(this,e)}return e.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(b7,e){if(b7.which==null){b7.which=e.charCode!=null?e.charCode:e.keyCode}return b7}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(b9,b8){var ca,cb,e,b7=b8.button,cc=b8.fromElement;if(b9.pageX==null&&b8.clientX!=null){ca=b9.target.ownerDocument||u;cb=ca.documentElement;e=ca.body;b9.pageX=b8.clientX+(cb&&cb.scrollLeft||e&&e.scrollLeft||0)-(cb&&cb.clientLeft||e&&e.clientLeft||0);b9.pageY=b8.clientY+(cb&&cb.scrollTop||e&&e.scrollTop||0)-(cb&&cb.clientTop||e&&e.clientTop||0)}if(!b9.relatedTarget&&cc){b9.relatedTarget=cc===b9.target?b8.toElement:cc}if(!b9.which&&b7!==aI){b9.which=(b7&1?1:(b7&2?3:(b7&4?2:0)))}return b9}},fix:function(b8){if(b8[bO.expando]){return b8}var b7,cb,e=b8,b9=bO.event.fixHooks[b8.type]||{},ca=b9.props?this.props.concat(b9.props):this.props;b8=bO.Event(e);for(b7=ca.length;b7;){cb=ca[--b7];b8[cb]=e[cb]}if(!b8.target){b8.target=e.srcElement||u}if(b8.target.nodeType===3){b8.target=b8.target.parentNode}b8.metaKey=!!b8.metaKey;return b9.filter?b9.filter(b8,e):b8},special:{load:{noBubble:true},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(b8,b7,e){if(bO.isWindow(this)){this.onbeforeunload=e}},teardown:function(b7,e){if(this.onbeforeunload===e){this.onbeforeunload=null}}}},simulate:function(b8,ca,b9,b7){var cb=bO.extend(new bO.Event(),b9,{type:b8,isSimulated:true,originalEvent:{}});if(b7){bO.event.trigger(cb,null,ca)}else{bO.event.dispatch.call(ca,cb)}if(cb.isDefaultPrevented()){b9.preventDefault()}}};bO.event.handle=bO.event.dispatch;bO.removeEvent=u.removeEventListener?function(b7,e,b8){if(b7.removeEventListener){b7.removeEventListener(e,b8,false)}}:function(b8,b7,b9){var e="on"+b7;if(b8.detachEvent){if(typeof b8[e]==="undefined"){b8[e]=null}b8.detachEvent(e,b9)}};bO.Event=function(b7,e){if(!(this instanceof bO.Event)){return new bO.Event(b7,e)}if(b7&&b7.type){this.originalEvent=b7;this.type=b7.type;this.isDefaultPrevented=(b7.defaultPrevented||b7.returnValue===false||b7.getPreventDefault&&b7.getPreventDefault())?Y:ae}else{this.type=b7}if(e){bO.extend(this,e)}this.timeStamp=b7&&b7.timeStamp||bO.now();this[bO.expando]=true};function ae(){return false}function Y(){return true}bO.Event.prototype={preventDefault:function(){this.isDefaultPrevented=Y;var b7=this.originalEvent;if(!b7){return}if(b7.preventDefault){b7.preventDefault()}else{b7.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=Y;var b7=this.originalEvent;if(!b7){return}if(b7.stopPropagation){b7.stopPropagation()}b7.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Y;this.stopPropagation()},isDefaultPrevented:ae,isPropagationStopped:ae,isImmediatePropagationStopped:ae};bO.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(b7,e){bO.event.special[b7]={delegateType:e,bindType:e,handle:function(cb){var b9,cd=this,cc=cb.relatedTarget,ca=cb.handleObj,b8=ca.selector;if(!cc||(cc!==cd&&!bO.contains(cd,cc))){cb.type=ca.origType;b9=ca.handler.apply(this,arguments);cb.type=e}return b9}}});if(!bO.support.submitBubbles){bO.event.special.submit={setup:function(){if(bO.nodeName(this,"form")){return false}bO.event.add(this,"click._submit keypress._submit",function(b9){var b8=b9.target,b7=bO.nodeName(b8,"input")||bO.nodeName(b8,"button")?b8.form:aI;if(b7&&!bO._data(b7,"_submit_attached")){bO.event.add(b7,"submit._submit",function(e){e._submit_bubble=true});bO._data(b7,"_submit_attached",true)}})},postDispatch:function(e){if(e._submit_bubble){delete e._submit_bubble;if(this.parentNode&&!e.isTrigger){bO.event.simulate("submit",this.parentNode,e,true)}}},teardown:function(){if(bO.nodeName(this,"form")){return false}bO.event.remove(this,"._submit")}}}if(!bO.support.changeBubbles){bO.event.special.change={setup:function(){if(bM.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){bO.event.add(this,"propertychange._change",function(e){if(e.originalEvent.propertyName==="checked"){this._just_changed=true}});bO.event.add(this,"click._change",function(e){if(this._just_changed&&!e.isTrigger){this._just_changed=false}bO.event.simulate("change",this,e,true)})}return false}bO.event.add(this,"beforeactivate._change",function(b8){var b7=b8.target;if(bM.test(b7.nodeName)&&!bO._data(b7,"_change_attached")){bO.event.add(b7,"change._change",function(e){if(this.parentNode&&!e.isSimulated&&!e.isTrigger){bO.event.simulate("change",this.parentNode,e,true)}});bO._data(b7,"_change_attached",true)}})},handle:function(b7){var e=b7.target;if(this!==e||b7.isSimulated||b7.isTrigger||(e.type!=="radio"&&e.type!=="checkbox")){return b7.handleObj.handler.apply(this,arguments)}},teardown:function(){bO.event.remove(this,"._change");return !bM.test(this.nodeName)}}}if(!bO.support.focusinBubbles){bO.each({focus:"focusin",blur:"focusout"},function(b9,e){var b7=0,b8=function(ca){bO.event.simulate(e,ca.target,bO.event.fix(ca),true)};bO.event.special[e]={setup:function(){if(b7++===0){u.addEventListener(b9,b8,true)}},teardown:function(){if(--b7===0){u.removeEventListener(b9,b8,true)}}}})}bO.fn.extend({on:function(b8,e,cb,ca,b7){var cc,b9;if(typeof b8==="object"){if(typeof e!=="string"){cb=cb||e;e=aI}for(b9 in b8){this.on(b9,e,cb,b8[b9],b7)}return this}if(cb==null&&ca==null){ca=e;cb=e=aI}else{if(ca==null){if(typeof e==="string"){ca=cb;cb=aI}else{ca=cb;cb=e;e=aI}}}if(ca===false){ca=ae}else{if(!ca){return this}}if(b7===1){cc=ca;ca=function(cd){bO().off(cd);return cc.apply(this,arguments)};ca.guid=cc.guid||(cc.guid=bO.guid++)}return this.each(function(){bO.event.add(this,b8,ca,cb,e)})},one:function(b7,e,b9,b8){return this.on(b7,e,b9,b8,1)},off:function(b8,e,ca){var b7,b9;if(b8&&b8.preventDefault&&b8.handleObj){b7=b8.handleObj;bO(b8.delegateTarget).off(b7.namespace?b7.origType+"."+b7.namespace:b7.origType,b7.selector,b7.handler);return this}if(typeof b8==="object"){for(b9 in b8){this.off(b9,e,b8[b9])}return this}if(e===false||typeof e==="function"){ca=e;e=aI}if(ca===false){ca=ae}return this.each(function(){bO.event.remove(this,b8,ca,e)})},bind:function(e,b8,b7){return this.on(e,null,b8,b7)},unbind:function(e,b7){return this.off(e,null,b7)},live:function(e,b8,b7){bO(this.context).on(e,this.selector,b8,b7);return this},die:function(e,b7){bO(this.context).off(e,this.selector||"**",b7);return this},delegate:function(e,b7,b9,b8){return this.on(b7,e,b9,b8)},undelegate:function(e,b7,b8){return arguments.length===1?this.off(e,"**"):this.off(b7,e||"**",b8)},trigger:function(e,b7){return this.each(function(){bO.event.trigger(e,b7,this)})},triggerHandler:function(e,b7){if(this[0]){return bO.event.trigger(e,b7,this[0],true)}},toggle:function(b9){var b7=arguments,e=b9.guid||bO.guid++,b8=0,ca=function(cb){var cc=(bO._data(this,"lastToggle"+b9.guid)||0)%b8;bO._data(this,"lastToggle"+b9.guid,cc+1);cb.preventDefault();return b7[cc].apply(this,arguments)||false};ca.guid=e;while(b8<b7.length){b7[b8++].guid=e}return this.click(ca)},hover:function(e,b7){return this.mouseenter(e).mouseleave(b7||e)}});bO.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(b7,e){bO.fn[e]=function(b9,b8){if(b8==null){b8=b9;b9=null}return arguments.length>0?this.on(e,null,b9,b8):this.trigger(e)};if(ba.test(e)){bO.event.fixHooks[e]=bO.event.keyHooks}if(bS.test(e)){bO.event.fixHooks[e]=bO.event.mouseHooks}});
/*
 * Sizzle CSS Selector Engine
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://sizzlejs.com/
 */
(function(c0,cp){var c5,ci,cT,b8,cu,cI,cl,co,ck,cR,ch=true,cC="undefined",c7=("sizcache"+Math.random()).replace(".",""),cc=String,cg=c0.document,cj=cg.documentElement,cz=0,cn=0,cM=[].pop,c4=[].push,ct=[].slice,cw=[].indexOf||function(dg){var df=0,e=this.length;for(;df<e;df++){if(this[df]===dg){return df}}return -1},c9=function(e,df){e[c7]=df==null||df;return e},dd=function(){var e={},df=[];return c9(function(dg,dh){if(df.push(dg)>cT.cacheLength){delete e[df.shift()]}return(e[dg]=dh)},e)},c2=dd(),c3=dd(),cv=dd(),cG="[\\x20\\t\\r\\n\\f]",cs="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",cq=cs.replace("w","w#"),dc="([*^$|!~]?=)",cX="\\["+cG+"*("+cs+")"+cG+"*(?:"+dc+cG+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+cq+")|)|)"+cG+"*\\]",de=":("+cs+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+cX+")|[^:]|\\\\.)*|.*))\\)|)",cH=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+cG+"*((?:-\\d)?\\d*)"+cG+"*\\)|)(?=[^-]|$)",c1=new RegExp("^"+cG+"+|((?:^|[^\\\\])(?:\\\\.)*)"+cG+"+$","g"),cd=new RegExp("^"+cG+"*,"+cG+"*"),cP=new RegExp("^"+cG+"*([\\x20\\t\\r\\n\\f>+~])"+cG+"*"),cU=new RegExp(de),cW=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,cL=/^:not/,cZ=/[\x20\t\r\n\f]*[+~]/,c8=/:not\($/,cA=/h\d/i,cV=/input|select|textarea|button/i,cB=/\\(?!\\)/g,cO={ID:new RegExp("^#("+cs+")"),CLASS:new RegExp("^\\.("+cs+")"),NAME:new RegExp("^\\[name=['\"]?("+cs+")['\"]?\\]"),TAG:new RegExp("^("+cs.replace("w","w*")+")"),ATTR:new RegExp("^"+cX),PSEUDO:new RegExp("^"+de),POS:new RegExp(cH,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+cG+"*(even|odd|(([+-]|)(\\d*)n|)"+cG+"*(?:([+-]|)"+cG+"*(\\d+)|))"+cG+"*\\)|)","i"),needsContext:new RegExp("^"+cG+"*[>+~]|"+cH,"i")},cS=function(df){var dh=cg.createElement("div");try{return df(dh)}catch(dg){return false}finally{dh=null}},cf=cS(function(e){e.appendChild(cg.createComment(""));return !e.getElementsByTagName("*").length}),cK=cS(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild&&typeof e.firstChild.getAttribute!==cC&&e.firstChild.getAttribute("href")==="#"}),cy=cS(function(df){df.innerHTML="<select></select>";var e=typeof df.lastChild.getAttribute("multiple");return e!=="boolean"&&e!=="string"}),cJ=cS(function(e){e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";if(!e.getElementsByClassName||!e.getElementsByClassName("e").length){return false}e.lastChild.className="e";return e.getElementsByClassName("e").length===2}),b7=cS(function(df){df.id=c7+0;df.innerHTML="<a name='"+c7+"'></a><div name='"+c7+"'></div>";cj.insertBefore(df,cj.firstChild);var e=cg.getElementsByName&&cg.getElementsByName(c7).length===2+cg.getElementsByName(c7+0).length;ci=!cg.getElementById(c7);cj.removeChild(df);return e});try{ct.call(cj.childNodes,0)[0].nodeType}catch(db){ct=function(df){var dg,e=[];for(;(dg=this[df]);df++){e.push(dg)}return e}}function cY(dh,e,dj,dm){dj=dj||[];e=e||cg;var dk,df,dl,dg,di=e.nodeType;if(!dh||typeof dh!=="string"){return dj}if(di!==1&&di!==9){return[]}dl=cu(e);if(!dl&&!dm){if((dk=cW.exec(dh))){if((dg=dk[1])){if(di===9){df=e.getElementById(dg);if(df&&df.parentNode){if(df.id===dg){dj.push(df);return dj}}else{return dj}}else{if(e.ownerDocument&&(df=e.ownerDocument.getElementById(dg))&&cI(e,df)&&df.id===dg){dj.push(df);return dj}}}else{if(dk[2]){c4.apply(dj,ct.call(e.getElementsByTagName(dh),0));return dj}else{if((dg=dk[3])&&cJ&&e.getElementsByClassName){c4.apply(dj,ct.call(e.getElementsByClassName(dg),0));return dj}}}}}return c6(dh.replace(c1,"$1"),e,dj,dm,dl)}cY.matches=function(df,e){return cY(df,null,null,e)};cY.matchesSelector=function(e,df){return cY(df,null,null,[e]).length>0};function cQ(e){return function(dg){var df=dg.nodeName.toLowerCase();return df==="input"&&dg.type===e}}function cb(e){return function(dg){var df=dg.nodeName.toLowerCase();return(df==="input"||df==="button")&&dg.type===e}}function cN(e){return c9(function(df){df=+df;return c9(function(dg,dk){var di,dh=e([],dg.length,df),dj=dh.length;while(dj--){if(dg[(di=dh[dj])]){dg[di]=!(dk[di]=dg[di])}}})})}b8=cY.getText=function(di){var dh,df="",dg=0,e=di.nodeType;if(e){if(e===1||e===9||e===11){if(typeof di.textContent==="string"){return di.textContent}else{for(di=di.firstChild;di;di=di.nextSibling){df+=b8(di)}}}else{if(e===3||e===4){return di.nodeValue}}}else{for(;(dh=di[dg]);dg++){df+=b8(dh)}}return df};cu=cY.isXML=function(e){var df=e&&(e.ownerDocument||e).documentElement;return df?df.nodeName!=="HTML":false};cI=cY.contains=cj.contains?function(df,e){var dh=df.nodeType===9?df.documentElement:df,dg=e&&e.parentNode;return df===dg||!!(dg&&dg.nodeType===1&&dh.contains&&dh.contains(dg))}:cj.compareDocumentPosition?function(df,e){return e&&!!(df.compareDocumentPosition(e)&16)}:function(df,e){while((e=e.parentNode)){if(e===df){return true}}return false};cY.attr=function(dg,df){var dh,e=cu(dg);if(!e){df=df.toLowerCase()}if((dh=cT.attrHandle[df])){return dh(dg)}if(e||cy){return dg.getAttribute(df)}dh=dg.getAttributeNode(df);return dh?typeof dg[df]==="boolean"?dg[df]?df:null:dh.specified?dh.value:null:null};cT=cY.selectors={cacheLength:50,createPseudo:c9,match:cO,attrHandle:cK?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:ci?function(dh,dg,df){if(typeof dg.getElementById!==cC&&!df){var e=dg.getElementById(dh);return e&&e.parentNode?[e]:[]}}:function(dh,dg,df){if(typeof dg.getElementById!==cC&&!df){var e=dg.getElementById(dh);return e?e.id===dh||typeof e.getAttributeNode!==cC&&e.getAttributeNode("id").value===dh?[e]:cp:[]}},TAG:cf?function(e,df){if(typeof df.getElementsByTagName!==cC){return df.getElementsByTagName(e)}}:function(e,di){var dh=di.getElementsByTagName(e);if(e==="*"){var dj,dg=[],df=0;for(;(dj=dh[df]);df++){if(dj.nodeType===1){dg.push(dj)}}return dg}return dh},NAME:b7&&function(e,df){if(typeof df.getElementsByName!==cC){return df.getElementsByName(name)}},CLASS:cJ&&function(dg,df,e){if(typeof df.getElementsByClassName!==cC&&!e){return df.getElementsByClassName(dg)}}},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(cB,"");e[3]=(e[4]||e[5]||"").replace(cB,"");if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1]==="nth"){if(!e[2]){cY.error(e[0])}e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd"));e[4]=+((e[6]+e[7])||e[2]==="odd")}else{if(e[2]){cY.error(e[0])}}return e},PSEUDO:function(df){var dg,e;if(cO.CHILD.test(df[0])){return null}if(df[3]){df[2]=df[3]}else{if((dg=df[4])){if(cU.test(dg)&&(e=b9(dg,true))&&(e=dg.indexOf(")",dg.length-e)-dg.length)){dg=dg.slice(0,e);df[0]=df[0].slice(0,e)}df[2]=dg}}return df.slice(0,3)}},filter:{ID:ci?function(e){e=e.replace(cB,"");return function(df){return df.getAttribute("id")===e}}:function(e){e=e.replace(cB,"");return function(dg){var df=typeof dg.getAttributeNode!==cC&&dg.getAttributeNode("id");return df&&df.value===e}},TAG:function(e){if(e==="*"){return function(){return true}}e=e.replace(cB,"").toLowerCase();return function(df){return df.nodeName&&df.nodeName.toLowerCase()===e}},CLASS:function(e){var df=c2[c7][e];if(!df){df=c2(e,new RegExp("(^|"+cG+")"+e+"("+cG+"|$)"))}return function(dg){return df.test(dg.className||(typeof dg.getAttribute!==cC&&dg.getAttribute("class"))||"")}},ATTR:function(dg,df,e){return function(dj,di){var dh=cY.attr(dj,dg);if(dh==null){return df==="!="}if(!df){return true}dh+="";return df==="="?dh===e:df==="!="?dh!==e:df==="^="?e&&dh.indexOf(e)===0:df==="*="?e&&dh.indexOf(e)>-1:df==="$="?e&&dh.substr(dh.length-e.length)===e:df==="~="?(" "+dh+" ").indexOf(e)>-1:df==="|="?dh===e||dh.substr(0,e.length+1)===e+"-":false}},CHILD:function(e,dg,dh,df){if(e==="nth"){return function(dk){var dj,dl,di=dk.parentNode;if(dh===1&&df===0){return true}if(di){dl=0;for(dj=di.firstChild;dj;dj=dj.nextSibling){if(dj.nodeType===1){dl++;if(dk===dj){break}}}}dl-=df;return dl===dh||(dl%dh===0&&dl/dh>=0)}}return function(dj){var di=dj;switch(e){case"only":case"first":while((di=di.previousSibling)){if(di.nodeType===1){return false}}if(e==="first"){return true}di=dj;case"last":while((di=di.nextSibling)){if(di.nodeType===1){return false}}return true}}},PSEUDO:function(dh,dg){var e,df=cT.pseudos[dh]||cT.setFilters[dh.toLowerCase()]||cY.error("unsupported pseudo: "+dh);if(df[c7]){return df(dg)}if(df.length>1){e=[dh,dh,"",dg];return cT.setFilters.hasOwnProperty(dh.toLowerCase())?c9(function(dk,dm){var dj,di=df(dk,dg),dl=di.length;while(dl--){dj=cw.call(dk,di[dl]);dk[dj]=!(dm[dj]=di[dl])}}):function(di){return df(di,0,e)}}return df}},pseudos:{not:c9(function(e){var df=[],dg=[],dh=cl(e.replace(c1,"$1"));return dh[c7]?c9(function(dj,dp,dm,dk){var dn,di=dh(dj,null,dk,[]),dl=dj.length;while(dl--){if((dn=di[dl])){dj[dl]=!(dp[dl]=dn)}}}):function(dk,dj,di){df[0]=dk;dh(df,null,di,dg);return !dg.pop()}}),has:c9(function(e){return function(df){return cY(e,df).length>0}}),contains:c9(function(e){return function(df){return(df.textContent||df.innerText||b8(df)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===false},disabled:function(e){return e.disabled===true},checked:function(e){var df=e.nodeName.toLowerCase();return(df==="input"&&!!e.checked)||(df==="option"&&!!e.selected)},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},parent:function(e){return !cT.pseudos.empty(e)},empty:function(df){var e;df=df.firstChild;while(df){if(df.nodeName>"@"||(e=df.nodeType)===3||e===4){return false}df=df.nextSibling}return true},header:function(e){return cA.test(e.nodeName)},text:function(dg){var df,e;return dg.nodeName.toLowerCase()==="input"&&(df=dg.type)==="text"&&((e=dg.getAttribute("type"))==null||e.toLowerCase()===df)},radio:cQ("radio"),checkbox:cQ("checkbox"),file:cQ("file"),password:cQ("password"),image:cQ("image"),submit:cb("submit"),reset:cb("reset"),button:function(df){var e=df.nodeName.toLowerCase();return e==="input"&&df.type==="button"||e==="button"},input:function(e){return cV.test(e.nodeName)},focus:function(e){var df=e.ownerDocument;return e===df.activeElement&&(!df.hasFocus||df.hasFocus())&&!!(e.type||e.href)},active:function(e){return e===e.ownerDocument.activeElement},first:cN(function(e,dg,df){return[0]}),last:cN(function(e,dg,df){return[dg-1]}),eq:cN(function(e,dg,df){return[df<0?df+dg:df]}),even:cN(function(e,dh,dg){for(var df=0;df<dh;df+=2){e.push(df)}return e}),odd:cN(function(e,dh,dg){for(var df=1;df<dh;df+=2){e.push(df)}return e}),lt:cN(function(e,dh,dg){for(var df=dg<0?dg+dh:dg;--df>=0;){e.push(df)}return e}),gt:cN(function(e,dh,dg){for(var df=dg<0?dg+dh:dg;++df<dh;){e.push(df)}return e})}};function ca(df,e,dg){if(df===e){return dg}var dh=df.nextSibling;while(dh){if(dh===e){return -1}dh=dh.nextSibling}return 1}co=cj.compareDocumentPosition?function(df,e){if(df===e){ck=true;return 0}return(!df.compareDocumentPosition||!e.compareDocumentPosition?df.compareDocumentPosition:df.compareDocumentPosition(e)&4)?-1:1}:function(dm,dl){if(dm===dl){ck=true;return 0}else{if(dm.sourceIndex&&dl.sourceIndex){return dm.sourceIndex-dl.sourceIndex}}var dj,df,dg=[],e=[],di=dm.parentNode,dk=dl.parentNode,dn=di;if(di===dk){return ca(dm,dl)}else{if(!di){return -1}else{if(!dk){return 1}}}while(dn){dg.unshift(dn);dn=dn.parentNode}dn=dk;while(dn){e.unshift(dn);dn=dn.parentNode}dj=dg.length;df=e.length;for(var dh=0;dh<dj&&dh<df;dh++){if(dg[dh]!==e[dh]){return ca(dg[dh],e[dh])}}return dh===dj?ca(dm,e[dh],-1):ca(dg[dh],dl,1)};[0,0].sort(co);ch=!ck;cY.uniqueSort=function(df){var dg,e=1;ck=ch;df.sort(co);if(ck){for(;(dg=df[e]);e++){if(dg===df[e-1]){df.splice(e--,1)}}}return df};cY.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};function b9(di,dn){var df,dj,dl,dm,dk,dg,e,dh=c3[c7][di];if(dh){return dn?0:dh.slice(0)}dk=di;dg=[];e=cT.preFilter;while(dk){if(!df||(dj=cd.exec(dk))){if(dj){dk=dk.slice(dj[0].length)}dg.push(dl=[])}df=false;if((dj=cP.exec(dk))){dl.push(df=new cc(dj.shift()));dk=dk.slice(df.length);df.type=dj[0].replace(c1," ")}for(dm in cT.filter){if((dj=cO[dm].exec(dk))&&(!e[dm]||(dj=e[dm](dj,cg,true)))){dl.push(df=new cc(dj.shift()));dk=dk.slice(df.length);df.type=dm;df.matches=dj}}if(!df){break}}return dn?dk.length:dk?cY.error(di):c3(di,dg).slice(0)}function cE(di,dg,dh){var e=dg.dir,dj=dh&&dg.dir==="parentNode",df=cn++;return dg.first?function(dm,dl,dk){while((dm=dm[e])){if(dj||dm.nodeType===1){return di(dm,dl,dk)}}}:function(dn,dm,dl){if(!dl){var dk,dp=cz+" "+df+" ",dq=dp+c5;while((dn=dn[e])){if(dj||dn.nodeType===1){if((dk=dn[c7])===dq){return dn.sizset}else{if(typeof dk==="string"&&dk.indexOf(dp)===0){if(dn.sizset){return dn}}else{dn[c7]=dq;if(di(dn,dm,dl)){dn.sizset=true;return dn}dn.sizset=false}}}}}else{while((dn=dn[e])){if(dj||dn.nodeType===1){if(di(dn,dm,dl)){return dn}}}}}}function cm(e){return e.length>1?function(di,dh,df){var dg=e.length;while(dg--){if(!e[dg](di,dh,df)){return false}}return true}:e[0]}function cD(e,df,dg,dh,dk){var di,dn=[],dj=0,dl=e.length,dm=df!=null;for(;dj<dl;dj++){if((di=e[dj])){if(!dg||dg(di,dh,dk)){dn.push(di);if(dm){df.push(dj)}}}}return dn}function da(dg,df,di,dh,dj,e){if(dh&&!dh[c7]){dh=da(dh)}if(dj&&!dj[c7]){dj=da(dj,e)}return c9(function(dw,dt,dm,dv){if(dw&&dj){return}var du,dp,dq,dn=[],dx=[],dl=dt.length,dk=dw||cx(df||"*",dm.nodeType?[dm]:dm,[],dw),dr=dg&&(dw||!df)?cD(dk,dn,dg,dm,dv):dk,ds=di?dj||(dw?dg:dl||dh)?[]:dt:dr;if(di){di(dr,ds,dm,dv)}if(dh){dq=cD(ds,dx);dh(dq,[],dm,dv);du=dq.length;while(du--){if((dp=dq[du])){ds[dx[du]]=!(dr[dx[du]]=dp)}}}if(dw){du=dg&&ds.length;while(du--){if((dp=ds[du])){dw[dn[du]]=!(dt[dn[du]]=dp)}}}else{ds=cD(ds===dt?ds.splice(dl,ds.length):ds);if(dj){dj(null,dt,ds,dv)}else{c4.apply(dt,ds)}}})}function cF(dk){var df,di,dg,dj=dk.length,dn=cT.relative[dk[0].type],dp=dn||cT.relative[" "],dh=dn?1:0,dl=cE(function(dq){return dq===df},dp,true),dm=cE(function(dq){return cw.call(df,dq)>-1},dp,true),e=[function(ds,dr,dq){return(!dn&&(dq||dr!==cR))||((df=dr).nodeType?dl(ds,dr,dq):dm(ds,dr,dq))}];for(;dh<dj;dh++){if((di=cT.relative[dk[dh].type])){e=[cE(cm(e),di)]}else{di=cT.filter[dk[dh].type].apply(null,dk[dh].matches);if(di[c7]){dg=++dh;for(;dg<dj;dg++){if(cT.relative[dk[dg].type]){break}}return da(dh>1&&cm(e),dh>1&&dk.slice(0,dh-1).join("").replace(c1,"$1"),di,dh<dg&&cF(dk.slice(dh,dg)),dg<dj&&cF((dk=dk.slice(dg))),dg<dj&&dk.join(""))}e.push(di)}}return cm(e)}function ce(dh,dg){var e=dg.length>0,di=dh.length>0,df=function(dt,dm,ds,dr,dz){var dn,dp,du,dy=[],dx=0,dq="0",dj=dt&&[],dv=dz!=null,dw=cR,dl=dt||di&&cT.find.TAG("*",dz&&dm.parentNode||dm),dk=(cz+=dw==null?1:Math.E);if(dv){cR=dm!==cg&&dm;c5=df.el}for(;(dn=dl[dq])!=null;dq++){if(di&&dn){for(dp=0;(du=dh[dp]);dp++){if(du(dn,dm,ds)){dr.push(dn);break}}if(dv){cz=dk;c5=++df.el}}if(e){if((dn=!du&&dn)){dx--}if(dt){dj.push(dn)}}}dx+=dq;if(e&&dq!==dx){for(dp=0;(du=dg[dp]);dp++){du(dj,dy,dm,ds)}if(dt){if(dx>0){while(dq--){if(!(dj[dq]||dy[dq])){dy[dq]=cM.call(dr)}}}dy=cD(dy)}c4.apply(dr,dy);if(dv&&!dt&&dy.length>0&&(dx+dg.length)>1){cY.uniqueSort(dr)}}if(dv){cz=dk;cR=dw}return dj};df.el=0;return e?c9(df):df}cl=cY.compile=function(e,dj){var dg,df=[],di=[],dh=cv[c7][e];if(!dh){if(!dj){dj=b9(e)}dg=dj.length;while(dg--){dh=cF(dj[dg]);if(dh[c7]){df.push(dh)}else{di.push(dh)}}dh=cv(e,ce(di,df))}return dh};function cx(df,dj,di,dg){var dh=0,e=dj.length;for(;dh<e;dh++){cY(df,dj[dh],di,dg)}return di}function c6(dg,e,di,dm,dl){var dj,dq,df,dp,dn,dk=b9(dg),dh=dk.length;if(!dm){if(dk.length===1){dq=dk[0]=dk[0].slice(0);if(dq.length>2&&(df=dq[0]).type==="ID"&&e.nodeType===9&&!dl&&cT.relative[dq[1].type]){e=cT.find.ID(df.matches[0].replace(cB,""),e,dl)[0];if(!e){return di}dg=dg.slice(dq.shift().length)}for(dj=cO.POS.test(dg)?-1:dq.length-1;dj>=0;dj--){df=dq[dj];if(cT.relative[(dp=df.type)]){break}if((dn=cT.find[dp])){if((dm=dn(df.matches[0].replace(cB,""),cZ.test(dq[0].type)&&e.parentNode||e,dl))){dq.splice(dj,1);dg=dm.length&&dq.join("");if(!dg){c4.apply(di,ct.call(dm,0));return di}break}}}}}cl(dg,dk)(dm,e,dl,di,cZ.test(dg));return di}if(cg.querySelectorAll){(function(){var dj,dk=c6,di=/'|\\/g,dg=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,df=[":focus"],e=[":active",":focus"],dh=cj.matchesSelector||cj.mozMatchesSelector||cj.webkitMatchesSelector||cj.oMatchesSelector||cj.msMatchesSelector;cS(function(dl){dl.innerHTML="<select><option selected=''></option></select>";if(!dl.querySelectorAll("[selected]").length){df.push("\\["+cG+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)")}if(!dl.querySelectorAll(":checked").length){df.push(":checked")}});cS(function(dl){dl.innerHTML="<p test=''></p>";if(dl.querySelectorAll("[test^='']").length){df.push("[*^$]="+cG+"*(?:\"\"|'')")}dl.innerHTML="<input type='hidden'/>";if(!dl.querySelectorAll(":enabled").length){df.push(":enabled",":disabled")}});df=new RegExp(df.join("|"));c6=function(ds,dm,du,dx,dw){if(!dx&&!dw&&(!df||!df.test(ds))){var dq,dv,dp=true,dl=c7,dn=dm,dt=dm.nodeType===9&&ds;if(dm.nodeType===1&&dm.nodeName.toLowerCase()!=="object"){dq=b9(ds);if((dp=dm.getAttribute("id"))){dl=dp.replace(di,"\\$&")}else{dm.setAttribute("id",dl)}dl="[id='"+dl+"'] ";dv=dq.length;while(dv--){dq[dv]=dl+dq[dv].join("")}dn=cZ.test(ds)&&dm.parentNode||dm;dt=dq.join(",")}if(dt){try{c4.apply(du,ct.call(dn.querySelectorAll(dt),0));return du}catch(dr){}finally{if(!dp){dm.removeAttribute("id")}}}}return dk(ds,dm,du,dx,dw)};if(dh){cS(function(dm){dj=dh.call(dm,"div");try{dh.call(dm,"[test!='']:sizzle");e.push("!=",de)}catch(dl){}});e=new RegExp(e.join("|"));cY.matchesSelector=function(dm,dp){dp=dp.replace(dg,"='$1']");if(!cu(dm)&&!e.test(dp)&&(!df||!df.test(dp))){try{var dl=dh.call(dm,dp);if(dl||dj||dm.document&&dm.document.nodeType!==11){return dl}}catch(dn){}}return cY(dp,null,null,[dm]).length>0}}})()}cT.pseudos.nth=cT.pseudos.eq;function cr(){}cT.filters=cr.prototype=cT.pseudos;cT.setFilters=new cr();cY.attr=bO.attr;bO.find=cY;bO.expr=cY.selectors;bO.expr[":"]=bO.expr.pseudos;bO.unique=cY.uniqueSort;bO.text=cY.getText;bO.isXMLDoc=cY.isXML;bO.contains=cY.contains})(a9);var an=/Until$/,by=/^(?:parents|prev(?:Until|All))/,at=/^.[^:#\[\.,]*$/,F=bO.expr.match.needsContext,bC={children:true,contents:true,next:true,prev:true};bO.fn.extend({find:function(e){var ca,b7,cc,cd,cb,b9,b8=this;if(typeof e!=="string"){return bO(e).filter(function(){for(ca=0,b7=b8.length;ca<b7;ca++){if(bO.contains(b8[ca],this)){return true}}})}b9=this.pushStack("","find",e);for(ca=0,b7=this.length;ca<b7;ca++){cc=b9.length;bO.find(e,this[ca],b9);if(ca>0){for(cd=cc;cd<b9.length;cd++){for(cb=0;cb<cc;cb++){if(b9[cb]===b9[cd]){b9.splice(cd--,1);break}}}}}return b9},has:function(b9){var b8,b7=bO(b9,this),e=b7.length;return this.filter(function(){for(b8=0;b8<e;b8++){if(bO.contains(this,b7[b8])){return true}}})},not:function(e){return this.pushStack(aT(this,e,false),"not",e)},filter:function(e){return this.pushStack(aT(this,e,true),"filter",e)},is:function(e){return !!e&&(typeof e==="string"?F.test(e)?bO(e,this.context).index(this[0])>=0:bO.filter(e,this).length>0:this.filter(e).length>0)},closest:function(ca,b9){var cb,b8=0,e=this.length,b7=[],cc=F.test(ca)||typeof ca!=="string"?bO(ca,b9||this.context):0;for(;b8<e;b8++){cb=this[b8];while(cb&&cb.ownerDocument&&cb!==b9&&cb.nodeType!==11){if(cc?cc.index(cb)>-1:bO.find.matchesSelector(cb,ca)){b7.push(cb);break}cb=cb.parentNode}}b7=b7.length>1?bO.unique(b7):b7;return this.pushStack(b7,"closest",ca)},index:function(e){if(!e){return(this[0]&&this[0].parentNode)?this.prevAll().length:-1}if(typeof e==="string"){return bO.inArray(this[0],bO(e))}return bO.inArray(e.jquery?e[0]:e,this)},add:function(e,b7){var b9=typeof e==="string"?bO(e,b7):bO.makeArray(e&&e.nodeType?[e]:e),b8=bO.merge(this.get(),b9);return this.pushStack(aY(b9[0])||aY(b8[0])?b8:bO.unique(b8))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});bO.fn.andSelf=bO.fn.addBack;function aY(e){return !e||!e.parentNode||e.parentNode.nodeType===11}function a5(b7,e){do{b7=b7[e]}while(b7&&b7.nodeType!==1);return b7}bO.each({parent:function(b7){var e=b7.parentNode;return e&&e.nodeType!==11?e:null},parents:function(e){return bO.dir(e,"parentNode")},parentsUntil:function(b7,e,b8){return bO.dir(b7,"parentNode",b8)},next:function(e){return a5(e,"nextSibling")},prev:function(e){return a5(e,"previousSibling")},nextAll:function(e){return bO.dir(e,"nextSibling")},prevAll:function(e){return bO.dir(e,"previousSibling")},nextUntil:function(b7,e,b8){return bO.dir(b7,"nextSibling",b8)},prevUntil:function(b7,e,b8){return bO.dir(b7,"previousSibling",b8)},siblings:function(e){return bO.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return bO.sibling(e.firstChild)},contents:function(e){return bO.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:bO.merge([],e.childNodes)}},function(e,b7){bO.fn[e]=function(ca,b8){var b9=bO.map(this,b7,ca);if(!an.test(e)){b8=ca}if(b8&&typeof b8==="string"){b9=bO.filter(b8,b9)}b9=this.length>1&&!bC[e]?bO.unique(b9):b9;if(this.length>1&&by.test(e)){b9=b9.reverse()}return this.pushStack(b9,e,bb.call(arguments).join(","))}});bO.extend({filter:function(b8,e,b7){if(b7){b8=":not("+b8+")"}return e.length===1?bO.find.matchesSelector(e[0],b8)?[e[0]]:[]:bO.find.matches(b8,e)},dir:function(b8,b7,ca){var e=[],b9=b8[b7];while(b9&&b9.nodeType!==9&&(ca===aI||b9.nodeType!==1||!bO(b9).is(ca))){if(b9.nodeType===1){e.push(b9)}b9=b9[b7]}return e},sibling:function(b8,b7){var e=[];for(;b8;b8=b8.nextSibling){if(b8.nodeType===1&&b8!==b7){e.push(b8)}}return e}});function aT(b9,b8,e){b8=b8||0;if(bO.isFunction(b8)){return bO.grep(b9,function(cb,ca){var cc=!!b8.call(cb,ca,cb);return cc===e})}else{if(b8.nodeType){return bO.grep(b9,function(cb,ca){return(cb===b8)===e})}else{if(typeof b8==="string"){var b7=bO.grep(b9,function(ca){return ca.nodeType===1});if(at.test(b8)){return bO.filter(b8,b7,!e)}else{b8=bO.filter(b8,b7)}}}}return bO.grep(b9,function(cb,ca){return(bO.inArray(cb,b8)>=0)===e})}function H(e){var b8=f.split("|"),b7=e.createDocumentFragment();if(b7.createElement){while(b8.length){b7.createElement(b8.pop())}}return b7}var f="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",aC=/ jQuery\d+="(?:null|\d+)"/g,b6=/^\s+/,aF=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,v=/<([\w:]+)/,b1=/<tbody/i,Q=/<|&#?\w+;/,aq=/<(?:script|style|link)/i,ax=/<(?:script|object|embed|option|style)/i,R=new RegExp("<(?:"+f+")[\\s/>]","i"),aL=/^(?:checkbox|radio)$/,bZ=/checked\s*(?:[^=]|=\s*.checked.)/i,bE=/\/(java|ecma)script/i,aO=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,aa={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},aX=H(u),r=aX.appendChild(u.createElement("div"));aa.optgroup=aa.option;aa.tbody=aa.tfoot=aa.colgroup=aa.caption=aa.thead;aa.th=aa.td;if(!bO.support.htmlSerialize){aa._default=[1,"X<div>","</div>"]}bO.fn.extend({text:function(e){return bO.access(this,function(b7){return b7===aI?bO.text(this):this.empty().append((this[0]&&this[0].ownerDocument||u).createTextNode(b7))},null,e,arguments.length)},wrapAll:function(e){if(bO.isFunction(e)){return this.each(function(b8){bO(this).wrapAll(e.call(this,b8))})}if(this[0]){var b7=bO(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){b7.insertBefore(this[0])}b7.map(function(){var b8=this;while(b8.firstChild&&b8.firstChild.nodeType===1){b8=b8.firstChild}return b8}).append(this)}return this},wrapInner:function(e){if(bO.isFunction(e)){return this.each(function(b7){bO(this).wrapInner(e.call(this,b7))})}return this.each(function(){var b7=bO(this),b8=b7.contents();if(b8.length){b8.wrapAll(e)}else{b7.append(e)}})},wrap:function(e){var b7=bO.isFunction(e);return this.each(function(b8){bO(this).wrapAll(b7?e.call(this,b8):e)})},unwrap:function(){return this.parent().each(function(){if(!bO.nodeName(this,"body")){bO(this).replaceWith(this.childNodes)}}).end()},append:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1||this.nodeType===11){this.appendChild(e)}})},prepend:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1||this.nodeType===11){this.insertBefore(e,this.firstChild)}})},before:function(){if(!aY(this[0])){return this.domManip(arguments,false,function(b7){this.parentNode.insertBefore(b7,this)})}if(arguments.length){var e=bO.clean(arguments);return this.pushStack(bO.merge(e,this),"before",this.selector)}},after:function(){if(!aY(this[0])){return this.domManip(arguments,false,function(b7){this.parentNode.insertBefore(b7,this.nextSibling)})}if(arguments.length){var e=bO.clean(arguments);return this.pushStack(bO.merge(this,e),"after",this.selector)}},remove:function(e,b9){var b8,b7=0;for(;(b8=this[b7])!=null;b7++){if(!e||bO.filter(e,[b8]).length){if(!b9&&b8.nodeType===1){bO.cleanData(b8.getElementsByTagName("*"));bO.cleanData([b8])}if(b8.parentNode){b8.parentNode.removeChild(b8)}}}return this},empty:function(){var b7,e=0;for(;(b7=this[e])!=null;e++){if(b7.nodeType===1){bO.cleanData(b7.getElementsByTagName("*"))}while(b7.firstChild){b7.removeChild(b7.firstChild)}}return this},clone:function(b7,e){b7=b7==null?false:b7;e=e==null?b7:e;return this.map(function(){return bO.clone(this,b7,e)})},html:function(e){return bO.access(this,function(ca){var b9=this[0]||{},b8=0,b7=this.length;if(ca===aI){return b9.nodeType===1?b9.innerHTML.replace(aC,""):aI}if(typeof ca==="string"&&!aq.test(ca)&&(bO.support.htmlSerialize||!R.test(ca))&&(bO.support.leadingWhitespace||!b6.test(ca))&&!aa[(v.exec(ca)||["",""])[1].toLowerCase()]){ca=ca.replace(aF,"<$1></$2>");try{for(;b8<b7;b8++){b9=this[b8]||{};if(b9.nodeType===1){bO.cleanData(b9.getElementsByTagName("*"));b9.innerHTML=ca}}b9=0}catch(cb){}}if(b9){this.empty().append(ca)}},null,e,arguments.length)},replaceWith:function(e){if(!aY(this[0])){if(bO.isFunction(e)){return this.each(function(b9){var b8=bO(this),b7=b8.html();b8.replaceWith(e.call(this,b9,b7))})}if(typeof e!=="string"){e=bO(e).detach()}return this.each(function(){var b8=this.nextSibling,b7=this.parentNode;bO(this).remove();if(b8){bO(b8).before(e)}else{bO(b7).append(e)}})}return this.length?this.pushStack(bO(bO.isFunction(e)?e():e),"replaceWith",e):this},detach:function(e){return this.remove(e,true)},domManip:function(cc,cg,cf){cc=[].concat.apply([],cc);var b8,ca,cb,ce,b9=0,cd=cc[0],b7=[],e=this.length;if(!bO.support.checkClone&&e>1&&typeof cd==="string"&&bZ.test(cd)){return this.each(function(){bO(this).domManip(cc,cg,cf)})}if(bO.isFunction(cd)){return this.each(function(ci){var ch=bO(this);cc[0]=cd.call(this,ci,cg?ch.html():aI);ch.domManip(cc,cg,cf)})}if(this[0]){b8=bO.buildFragment(cc,this,b7);cb=b8.fragment;ca=cb.firstChild;if(cb.childNodes.length===1){cb=ca}if(ca){cg=cg&&bO.nodeName(ca,"tr");for(ce=b8.cacheable||e-1;b9<e;b9++){cf.call(cg&&bO.nodeName(this[b9],"table")?E(this[b9],"tbody"):this[b9],b9===ce?cb:bO.clone(cb,true,true))}}cb=ca=null;if(b7.length){bO.each(b7,function(ch,ci){if(ci.src){if(bO.ajax){bO.ajax({url:ci.src,type:"GET",dataType:"script",async:false,global:false,"throws":true})}else{bO.error("no ajax")}}else{bO.globalEval((ci.text||ci.textContent||ci.innerHTML||"").replace(aO,""))}if(ci.parentNode){ci.parentNode.removeChild(ci)}})}}return this}});function E(b7,e){return b7.getElementsByTagName(e)[0]||b7.appendChild(b7.ownerDocument.createElement(e))}function aw(cd,b7){if(b7.nodeType!==1||!bO.hasData(cd)){return}var ca,b9,e,cc=bO._data(cd),cb=bO._data(b7,cc),b8=cc.events;if(b8){delete cb.handle;cb.events={};for(ca in b8){for(b9=0,e=b8[ca].length;b9<e;b9++){bO.event.add(b7,ca,b8[ca][b9])}}}if(cb.data){cb.data=bO.extend({},cb.data)}}function M(b7,e){var b8;if(e.nodeType!==1){return}if(e.clearAttributes){e.clearAttributes()}if(e.mergeAttributes){e.mergeAttributes(b7)}b8=e.nodeName.toLowerCase();if(b8==="object"){if(e.parentNode){e.outerHTML=b7.outerHTML}if(bO.support.html5Clone&&(b7.innerHTML&&!bO.trim(e.innerHTML))){e.innerHTML=b7.innerHTML}}else{if(b8==="input"&&aL.test(b7.type)){e.defaultChecked=e.checked=b7.checked;if(e.value!==b7.value){e.value=b7.value}}else{if(b8==="option"){e.selected=b7.defaultSelected}else{if(b8==="input"||b8==="textarea"){e.defaultValue=b7.defaultValue}else{if(b8==="script"&&e.text!==b7.text){e.text=b7.text}}}}}e.removeAttribute(bO.expando)}bO.buildFragment=function(b9,ca,b7){var b8,e,cb,cc=b9[0];ca=ca||u;ca=!ca.nodeType&&ca[0]||ca;ca=ca.ownerDocument||ca;if(b9.length===1&&typeof cc==="string"&&cc.length<512&&ca===u&&cc.charAt(0)==="<"&&!ax.test(cc)&&(bO.support.checkClone||!bZ.test(cc))&&(bO.support.html5Clone||!R.test(cc))){e=true;b8=bO.fragments[cc];cb=b8!==aI}if(!b8){b8=ca.createDocumentFragment();bO.clean(b9,ca,b8,b7);if(e){bO.fragments[cc]=cb&&b8}}return{fragment:b8,cacheable:e}};bO.fragments={};bO.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,b7){bO.fn[e]=function(b8){var ca,cc=0,cb=[],ce=bO(b8),b9=ce.length,cd=this.length===1&&this[0].parentNode;if((cd==null||cd&&cd.nodeType===11&&cd.childNodes.length===1)&&b9===1){ce[b7](this[0]);return this}else{for(;cc<b9;cc++){ca=(cc>0?this.clone(true):this).get();bO(ce[cc])[b7](ca);cb=cb.concat(ca)}return this.pushStack(cb,e,ce.selector)}}});function s(e){if(typeof e.getElementsByTagName!=="undefined"){return e.getElementsByTagName("*")}else{if(typeof e.querySelectorAll!=="undefined"){return e.querySelectorAll("*")}else{return[]}}}function b0(e){if(aL.test(e.type)){e.defaultChecked=e.checked}}bO.extend({clone:function(ca,cc,b8){var e,b7,b9,cb;if(bO.support.html5Clone||bO.isXMLDoc(ca)||!R.test("<"+ca.nodeName+">")){cb=ca.cloneNode(true)}else{r.innerHTML=ca.outerHTML;r.removeChild(cb=r.firstChild)}if((!bO.support.noCloneEvent||!bO.support.noCloneChecked)&&(ca.nodeType===1||ca.nodeType===11)&&!bO.isXMLDoc(ca)){M(ca,cb);e=s(ca);b7=s(cb);for(b9=0;e[b9];++b9){if(b7[b9]){M(e[b9],b7[b9])}}}if(cc){aw(ca,cb);if(b8){e=s(ca);b7=s(cb);for(b9=0;e[b9];++b9){aw(e[b9],b7[b9])}}}e=b7=null;return cb},clean:function(cj,b8,e,b9){var cg,cf,ci,cn,cc,cm,cd,ca,b7,ch,cl,ce,cb=b8===u&&aX,ck=[];if(!b8||typeof b8.createDocumentFragment==="undefined"){b8=u}for(cg=0;(ci=cj[cg])!=null;cg++){if(typeof ci==="number"){ci+=""}if(!ci){continue}if(typeof ci==="string"){if(!Q.test(ci)){ci=b8.createTextNode(ci)}else{cb=cb||H(b8);cd=b8.createElement("div");cb.appendChild(cd);ci=ci.replace(aF,"<$1></$2>");cn=(v.exec(ci)||["",""])[1].toLowerCase();cc=aa[cn]||aa._default;cm=cc[0];cd.innerHTML=cc[1]+ci+cc[2];while(cm--){cd=cd.lastChild}if(!bO.support.tbody){ca=b1.test(ci);b7=cn==="table"&&!ca?cd.firstChild&&cd.firstChild.childNodes:cc[1]==="<table>"&&!ca?cd.childNodes:[];for(cf=b7.length-1;cf>=0;--cf){if(bO.nodeName(b7[cf],"tbody")&&!b7[cf].childNodes.length){b7[cf].parentNode.removeChild(b7[cf])}}}if(!bO.support.leadingWhitespace&&b6.test(ci)){cd.insertBefore(b8.createTextNode(b6.exec(ci)[0]),cd.firstChild)}ci=cd.childNodes;cd.parentNode.removeChild(cd)}}if(ci.nodeType){ck.push(ci)}else{bO.merge(ck,ci)}}if(cd){ci=cd=cb=null}if(!bO.support.appendChecked){for(cg=0;(ci=ck[cg])!=null;cg++){if(bO.nodeName(ci,"input")){b0(ci)}else{if(typeof ci.getElementsByTagName!=="undefined"){bO.grep(ci.getElementsByTagName("input"),b0)}}}}if(e){cl=function(co){if(!co.type||bE.test(co.type)){return b9?b9.push(co.parentNode?co.parentNode.removeChild(co):co):e.appendChild(co)}};for(cg=0;(ci=ck[cg])!=null;cg++){if(!(bO.nodeName(ci,"script")&&cl(ci))){e.appendChild(ci);if(typeof ci.getElementsByTagName!=="undefined"){ce=bO.grep(bO.merge([],ci.getElementsByTagName("script")),cl);ck.splice.apply(ck,[cg+1,0].concat(ce));cg+=ce.length}}}}return ck},cleanData:function(b7,cf){var ca,b8,b9,ce,cb=0,cg=bO.expando,e=bO.cache,cc=bO.support.deleteExpando,cd=bO.event.special;for(;(b9=b7[cb])!=null;cb++){if(cf||bO.acceptData(b9)){b8=b9[cg];ca=b8&&e[b8];if(ca){if(ca.events){for(ce in ca.events){if(cd[ce]){bO.event.remove(b9,ce)}else{bO.removeEvent(b9,ce,ca.handle)}}}if(e[b8]){delete e[b8];if(cc){delete b9[cg]}else{if(b9.removeAttribute){b9.removeAttribute(cg)}else{b9[cg]=null}}bO.deletedIds.push(b8)}}}}}});(function(){var e,b7;bO.uaMatch=function(b9){b9=b9.toLowerCase();var b8=/(chrome)[ \/]([\w.]+)/.exec(b9)||/(webkit)[ \/]([\w.]+)/.exec(b9)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b9)||/(msie) ([\w.]+)/.exec(b9)||b9.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b9)||[];return{browser:b8[1]||"",version:b8[2]||"0"}};e=bO.uaMatch(g.userAgent);b7={};if(e.browser){b7[e.browser]=true;b7.version=e.version}if(b7.chrome){b7.webkit=true}else{if(b7.webkit){b7.safari=true}}bO.browser=b7;bO.sub=function(){function b8(cb,cc){return new b8.fn.init(cb,cc)}bO.extend(true,b8,this);b8.superclass=this;b8.fn=b8.prototype=this();b8.fn.constructor=b8;b8.sub=this.sub;b8.fn.init=function ca(cb,cc){if(cc&&cc instanceof bO&&!(cc instanceof b8)){cc=b8(cc)}return bO.fn.init.call(this,cb,cc,b9)};b8.fn.init.prototype=b8.fn;var b9=b8(u);return b8}})();var L,aG,a3,bl=/alpha\([^)]*\)/i,aZ=/opacity=([^)]*)/,bs=/^(top|right|bottom|left)$/,N=/^(none|table(?!-c[ea]).+)/,a6=/^margin/,bf=new RegExp("^("+bF+")(.*)$","i"),ad=new RegExp("^("+bF+")(?!px)[a-z%]+$","i"),Z=new RegExp("^([-+])=("+bF+")","i"),bp={},bg={position:"absolute",visibility:"hidden",display:"block"},bI={letterSpacing:0,fontWeight:400},bY=["Top","Right","Bottom","Left"],az=["Webkit","O","Moz","ms"],aQ=bO.fn.toggle;function b(b9,b7){if(b7 in b9){return b7}var ca=b7.charAt(0).toUpperCase()+b7.slice(1),e=b7,b8=az.length;while(b8--){b7=az[b8]+ca;if(b7 in b9){return b7}}return e}function X(b7,e){b7=e||b7;return bO.css(b7,"display")==="none"||!bO.contains(b7.ownerDocument,b7)}function z(cb,e){var ca,cc,b7=[],b8=0,b9=cb.length;for(;b8<b9;b8++){ca=cb[b8];if(!ca.style){continue}b7[b8]=bO._data(ca,"olddisplay");if(e){if(!b7[b8]&&ca.style.display==="none"){ca.style.display=""}if(ca.style.display===""&&X(ca)){b7[b8]=bO._data(ca,"olddisplay",bK(ca.nodeName))}}else{cc=L(ca,"display");if(!b7[b8]&&cc!=="none"){bO._data(ca,"olddisplay",cc)}}}for(b8=0;b8<b9;b8++){ca=cb[b8];if(!ca.style){continue}if(!e||ca.style.display==="none"||ca.style.display===""){ca.style.display=e?b7[b8]||"":"none"}}return cb}bO.fn.extend({css:function(e,b7){return bO.access(this,function(b9,b8,ca){return ca!==aI?bO.style(b9,b8,ca):bO.css(b9,b8)},e,b7,arguments.length>1)},show:function(){return z(this,true)},hide:function(){return z(this)},toggle:function(b8,b7){var e=typeof b8==="boolean";if(bO.isFunction(b8)&&bO.isFunction(b7)){return aQ.apply(this,arguments)}return this.each(function(){if(e?b8:X(this)){bO(this).show()}else{bO(this).hide()}})}});bO.extend({cssHooks:{opacity:{get:function(b8,b7){if(b7){var e=L(b8,"opacity");return e===""?"1":e}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":bO.support.cssFloat?"cssFloat":"styleFloat"},style:function(b9,b8,cf,ca){if(!b9||b9.nodeType===3||b9.nodeType===8||!b9.style){return}var cd,ce,cg,cb=bO.camelCase(b8),b7=b9.style;b8=bO.cssProps[cb]||(bO.cssProps[cb]=b(b7,cb));cg=bO.cssHooks[b8]||bO.cssHooks[cb];if(cf!==aI){ce=typeof cf;if(ce==="string"&&(cd=Z.exec(cf))){cf=(cd[1]+1)*cd[2]+parseFloat(bO.css(b9,b8));ce="number"}if(cf==null||ce==="number"&&isNaN(cf)){return}if(ce==="number"&&!bO.cssNumber[cb]){cf+="px"}if(!cg||!("set" in cg)||(cf=cg.set(b9,cf,ca))!==aI){try{b7[b8]=cf}catch(cc){}}}else{if(cg&&"get" in cg&&(cd=cg.get(b9,false,ca))!==aI){return cd}return b7[b8]}},css:function(cc,ca,cb,b7){var cd,b9,e,b8=bO.camelCase(ca);ca=bO.cssProps[b8]||(bO.cssProps[b8]=b(cc.style,b8));e=bO.cssHooks[ca]||bO.cssHooks[b8];if(e&&"get" in e){cd=e.get(cc,true,b7)}if(cd===aI){cd=L(cc,ca)}if(cd==="normal"&&ca in bI){cd=bI[ca]}if(cb||b7!==aI){b9=parseFloat(cd);return cb||bO.isNumeric(b9)?b9||0:cd}return cd},swap:function(ca,b9,cb){var b8,b7,e={};for(b7 in b9){e[b7]=ca.style[b7];ca.style[b7]=b9[b7]}b8=cb.call(ca);for(b7 in b9){ca.style[b7]=e[b7]}return b8}});if(a9.getComputedStyle){L=function(cd,b7){var e,ca,b9,cc,cb=a9.getComputedStyle(cd,null),b8=cd.style;if(cb){e=cb[b7];if(e===""&&!bO.contains(cd.ownerDocument,cd)){e=bO.style(cd,b7)}if(ad.test(e)&&a6.test(b7)){ca=b8.width;b9=b8.minWidth;cc=b8.maxWidth;b8.minWidth=b8.maxWidth=b8.width=e;e=cb.width;b8.width=ca;b8.minWidth=b9;b8.maxWidth=cc}}return e}}else{if(u.documentElement.currentStyle){L=function(ca,b8){var cb,e,b7=ca.currentStyle&&ca.currentStyle[b8],b9=ca.style;if(b7==null&&b9&&b9[b8]){b7=b9[b8]}if(ad.test(b7)&&!bs.test(b8)){cb=b9.left;e=ca.runtimeStyle&&ca.runtimeStyle.left;if(e){ca.runtimeStyle.left=ca.currentStyle.left}b9.left=b8==="fontSize"?"1em":b7;b7=b9.pixelLeft+"px";b9.left=cb;if(e){ca.runtimeStyle.left=e}}return b7===""?"auto":b7}}}function aN(e,b8,b9){var b7=bf.exec(b8);return b7?Math.max(0,b7[1]-(b9||0))+(b7[2]||"px"):b8}function aA(b9,b7,e,cb){var b8=e===(cb?"border":"content")?4:b7==="width"?1:0,ca=0;for(;b8<4;b8+=2){if(e==="margin"){ca+=bO.css(b9,e+bY[b8],true)}if(cb){if(e==="content"){ca-=parseFloat(L(b9,"padding"+bY[b8]))||0}if(e!=="margin"){ca-=parseFloat(L(b9,"border"+bY[b8]+"Width"))||0}}else{ca+=parseFloat(L(b9,"padding"+bY[b8]))||0;if(e!=="padding"){ca+=parseFloat(L(b9,"border"+bY[b8]+"Width"))||0}}}return ca}function B(b9,b7,e){var ca=b7==="width"?b9.offsetWidth:b9.offsetHeight,b8=true,cb=bO.support.boxSizing&&bO.css(b9,"boxSizing")==="border-box";if(ca<=0||ca==null){ca=L(b9,b7);if(ca<0||ca==null){ca=b9.style[b7]}if(ad.test(ca)){return ca}b8=cb&&(bO.support.boxSizingReliable||ca===b9.style[b7]);ca=parseFloat(ca)||0}return(ca+aA(b9,b7,e||(cb?"border":"content"),b8))+"px"}function bK(b8){if(bp[b8]){return bp[b8]}var e=bO("<"+b8+">").appendTo(u.body),b7=e.css("display");e.remove();if(b7==="none"||b7===""){aG=u.body.appendChild(aG||bO.extend(u.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!a3||!aG.createElement){a3=(aG.contentWindow||aG.contentDocument).document;a3.write("<!doctype html><html><body>");a3.close()}e=a3.body.appendChild(a3.createElement(b8));b7=L(e,"display");u.body.removeChild(aG)}bp[b8]=b7;return b7}bO.each(["height","width"],function(b7,e){bO.cssHooks[e]={get:function(ca,b9,b8){if(b9){if(ca.offsetWidth===0&&N.test(L(ca,"display"))){return bO.swap(ca,bg,function(){return B(ca,e,b8)})}else{return B(ca,e,b8)}}},set:function(b9,ca,b8){return aN(b9,ca,b8?aA(b9,e,b8,bO.support.boxSizing&&bO.css(b9,"boxSizing")==="border-box"):0)}}});if(!bO.support.opacity){bO.cssHooks.opacity={get:function(b7,e){return aZ.test((e&&b7.currentStyle?b7.currentStyle.filter:b7.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":e?"1":""},set:function(ca,cb){var b9=ca.style,b7=ca.currentStyle,e=bO.isNumeric(cb)?"alpha(opacity="+cb*100+")":"",b8=b7&&b7.filter||b9.filter||"";b9.zoom=1;if(cb>=1&&bO.trim(b8.replace(bl,""))===""&&b9.removeAttribute){b9.removeAttribute("filter");if(b7&&!b7.filter){return}}b9.filter=bl.test(b8)?b8.replace(bl,e):b8+" "+e}}}bO(function(){if(!bO.support.reliableMarginRight){bO.cssHooks.marginRight={get:function(b7,e){return bO.swap(b7,{display:"inline-block"},function(){if(e){return L(b7,"marginRight")}})}}}if(!bO.support.pixelPosition&&bO.fn.position){bO.each(["top","left"],function(e,b7){bO.cssHooks[b7]={get:function(ca,b9){if(b9){var b8=L(ca,b7);return ad.test(b8)?bO(ca).position()[b7]+"px":b8}}}})}});if(bO.expr&&bO.expr.filters){bO.expr.filters.hidden=function(e){return(e.offsetWidth===0&&e.offsetHeight===0)||(!bO.support.reliableHiddenOffsets&&((e.style&&e.style.display)||L(e,"display"))==="none")};bO.expr.filters.visible=function(e){return !bO.expr.filters.hidden(e)}}bO.each({margin:"",padding:"",border:"Width"},function(e,b7){bO.cssHooks[e+b7]={expand:function(ca){var b9,cb=typeof ca==="string"?ca.split(" "):[ca],b8={};for(b9=0;b9<4;b9++){b8[e+bY[b9]+b7]=cb[b9]||cb[b9-2]||cb[0]}return b8}};if(!a6.test(e)){bO.cssHooks[e+b7].set=aN}});var bA=/%20/g,aW=/\[\]$/,ab=/\r?\n/g,bH=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,aK=/^(?:select|textarea)/i;bO.fn.extend({serialize:function(){return bO.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?bO.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||aK.test(this.nodeName)||bH.test(this.type))}).map(function(e,b7){var b8=bO(this).val();return b8==null?null:bO.isArray(b8)?bO.map(b8,function(ca,b9){return{name:b7.name,value:ca.replace(ab,"\r\n")}}):{name:b7.name,value:b8.replace(ab,"\r\n")}}).get()}});bO.param=function(e,b8){var b9,b7=[],ca=function(cb,cc){cc=bO.isFunction(cc)?cc():(cc==null?"":cc);b7[b7.length]=encodeURIComponent(cb)+"="+encodeURIComponent(cc)};if(b8===aI){b8=bO.ajaxSettings&&bO.ajaxSettings.traditional}if(bO.isArray(e)||(e.jquery&&!bO.isPlainObject(e))){bO.each(e,function(){ca(this.name,this.value)})}else{for(b9 in e){q(b9,e[b9],b8,ca)}}return b7.join("&").replace(bA,"+")};function q(b8,ca,b7,b9){var e;if(bO.isArray(ca)){bO.each(ca,function(cc,cb){if(b7||aW.test(b8)){b9(b8,cb)}else{q(b8+"["+(typeof cb==="object"?cc:"")+"]",cb,b7,b9)}})}else{if(!b7&&bO.type(ca)==="object"){for(e in ca){q(b8+"["+e+"]",ca[e],b7,b9)}}else{b9(b8,ca)}}}var b5,af,av=/#.*$/,ak=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,I=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,x=/^(?:GET|HEAD)$/,aJ=/^\/\//,bV=/\?/,i=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,W=/([?&])_=[^&]*/,a0=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,b4=bO.fn.load,C={},bd={},a4=["*/"]+["*"];try{af=aP.href}catch(bk){af=u.createElement("a");af.href="";af=af.href}b5=a0.exec(af.toLowerCase())||[];function bQ(e){return function(ca,cc){if(typeof ca!=="string"){cc=ca;ca="*"}var b7,cd,ce,b9=ca.toLowerCase().split(a2),b8=0,cb=b9.length;if(bO.isFunction(cc)){for(;b8<cb;b8++){b7=b9[b8];ce=/^\+/.test(b7);if(ce){b7=b7.substr(1)||"*"}cd=e[b7]=e[b7]||[];cd[ce?"unshift":"push"](cc)}}}}function w(b7,cg,cb,ce,cd,b9){cd=cd||cg.dataTypes[0];b9=b9||{};b9[cd]=true;var cf,cc=b7[cd],b8=0,e=cc?cc.length:0,ca=(b7===C);for(;b8<e&&(ca||!cf);b8++){cf=cc[b8](cg,cb,ce);if(typeof cf==="string"){if(!ca||b9[cf]){cf=aI}else{cg.dataTypes.unshift(cf);cf=w(b7,cg,cb,ce,cf,b9)}}}if((ca||!cf)&&!b9["*"]){cf=w(b7,cg,cb,ce,"*",b9)}return cf}function A(b8,b9){var b7,e,ca=bO.ajaxSettings.flatOptions||{};for(b7 in b9){if(b9[b7]!==aI){(ca[b7]?b8:(e||(e={})))[b7]=b9[b7]}}if(e){bO.extend(true,b8,e)}}bO.fn.load=function(b9,cc,cd){if(typeof b9!=="string"&&b4){return b4.apply(this,arguments)}if(!this.length){return this}var e,ca,b8,b7=this,cb=b9.indexOf(" ");if(cb>=0){e=b9.slice(cb,b9.length);b9=b9.slice(0,cb)}if(bO.isFunction(cc)){cd=cc;cc=aI}else{if(cc&&typeof cc==="object"){ca="POST"}}bO.ajax({url:b9,type:ca,dataType:"html",data:cc,complete:function(cf,ce){if(cd){b7.each(cd,b8||[cf.responseText,ce,cf])}}}).done(function(ce){b8=arguments;b7.html(e?bO("<div>").append(ce.replace(i,"")).find(e):ce)});return this};bO.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,b7){bO.fn[b7]=function(b8){return this.on(b7,b8)}});bO.each(["get","post"],function(e,b7){bO[b7]=function(b8,ca,cb,b9){if(bO.isFunction(ca)){b9=b9||cb;cb=ca;ca=aI}return bO.ajax({type:b7,url:b8,data:ca,success:cb,dataType:b9})}});bO.extend({getScript:function(e,b7){return bO.get(e,aI,b7,"script")},getJSON:function(e,b7,b8){return bO.get(e,b7,b8,"json")},ajaxSetup:function(b7,e){if(e){A(b7,bO.ajaxSettings)}else{e=b7;b7=bO.ajaxSettings}A(b7,e);return b7},ajaxSettings:{url:af,isLocal:I.test(b5[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":a4},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a9.String,"text html":true,"text json":bO.parseJSON,"text xml":bO.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:bQ(C),ajaxTransport:bQ(bd),ajax:function(cc,b9){if(typeof cc==="object"){b9=cc;cc=aI}b9=b9||{};var cf,ct,ca,co,ch,cl,b8,cn,cg=bO.ajaxSetup({},b9),cv=cg.context||cg,cj=cv!==cg&&(cv.nodeType||cv instanceof bO)?bO(cv):bO.event,cu=bO.Deferred(),cq=bO.Callbacks("once memory"),cd=cg.statusCode||{},ck={},cr={},cb=0,ce="canceled",cm={readyState:0,setRequestHeader:function(cw,cx){if(!cb){var e=cw.toLowerCase();cw=cr[e]=cr[e]||cw;ck[cw]=cx}return this},getAllResponseHeaders:function(){return cb===2?ct:null},getResponseHeader:function(cw){var e;if(cb===2){if(!ca){ca={};while((e=ak.exec(ct))){ca[e[1].toLowerCase()]=e[2]}}e=ca[cw.toLowerCase()]}return e===aI?null:e},overrideMimeType:function(e){if(!cb){cg.mimeType=e}return this},abort:function(e){e=e||ce;if(co){co.abort(e)}ci(0,e);return this}};function ci(cA,cw,cB,cy){var e,cE,cC,cz,cD,cx=cw;if(cb===2){return}cb=2;if(ch){clearTimeout(ch)}co=aI;ct=cy||"";cm.readyState=cA>0?4:0;if(cB){cz=j(cg,cm,cB)}if(cA>=200&&cA<300||cA===304){if(cg.ifModified){cD=cm.getResponseHeader("Last-Modified");if(cD){bO.lastModified[cf]=cD}cD=cm.getResponseHeader("Etag");if(cD){bO.etag[cf]=cD}}if(cA===304){cx="notmodified";e=true}else{e=al(cg,cz);cx=e.state;cE=e.data;cC=e.error;e=!cC}}else{cC=cx;if(!cx||cA){cx="error";if(cA<0){cA=0}}}cm.status=cA;cm.statusText=(cw||cx)+"";if(e){cu.resolveWith(cv,[cE,cx,cm])}else{cu.rejectWith(cv,[cm,cx,cC])}cm.statusCode(cd);cd=aI;if(b8){cj.trigger("ajax"+(e?"Success":"Error"),[cm,cg,e?cE:cC])}cq.fireWith(cv,[cm,cx]);if(b8){cj.trigger("ajaxComplete",[cm,cg]);if(!(--bO.active)){bO.event.trigger("ajaxStop")}}}cu.promise(cm);cm.success=cm.done;cm.error=cm.fail;cm.complete=cq.add;cm.statusCode=function(cw){if(cw){var e;if(cb<2){for(e in cw){cd[e]=[cd[e],cw[e]]}}else{e=cw[cm.status];cm.always(e)}}return this};cg.url=((cc||cg.url)+"").replace(av,"").replace(aJ,b5[1]+"//");cg.dataTypes=bO.trim(cg.dataType||"*").toLowerCase().split(a2);if(cg.crossDomain==null){cl=a0.exec(cg.url.toLowerCase())||false;cg.crossDomain=cl&&(cl.join(":")+(cl[3]?"":cl[1]==="http:"?80:443))!==(b5.join(":")+(b5[3]?"":b5[1]==="http:"?80:443))}if(cg.data&&cg.processData&&typeof cg.data!=="string"){cg.data=bO.param(cg.data,cg.traditional)}w(C,cg,b9,cm);if(cb===2){return cm}b8=cg.global;cg.type=cg.type.toUpperCase();cg.hasContent=!x.test(cg.type);if(b8&&bO.active++===0){bO.event.trigger("ajaxStart")}if(!cg.hasContent){if(cg.data){cg.url+=(bV.test(cg.url)?"&":"?")+cg.data;delete cg.data}cf=cg.url;if(cg.cache===false){var b7=bO.now(),cs=cg.url.replace(W,"$1_="+b7);cg.url=cs+((cs===cg.url)?(bV.test(cg.url)?"&":"?")+"_="+b7:"")}}if(cg.data&&cg.hasContent&&cg.contentType!==false||b9.contentType){cm.setRequestHeader("Content-Type",cg.contentType)}if(cg.ifModified){cf=cf||cg.url;if(bO.lastModified[cf]){cm.setRequestHeader("If-Modified-Since",bO.lastModified[cf])}if(bO.etag[cf]){cm.setRequestHeader("If-None-Match",bO.etag[cf])}}cm.setRequestHeader("Accept",cg.dataTypes[0]&&cg.accepts[cg.dataTypes[0]]?cg.accepts[cg.dataTypes[0]]+(cg.dataTypes[0]!=="*"?", "+a4+"; q=0.01":""):cg.accepts["*"]);for(cn in cg.headers){cm.setRequestHeader(cn,cg.headers[cn])}if(cg.beforeSend&&(cg.beforeSend.call(cv,cm,cg)===false||cb===2)){return cm.abort()}ce="abort";for(cn in {success:1,error:1,complete:1}){cm[cn](cg[cn])}co=w(bd,cg,b9,cm);if(!co){ci(-1,"No Transport")}else{cm.readyState=1;if(b8){cj.trigger("ajaxSend",[cm,cg])}if(cg.async&&cg.timeout>0){ch=setTimeout(function(){cm.abort("timeout")},cg.timeout)}try{cb=1;co.send(ck,ci)}catch(cp){if(cb<2){ci(-1,cp)}else{throw cp}}}return cm},active:0,lastModified:{},etag:{}});function j(cf,ce,cb){var ca,cc,b9,e,b7=cf.contents,cd=cf.dataTypes,b8=cf.responseFields;for(cc in b8){if(cc in cb){ce[b8[cc]]=cb[cc]}}while(cd[0]==="*"){cd.shift();if(ca===aI){ca=cf.mimeType||ce.getResponseHeader("content-type")}}if(ca){for(cc in b7){if(b7[cc]&&b7[cc].test(ca)){cd.unshift(cc);break}}}if(cd[0] in cb){b9=cd[0]}else{for(cc in cb){if(!cd[0]||cf.converters[cc+" "+cd[0]]){b9=cc;break}if(!e){e=cc}}b9=b9||e}if(b9){if(b9!==cd[0]){cd.unshift(b9)}return cb[b9]}}function al(ch,b9){var cf,b7,cd,cb,ce=ch.dataTypes.slice(),b8=ce[0],cg={},ca=0;if(ch.dataFilter){b9=ch.dataFilter(b9,ch.dataType)}if(ce[1]){for(cf in ch.converters){cg[cf.toLowerCase()]=ch.converters[cf]}}for(;(cd=ce[++ca]);){if(cd!=="*"){if(b8!=="*"&&b8!==cd){cf=cg[b8+" "+cd]||cg["* "+cd];if(!cf){for(b7 in cg){cb=b7.split(" ");if(cb[1]===cd){cf=cg[b8+" "+cb[0]]||cg["* "+cb[0]];if(cf){if(cf===true){cf=cg[b7]}else{if(cg[b7]!==true){cd=cb[0];ce.splice(ca--,0,cd)}}break}}}}if(cf!==true){if(cf&&ch["throws"]){b9=cf(b9)}else{try{b9=cf(b9)}catch(cc){return{state:"parsererror",error:cf?cc:"No conversion from "+b8+" to "+cd}}}}}b8=cd}}return{state:"success",data:b9}}var bx=[],aD=/\?/,bc=/(=)\?(?=&|$)|\?\?/,bt=bO.now();bO.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=bx.pop()||(bO.expando+"_"+(bt++));this[e]=true;return e}});bO.ajaxPrefilter("json jsonp",function(cg,cb,cf){var ce,e,cd,b9=cg.data,b7=cg.url,b8=cg.jsonp!==false,cc=b8&&bc.test(b7),ca=b8&&!cc&&typeof b9==="string"&&!(cg.contentType||"").indexOf("application/x-www-form-urlencoded")&&bc.test(b9);if(cg.dataTypes[0]==="jsonp"||cc||ca){ce=cg.jsonpCallback=bO.isFunction(cg.jsonpCallback)?cg.jsonpCallback():cg.jsonpCallback;e=a9[ce];if(cc){cg.url=b7.replace(bc,"$1"+ce)}else{if(ca){cg.data=b9.replace(bc,"$1"+ce)}else{if(b8){cg.url+=(aD.test(b7)?"&":"?")+cg.jsonp+"="+ce}}}cg.converters["script json"]=function(){if(!cd){bO.error(ce+" was not called")}return cd[0]};cg.dataTypes[0]="json";a9[ce]=function(){cd=arguments};cf.always(function(){a9[ce]=e;if(cg[ce]){cg.jsonpCallback=cb.jsonpCallback;bx.push(ce)}if(cd&&bO.isFunction(e)){e(cd[0])}cd=e=aI});return"script"}});bO.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){bO.globalEval(e);return e}}});bO.ajaxPrefilter("script",function(e){if(e.cache===aI){e.cache=false}if(e.crossDomain){e.type="GET";e.global=false}});bO.ajaxTransport("script",function(b8){if(b8.crossDomain){var e,b7=u.head||u.getElementsByTagName("head")[0]||u.documentElement;return{send:function(b9,ca){e=u.createElement("script");e.async="async";if(b8.scriptCharset){e.charset=b8.scriptCharset}e.src=b8.url;e.onload=e.onreadystatechange=function(cc,cb){if(cb||!e.readyState||/loaded|complete/.test(e.readyState)){e.onload=e.onreadystatechange=null;if(b7&&e.parentNode){b7.removeChild(e)}e=aI;if(!cb){ca(200,"success")}}};b7.insertBefore(e,b7.firstChild)},abort:function(){if(e){e.onload(0,1)}}}}});var ao,aU=a9.ActiveXObject?function(){for(var e in ao){ao[e](0,1)}}:false,aB=0;function bJ(){try{return new a9.XMLHttpRequest()}catch(b7){}}function bi(){try{return new a9.ActiveXObject("Microsoft.XMLHTTP")}catch(b7){}}bO.ajaxSettings.xhr=a9.ActiveXObject?function(){return !this.isLocal&&bJ()||bi()}:bJ;(function(e){bO.extend(bO.support,{ajax:!!e,cors:!!e&&("withCredentials" in e)})})(bO.ajaxSettings.xhr());if(bO.support.ajax){bO.ajaxTransport(function(e){if(!e.crossDomain||bO.support.cors){var b7;return{send:function(cd,b8){var cb,ca,cc=e.xhr();if(e.username){cc.open(e.type,e.url,e.async,e.username,e.password)}else{cc.open(e.type,e.url,e.async)}if(e.xhrFields){for(ca in e.xhrFields){cc[ca]=e.xhrFields[ca]}}if(e.mimeType&&cc.overrideMimeType){cc.overrideMimeType(e.mimeType)}if(!e.crossDomain&&!cd["X-Requested-With"]){cd["X-Requested-With"]="XMLHttpRequest"}try{for(ca in cd){cc.setRequestHeader(ca,cd[ca])}}catch(b9){}cc.send((e.hasContent&&e.data)||null);b7=function(cm,cg){var ch,cf,ce,ck,cj;try{if(b7&&(cg||cc.readyState===4)){b7=aI;if(cb){cc.onreadystatechange=bO.noop;if(aU){delete ao[cb]}}if(cg){if(cc.readyState!==4){cc.abort()}}else{ch=cc.status;ce=cc.getAllResponseHeaders();ck={};cj=cc.responseXML;if(cj&&cj.documentElement){ck.xml=cj}try{ck.text=cc.responseText}catch(cm){}try{cf=cc.statusText}catch(cl){cf=""}if(!ch&&e.isLocal&&!e.crossDomain){ch=ck.text?200:404}else{if(ch===1223){ch=204}}}}}catch(ci){if(!cg){b8(-1,ci)}}if(ck){b8(ch,cf,ck,ce)}};if(!e.async){b7()}else{if(cc.readyState===4){setTimeout(b7,0)}else{cb=++aB;if(aU){if(!ao){ao={};bO(a9).unload(aU)}ao[cb]=b7}cc.onreadystatechange=b7}}},abort:function(){if(b7){b7(0,1)}}}}})}var S,ai,bW=/^(?:toggle|show|hide)$/,bP=new RegExp("^(?:([-+])=|)("+bF+")([a-z%]*)$","i"),bU=/queueHooks$/,aE=[k],a8={"*":[function(e,cd){var b9,ce,cf=this.createTween(e,cd),ca=bP.exec(cd),cb=cf.cur(),b7=+cb||0,b8=1,cc=20;if(ca){b9=+ca[2];ce=ca[3]||(bO.cssNumber[e]?"":"px");if(ce!=="px"&&b7){b7=bO.css(cf.elem,e,true)||b9||1;do{b8=b8||".5";b7=b7/b8;bO.style(cf.elem,e,b7+ce)}while(b8!==(b8=cf.cur()/cb)&&b8!==1&&--cc)}cf.unit=ce;cf.start=b7;cf.end=ca[1]?b7+(ca[1]+1)*b9:b9}return cf}]};function br(){setTimeout(function(){S=aI},0);return(S=bO.now())}function bj(b7,e){bO.each(e,function(cc,ca){var cb=(a8[cc]||[]).concat(a8["*"]),b8=0,b9=cb.length;for(;b8<b9;b8++){if(cb[b8].call(b7,cc,ca)){return}}})}function h(b8,cc,cf){var cg,cb=0,e=0,b7=aE.length,ce=bO.Deferred().always(function(){delete ca.elem}),ca=function(){var cl=S||br(),ci=Math.max(0,b9.startTime+b9.duration-cl),ck=1-(ci/b9.duration||0),ch=0,cj=b9.tweens.length;for(;ch<cj;ch++){b9.tweens[ch].run(ck)}ce.notifyWith(b8,[b9,ck,ci]);if(ck<1&&cj){return ci}else{ce.resolveWith(b8,[b9]);return false}},b9=ce.promise({elem:b8,props:bO.extend({},cc),opts:bO.extend(true,{specialEasing:{}},cf),originalProperties:cc,originalOptions:cf,startTime:S||br(),duration:cf.duration,tweens:[],createTween:function(ck,ch,cj){var ci=bO.Tween(b8,b9.opts,ck,ch,b9.opts.specialEasing[ck]||b9.opts.easing);b9.tweens.push(ci);return ci},stop:function(ci){var ch=0,cj=ci?b9.tweens.length:0;for(;ch<cj;ch++){b9.tweens[ch].run(1)}if(ci){ce.resolveWith(b8,[b9,ci])}else{ce.rejectWith(b8,[b9,ci])}return this}}),cd=b9.props;ar(cd,b9.opts.specialEasing);for(;cb<b7;cb++){cg=aE[cb].call(b9,b8,cd,b9.opts);if(cg){return cg}}bj(b9,cd);if(bO.isFunction(b9.opts.start)){b9.opts.start.call(b8,b9)}bO.fx.timer(bO.extend(ca,{anim:b9,queue:b9.opts.queue,elem:b8}));return b9.progress(b9.opts.progress).done(b9.opts.done,b9.opts.complete).fail(b9.opts.fail).always(b9.opts.always)}function ar(b9,cb){var b8,b7,cc,ca,e;for(b8 in b9){b7=bO.camelCase(b8);cc=cb[b7];ca=b9[b8];if(bO.isArray(ca)){cc=ca[1];ca=b9[b8]=ca[0]}if(b8!==b7){b9[b7]=ca;delete b9[b8]}e=bO.cssHooks[b7];if(e&&"expand" in e){ca=e.expand(ca);delete b9[b7];for(b8 in ca){if(!(b8 in b9)){b9[b8]=ca[b8];cb[b8]=cc}}}else{cb[b7]=cc}}}bO.Animation=bO.extend(h,{tweener:function(b7,ca){if(bO.isFunction(b7)){ca=b7;b7=["*"]}else{b7=b7.split(" ")}var b9,e=0,b8=b7.length;for(;e<b8;e++){b9=b7[e];a8[b9]=a8[b9]||[];a8[b9].unshift(ca)}},prefilter:function(b7,e){if(e){aE.unshift(b7)}else{aE.push(b7)}}});function k(ca,cf,e){var ce,b8,ch,b9,cl,ck,cj,ci,cb=this,b7=ca.style,cg={},cd=[],cc=ca.nodeType&&X(ca);if(!e.queue){cj=bO._queueHooks(ca,"fx");if(cj.unqueued==null){cj.unqueued=0;ci=cj.empty.fire;cj.empty.fire=function(){if(!cj.unqueued){ci()}}}cj.unqueued++;cb.always(function(){cb.always(function(){cj.unqueued--;if(!bO.queue(ca,"fx").length){cj.empty.fire()}})})}if(ca.nodeType===1&&("height" in cf||"width" in cf)){e.overflow=[b7.overflow,b7.overflowX,b7.overflowY];if(bO.css(ca,"display")==="inline"&&bO.css(ca,"float")==="none"){if(!bO.support.inlineBlockNeedsLayout||bK(ca.nodeName)==="inline"){b7.display="inline-block"}else{b7.zoom=1}}}if(e.overflow){b7.overflow="hidden";if(!bO.support.shrinkWrapBlocks){cb.done(function(){b7.overflow=e.overflow[0];b7.overflowX=e.overflow[1];b7.overflowY=e.overflow[2]})}}for(ce in cf){ch=cf[ce];if(bW.exec(ch)){delete cf[ce];if(ch===(cc?"hide":"show")){continue}cd.push(ce)}}b9=cd.length;if(b9){cl=bO._data(ca,"fxshow")||bO._data(ca,"fxshow",{});if(cc){bO(ca).show()}else{cb.done(function(){bO(ca).hide()})}cb.done(function(){var cm;bO.removeData(ca,"fxshow",true);for(cm in cg){bO.style(ca,cm,cg[cm])}});for(ce=0;ce<b9;ce++){b8=cd[ce];ck=cb.createTween(b8,cc?cl[b8]:0);cg[b8]=cl[b8]||bO.style(ca,b8);if(!(b8 in cl)){cl[b8]=ck.start;if(cc){ck.end=ck.start;ck.start=b8==="width"||b8==="height"?1:0}}}}}function O(b8,b7,ca,e,b9){return new O.prototype.init(b8,b7,ca,e,b9)}bO.Tween=O;O.prototype={constructor:O,init:function(b9,b7,cb,e,ca,b8){this.elem=b9;this.prop=cb;this.easing=ca||"swing";this.options=b7;this.start=this.now=this.cur();this.end=e;this.unit=b8||(bO.cssNumber[cb]?"":"px")},cur:function(){var e=O.propHooks[this.prop];return e&&e.get?e.get(this):O.propHooks._default.get(this)},run:function(b8){var b7,e=O.propHooks[this.prop];if(this.options.duration){this.pos=b7=bO.easing[this.easing](b8,this.options.duration*b8,0,1,this.options.duration)}else{this.pos=b7=b8}this.now=(this.end-this.start)*b7+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(e&&e.set){e.set(this)}else{O.propHooks._default.set(this)}return this}};O.prototype.init.prototype=O.prototype;O.propHooks={_default:{get:function(b7){var e;if(b7.elem[b7.prop]!=null&&(!b7.elem.style||b7.elem.style[b7.prop]==null)){return b7.elem[b7.prop]}e=bO.css(b7.elem,b7.prop,false,"");return !e||e==="auto"?0:e},set:function(e){if(bO.fx.step[e.prop]){bO.fx.step[e.prop](e)}else{if(e.elem.style&&(e.elem.style[bO.cssProps[e.prop]]!=null||bO.cssHooks[e.prop])){bO.style(e.elem,e.prop,e.now+e.unit)}else{e.elem[e.prop]=e.now}}}}};O.propHooks.scrollTop=O.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now}}};bO.each(["toggle","show","hide"],function(b7,e){var b8=bO.fn[e];bO.fn[e]=function(b9,cb,ca){return b9==null||typeof b9==="boolean"||(!b7&&bO.isFunction(b9)&&bO.isFunction(cb))?b8.apply(this,arguments):this.animate(bN(e,true),b9,cb,ca)}});bO.fn.extend({fadeTo:function(e,b9,b8,b7){return this.filter(X).css("opacity",0).show().end().animate({opacity:b9},e,b8,b7)},animate:function(cc,b9,cb,ca){var b8=bO.isEmptyObject(cc),e=bO.speed(b9,cb,ca),b7=function(){var cd=h(this,bO.extend({},cc),e);if(b8){cd.stop(true)}};return b8||e.queue===false?this.each(b7):this.queue(e.queue,b7)},stop:function(b8,b7,e){var b9=function(ca){var cb=ca.stop;delete ca.stop;cb(e)};if(typeof b8!=="string"){e=b7;b7=b8;b8=aI}if(b7&&b8!==false){this.queue(b8||"fx",[])}return this.each(function(){var cd=true,ca=b8!=null&&b8+"queueHooks",cc=bO.timers,cb=bO._data(this);if(ca){if(cb[ca]&&cb[ca].stop){b9(cb[ca])}}else{for(ca in cb){if(cb[ca]&&cb[ca].stop&&bU.test(ca)){b9(cb[ca])}}}for(ca=cc.length;ca--;){if(cc[ca].elem===this&&(b8==null||cc[ca].queue===b8)){cc[ca].anim.stop(e);cd=false;cc.splice(ca,1)}}if(cd||!e){bO.dequeue(this,b8)}})}});function bN(b8,ca){var b9,e={height:b8},b7=0;ca=ca?1:0;for(;b7<4;b7+=2-ca){b9=bY[b7];e["margin"+b9]=e["padding"+b9]=b8}if(ca){e.opacity=e.width=b8}return e}bO.each({slideDown:bN("show"),slideUp:bN("hide"),slideToggle:bN("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,b7){bO.fn[e]=function(b8,ca,b9){return this.animate(b7,b8,ca,b9)}});bO.speed=function(b8,b9,b7){var e=b8&&typeof b8==="object"?bO.extend({},b8):{complete:b7||!b7&&b9||bO.isFunction(b8)&&b8,duration:b8,easing:b7&&b9||b9&&!bO.isFunction(b9)&&b9};e.duration=bO.fx.off?0:typeof e.duration==="number"?e.duration:e.duration in bO.fx.speeds?bO.fx.speeds[e.duration]:bO.fx.speeds._default;if(e.queue==null||e.queue===true){e.queue="fx"}e.old=e.complete;e.complete=function(){if(bO.isFunction(e.old)){e.old.call(this)}if(e.queue){bO.dequeue(this,e.queue)}};return e};bO.easing={linear:function(e){return e},swing:function(e){return 0.5-Math.cos(e*Math.PI)/2}};bO.timers=[];bO.fx=O.prototype.init;bO.fx.tick=function(){var b8,b7=bO.timers,e=0;for(;e<b7.length;e++){b8=b7[e];if(!b8()&&b7[e]===b8){b7.splice(e--,1)}}if(!b7.length){bO.fx.stop()}};bO.fx.timer=function(e){if(e()&&bO.timers.push(e)&&!ai){ai=setInterval(bO.fx.tick,bO.fx.interval)}};bO.fx.interval=13;bO.fx.stop=function(){clearInterval(ai);ai=null};bO.fx.speeds={slow:600,fast:200,_default:400};bO.fx.step={};if(bO.expr&&bO.expr.filters){bO.expr.filters.animated=function(e){return bO.grep(bO.timers,function(b7){return e===b7.elem}).length}}var bu=/^(?:body|html)$/i;bO.fn.offset=function(cg){if(arguments.length){return cg===aI?this:this.each(function(ch){bO.offset.setOffset(this,cg,ch)})}var b7,cc,cd,ca,ce,e,b9,cb={top:0,left:0},b8=this[0],cf=b8&&b8.ownerDocument;if(!cf){return}if((cc=cf.body)===b8){return bO.offset.bodyOffset(b8)}b7=cf.documentElement;if(!bO.contains(b7,b8)){return cb}if(typeof b8.getBoundingClientRect!=="undefined"){cb=b8.getBoundingClientRect()}cd=bv(cf);ca=b7.clientTop||cc.clientTop||0;ce=b7.clientLeft||cc.clientLeft||0;e=cd.pageYOffset||b7.scrollTop;b9=cd.pageXOffset||b7.scrollLeft;return{top:cb.top+e-ca,left:cb.left+b9-ce}};bO.offset={bodyOffset:function(e){var b8=e.offsetTop,b7=e.offsetLeft;if(bO.support.doesNotIncludeMarginInBodyOffset){b8+=parseFloat(bO.css(e,"marginTop"))||0;b7+=parseFloat(bO.css(e,"marginLeft"))||0}return{top:b8,left:b7}},setOffset:function(b9,ci,cc){var cd=bO.css(b9,"position");if(cd==="static"){b9.style.position="relative"}var cb=bO(b9),b7=cb.offset(),e=bO.css(b9,"top"),cg=bO.css(b9,"left"),ch=(cd==="absolute"||cd==="fixed")&&bO.inArray("auto",[e,cg])>-1,cf={},ce={},b8,ca;if(ch){ce=cb.position();b8=ce.top;ca=ce.left}else{b8=parseFloat(e)||0;ca=parseFloat(cg)||0}if(bO.isFunction(ci)){ci=ci.call(b9,cc,b7)}if(ci.top!=null){cf.top=(ci.top-b7.top)+b8}if(ci.left!=null){cf.left=(ci.left-b7.left)+ca}if("using" in ci){ci.using.call(b9,cf)}else{cb.css(cf)}}};bO.fn.extend({position:function(){if(!this[0]){return}var b8=this[0],b7=this.offsetParent(),b9=this.offset(),e=bu.test(b7[0].nodeName)?{top:0,left:0}:b7.offset();b9.top-=parseFloat(bO.css(b8,"marginTop"))||0;b9.left-=parseFloat(bO.css(b8,"marginLeft"))||0;e.top+=parseFloat(bO.css(b7[0],"borderTopWidth"))||0;e.left+=parseFloat(bO.css(b7[0],"borderLeftWidth"))||0;return{top:b9.top-e.top,left:b9.left-e.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||u.body;while(e&&(!bu.test(e.nodeName)&&bO.css(e,"position")==="static")){e=e.offsetParent}return e||u.body})}});bO.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b8,b7){var e=/Y/.test(b7);bO.fn[b8]=function(b9){return bO.access(this,function(ca,cd,cc){var cb=bv(ca);if(cc===aI){return cb?(b7 in cb)?cb[b7]:cb.document.documentElement[cd]:ca[cd]}if(cb){cb.scrollTo(!e?cc:bO(cb).scrollLeft(),e?cc:bO(cb).scrollTop())}else{ca[cd]=cc}},b8,b9,arguments.length,null)}});function bv(e){return bO.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:false}bO.each({Height:"height",Width:"width"},function(e,b7){bO.each({padding:"inner"+e,content:b7,"":"outer"+e},function(b8,b9){bO.fn[b9]=function(cd,cc){var cb=arguments.length&&(b8||typeof cd!=="boolean"),ca=b8||(cd===true||cc===true?"margin":"border");return bO.access(this,function(cf,ce,cg){var ch;if(bO.isWindow(cf)){return cf.document.documentElement["client"+e]}if(cf.nodeType===9){ch=cf.documentElement;return Math.max(cf.body["scroll"+e],ch["scroll"+e],cf.body["offset"+e],ch["offset"+e],ch["client"+e])}return cg===aI?bO.css(cf,ce,cg,ca):bO.style(cf,ce,cg,ca)},b7,cb?cd:aI,cb,null)}})});a9.jQuery=a9.$=bO;if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("jquery",[],function(){return bO})}})(window);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(g){g.ans=g.ans||{};function j(v,t,r){var q=v.getResponseHeader("content-type")||"",p=t==="xml"||!t&&q.indexOf("xml")>=0,u=p?v.responseXML:v.responseText;if(p&&u.documentElement.nodeName==="parsererror"){jQuery.error("parsererror")}if(r&&r.dataFilter){u=r.dataFilter(u,t)}if(typeof u==="string"){if(t==="json"||!t&&q.indexOf("json")>=0){u=jQuery.parseJSON(u)}else{if(t==="script"||!t&&q.indexOf("javascript")>=0){jQuery.globalEval(u)}}}return u}function e(p,r){if(typeof hex_sha1=="undefined"){alert("creating a user doc requires sha1.js to be loaded in the page");return}var q="org.notesdb.user:";p._id=p._id||q+p.name;if(r){p.salt=g.notes.newUUID();p.password_sha=hex_sha1(r+p.salt)}p.type="user";if(!p.roles){p.roles=[]}return p}function h(r){var q=[];if(typeof(r)==="object"&&r!==null){for(var p in r){var s=r[p];if(typeof(s==="object")){s=k(s)}q.push(encodeURIComponent(p)+"="+encodeURIComponent(s))}}return q.length?"?"+q.join("&"):""}function k(p){return p!==null?JSON.stringify(p):null}function i(q,r,p){g.ajax(g.extend(true,{type:"GET",url:q,cache:!(g.browser.msie),dataType:"json",complete:function(u){var v=j(u,"json"),t,s;if(u.status==200){s=v}else{t={status:u.status,error:v.error,reason:v.reason}}r(t,s)}},p))}function a(p,q,r){g.ajax({type:"POST",url:p,dataType:"json",contentType:"application/json",data:JSON.stringify(q),complete:function(u){var v=j(u,"json"),t=null,s=null;if(u.status==201||u.status==200){s=v}else{t={status:u.status,error:v.error,reason:v.reason}}r(t,s,v)}})}function b(p,q,r){g.ajax({type:"PUT",url:p,dataType:"json",contentType:"application/json",data:JSON.stringify(q),complete:function(u){var v=j(u,"json"),t,s;if(u.status==200){s=v}else{t={status:u.status,error:v.error,reason:v.reason}}r(t,s)}})}function f(p,q){g.ajax({type:"DELETE",url:p,dataType:"json",complete:function(t){var u=j(t,"json"),s,r;if(t.status==200){r=u}else{s={status:t.status,error:u.error,reason:u.reason}}q(s,r)}})}g.extend(g.ans,{login:function(p,q){a("/login",p,q)},logout:function(p){i("/logout",p)},dbAttachmentUri:function(p,q){return"/dbs/"+Model.ADMINDBID+"/"+p+"/attachments/"+q},getDB:function(p,q,r){q=q||{};g.extend(true,q,{selector:{type:Model.DATABASE}});i("/dbs/"+Model.ADMINDBID+"/"+(p||h(q)),r)},postDB:function(p,q){a("/dbs/"+Model.ADMINDBID,p,function(s,r){q(s,r);if(!s){g(document).trigger("databaseCreated",r)}})},putDB:function(p,r,q,s){q=q||{};g.extend(true,q,{selector:{type:Model.DATABASE}});b("/dbs/"+Model.ADMINDBID+"/"+(p||h(q)),r,function(u,t){s(u,t);if(!u){g(document).trigger("databaseChanged",r)}})},delDB:function(p,q,r){q=q||{};g.extend(true,q,{selector:{type:Model.DATABASE}});f("/dbs/"+Model.ADMINDBID+"/"+(p||h(q)),function(t,s){r(t,s);if(!t){g(document).trigger("databaseDeleted",{_id:p})}})},getDBAttachment:function(p,q){},postDBAttachment:function(q,p,r){var s=g('<form action="" method="POST"></form>').append(p.clone().attr("name","attachment"));var t={url:"/dbs/"+Model.ADMINDBID+"/"+q._id+"/attachments"};g.extend(t,r);s.ajaxSubmit(t)},delDBAttachment:function(p,q){},getDoc:function(q,t,s,u){var p={},r="/dbs/"+q;if(s&&s.headers){g.extend(p,{headers:s.headers});delete s.headers}if(t){r+="/"+t}if(s){r+=h(s)}i(r,u,p)},postDoc:function(p,r,q,s){if(q&&q.redirect){g.ajax({type:"POST",url:"/dbs/"+p,dataType:"json",contentType:"application/json",data:JSON.stringify(r),success:function(t){s(t)}})}else{a("/dbs/"+p+h(q),r,function(u,t){s(u,t);if(!u){g(document).trigger("documentCreated",r)}})}},putDoc:function(q,t,p,s,u){var r="/dbs/"+q+"/"+t;if(s){r+=h(s)}b(r,p,function(w,v){u(w,v);if(!w){g(document).trigger("documentChanged",p)}})},delDoc:function(p,s,r,t){var q="/dbs/"+p;if(s){q+="/"+s}if(r){q+=h(r)}f(q,function(v,u){t(v,u);if(!v){g(document).trigger("documentDeleted",{_id:s})}})},getAttachmentPath:function(p,q,r){return"/dbs/"+p+"/"+q+"/attachments/"+r},delAttachment:function(p,q,r){},getTempPath:function(p){return"/tmp/"+p},postTemp:function(p,q){var r=g('<form action="" method="POST"></form>').append(p.attr("name","file")),s={url:"/tmp"};g.extend(s,q);r.ajaxSubmit(s)},downPdf:function(p){window.location.href=p}})})(jQuery);(function($){$.extend({metadata:{defaults:{type:"elem",name:"script",single:"script"},setType:function(type,name){this.defaults.type=type;this.defaults.name=name},get:function(elem,opts){var settings=$.extend({},this.defaults,opts),elem=$(elem);settings.single=settings.single||"metadata";var data=$.data(elem,settings.single);if(!$.isEmptyObject(data)){return data}data="{}";if(settings.type=="elem"){data=$.trim(elem.children(settings.name+"[type='text/json']").html())||data}else{if(settings.type=="attr"){data=elem.attr(settings.name)||data}}if(data.indexOf("{")<0){data="{"+data+"}"}try{data=eval("("+data+")")}catch(e){}if(!$.isEmptyObject(data)){$.data(elem,settings.single,data)}return data},set:function(elem,metadata,opts){var settings=$.extend({},this.defaults,opts),elem=$(elem);settings.single=settings.single||"metadata";if(settings.type=="elem"){elem.children("script[type='text/json']").remove();if(!$.isEmptyObject(metadata)){$("<script type='text/json'>"+$.toJSON(metadata)+"<\/script>").prependTo(elem)}}else{if(settings.type=="attr"){elem.removeAttr(settings.name);if(!$.isEmptyObject(metadata)){elem.attr(settings.name,$.toJSON(metadata))}}}$.data(elem,settings.single,metadata)}}});$.fn.metadata=function(opts){return $.metadata.get(this,opts)};$.fn.getMetadata=function(opts){return $.metadata.get(this,opts)};$.fn.setMetadata=function(metadata,opts){$.metadata.set(this,metadata,opts)}})(jQuery);(function(a){a.extend(a.fn,{validate:function(b){if(!this.length){b&&b.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var e=a.data(this[0],"validator");if(e){return e}this.attr("novalidate","novalidate");e=new a.validator(b,this[0]);a.data(this[0],"validator",e);if(e.settings.onsubmit){var f=this.find("input, button");f.filter(".cancel").click(function(){e.cancelSubmit=true});if(e.settings.submitHandler){f.filter(":submit").click(function(){e.submitButton=this})}this.submit(function(g){if(e.settings.debug){g.preventDefault()}function h(){if(e.settings.submitHandler){if(e.submitButton){var i=a("<input type='hidden'/>").attr("name",e.submitButton.name).val(e.submitButton.value).appendTo(e.currentForm)}e.settings.submitHandler.call(e,e.currentForm);if(e.submitButton){i.remove()}return false}return true}if(e.cancelSubmit){e.cancelSubmit=false;return h()}if(e.form()){if(e.pendingRequest){e.formSubmitted=true;return false}return h()}else{e.focusInvalid();return false}})}return e},valid:function(){if(a(this[0]).is("form")){return this.validate().form()}else{var e=true;var b=a(this[0].form).validate();this.each(function(){e&=b.element(this)});return e}},removeAttrs:function(f){var b={},e=this;a.each(f.split(/\s/),function(g,h){b[h]=e.attr(h);e.removeAttr(h)});return b},rules:function(g,b){var i=this[0];if(g){var f=a.data(i.form,"validator").settings;var k=f.rules;var p=a.validator.staticRules(i);switch(g){case"add":a.extend(p,a.validator.normalizeRule(b));k[i.name]=p;if(b.messages){f.messages[i.name]=a.extend(f.messages[i.name],b.messages)}break;case"remove":if(!b){delete k[i.name];return p}var j={};a.each(b.split(/\s/),function(q,r){j[r]=p[r];delete p[r]});return j}}var h=a.validator.normalizeRules(a.extend({},a.validator.metadataRules(i),a.validator.classRules(i),a.validator.attributeRules(i),a.validator.staticRules(i)),i);if(h.required){var e=h.required;delete h.required;h=a.extend({required:e},h)}return h}});a.extend(a.expr[":"],{blank:function(b){return !a.trim(""+b.value)},filled:function(b){return !!a.trim(""+b.value)},unchecked:function(b){return !b.checked}});a.validator=function(b,e){this.settings=a.extend(true,{},a.validator.defaults,b);this.currentForm=e;this.init()};a.validator.format=function(b,e){if(arguments.length==1){return function(){var f=a.makeArray(arguments);f.unshift(b);return a.validator.format.apply(this,f)}}if(arguments.length>2&&e.constructor!=Array){e=a.makeArray(arguments).slice(1)}if(e.constructor!=Array){e=[e]}a.each(e,function(f,g){b=b.replace(new RegExp("\\{"+f+"\\}","g"),g)});return b};a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:true,ignore:":hidden",ignoreTitle:false,onfocusin:function(b,e){this.lastActive=b;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,b,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(b)).hide()}},onfocusout:function(b,e){if(!this.checkable(b)&&(b.name in this.submitted||!this.optional(b))){this.element(b)}},onkeyup:function(b,e){if(b.name in this.submitted||b==this.lastElement){this.element(b)}},onclick:function(b,e){if(b.name in this.submitted){this.element(b)}else{if(b.parentNode.name in this.submitted){this.element(b.parentNode)}}},highlight:function(f,b,e){if(f.type==="radio"){this.findByName(f.name).addClass(b).removeClass(e)}else{a(f).addClass(b).removeClass(e)}},unhighlight:function(f,b,e){if(f.type==="radio"){this.findByName(f.name).removeClass(b).addClass(e)}else{a(f).removeClass(b).addClass(e)}}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=a(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm);this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var b=(this.groups={});a.each(this.settings.groups,function(g,h){a.each(h.split(/\s/),function(j,i){b[i]=g})});var f=this.settings.rules;a.each(f,function(g,h){f[g]=a.validator.normalizeRule(h)});function e(i){var h=a.data(this[0].form,"validator"),g="on"+i.type.replace(/^validate/,"");h.settings[g]&&h.settings[g].call(h,this[0],i)}a(this.currentForm).validateDelegate("input[type='text'], input[type='password'], input[type='file'], select, textarea, input[type='number'], input[type='search'] ,input[type='tel'], input[type='url'], input[type='email'], input[type='datetime'], input[type='date'], input[type='month'], input[type='week'], input[type='time'], input[type='datetime-local'], input[type='range'], input[type='color'] ","focusin focusout keyup",e).validateDelegate("input[type='radio'], input[type='checkbox'], select, option","click",e);if(this.settings.invalidHandler){a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)}},form:function(){this.checkForm();a.extend(this.submitted,this.errorMap);this.invalid=a.extend({},this.errorMap);if(!this.valid()){a(this.currentForm).triggerHandler("invalid-form",[this])}this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var b=0,e=(this.currentElements=this.elements());e[b];b++){this.check(e[b])}return this.valid()},element:function(e){e=this.validationTargetFor(this.clean(e));this.lastElement=e;this.prepareElement(e);this.currentElements=a(e);var b=this.check(e);if(b){delete this.invalid[e.name]}else{this.invalid[e.name]=true}if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers)}this.showErrors();return b},showErrors:function(e){if(e){a.extend(this.errorMap,e);this.errorList=[];for(var b in e){this.errorList.push({message:e[b],element:this.findByName(b)[0]})}this.successList=a.grep(this.successList,function(f){return !(f.name in e)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){if(a.fn.resetForm){a(this.currentForm).resetForm()}this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(f){var e=0;for(var b in f){e++}return e},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid){try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}}},findLastActive:function(){var b=this.lastActive;return b&&a.grep(this.errorList,function(e){return e.element.name==b.name}).length==1&&b},elements:function(){var e=this,b={};return a(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&e.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in b||!e.objectLength(a(this).rules())){return false}b[this.name]=true;return true})},clean:function(b){return a(b)[0]},errors:function(){return a(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=a([]);this.toHide=a([]);this.currentElements=a([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(b){this.reset();this.toHide=this.errorsFor(b)},check:function(f){f=this.validationTargetFor(this.clean(f));var j=a(f).rules();var g=false;for(var k in j){var i={method:k,parameters:j[k]};try{var b=a.validator.methods[k].call(this,f.value.replace(/\r/g,""),f,i.parameters);if(b=="dependency-mismatch"){g=true;continue}g=false;if(b=="pending"){this.toHide=this.toHide.not(this.errorsFor(f));return}if(!b){this.formatAndAdd(f,i);return false}}catch(h){this.settings.debug&&window.console&&console.log("exception occured when checking element "+f.id+", check the '"+i.method+"' method",h);throw h}}if(g){return}if(this.objectLength(j)){this.successList.push(f)}return true},customMetaMessage:function(b,f){if(!a.metadata){return}var e=this.settings.meta?a(b).metadata()[this.settings.meta]:a(b).metadata();return e&&e.messages&&e.messages[f]},customMessage:function(e,f){var b=this.settings.messages[e];return b&&(b.constructor==String?b:b[f])},findDefined:function(){for(var b=0;b<arguments.length;b++){if(arguments[b]!==undefined){return arguments[b]}}return undefined},defaultMessage:function(b,e){return this.findDefined(this.customMessage(b.name,e),this.customMetaMessage(b,e),!this.settings.ignoreTitle&&b.title||undefined,a.validator.messages[e],"<strong>Warning: No message defined for "+b.name+"</strong>")},formatAndAdd:function(e,g){var f=this.defaultMessage(e,g.method),b=/\$?\{(\d+)\}/g;if(typeof f=="function"){f=f.call(this,g.parameters,e)}else{if(b.test(f)){f=jQuery.format(f.replace(b,"{$1}"),g.parameters)}}this.errorList.push({message:f,element:e});this.errorMap[e.name]=f;this.submitted[e.name]=f},addWrapper:function(b){if(this.settings.wrapper){b=b.add(b.parent(this.settings.wrapper))}return b},defaultShowErrors:function(){for(var e=0;this.errorList[e];e++){var b=this.errorList[e];this.settings.highlight&&this.settings.highlight.call(this,b.element,this.settings.errorClass,this.settings.validClass);this.showLabel(b.element,b.message)}if(this.errorList.length){this.toShow=this.toShow.add(this.containers)}if(this.settings.success){for(var e=0;this.successList[e];e++){this.showLabel(this.successList[e])}}if(this.settings.unhighlight){for(var e=0,f=this.validElements();f[e];e++){this.settings.unhighlight.call(this,f[e],this.settings.errorClass,this.settings.validClass)}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(e,f){var b=this.errorsFor(e);if(b.length){b.removeClass(this.settings.validClass).addClass(this.settings.errorClass);b.attr("generated")&&b.html(f)}else{b=a("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(e),generated:true}).addClass(this.settings.errorClass).html(f||"");if(this.settings.wrapper){b=b.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()}if(!this.labelContainer.append(b).length){this.settings.errorPlacement?this.settings.errorPlacement(b,a(e)):b.insertAfter(e)}}if(!f&&this.settings.success){b.text("");typeof this.settings.success=="string"?b.addClass(this.settings.success):this.settings.success(b)}this.toShow=this.toShow.add(b)},errorsFor:function(e){var b=this.idOrName(e);return this.errors().filter(function(){return a(this).attr("for")==b})},idOrName:function(b){return this.groups[b.name]||(this.checkable(b)?b.name:b.id||b.name)},validationTargetFor:function(b){if(this.checkable(b)){b=this.findByName(b.name).not(this.settings.ignore)[0]}return b},checkable:function(b){return/radio|checkbox/i.test(b.type)},findByName:function(b){var e=this.currentForm;return a(document.getElementsByName(b)).map(function(f,g){return g.form==e&&g.name==b&&g||null})},getLength:function(e,b){switch(b.nodeName.toLowerCase()){case"select":return a("option:selected",b).length;case"input":if(this.checkable(b)){return this.findByName(b.name).filter(":checked").length}}return e.length},depend:function(e,b){return this.dependTypes[typeof e]?this.dependTypes[typeof e](e,b):true},dependTypes:{"boolean":function(e,b){return e},string:function(e,b){return !!a(e,b.form).length},"function":function(e,b){return e(b)}},optional:function(b){return !a.validator.methods.required.call(this,a.trim(b.value),b)&&"dependency-mismatch"},startRequest:function(b){if(!this.pending[b.name]){this.pendingRequest++;this.pending[b.name]=true}},stopRequest:function(b,e){this.pendingRequest--;if(this.pendingRequest<0){this.pendingRequest=0}delete this.pending[b.name];if(e&&this.pendingRequest==0&&this.formSubmitted&&this.form()){a(this.currentForm).submit();this.formSubmitted=false}else{if(!e&&this.pendingRequest==0&&this.formSubmitted){a(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}}},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:true,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(b,e){b.constructor==String?this.classRuleSettings[b]=e:a.extend(this.classRuleSettings,b)},classRules:function(e){var f={};var b=a(e).attr("class");b&&a.each(b.split(" "),function(){if(this in a.validator.classRuleSettings){a.extend(f,a.validator.classRuleSettings[this])}});return f},attributeRules:function(e){var g={};var b=a(e);for(var h in a.validator.methods){var f;if(h==="required"&&typeof a.fn.prop==="function"){f=b.prop(h)}else{f=b.attr(h)}if(f){g[h]=f}else{if(b[0].getAttribute("type")===h){g[h]=true}}}if(g.maxlength&&/-1|2147483647|524288/.test(g.maxlength)){delete g.maxlength}return g},metadataRules:function(b){if(!a.metadata){return{}}var e=a.data(b.form,"validator").settings.meta;return e?a(b).metadata()[e]:a(b).metadata()},staticRules:function(e){var f={};var b=a.data(e.form,"validator");if(b.settings.rules){f=a.validator.normalizeRule(b.settings.rules[e.name])||{}}return f},normalizeRules:function(e,b){a.each(e,function(h,g){if(g===false){delete e[h];return}if(g.param||g.depends){var f=true;switch(typeof g.depends){case"string":f=!!a(g.depends,b.form).length;break;case"function":f=g.depends.call(b,b);break}if(f){e[h]=g.param!==undefined?g.param:true}else{delete e[h]}}});a.each(e,function(f,g){e[f]=a.isFunction(g)?g(b):g});a.each(["minlength","maxlength","min","max"],function(){if(e[this]){e[this]=Number(e[this])}});a.each(["rangelength","range"],function(){if(e[this]){e[this]=[Number(e[this][0]),Number(e[this][1])]}});if(a.validator.autoCreateRanges){if(e.min&&e.max){e.range=[e.min,e.max];delete e.min;delete e.max}if(e.minlength&&e.maxlength){e.rangelength=[e.minlength,e.maxlength];delete e.minlength;delete e.maxlength}}if(e.messages){delete e.messages}return e},normalizeRule:function(e){if(typeof e=="string"){var b={};a.each(e.split(/\s/),function(){b[this]=true});e=b}return e},addMethod:function(b,f,e){a.validator.methods[b]=f;a.validator.messages[b]=e!=undefined?e:a.validator.messages[b];if(f.length<3){a.validator.addClassRules(b,a.validator.normalizeRule(b))}},methods:{required:function(e,b,g){if(!this.depend(g,b)){return"dependency-mismatch"}switch(b.nodeName.toLowerCase()){case"select":var f=a(b).val();return f&&f.length>0;case"input":if(this.checkable(b)){return this.getLength(e,b)>0}default:return a.trim(e).length>0}},remote:function(h,e,i){if(this.optional(e)){return"dependency-mismatch"}var f=this.previousValue(e);if(!this.settings.messages[e.name]){this.settings.messages[e.name]={}}f.originalMessage=this.settings.messages[e.name].remote;this.settings.messages[e.name].remote=f.message;i=typeof i=="string"&&{url:i}||i;if(this.pending[e.name]){return"pending"}if(f.old===h){return f.valid}f.old=h;var b=this;this.startRequest(e);var g={};g[e.name]=h;a.ajax(a.extend(true,{url:i,mode:"abort",port:"validate"+e.name,dataType:"json",data:g,success:function(k){b.settings.messages[e.name].remote=f.originalMessage;var q=k===true;if(q){var j=b.formSubmitted;b.prepareElement(e);b.formSubmitted=j;b.successList.push(e);b.showErrors()}else{var r={};var p=k||b.defaultMessage(e,"remote");r[e.name]=f.message=a.isFunction(p)?p(h):p;b.showErrors(r)}f.valid=q;b.stopRequest(e,q)}},i));return"pending"},minlength:function(e,b,f){return this.optional(b)||this.getLength(a.trim(e),b)>=f},maxlength:function(e,b,f){return this.optional(b)||this.getLength(a.trim(e),b)<=f},rangelength:function(f,b,g){var e=this.getLength(a.trim(f),b);return this.optional(b)||(e>=g[0]&&e<=g[1])},min:function(e,b,f){return this.optional(b)||e>=f},max:function(e,b,f){return this.optional(b)||e<=f},range:function(e,b,f){return this.optional(b)||(e>=f[0]&&e<=f[1])},email:function(e,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},url:function(e,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},date:function(e,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(e))},dateISO:function(e,b){return this.optional(b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e)},number:function(e,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e)},digits:function(e,b){return this.optional(b)||/^\d+$/.test(e)},creditcard:function(h,e){if(this.optional(e)){return"dependency-mismatch"}if(/[^0-9 -]+/.test(h)){return false}var i=0,g=0,b=false;h=h.replace(/\D/g,"");for(var j=h.length-1;j>=0;j--){var f=h.charAt(j);var g=parseInt(f,10);if(b){if((g*=2)>9){g-=9}}i+=g;b=!b}return(i%10)==0},accept:function(e,b,f){f=typeof f=="string"?f.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(b)||e.match(new RegExp(".("+f+")$","i"))},equalTo:function(e,b,g){var f=a(g).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(b).valid()});return e==f.val()}}});a.format=a.validator.format})(jQuery);(function(e){var a={};if(e.ajaxPrefilter){e.ajaxPrefilter(function(h,g,i){var f=h.port;if(h.mode=="abort"){if(a[f]){a[f].abort()}a[f]=i}})}else{var b=e.ajax;e.ajax=function(g){var h=("mode" in g?g:e.ajaxSettings).mode,f=("port" in g?g:e.ajaxSettings).port;if(h=="abort"){if(a[f]){a[f].abort()}return(a[f]=b.apply(this,arguments))}return b.apply(this,arguments)}}})(jQuery);(function(a){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener){a.each({focus:"focusin",blur:"focusout"},function(e,b){a.event.special[b]={setup:function(){this.addEventListener(e,f,true)},teardown:function(){this.removeEventListener(e,f,true)},handler:function(g){arguments[0]=a.event.fix(g);arguments[0].type=b;return a.event.handle.apply(this,arguments)}};function f(g){g=a.event.fix(g);g.type=b;return a.event.handle.call(this,g)}})}a.extend(a.fn,{validateDelegate:function(f,e,b){return this.bind(e,function(g){var h=a(g.target);if(h.is(f)){return b.apply(h,arguments)}})}})})(jQuery);(function($){$.toJSON=function(o){if(typeof(JSON)=="object"&&JSON.stringify){return JSON.stringify(o)}var type=typeof(o);if(o===null){return"null"}if(type=="undefined"){return undefined}if(type=="number"||type=="boolean"){return o+""}if(type=="string"){return $.quoteString(o)}if(type=="object"){if(typeof o.toJSON=="function"){return $.toJSON(o.toJSON())}if(o.constructor===Date){var month=o.getUTCMonth()+1;if(month<10){month="0"+month}var day=o.getUTCDate();if(day<10){day="0"+day}var year=o.getUTCFullYear();var hours=o.getUTCHours();if(hours<10){hours="0"+hours}var minutes=o.getUTCMinutes();if(minutes<10){minutes="0"+minutes}var seconds=o.getUTCSeconds();if(seconds<10){seconds="0"+seconds}var milli=o.getUTCMilliseconds();if(milli<100){milli="0"+milli}if(milli<10){milli="0"+milli}return'"'+year+"-"+month+"-"+day+"T"+hours+":"+minutes+":"+seconds+"."+milli+'Z"'}if(o.constructor===Array){var ret=[];for(var i=0;i<o.length;i++){ret.push($.toJSON(o[i])||"null")}return"["+ret.join(",")+"]"}var pairs=[];for(var k in o){var name;var type=typeof k;if(type=="number"){name='"'+k+'"'}else{if(type=="string"){name=$.quoteString(k)}else{continue}}if(typeof o[k]=="function"){continue}var val=$.toJSON(o[k]);pairs.push(name+":"+val)}return"{"+pairs.join(", ")+"}"}};$.evalJSON=function(src){if(typeof(JSON)=="object"&&JSON.parse){return JSON.parse(src)}return eval("("+src+")")};$.secureEvalJSON=function(src){if(typeof(JSON)=="object"&&JSON.parse){return JSON.parse(src)}var filtered=src;filtered=filtered.replace(/\\["\\\/bfnrtu]/g,"@");filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered)){return eval("("+src+")")}else{throw new SyntaxError("Error parsing JSON, source is not valid.")}};$.quoteString=function(string){if(string.match(_escapeable)){return'"'+string.replace(_escapeable,function(a){var c=_meta[a];if(typeof c==="string"){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+string+'"'};var _escapeable=/["\\\x00-\x1f\x7f-\x9f]/g;var _meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}})(jQuery);
/* Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(f){var b=["DOMMouseScroll","mousewheel"];if(f.event.fixHooks){for(var a=b.length;a;){f.event.fixHooks[b[--a]]=f.event.mouseHooks}}f.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var g=b.length;g;){this.addEventListener(b[--g],e,false)}}else{this.onmousewheel=e}},teardown:function(){if(this.removeEventListener){for(var g=b.length;g;){this.removeEventListener(b[--g],e,false)}}else{this.onmousewheel=null}}};f.fn.extend({mousewheel:function(g){return g?this.bind("mousewheel",g):this.trigger("mousewheel")},unmousewheel:function(g){return this.unbind("mousewheel",g)}});function e(p){var j=p||window.event,i=[].slice.call(arguments,1),q=0,k=true,h=0,g=0;p=f.event.fix(j);p.type="mousewheel";if(j.wheelDelta){q=j.wheelDelta/120}if(j.detail){q=-j.detail/3}g=q;if(j.axis!==undefined&&j.axis===j.HORIZONTAL_AXIS){g=0;h=-1*q}if(j.wheelDeltaY!==undefined){g=j.wheelDeltaY/120}if(j.wheelDeltaX!==undefined){h=-1*j.wheelDeltaX/120}i.unshift(p,q,h,g);return(f.event.dispatch||f.event.handle).apply(this,i)}})(jQuery);(function(b,g){var f,e,a;f=e=b.jQuery;a=e.ScrollTo=e.ScrollTo||{config:{duration:400,easing:"swing",callback:g,durationMode:"each",offsetTop:0,offsetLeft:0},configure:function(h){e.extend(a.config,h||{});return this},scroll:function(u,C){var t,w,r,h,p,E,A,s,B,x,z,i,q,v,F,D,k,j;t=u.pop();w=t.$container;r=w.get(0);h=t.$target;p=e("<span/>").css({position:"absolute",top:"0px",left:"0px"});E=w.css("position");w.css("position","relative");p.appendTo(w);z=p.offset().top;i=h.offset().top;q=i-z-parseInt(C.offsetTop,10);v=p.offset().left;F=h.offset().left;D=F-v-parseInt(C.offsetLeft,10);A=r.scrollTop;s=r.scrollLeft;p.remove();w.css("position",E);k={};j=function(G){if(u.length===0){if(typeof C.callback==="function"){C.callback.apply(this,[G])}}else{a.scroll(u,C)}return true};if(C.onlyIfOutside){B=A+w.height();x=s+w.width();if(A<q&&q<B){q=A}if(s<D&&D<x){D=s}}if(q!==A){k.scrollTop=q}if(D!==s){k.scrollLeft=D}if(e.browser.safari&&r===document.body){b.scrollTo(k.scrollLeft,k.scrollTop);j()}else{if(k.scrollTop||k.scrollLeft){w.animate(k,C.duration,C.easing,j)}else{j()}}return true},fn:function(k){var p,j,s,i;p=[];var h=e(this);if(h.length===0){return this}j=e.extend({},a.config,k);s=h.parent();i=s.get(0);while((s.length===1)&&(i!==document.body)&&(i!==document)){var q,r;q=s.css("overflow-y")!=="visible"&&i.scrollHeight!==i.clientHeight;r=s.css("overflow-x")!=="visible"&&i.scrollWidth!==i.clientWidth;if(q||r){p.push({"$container":s,"$target":h});h=s}s=s.parent();i=s.get(0)}p.push({"$container":e((e.browser.msie||e.browser.mozilla)?"html,body":"body"),"$target":h});if(j.durationMode==="all"){j.duration/=p.length}a.scroll(p,j);return this}};e.fn.ScrollTo=e.ScrollTo.fn})(window);
/*
 * jQuery UI 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(a,f){a.ui=a.ui||{};if(a.ui.version){return}a.extend(a.ui,{version:"1.8.24",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(g,h){return typeof g==="number"?this.each(function(){var i=this;setTimeout(function(){a(i).focus();if(h){h.call(i)}},g)}):this._focus.apply(this,arguments)},scrollParent:function(){var g;if((a.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){g=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(a.curCSS(this,"position",1))&&(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}else{g=this.parents().filter(function(){return(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!g.length?a(document):g},zIndex:function(j){if(j!==f){return this.css("zIndex",j)}if(this.length){var h=a(this[0]),g,i;while(h.length&&h[0]!==document){g=h.css("position");if(g==="absolute"||g==="relative"||g==="fixed"){i=parseInt(h.css("zIndex"),10);if(!isNaN(i)&&i!==0){return i}}h=h.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(g){g.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});if(!a("<a>").outerWidth(1).jquery){a.each(["Width","Height"],function(j,g){var h=g==="Width"?["Left","Right"]:["Top","Bottom"],k=g.toLowerCase(),q={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};function p(s,r,i,t){a.each(h,function(){r-=parseFloat(a.curCSS(s,"padding"+this,true))||0;if(i){r-=parseFloat(a.curCSS(s,"border"+this+"Width",true))||0}if(t){r-=parseFloat(a.curCSS(s,"margin"+this,true))||0}});return r}a.fn["inner"+g]=function(i){if(i===f){return q["inner"+g].call(this)}return this.each(function(){a(this).css(k,p(this,i)+"px")})};a.fn["outer"+g]=function(i,r){if(typeof i!=="number"){return q["outer"+g].call(this,i)}return this.each(function(){a(this).css(k,p(this,i,true,r)+"px")})}})}function e(i,g){var p=i.nodeName.toLowerCase();if("area"===p){var k=i.parentNode,j=k.name,h;if(!i.href||!j||k.nodeName.toLowerCase()!=="map"){return false}h=a("img[usemap=#"+j+"]")[0];return !!h&&b(h)}return(/input|select|textarea|button|object/.test(p)?!i.disabled:"a"==p?i.href||g:g)&&b(i)}function b(g){return !a(g).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(g){return function(h){return !!a.data(h,g)}}):function(j,h,g){return !!a.data(j,g[3])},focusable:function(g){return e(g,!isNaN(a.attr(g,"tabindex")))},tabbable:function(i){var g=a.attr(i,"tabindex"),h=isNaN(g);return(h||g>=0)&&e(i,!h)}});a(function(){var g=document.body,h=g.appendChild(h=document.createElement("div"));h.offsetHeight;a.extend(h.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=h.offsetHeight===100;a.support.selectstart="onselectstart" in h;g.removeChild(h).style.display="none"});if(!a.curCSS){a.curCSS=a.css}a.extend(a.ui,{plugin:{add:function(h,j,p){var k=a.ui[h].prototype;for(var g in p){k.plugins[g]=k.plugins[g]||[];k.plugins[g].push([j,p[g]])}},call:function(g,j,h){var p=g.plugins[j];if(!p||!g.element[0].parentNode){return}for(var k=0;k<p.length;k++){if(g.options[p[k][0]]){p[k][1].apply(g.element,h)}}}},contains:function(h,g){return document.compareDocumentPosition?h.compareDocumentPosition(g)&16:h!==g&&h.contains(g)},hasScroll:function(j,h){if(a(j).css("overflow")==="hidden"){return false}var g=(h&&h==="left")?"scrollLeft":"scrollTop",i=false;if(j[g]>0){return true}j[g]=1;i=(j[g]>0);j[g]=0;return i},isOverAxis:function(h,g,i){return(h>g)&&(h<(g+i))},isOver:function(p,h,k,j,g,i){return a.ui.isOverAxis(p,k,g)&&a.ui.isOverAxis(h,j,i)}})})(jQuery);
/*
 * jQuery UI Widget 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(b,f){if(b.cleanData){var e=b.cleanData;b.cleanData=function(g){for(var h=0,j;(j=g[h])!=null;h++){try{b(j).triggerHandler("remove")}catch(k){}}e(g)}}else{var a=b.fn.remove;b.fn.remove=function(g,h){return this.each(function(){if(!h){if(!g||b.filter(g,[this]).length){b("*",this).add([this]).each(function(){try{b(this).triggerHandler("remove")}catch(i){}})}}return a.call(b(this),g,h)})}}b.widget=function(h,j,g){var i=h.split(".")[0],p;h=h.split(".")[1];p=i+"-"+h;if(!g){g=j;j=b.Widget}b.expr[":"][p]=function(q){return !!b.data(q,h)};b[i]=b[i]||{};b[i][h]=function(q,r){if(arguments.length){this._createWidget(q,r)}};var k=new j();k.options=b.extend(true,{},k.options);b[i][h].prototype=b.extend(true,k,{namespace:i,widgetName:h,widgetEventPrefix:b[i][h].prototype.widgetEventPrefix||h,widgetBaseClass:p},g);b.widget.bridge(h,b[i][h])};b.widget.bridge=function(h,g){b.fn[h]=function(k){var i=typeof k==="string",j=Array.prototype.slice.call(arguments,1),p=this;k=!i&&j.length?b.extend.apply(null,[true,k].concat(j)):k;if(i&&k.charAt(0)==="_"){return p}if(i){this.each(function(){var q=b.data(this,h),r=q&&b.isFunction(q[k])?q[k].apply(q,j):q;if(r!==q&&r!==f){p=r;return false}})}else{this.each(function(){var q=b.data(this,h);if(q){q.option(k||{})._init()}else{b.data(this,h,new g(k,this))}})}return p}};b.Widget=function(g,h){if(arguments.length){this._createWidget(g,h)}};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(h,i){b.data(i,this.widgetName,this);this.element=b(i);this.options=b.extend(true,{},this.options,this._getCreateOptions(),h);var g=this;this.element.bind("remove."+this.widgetName,function(){g.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(h,i){var g=h;if(arguments.length===0){return b.extend({},this.options)}if(typeof h==="string"){if(i===f){return this.options[h]}g={};g[h]=i}this._setOptions(g);return this},_setOptions:function(h){var g=this;b.each(h,function(i,j){g._setOption(i,j)});return this},_setOption:function(g,h){this.options[g]=h;if(g==="disabled"){this.widget()[h?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",h)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(g,h,i){var p,k,j=this.options[g];i=i||{};h=b.Event(h);h.type=(g===this.widgetEventPrefix?g:this.widgetEventPrefix+g).toLowerCase();h.target=this.element[0];k=h.originalEvent;if(k){for(p in k){if(!(p in h)){h[p]=k[p]}}}this.element.trigger(h,i);return !(b.isFunction(j)&&j.call(this.element[0],h,i)===false||h.isDefaultPrevented())}}})(jQuery);
/*
 * jQuery UI Mouse 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(b,e){var a=false;b(document).mouseup(function(f){a=false});b.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var f=this;this.element.bind("mousedown."+this.widgetName,function(g){return f._mouseDown(g)}).bind("click."+this.widgetName,function(g){if(true===b.data(g.target,f.widgetName+".preventClickEvent")){b.removeData(g.target,f.widgetName+".preventClickEvent");g.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(h){if(a){return}(this._mouseStarted&&this._mouseUp(h));this._mouseDownEvent=h;var g=this,i=(h.which==1),f=(typeof this.options.cancel=="string"&&h.target.nodeName?b(h.target).closest(this.options.cancel).length:false);if(!i||f||!this._mouseCapture(h)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){g.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(h)&&this._mouseDelayMet(h)){this._mouseStarted=(this._mouseStart(h)!==false);if(!this._mouseStarted){h.preventDefault();return true}}if(true===b.data(h.target,this.widgetName+".preventClickEvent")){b.removeData(h.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(j){return g._mouseMove(j)};this._mouseUpDelegate=function(j){return g._mouseUp(j)};b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);h.preventDefault();a=true;return true},_mouseMove:function(f){if(b.browser.msie&&!(document.documentMode>=9)&&!f.button){return this._mouseUp(f)}if(this._mouseStarted){this._mouseDrag(f);return f.preventDefault()}if(this._mouseDistanceMet(f)&&this._mouseDelayMet(f)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,f)!==false);(this._mouseStarted?this._mouseDrag(f):this._mouseUp(f))}return !this._mouseStarted},_mouseUp:function(f){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(f.target==this._mouseDownEvent.target){b.data(f.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(f)}return false},_mouseDistanceMet:function(f){return(Math.max(Math.abs(this._mouseDownEvent.pageX-f.pageX),Math.abs(this._mouseDownEvent.pageY-f.pageY))>=this.options.distance)},_mouseDelayMet:function(f){return this.mouseDelayMet},_mouseStart:function(f){},_mouseDrag:function(f){},_mouseStop:function(f){},_mouseCapture:function(f){return true}})})(jQuery);
/*
 * jQuery UI Position 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 */
(function(i,j){i.ui=i.ui||{};var f=/left|center|right/,g=/top|center|bottom/,a="center",h={},b=i.fn.position,e=i.fn.offset;i.fn.position=function(p){if(!p||!p.of){return b.apply(this,arguments)}p=i.extend({},p);var t=i(p.of),s=t[0],v=(p.collision||"flip").split(" "),u=p.offset?p.offset.split(" "):[0,0],r,k,q;if(s.nodeType===9){r=t.width();k=t.height();q={top:0,left:0}}else{if(s.setTimeout){r=t.width();k=t.height();q={top:t.scrollTop(),left:t.scrollLeft()}}else{if(s.preventDefault){p.at="left top";r=k=0;q={top:p.of.pageY,left:p.of.pageX}}else{r=t.outerWidth();k=t.outerHeight();q=t.offset()}}}i.each(["my","at"],function(){var w=(p[this]||"").split(" ");if(w.length===1){w=f.test(w[0])?w.concat([a]):g.test(w[0])?[a].concat(w):[a,a]}w[0]=f.test(w[0])?w[0]:a;w[1]=g.test(w[1])?w[1]:a;p[this]=w});if(v.length===1){v[1]=v[0]}u[0]=parseInt(u[0],10)||0;if(u.length===1){u[1]=u[0]}u[1]=parseInt(u[1],10)||0;if(p.at[0]==="right"){q.left+=r}else{if(p.at[0]===a){q.left+=r/2}}if(p.at[1]==="bottom"){q.top+=k}else{if(p.at[1]===a){q.top+=k/2}}q.left+=u[0];q.top+=u[1];return this.each(function(){var A=i(this),C=A.outerWidth(),z=A.outerHeight(),B=parseInt(i.curCSS(this,"marginLeft",true))||0,x=parseInt(i.curCSS(this,"marginTop",true))||0,E=C+B+(parseInt(i.curCSS(this,"marginRight",true))||0),F=z+x+(parseInt(i.curCSS(this,"marginBottom",true))||0),D=i.extend({},q),w;if(p.my[0]==="right"){D.left-=C}else{if(p.my[0]===a){D.left-=C/2}}if(p.my[1]==="bottom"){D.top-=z}else{if(p.my[1]===a){D.top-=z/2}}if(!h.fractions){D.left=Math.round(D.left);D.top=Math.round(D.top)}w={left:D.left-B,top:D.top-x};i.each(["left","top"],function(H,G){if(i.ui.position[v[H]]){i.ui.position[v[H]][G](D,{targetWidth:r,targetHeight:k,elemWidth:C,elemHeight:z,collisionPosition:w,collisionWidth:E,collisionHeight:F,offset:u,my:p.my,at:p.at})}});if(i.fn.bgiframe){A.bgiframe()}A.offset(i.extend(D,{using:p.using}))})};i.ui.position={fit:{left:function(k,p){var r=i(window),q=p.collisionPosition.left+p.collisionWidth-r.width()-r.scrollLeft();k.left=q>0?k.left-q:Math.max(k.left-p.collisionPosition.left,k.left)},top:function(k,p){var r=i(window),q=p.collisionPosition.top+p.collisionHeight-r.height()-r.scrollTop();k.top=q>0?k.top-q:Math.max(k.top-p.collisionPosition.top,k.top)}},flip:{left:function(p,r){if(r.at[0]===a){return}var t=i(window),s=r.collisionPosition.left+r.collisionWidth-t.width()-t.scrollLeft(),k=r.my[0]==="left"?-r.elemWidth:r.my[0]==="right"?r.elemWidth:0,q=r.at[0]==="left"?r.targetWidth:-r.targetWidth,u=-2*r.offset[0];p.left+=r.collisionPosition.left<0?k+q+u:s>0?k+q+u:0},top:function(p,r){if(r.at[1]===a){return}var t=i(window),s=r.collisionPosition.top+r.collisionHeight-t.height()-t.scrollTop(),k=r.my[1]==="top"?-r.elemHeight:r.my[1]==="bottom"?r.elemHeight:0,q=r.at[1]==="top"?r.targetHeight:-r.targetHeight,u=-2*r.offset[1];p.top+=r.collisionPosition.top<0?k+q+u:s>0?k+q+u:0}}};if(!i.offset.setOffset){i.offset.setOffset=function(s,p){if(/static/.test(i.curCSS(s,"position"))){s.style.position="relative"}var r=i(s),u=r.offset(),k=parseInt(i.curCSS(s,"top",true),10)||0,t=parseInt(i.curCSS(s,"left",true),10)||0,q={top:(p.top-u.top)+k,left:(p.left-u.left)+t};if("using" in p){p.using.call(s,q)}else{r.css(q)}};i.fn.offset=function(k){var p=this[0];if(!p||!p.ownerDocument){return null}if(k){if(i.isFunction(k)){return this.each(function(q){i(this).offset(k.call(this,q,i(this).offset()))})}return this.each(function(){i.offset.setOffset(this,k)})}return e.call(this)}}if(!i.curCSS){i.curCSS=i.css}(function(){var k=document.getElementsByTagName("body")[0],v=document.createElement("div"),s,u,p,t,r;s=document.createElement(k?"div":"body");p={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(k){i.extend(p,{position:"absolute",left:"-1000px",top:"-1000px"})}for(var q in p){s.style[q]=p[q]}s.appendChild(v);u=k||document.documentElement;u.insertBefore(s,u.firstChild);v.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;";t=i(v).offset(function(w,x){return x}).offset();s.innerHTML="";u.removeChild(s);r=t.top+t.left+(k?2000:0);h.fractions=r>21&&r<22})()}(jQuery));
/*
 * jQuery UI Draggable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Draggables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}(this.options.addClasses&&this.element.addClass("ui-draggable"));(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));this._mouseInit()},destroy:function(){if(!this.element.data("draggable")){return}this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this},_mouseCapture:function(e){var f=this.options;if(this.helper||f.disabled||a(e.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(e);if(!this.handle){return false}if(f.iframeFix){a(f.iframeFix===true?"iframe":f.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(a(this).offset()).appendTo("body")})}return true},_mouseStart:function(e){var f=this.options;this.helper=this._createHelper(e);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if(a.ui.ddmanager){a.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(e);this.originalPageX=e.pageX;this.originalPageY=e.pageY;(f.cursorAt&&this._adjustOffsetFromHelper(f.cursorAt));if(f.containment){this._setContainment()}if(this._trigger("start",e)===false){this._clear();return false}this._cacheHelperProportions();if(a.ui.ddmanager&&!f.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,e)}this._mouseDrag(e,true);if(a.ui.ddmanager){a.ui.ddmanager.dragStart(this,e)}return true},_mouseDrag:function(e,g){this.position=this._generatePosition(e);this.positionAbs=this._convertPositionTo("absolute");if(!g){var f=this._uiHash();if(this._trigger("drag",e,f)===false){this._mouseUp({});return false}this.position=f.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if(a.ui.ddmanager){a.ui.ddmanager.drag(this,e)}return false},_mouseStop:function(g){var i=false;if(a.ui.ddmanager&&!this.options.dropBehaviour){i=a.ui.ddmanager.drop(this,g)}if(this.dropped){i=this.dropped;this.dropped=false}var f=this.element[0],h=false;while(f&&(f=f.parentNode)){if(f==document){h=true}}if(!h&&this.options.helper==="original"){return false}if((this.options.revert=="invalid"&&!i)||(this.options.revert=="valid"&&i)||this.options.revert===true||(a.isFunction(this.options.revert)&&this.options.revert.call(this.element,i))){var e=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(e._trigger("stop",g)!==false){e._clear()}})}else{if(this._trigger("stop",g)!==false){this._clear()}}return false},_mouseUp:function(e){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});if(a.ui.ddmanager){a.ui.ddmanager.dragStop(this,e)}return a.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(e){var f=!this.options.handle||!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==e.target){f=true}});return f},_createHelper:function(f){var g=this.options;var e=a.isFunction(g.helper)?a(g.helper.apply(this.element[0],[f])):(g.helper=="clone"?this.element.clone().removeAttr("id"):this.element);if(!e.parents("body").length){e.appendTo((g.appendTo=="parent"?this.element[0].parentNode:g.appendTo))}if(e[0]!=this.element[0]&&!(/(fixed|absolute)/).test(e.css("position"))){e.css("position","absolute")}return e},_adjustOffsetFromHelper:function(e){if(typeof e=="string"){e=e.split(" ")}if(a.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left" in e){this.offset.click.left=e.left+this.margins.left}if("right" in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top" in e){this.offset.click.top=e.top+this.margins.top}if("bottom" in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var h=this.options;if(h.containment=="parent"){h.containment=this.helper[0].parentNode}if(h.containment=="document"||h.containment=="window"){this.containment=[h.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,h.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(h.containment=="document"?0:a(window).scrollLeft())+a(h.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(h.containment=="document"?0:a(window).scrollTop())+(a(h.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(h.containment)&&h.containment.constructor!=Array){var i=a(h.containment);var f=i[0];if(!f){return}var g=i.offset();var e=(a(f).css("overflow")!="hidden");this.containment=[(parseInt(a(f).css("borderLeftWidth"),10)||0)+(parseInt(a(f).css("paddingLeft"),10)||0),(parseInt(a(f).css("borderTopWidth"),10)||0)+(parseInt(a(f).css("paddingTop"),10)||0),(e?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(a(f).css("borderLeftWidth"),10)||0)-(parseInt(a(f).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(a(f).css("borderTopWidth"),10)||0)-(parseInt(a(f).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=i}else{if(h.containment.constructor==Array){this.containment=h.containment}}},_convertPositionTo:function(h,j){if(!j){j=this.position}var f=h=="absolute"?1:-1;var g=this.options,e=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,i=(/(html|body)/i).test(e[0].tagName);return{top:(j.top+this.offset.relative.top*f+this.offset.parent.top*f-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(i?0:e.scrollTop()))*f)),left:(j.left+this.offset.relative.left*f+this.offset.parent.left*f-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:e.scrollLeft())*f))}},_generatePosition:function(f){var g=this.options,r=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,k=(/(html|body)/i).test(r[0].tagName);var j=f.pageX;var i=f.pageY;if(this.originalPosition){var e;if(this.containment){if(this.relative_container){var q=this.relative_container.offset();e=[this.containment[0]+q.left,this.containment[1]+q.top,this.containment[2]+q.left,this.containment[3]+q.top]}else{e=this.containment}if(f.pageX-this.offset.click.left<e[0]){j=e[0]+this.offset.click.left}if(f.pageY-this.offset.click.top<e[1]){i=e[1]+this.offset.click.top}if(f.pageX-this.offset.click.left>e[2]){j=e[2]+this.offset.click.left}if(f.pageY-this.offset.click.top>e[3]){i=e[3]+this.offset.click.top}}if(g.grid){var p=g.grid[1]?this.originalPageY+Math.round((i-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY;i=e?(!(p-this.offset.click.top<e[1]||p-this.offset.click.top>e[3])?p:(!(p-this.offset.click.top<e[1])?p-g.grid[1]:p+g.grid[1])):p;var h=g.grid[0]?this.originalPageX+Math.round((j-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX;j=e?(!(h-this.offset.click.left<e[0]||h-this.offset.click.left>e[2])?h:(!(h-this.offset.click.left<e[0])?h-g.grid[0]:h+g.grid[0])):h}}return{top:(i-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(k?0:r.scrollTop())))),left:(j-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():k?0:r.scrollLeft())))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(e,f,g){g=g||this._uiHash();a.ui.plugin.call(this,e,[f,g]);if(e=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return a.Widget.prototype._trigger.call(this,e,f,g)},plugins:{},_uiHash:function(e){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.24"});a.ui.plugin.add("draggable","connectToSortable",{start:function(f,h){var g=a(this).data("draggable"),i=g.options,e=a.extend({},h,{item:g.element});g.sortables=[];a(i.connectToSortable).each(function(){var j=a.data(this,"sortable");if(j&&!j.options.disabled){g.sortables.push({instance:j,shouldRevert:j.options.revert});j.refreshPositions();j._trigger("activate",f,e)}})},stop:function(f,h){var g=a(this).data("draggable"),e=a.extend({},h,{item:g.element});a.each(g.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;g.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(f);this.instance.options.helper=this.instance.options._helper;if(g.options.helper=="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",f,e)}})},drag:function(f,i){var h=a(this).data("draggable"),e=this;var g=function(p){var u=this.offset.click.top,t=this.offset.click.left;var j=this.positionAbs.top,r=this.positionAbs.left;var q=p.height,s=p.width;var v=p.top,k=p.left;return a.ui.isOver(j+u,r+t,v,k,q,s)};a.each(h.sortables,function(j){this.instance.positionAbs=h.positionAbs;this.instance.helperProportions=h.helperProportions;this.instance.offset.click=h.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return i.helper[0]};f.target=this.instance.currentItem[0];this.instance._mouseCapture(f,true);this.instance._mouseStart(f,true,true);this.instance.offset.click.top=h.offset.click.top;this.instance.offset.click.left=h.offset.click.left;this.instance.offset.parent.left-=h.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=h.offset.parent.top-this.instance.offset.parent.top;h._trigger("toSortable",f);h.dropped=this.instance.element;h.currentItem=h.element;this.instance.fromOutside=h}if(this.instance.currentItem){this.instance._mouseDrag(f)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",f,this.instance._uiHash(this.instance));this.instance._mouseStop(f,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}h._trigger("fromSortable",f);h.dropped=false}}})}});a.ui.plugin.add("draggable","cursor",{start:function(f,g){var e=a("body"),h=a(this).data("draggable").options;if(e.css("cursor")){h._cursor=e.css("cursor")}e.css("cursor",h.cursor)},stop:function(e,f){var g=a(this).data("draggable").options;if(g._cursor){a("body").css("cursor",g._cursor)}}});a.ui.plugin.add("draggable","opacity",{start:function(f,g){var e=a(g.helper),h=a(this).data("draggable").options;if(e.css("opacity")){h._opacity=e.css("opacity")}e.css("opacity",h.opacity)},stop:function(e,f){var g=a(this).data("draggable").options;if(g._opacity){a(f.helper).css("opacity",g._opacity)}}});a.ui.plugin.add("draggable","scroll",{start:function(f,g){var e=a(this).data("draggable");if(e.scrollParent[0]!=document&&e.scrollParent[0].tagName!="HTML"){e.overflowOffset=e.scrollParent.offset()}},drag:function(g,h){var f=a(this).data("draggable"),j=f.options,e=false;if(f.scrollParent[0]!=document&&f.scrollParent[0].tagName!="HTML"){if(!j.axis||j.axis!="x"){if((f.overflowOffset.top+f.scrollParent[0].offsetHeight)-g.pageY<j.scrollSensitivity){f.scrollParent[0].scrollTop=e=f.scrollParent[0].scrollTop+j.scrollSpeed}else{if(g.pageY-f.overflowOffset.top<j.scrollSensitivity){f.scrollParent[0].scrollTop=e=f.scrollParent[0].scrollTop-j.scrollSpeed}}}if(!j.axis||j.axis!="y"){if((f.overflowOffset.left+f.scrollParent[0].offsetWidth)-g.pageX<j.scrollSensitivity){f.scrollParent[0].scrollLeft=e=f.scrollParent[0].scrollLeft+j.scrollSpeed}else{if(g.pageX-f.overflowOffset.left<j.scrollSensitivity){f.scrollParent[0].scrollLeft=e=f.scrollParent[0].scrollLeft-j.scrollSpeed}}}}else{if(!j.axis||j.axis!="x"){if(g.pageY-a(document).scrollTop()<j.scrollSensitivity){e=a(document).scrollTop(a(document).scrollTop()-j.scrollSpeed)}else{if(a(window).height()-(g.pageY-a(document).scrollTop())<j.scrollSensitivity){e=a(document).scrollTop(a(document).scrollTop()+j.scrollSpeed)}}}if(!j.axis||j.axis!="y"){if(g.pageX-a(document).scrollLeft()<j.scrollSensitivity){e=a(document).scrollLeft(a(document).scrollLeft()-j.scrollSpeed)}else{if(a(window).width()-(g.pageX-a(document).scrollLeft())<j.scrollSensitivity){e=a(document).scrollLeft(a(document).scrollLeft()+j.scrollSpeed)}}}}if(e!==false&&a.ui.ddmanager&&!j.dropBehaviour){a.ui.ddmanager.prepareOffsets(f,g)}}});a.ui.plugin.add("draggable","snap",{start:function(f,g){var e=a(this).data("draggable"),h=e.options;e.snapElements=[];a(h.snap.constructor!=String?(h.snap.items||":data(draggable)"):h.snap).each(function(){var j=a(this);var i=j.offset();if(this!=e.element[0]){e.snapElements.push({item:this,width:j.outerWidth(),height:j.outerHeight(),top:i.top,left:i.left})}})},drag:function(x,u){var h=a(this).data("draggable"),v=h.options;var C=v.snapTolerance;var B=u.offset.left,A=B+h.helperProportions.width,g=u.offset.top,f=g+h.helperProportions.height;for(var z=h.snapElements.length-1;z>=0;z--){var w=h.snapElements[z].left,s=w+h.snapElements[z].width,q=h.snapElements[z].top,E=q+h.snapElements[z].height;if(!((w-C<B&&B<s+C&&q-C<g&&g<E+C)||(w-C<B&&B<s+C&&q-C<f&&f<E+C)||(w-C<A&&A<s+C&&q-C<g&&g<E+C)||(w-C<A&&A<s+C&&q-C<f&&f<E+C))){if(h.snapElements[z].snapping){(h.options.snap.release&&h.options.snap.release.call(h.element,x,a.extend(h._uiHash(),{snapItem:h.snapElements[z].item})))}h.snapElements[z].snapping=false;continue}if(v.snapMode!="inner"){var e=Math.abs(q-f)<=C;var D=Math.abs(E-g)<=C;var k=Math.abs(w-A)<=C;var p=Math.abs(s-B)<=C;if(e){u.position.top=h._convertPositionTo("relative",{top:q-h.helperProportions.height,left:0}).top-h.margins.top}if(D){u.position.top=h._convertPositionTo("relative",{top:E,left:0}).top-h.margins.top}if(k){u.position.left=h._convertPositionTo("relative",{top:0,left:w-h.helperProportions.width}).left-h.margins.left}if(p){u.position.left=h._convertPositionTo("relative",{top:0,left:s}).left-h.margins.left}}var j=(e||D||k||p);if(v.snapMode!="outer"){var e=Math.abs(q-g)<=C;var D=Math.abs(E-f)<=C;var k=Math.abs(w-B)<=C;var p=Math.abs(s-A)<=C;if(e){u.position.top=h._convertPositionTo("relative",{top:q,left:0}).top-h.margins.top}if(D){u.position.top=h._convertPositionTo("relative",{top:E-h.helperProportions.height,left:0}).top-h.margins.top}if(k){u.position.left=h._convertPositionTo("relative",{top:0,left:w}).left-h.margins.left}if(p){u.position.left=h._convertPositionTo("relative",{top:0,left:s-h.helperProportions.width}).left-h.margins.left}}if(!h.snapElements[z].snapping&&(e||D||k||p||j)){(h.options.snap.snap&&h.options.snap.snap.call(h.element,x,a.extend(h._uiHash(),{snapItem:h.snapElements[z].item})))}h.snapElements[z].snapping=(e||D||k||p||j)}}});a.ui.plugin.add("draggable","stack",{start:function(f,g){var i=a(this).data("draggable").options;var h=a.makeArray(a(i.stack)).sort(function(k,j){return(parseInt(a(k).css("zIndex"),10)||0)-(parseInt(a(j).css("zIndex"),10)||0)});if(!h.length){return}var e=parseInt(h[0].style.zIndex)||0;a(h).each(function(j){this.style.zIndex=e+j});this[0].style.zIndex=e+h.length}});a.ui.plugin.add("draggable","zIndex",{start:function(f,g){var e=a(g.helper),h=a(this).data("draggable").options;if(e.css("zIndex")){h._zIndex=e.css("zIndex")}e.css("zIndex",h.zIndex)},stop:function(e,f){var g=a(this).data("draggable").options;if(g._zIndex){a(f.helper).css("zIndex",g._zIndex)}}})})(jQuery);
/*
 * jQuery UI Droppable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Droppables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */
(function(a,b){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var f=this.options,e=f.accept;this.isover=0;this.isout=1;this.accept=a.isFunction(e)?e:function(g){return g.is(e)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[f.scope]=a.ui.ddmanager.droppables[f.scope]||[];a.ui.ddmanager.droppables[f.scope].push(this);(f.addClasses&&this.element.addClass("ui-droppable"))},destroy:function(){var e=a.ui.ddmanager.droppables[this.options.scope];for(var f=0;f<e.length;f++){if(e[f]==this){e.splice(f,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(e,f){if(e=="accept"){this.accept=a.isFunction(f)?f:function(g){return g.is(f)}}a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(f){var e=a.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}(e&&this._trigger("activate",f,this.ui(e)))},_deactivate:function(f){var e=a.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}(e&&this._trigger("deactivate",f,this.ui(e)))},_over:function(f){var e=a.ui.ddmanager.current;if(!e||(e.currentItem||e.element)[0]==this.element[0]){return}if(this.accept.call(this.element[0],(e.currentItem||e.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",f,this.ui(e))}},_out:function(f){var e=a.ui.ddmanager.current;if(!e||(e.currentItem||e.element)[0]==this.element[0]){return}if(this.accept.call(this.element[0],(e.currentItem||e.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",f,this.ui(e))}},_drop:function(f,g){var e=g||a.ui.ddmanager.current;if(!e||(e.currentItem||e.element)[0]==this.element[0]){return false}var h=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var i=a.data(this,"droppable");if(i.options.greedy&&!i.options.disabled&&i.options.scope==e.options.scope&&i.accept.call(i.element[0],(e.currentItem||e.element))&&a.ui.intersect(e,a.extend(i,{offset:i.element.offset()}),i.options.tolerance)){h=true;return false}});if(h){return false}if(this.accept.call(this.element[0],(e.currentItem||e.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",f,this.ui(e));return this.element}return false},ui:function(e){return{draggable:(e.currentItem||e.element),helper:e.helper,position:e.position,offset:e.positionAbs}}});a.extend(a.ui.droppable,{version:"1.8.24"});a.ui.intersect=function(x,p,v){if(!p.offset){return false}var g=(x.positionAbs||x.position.absolute).left,f=g+x.helperProportions.width,u=(x.positionAbs||x.position.absolute).top,s=u+x.helperProportions.height;var i=p.offset.left,e=i+p.proportions.width,w=p.offset.top,q=w+p.proportions.height;switch(v){case"fit":return(i<=g&&f<=e&&w<=u&&s<=q);break;case"intersect":return(i<g+(x.helperProportions.width/2)&&f-(x.helperProportions.width/2)<e&&w<u+(x.helperProportions.height/2)&&s-(x.helperProportions.height/2)<q);break;case"pointer":var j=((x.positionAbs||x.position.absolute).left+(x.clickOffset||x.offset.click).left),k=((x.positionAbs||x.position.absolute).top+(x.clickOffset||x.offset.click).top),h=a.ui.isOver(k,j,w,i,p.proportions.height,p.proportions.width);return h;break;case"touch":return((u>=w&&u<=q)||(s>=w&&s<=q)||(u<w&&s>q))&&((g>=i&&g<=e)||(f>=i&&f<=e)||(g<i&&f>e));break;default:return false;break}};a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(h,p){var e=a.ui.ddmanager.droppables[h.options.scope]||[];var k=p?p.type:null;var q=(h.currentItem||h.element).find(":data(droppable)").andSelf();droppablesLoop:for(var g=0;g<e.length;g++){if(e[g].options.disabled||(h&&!e[g].accept.call(e[g].element[0],(h.currentItem||h.element)))){continue}for(var f=0;f<q.length;f++){if(q[f]==e[g].element[0]){e[g].proportions.height=0;continue droppablesLoop}}e[g].visible=e[g].element.css("display")!="none";if(!e[g].visible){continue}if(k=="mousedown"){e[g]._activate.call(e[g],p)}e[g].offset=e[g].element.offset();e[g].proportions={width:e[g].element[0].offsetWidth,height:e[g].element[0].offsetHeight}}},drop:function(e,f){var g=false;a.each(a.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&a.ui.intersect(e,this,this.options.tolerance)){g=this._drop.call(this,f)||g}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(e.currentItem||e.element))){this.isout=1;this.isover=0;this._deactivate.call(this,f)}});return g},dragStart:function(e,f){e.element.parents(":not(body,html)").bind("scroll.droppable",function(){if(!e.options.refreshPositions){a.ui.ddmanager.prepareOffsets(e,f)}})},drag:function(e,f){if(e.options.refreshPositions){a.ui.ddmanager.prepareOffsets(e,f)}a.each(a.ui.ddmanager.droppables[e.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var i=a.ui.intersect(e,this,this.options.tolerance);var k=!i&&this.isover==1?"isout":(i&&this.isover==0?"isover":null);if(!k){return}var j;if(this.options.greedy){var h=this.options.scope;var g=this.element.parents(":data(droppable)").filter(function(){return a.data(this,"droppable").options.scope===h});if(g.length){j=a.data(g[0],"droppable");j.greedyChild=(k=="isover"?1:0)}}if(j&&k=="isover"){j.isover=0;j.isout=1;j._out.call(j,f)}this[k]=1;this[k=="isout"?"isover":"isout"]=0;this[k=="isover"?"_over":"_out"].call(this,f);if(j&&k=="isout"){j.isout=0;j.isover=1;j._over.call(j,f)}})},dragStop:function(e,f){e.element.parents(":not(body,html)").unbind("scroll.droppable");if(!e.options.refreshPositions){a.ui.ddmanager.prepareOffsets(e,f)}}}})(jQuery);
/*
 * jQuery UI Resizable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Resizables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(e,f){e.widget("ui.resizable",e.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var h=this,q=this.options;this.element.addClass("ui-resizable");e.extend(this,{_aspectRatio:!!(q.aspectRatio),aspectRatio:q.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:q.helper||q.ghost||q.animate?q.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=q.handles||(!e(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var r=this.handles.split(",");this.handles={};for(var j=0;j<r.length;j++){var p=e.trim(r[j]),g="ui-resizable-"+p;var k=e('<div class="ui-resizable-handle '+g+'"></div>');k.css({zIndex:q.zIndex});if("se"==p){k.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[p]=".ui-resizable-"+p;this.element.append(k)}}this._renderAxis=function(w){w=w||this.element;for(var t in this.handles){if(this.handles[t].constructor==String){this.handles[t]=e(this.handles[t],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var u=e(this.handles[t],this.element),v=0;v=/sw|ne|nw|se|n|s/.test(t)?u.outerHeight():u.outerWidth();var s=["padding",/ne|nw|n/.test(t)?"Top":/se|sw|s/.test(t)?"Bottom":/^e$/.test(t)?"Right":"Left"].join("");w.css(s,v);this._proportionallyResize()}if(!e(this.handles[t]).length){continue}}};this._renderAxis(this.element);this._handles=e(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!h.resizing){if(this.className){var i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}h.axis=i&&i[1]?i[1]:"se"}});if(q.autoHide){this._handles.hide();e(this.element).addClass("ui-resizable-autohide").hover(function(){if(q.disabled){return}e(this).removeClass("ui-resizable-autohide");h._handles.show()},function(){if(q.disabled){return}if(!h.resizing){e(this).addClass("ui-resizable-autohide");h._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var g=function(i){e(i).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){g(this.element);var h=this.element;h.after(this.originalElement.css({position:h.css("position"),width:h.outerWidth(),height:h.outerHeight(),top:h.css("top"),left:h.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);g(this.originalElement);return this},_mouseCapture:function(h){var j=false;for(var g in this.handles){if(e(this.handles[g])[0]==h.target){j=true}}return !this.options.disabled&&j},_mouseStart:function(i){var p=this.options,h=this.element.position(),g=this.element;this.resizing=true;this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()};if(g.is(".ui-draggable")||(/absolute/).test(g.css("position"))){g.css({position:"absolute",top:h.top,left:h.left})}this._renderProxy();var q=b(this.helper.css("left")),j=b(this.helper.css("top"));if(p.containment){q+=e(p.containment).scrollLeft()||0;j+=e(p.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:q,top:j};this.size=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()};this.originalSize=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()};this.originalPosition={left:q,top:j};this.sizeDiff={width:g.outerWidth()-g.width(),height:g.outerHeight()-g.height()};this.originalMousePosition={left:i.pageX,top:i.pageY};this.aspectRatio=(typeof p.aspectRatio=="number")?p.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var k=e(".ui-resizable-"+this.axis).css("cursor");e("body").css("cursor",k=="auto"?this.axis+"-resize":k);g.addClass("ui-resizable-resizing");this._propagate("start",i);return true},_mouseDrag:function(g){var j=this.helper,i=this.options,s={},v=this,p=this.originalMousePosition,t=this.axis;var w=(g.pageX-p.left)||0,u=(g.pageY-p.top)||0;var k=this._change[t];if(!k){return false}var r=k.apply(this,[g,w,u]),q=e.browser.msie&&e.browser.version<7,h=this.sizeDiff;this._updateVirtualBoundaries(g.shiftKey);if(this._aspectRatio||g.shiftKey){r=this._updateRatio(r,g)}r=this._respectSize(r,g);this._propagate("resize",g);j.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(r);this._trigger("resize",g,this.ui());return false},_mouseStop:function(j){this.resizing=false;var k=this.options,t=this;if(this._helper){var i=this._proportionallyResizeElements,g=i.length&&(/textarea/i).test(i[0].nodeName),h=g&&e.ui.hasScroll(i[0],"left")?0:t.sizeDiff.height,q=g?0:t.sizeDiff.width;var u={width:(t.helper.width()-q),height:(t.helper.height()-h)},p=(parseInt(t.element.css("left"),10)+(t.position.left-t.originalPosition.left))||null,r=(parseInt(t.element.css("top"),10)+(t.position.top-t.originalPosition.top))||null;if(!k.animate){this.element.css(e.extend(u,{top:r,left:p}))}t.helper.height(t.size.height);t.helper.width(t.size.width);if(this._helper&&!k.animate){this._proportionallyResize()}}e("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",j);if(this._helper){this.helper.remove()}return false},_updateVirtualBoundaries:function(i){var p=this.options,k,j,h,q,g;g={minWidth:a(p.minWidth)?p.minWidth:0,maxWidth:a(p.maxWidth)?p.maxWidth:Infinity,minHeight:a(p.minHeight)?p.minHeight:0,maxHeight:a(p.maxHeight)?p.maxHeight:Infinity};if(this._aspectRatio||i){k=g.minHeight*this.aspectRatio;h=g.minWidth/this.aspectRatio;j=g.maxHeight*this.aspectRatio;q=g.maxWidth/this.aspectRatio;if(k>g.minWidth){g.minWidth=k}if(h>g.minHeight){g.minHeight=h}if(j<g.maxWidth){g.maxWidth=j}if(q<g.maxHeight){g.maxHeight=q}}this._vBoundaries=g},_updateCache:function(g){var h=this.options;this.offset=this.helper.offset();if(a(g.left)){this.position.left=g.left}if(a(g.top)){this.position.top=g.top}if(a(g.height)){this.size.height=g.height}if(a(g.width)){this.size.width=g.width}},_updateRatio:function(j,i){var k=this.options,p=this.position,h=this.size,g=this.axis;if(a(j.height)){j.width=(j.height*this.aspectRatio)}else{if(a(j.width)){j.height=(j.width/this.aspectRatio)}}if(g=="sw"){j.left=p.left+(h.width-j.width);j.top=null}if(g=="nw"){j.top=p.top+(h.height-j.height);j.left=p.left+(h.width-j.width)}return j},_respectSize:function(r,i){var p=this.helper,k=this._vBoundaries,w=this._aspectRatio||i.shiftKey,v=this.axis,z=a(r.width)&&k.maxWidth&&(k.maxWidth<r.width),s=a(r.height)&&k.maxHeight&&(k.maxHeight<r.height),j=a(r.width)&&k.minWidth&&(k.minWidth>r.width),x=a(r.height)&&k.minHeight&&(k.minHeight>r.height);if(j){r.width=k.minWidth}if(x){r.height=k.minHeight}if(z){r.width=k.maxWidth}if(s){r.height=k.maxHeight}var h=this.originalPosition.left+this.originalSize.width,u=this.position.top+this.size.height;var q=/sw|nw|w/.test(v),g=/nw|ne|n/.test(v);if(j&&q){r.left=h-k.minWidth}if(z&&q){r.left=h-k.maxWidth}if(x&&g){r.top=u-k.minHeight}if(s&&g){r.top=u-k.maxHeight}var t=!r.width&&!r.height;if(t&&!r.left&&r.top){r.top=null}else{if(t&&!r.top&&r.left){r.left=null}}return r},_proportionallyResize:function(){var r=this.options;if(!this._proportionallyResizeElements.length){return}var j=this.helper||this.element;for(var h=0;h<this._proportionallyResizeElements.length;h++){var k=this._proportionallyResizeElements[h];if(!this.borderDif){var g=[k.css("borderTopWidth"),k.css("borderRightWidth"),k.css("borderBottomWidth"),k.css("borderLeftWidth")],q=[k.css("paddingTop"),k.css("paddingRight"),k.css("paddingBottom"),k.css("paddingLeft")];this.borderDif=e.map(g,function(p,t){var s=parseInt(p,10)||0,u=parseInt(q[t],10)||0;return s+u})}if(e.browser.msie&&!(!(e(j).is(":hidden")||e(j).parents(":hidden").length))){continue}k.css({height:(j.height()-this.borderDif[0]-this.borderDif[2])||0,width:(j.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var h=this.element,k=this.options;this.elementOffset=h.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var g=e.browser.msie&&e.browser.version<7,i=(g?1:0),j=(g?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+j,height:this.element.outerHeight()+j,position:"absolute",left:this.elementOffset.left-i+"px",top:this.elementOffset.top-i+"px",zIndex:++k.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(i,h,g){return{width:this.originalSize.width+h}},w:function(j,h,g){var p=this.options,i=this.originalSize,k=this.originalPosition;return{left:k.left+h,width:i.width-h}},n:function(j,h,g){var p=this.options,i=this.originalSize,k=this.originalPosition;return{top:k.top+g,height:i.height-g}},s:function(i,h,g){return{height:this.originalSize.height+g}},se:function(i,h,g){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[i,h,g]))},sw:function(i,h,g){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[i,h,g]))},ne:function(i,h,g){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[i,h,g]))},nw:function(i,h,g){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[i,h,g]))}},_propagate:function(h,g){e.ui.plugin.call(this,h,[g,this.ui()]);(h!="resize"&&this._trigger(h,g,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});e.extend(e.ui.resizable,{version:"1.8.24"});e.ui.plugin.add("resizable","alsoResize",{start:function(h,i){var g=e(this).data("resizable"),k=g.options;var j=function(p){e(p).each(function(){var q=e(this);q.data("resizable-alsoresize",{width:parseInt(q.width(),10),height:parseInt(q.height(),10),left:parseInt(q.css("left"),10),top:parseInt(q.css("top"),10)})})};if(typeof(k.alsoResize)=="object"&&!k.alsoResize.parentNode){if(k.alsoResize.length){k.alsoResize=k.alsoResize[0];j(k.alsoResize)}else{e.each(k.alsoResize,function(p){j(p)})}}else{j(k.alsoResize)}},resize:function(i,k){var h=e(this).data("resizable"),p=h.options,j=h.originalSize,r=h.originalPosition;var q={height:(h.size.height-j.height)||0,width:(h.size.width-j.width)||0,top:(h.position.top-r.top)||0,left:(h.position.left-r.left)||0},g=function(s,t){e(s).each(function(){var w=e(this),x=e(this).data("resizable-alsoresize"),v={},u=t&&t.length?t:w.parents(k.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(u,function(z,B){var A=(x[B]||0)+(q[B]||0);if(A&&A>=0){v[B]=A||null}});w.css(v)})};if(typeof(p.alsoResize)=="object"&&!p.alsoResize.nodeType){e.each(p.alsoResize,function(s,t){g(s,t)})}else{g(p.alsoResize)}},stop:function(g,h){e(this).removeData("resizable-alsoresize")}});e.ui.plugin.add("resizable","animate",{stop:function(k,t){var u=e(this).data("resizable"),p=u.options;var j=u._proportionallyResizeElements,g=j.length&&(/textarea/i).test(j[0].nodeName),h=g&&e.ui.hasScroll(j[0],"left")?0:u.sizeDiff.height,r=g?0:u.sizeDiff.width;var i={width:(u.size.width-r),height:(u.size.height-h)},q=(parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left))||null,s=(parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top))||null;u.element.animate(e.extend(i,s&&q?{top:s,left:q}:{}),{duration:p.animateDuration,easing:p.animateEasing,step:function(){var v={width:parseInt(u.element.css("width"),10),height:parseInt(u.element.css("height"),10),top:parseInt(u.element.css("top"),10),left:parseInt(u.element.css("left"),10)};if(j&&j.length){e(j[0]).css({width:v.width,height:v.height})}u._updateCache(v);u._propagate("resize",k)}})}});e.ui.plugin.add("resizable","containment",{start:function(h,w){var z=e(this).data("resizable"),q=z.options,s=z.element;var i=q.containment,r=(i instanceof e)?i.get(0):(/parent/.test(i))?s.parent().get(0):i;if(!r){return}z.containerElement=e(r);if(/document/.test(i)||i==document){z.containerOffset={left:0,top:0};z.containerPosition={left:0,top:0};z.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}}else{var u=e(r),k=[];e(["Top","Right","Left","Bottom"]).each(function(A,p){k[A]=b(u.css("padding"+p))});z.containerOffset=u.offset();z.containerPosition=u.position();z.containerSize={height:(u.innerHeight()-k[3]),width:(u.innerWidth()-k[1])};var v=z.containerOffset,g=z.containerSize.height,t=z.containerSize.width,j=(e.ui.hasScroll(r,"left")?r.scrollWidth:t),x=(e.ui.hasScroll(r)?r.scrollHeight:g);z.parentData={element:r,left:v.left,top:v.top,width:j,height:x}}},resize:function(i,v){var z=e(this).data("resizable"),k=z.options,h=z.containerSize,u=z.containerOffset,s=z.size,t=z.position,w=z._aspectRatio||i.shiftKey,g={top:0,left:0},j=z.containerElement;if(j[0]!=document&&(/static/).test(j.css("position"))){g=u}if(t.left<(z._helper?u.left:0)){z.size.width=z.size.width+(z._helper?(z.position.left-u.left):(z.position.left-g.left));if(w){z.size.height=z.size.width/z.aspectRatio}z.position.left=k.helper?u.left:0}if(t.top<(z._helper?u.top:0)){z.size.height=z.size.height+(z._helper?(z.position.top-u.top):z.position.top);if(w){z.size.width=z.size.height*z.aspectRatio}z.position.top=z._helper?u.top:0}z.offset.left=z.parentData.left+z.position.left;z.offset.top=z.parentData.top+z.position.top;var r=Math.abs((z._helper?z.offset.left-g.left:(z.offset.left-g.left))+z.sizeDiff.width),x=Math.abs((z._helper?z.offset.top-g.top:(z.offset.top-u.top))+z.sizeDiff.height);var q=z.containerElement.get(0)==z.element.parent().get(0),p=/relative|absolute/.test(z.containerElement.css("position"));if(q&&p){r-=z.parentData.left}if(r+z.size.width>=z.parentData.width){z.size.width=z.parentData.width-r;if(w){z.size.height=z.size.width/z.aspectRatio}}if(x+z.size.height>=z.parentData.height){z.size.height=z.parentData.height-x;if(w){z.size.width=z.size.height*z.aspectRatio}}},stop:function(i,t){var v=e(this).data("resizable"),j=v.options,r=v.position,s=v.containerOffset,g=v.containerPosition,k=v.containerElement;var p=e(v.helper),x=p.offset(),u=p.outerWidth()-v.sizeDiff.width,q=p.outerHeight()-v.sizeDiff.height;if(v._helper&&!j.animate&&(/relative/).test(k.css("position"))){e(this).css({left:x.left-g.left-s.left,width:u,height:q})}if(v._helper&&!j.animate&&(/static/).test(k.css("position"))){e(this).css({left:x.left-g.left-s.left,width:u,height:q})}}});e.ui.plugin.add("resizable","ghost",{start:function(i,j){var g=e(this).data("resizable"),k=g.options,h=g.size;g.ghost=g.originalElement.clone();g.ghost.css({opacity:0.25,display:"block",position:"relative",height:h.height,width:h.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof k.ghost=="string"?k.ghost:"");g.ghost.appendTo(g.helper)},resize:function(h,i){var g=e(this).data("resizable"),j=g.options;if(g.ghost){g.ghost.css({position:"relative",height:g.size.height,width:g.size.width})}},stop:function(h,i){var g=e(this).data("resizable"),j=g.options;if(g.ghost&&g.helper){g.helper.get(0).removeChild(g.ghost.get(0))}}});e.ui.plugin.add("resizable","grid",{resize:function(g,s){var u=e(this).data("resizable"),j=u.options,q=u.size,k=u.originalSize,p=u.originalPosition,t=u.axis,r=j._aspectRatio||g.shiftKey;j.grid=typeof j.grid=="number"?[j.grid,j.grid]:j.grid;var i=Math.round((q.width-k.width)/(j.grid[0]||1))*(j.grid[0]||1),h=Math.round((q.height-k.height)/(j.grid[1]||1))*(j.grid[1]||1);if(/^(se|s|e)$/.test(t)){u.size.width=k.width+i;u.size.height=k.height+h}else{if(/^(ne)$/.test(t)){u.size.width=k.width+i;u.size.height=k.height+h;u.position.top=p.top-h}else{if(/^(sw)$/.test(t)){u.size.width=k.width+i;u.size.height=k.height+h;u.position.left=p.left-i}else{u.size.width=k.width+i;u.size.height=k.height+h;u.position.top=p.top-h;u.position.left=p.left-i}}}}});var b=function(g){return parseInt(g,10)||0};var a=function(g){return !isNaN(parseInt(g,10))}})(jQuery);
/*
 * jQuery UI Selectable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Selectables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.selectable",a.ui.mouse,{options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var e=this;this.element.addClass("ui-selectable");this.dragged=false;var f;this.refresh=function(){f=a(e.options.filter,e.element[0]);f.addClass("ui-selectee");f.each(function(){var g=a(this);var h=g.offset();a.data(this,"selectable-item",{element:this,$element:g,left:h.left,top:h.top,right:h.left+g.outerWidth(),bottom:h.top+g.outerHeight(),startselected:false,selected:g.hasClass("ui-selected"),selecting:g.hasClass("ui-selecting"),unselecting:g.hasClass("ui-unselecting")})})};this.refresh();this.selectees=f.addClass("ui-selectee");this._mouseInit();this.helper=a("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(g){var e=this;this.opos=[g.pageX,g.pageY];if(this.options.disabled){return}var f=this.options;this.selectees=a(f.filter,this.element[0]);this._trigger("start",g);a(f.appendTo).append(this.helper);this.helper.css({left:g.clientX,top:g.clientY,width:0,height:0});if(f.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var h=a.data(this,"selectable-item");h.startselected=true;if(!g.metaKey&&!g.ctrlKey){h.$element.removeClass("ui-selected");h.selected=false;h.$element.addClass("ui-unselecting");h.unselecting=true;e._trigger("unselecting",g,{unselecting:h.element})}});a(g.target).parents().andSelf().each(function(){var i=a.data(this,"selectable-item");if(i){var h=(!g.metaKey&&!g.ctrlKey)||!i.$element.hasClass("ui-selected");i.$element.removeClass(h?"ui-unselecting":"ui-selected").addClass(h?"ui-selecting":"ui-unselecting");i.unselecting=!h;i.selecting=h;i.selected=h;if(h){e._trigger("selecting",g,{selecting:i.element})}else{e._trigger("unselecting",g,{unselecting:i.element})}return false}})},_mouseDrag:function(p){var f=this;this.dragged=true;if(this.options.disabled){return}var h=this.options;var g=this.opos[0],k=this.opos[1],e=p.pageX,j=p.pageY;if(g>e){var i=e;e=g;g=i}if(k>j){var i=j;j=k;k=i}this.helper.css({left:g,top:k,width:e-g,height:j-k});this.selectees.each(function(){var q=a.data(this,"selectable-item");if(!q||q.element==f.element[0]){return}var r=false;if(h.tolerance=="touch"){r=(!(q.left>e||q.right<g||q.top>j||q.bottom<k))}else{if(h.tolerance=="fit"){r=(q.left>g&&q.right<e&&q.top>k&&q.bottom<j)}}if(r){if(q.selected){q.$element.removeClass("ui-selected");q.selected=false}if(q.unselecting){q.$element.removeClass("ui-unselecting");q.unselecting=false}if(!q.selecting){q.$element.addClass("ui-selecting");q.selecting=true;f._trigger("selecting",p,{selecting:q.element})}}else{if(q.selecting){if((p.metaKey||p.ctrlKey)&&q.startselected){q.$element.removeClass("ui-selecting");q.selecting=false;q.$element.addClass("ui-selected");q.selected=true}else{q.$element.removeClass("ui-selecting");q.selecting=false;if(q.startselected){q.$element.addClass("ui-unselecting");q.unselecting=true}f._trigger("unselecting",p,{unselecting:q.element})}}if(q.selected){if(!p.metaKey&&!p.ctrlKey&&!q.startselected){q.$element.removeClass("ui-selected");q.selected=false;q.$element.addClass("ui-unselecting");q.unselecting=true;f._trigger("unselecting",p,{unselecting:q.element})}}}});return false},_mouseStop:function(g){var e=this;this.dragged=false;var f=this.options;a(".ui-unselecting",this.element[0]).each(function(){var h=a.data(this,"selectable-item");h.$element.removeClass("ui-unselecting");h.unselecting=false;h.startselected=false;e._trigger("unselected",g,{unselected:h.element})});a(".ui-selecting",this.element[0]).each(function(){var h=a.data(this,"selectable-item");h.$element.removeClass("ui-selecting").addClass("ui-selected");h.selecting=false;h.selected=true;h.startselected=true;e._trigger("selected",g,{selected:h.element})});this._trigger("stop",g);this.helper.remove();return false}});a.extend(a.ui.selectable,{version:"1.8.24"})})(jQuery);
/*
 * jQuery UI Sortable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Sortables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){var e=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?e.axis==="x"||(/left|right/).test(this.items[0].item.css("float"))||(/inline|table-cell/).test(this.items[0].item.css("display")):false;this.offset=this.element.offset();this._mouseInit();this.ready=true},destroy:function(){a.Widget.prototype.destroy.call(this);this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--){this.items[e].item.removeData(this.widgetName+"-item")}return this},_setOption:function(e,f){if(e==="disabled"){this.options[e]=f;this.widget()[f?"addClass":"removeClass"]("ui-sortable-disabled")}else{a.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(i,j){var h=this;if(this.reverting){return false}if(this.options.disabled||this.options.type=="static"){return false}this._refreshItems(i);var g=null,f=this,e=a(i.target).parents().each(function(){if(a.data(this,h.widgetName+"-item")==f){g=a(this);return false}});if(a.data(i.target,h.widgetName+"-item")==f){g=a(i.target)}if(!g){return false}if(this.options.handle&&!j){var k=false;a(this.options.handle,g).find("*").andSelf().each(function(){if(this==i.target){k=true}});if(!k){return false}}this.currentItem=g;this._removeCurrentsFromItems();return true},_mouseStart:function(h,j,e){var k=this.options,f=this;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(h);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:h.pageX-this.offset.left,top:h.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(h);this.originalPageX=h.pageX;this.originalPageY=h.pageY;(k.cursorAt&&this._adjustOffsetFromHelper(k.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!=this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(k.containment){this._setContainment()}if(k.cursor){if(a("body").css("cursor")){this._storedCursor=a("body").css("cursor")}a("body").css("cursor",k.cursor)}if(k.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",k.opacity)}if(k.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",k.zIndex)}if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",h,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!e){for(var g=this.containers.length-1;g>=0;g--){this.containers[g]._trigger("activate",h,f._uiHash(this))}}if(a.ui.ddmanager){a.ui.ddmanager.current=this}if(a.ui.ddmanager&&!k.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,h)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(h);return true},_mouseDrag:function(j){this.position=this._generatePosition(j);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){var k=this.options,e=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-j.pageY<k.scrollSensitivity){this.scrollParent[0].scrollTop=e=this.scrollParent[0].scrollTop+k.scrollSpeed}else{if(j.pageY-this.overflowOffset.top<k.scrollSensitivity){this.scrollParent[0].scrollTop=e=this.scrollParent[0].scrollTop-k.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-j.pageX<k.scrollSensitivity){this.scrollParent[0].scrollLeft=e=this.scrollParent[0].scrollLeft+k.scrollSpeed}else{if(j.pageX-this.overflowOffset.left<k.scrollSensitivity){this.scrollParent[0].scrollLeft=e=this.scrollParent[0].scrollLeft-k.scrollSpeed}}}else{if(j.pageY-a(document).scrollTop()<k.scrollSensitivity){e=a(document).scrollTop(a(document).scrollTop()-k.scrollSpeed)}else{if(a(window).height()-(j.pageY-a(document).scrollTop())<k.scrollSensitivity){e=a(document).scrollTop(a(document).scrollTop()+k.scrollSpeed)}}if(j.pageX-a(document).scrollLeft()<k.scrollSensitivity){e=a(document).scrollLeft(a(document).scrollLeft()-k.scrollSpeed)}else{if(a(window).width()-(j.pageX-a(document).scrollLeft())<k.scrollSensitivity){e=a(document).scrollLeft(a(document).scrollLeft()+k.scrollSpeed)}}}if(e!==false&&a.ui.ddmanager&&!k.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,j)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}for(var g=this.items.length-1;g>=0;g--){var h=this.items[g],f=h.item[0],p=this._intersectsWithPointer(h);if(!p){continue}if(h.instance!==this.currentContainer){continue}if(f!=this.currentItem[0]&&this.placeholder[p==1?"next":"prev"]()[0]!=f&&!a.ui.contains(this.placeholder[0],f)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],f):true)){this.direction=p==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(h)){this._rearrange(j,h)}else{break}this._trigger("change",j,this._uiHash());break}}this._contactContainers(j);if(a.ui.ddmanager){a.ui.ddmanager.drag(this,j)}this._trigger("sort",j,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(f,g){if(!f){return}if(a.ui.ddmanager&&!this.options.dropBehaviour){a.ui.ddmanager.drop(this,f)}if(this.options.revert){var e=this;var h=e.placeholder.offset();e.reverting=true;a(this.helper).animate({left:h.left-this.offset.parent.left-e.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:h.top-this.offset.parent.top-e.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){e._clear(f)})}else{this._clear(f,g)}return false},cancel:function(){var e=this;if(this.dragging){this._mouseUp({target:null});if(this.options.helper=="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var f=this.containers.length-1;f>=0;f--){this.containers[f]._trigger("deactivate",null,e._uiHash(this));if(this.containers[f].containerCache.over){this.containers[f]._trigger("out",null,e._uiHash(this));this.containers[f].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}a.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){a(this.domPosition.prev).after(this.currentItem)}else{a(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(g){var e=this._getItemsAsjQuery(g&&g.connected);var f=[];g=g||{};a(e).each(function(){var h=(a(g.item||this).attr(g.attribute||"id")||"").match(g.expression||(/(.+)[-=_](.+)/));if(h){f.push((g.key||h[1]+"[]")+"="+(g.key&&g.expression?h[1]:h[2]))}});if(!f.length&&g.key){f.push(g.key+"=")}return f.join("&")},toArray:function(g){var e=this._getItemsAsjQuery(g&&g.connected);var f=[];g=g||{};e.each(function(){f.push(a(g.item||this).attr(g.attribute||"id")||"")});return f},_intersectsWith:function(s){var g=this.positionAbs.left,f=g+this.helperProportions.width,q=this.positionAbs.top,p=q+this.helperProportions.height;var h=s.left,e=h+s.width,u=s.top,k=u+s.height;var v=this.offset.click.top,j=this.offset.click.left;var i=(q+v)>u&&(q+v)<k&&(g+j)>h&&(g+j)<e;if(this.options.tolerance=="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>s[this.floating?"width":"height"])){return i}else{return(h<g+(this.helperProportions.width/2)&&f-(this.helperProportions.width/2)<e&&u<q+(this.helperProportions.height/2)&&p-(this.helperProportions.height/2)<k)}},_intersectsWithPointer:function(g){var h=(this.options.axis==="x")||a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,g.top,g.height),f=(this.options.axis==="y")||a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,g.left,g.width),j=h&&f,e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();if(!j){return false}return this.floating?(((i&&i=="right")||e=="down")?2:1):(e&&(e=="down"?2:1))},_intersectsWithSides:function(h){var f=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,h.top+(h.height/2),h.height),g=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,h.left+(h.width/2),h.width),e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();if(this.floating&&i){return((i=="right"&&g)||(i=="left"&&!g))}else{return e&&((e=="down"&&f)||(e=="up"&&!f))}},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!=0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!=0&&(e>0?"right":"left")},refresh:function(e){this._refreshItems(e);this.refreshPositions();return this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(e){var s=this;var p=[];var h=[];var q=this._connectWith();if(q&&e){for(var g=q.length-1;g>=0;g--){var r=a(q[g]);for(var f=r.length-1;f>=0;f--){var k=a.data(r[f],this.widgetName);if(k&&k!=this&&!k.options.disabled){h.push([a.isFunction(k.options.items)?k.options.items.call(k.element):a(k.options.items,k.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),k])}}}}h.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var g=h.length-1;g>=0;g--){h[g][0].each(function(){p.push(this)})}return a(p)},_removeCurrentsFromItems:function(){var g=this.currentItem.find(":data("+this.widgetName+"-item)");for(var f=0;f<this.items.length;f++){for(var e=0;e<g.length;e++){if(g[e]==this.items[f].item[0]){this.items.splice(f,1)}}}},_refreshItems:function(e){this.items=[];this.containers=[this];var q=this.items;var w=this;var k=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):a(this.options.items,this.element),this]];var s=this._connectWith();if(s&&this.ready){for(var h=s.length-1;h>=0;h--){var t=a(s[h]);for(var g=t.length-1;g>=0;g--){var p=a.data(t[g],this.widgetName);if(p&&p!=this&&!p.options.disabled){k.push([a.isFunction(p.options.items)?p.options.items.call(p.element[0],e,{item:this.currentItem}):a(p.options.items,p.element),p]);this.containers.push(p)}}}}for(var h=k.length-1;h>=0;h--){var r=k[h][1];var f=k[h][0];for(var g=0,u=f.length;g<u;g++){var v=a(f[g]);v.data(this.widgetName+"-item",r);q.push({item:v,instance:r,width:0,height:0,left:0,top:0})}}},refreshPositions:function(e){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}for(var g=this.items.length-1;g>=0;g--){var h=this.items[g];if(h.instance!=this.currentContainer&&this.currentContainer&&h.item[0]!=this.currentItem[0]){continue}var f=this.options.toleranceElement?a(this.options.toleranceElement,h.item):h.item;if(!e){h.width=f.outerWidth();h.height=f.outerHeight()}var j=f.offset();h.left=j.left;h.top=j.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var g=this.containers.length-1;g>=0;g--){var j=this.containers[g].element.offset();this.containers[g].containerCache.left=j.left;this.containers[g].containerCache.top=j.top;this.containers[g].containerCache.width=this.containers[g].element.outerWidth();this.containers[g].containerCache.height=this.containers[g].element.outerHeight()}}return this},_createPlaceholder:function(g){var e=g||this,h=e.options;if(!h.placeholder||h.placeholder.constructor==String){var f=h.placeholder;h.placeholder={element:function(){var i=a(document.createElement(e.currentItem[0].nodeName)).addClass(f||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!f){i.style.visibility="hidden"}return i},update:function(i,j){if(f&&!h.forcePlaceholderSize){return}if(!j.height()){j.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10))}if(!j.width()){j.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10))}}}}e.placeholder=a(h.placeholder.element.call(e.element,e.currentItem));e.currentItem.after(e.placeholder);h.placeholder.update(e,e.placeholder)},_contactContainers:function(e){var g=null,r=null;for(var k=this.containers.length-1;k>=0;k--){if(a.ui.contains(this.currentItem[0],this.containers[k].element[0])){continue}if(this._intersectsWith(this.containers[k].containerCache)){if(g&&a.ui.contains(this.containers[k].element[0],g.element[0])){continue}g=this.containers[k];r=k}else{if(this.containers[k].containerCache.over){this.containers[k]._trigger("out",e,this._uiHash(this));this.containers[k].containerCache.over=0}}}if(!g){return}if(this.containers.length===1){this.containers[r]._trigger("over",e,this._uiHash(this));this.containers[r].containerCache.over=1}else{if(this.currentContainer!=this.containers[r]){var q=10000;var p=null;var f=this.positionAbs[this.containers[r].floating?"left":"top"];for(var h=this.items.length-1;h>=0;h--){if(!a.ui.contains(this.containers[r].element[0],this.items[h].item[0])){continue}var s=this.containers[r].floating?this.items[h].item.offset().left:this.items[h].item.offset().top;if(Math.abs(s-f)<q){q=Math.abs(s-f);p=this.items[h];this.direction=(s-f>0)?"down":"up"}}if(!p&&!this.options.dropOnEmpty){return}this.currentContainer=this.containers[r];p?this._rearrange(e,p,null,true):this._rearrange(e,null,this.containers[r].element,true);this._trigger("change",e,this._uiHash());this.containers[r]._trigger("change",e,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[r]._trigger("over",e,this._uiHash(this));this.containers[r].containerCache.over=1}}},_createHelper:function(f){var g=this.options;var e=a.isFunction(g.helper)?a(g.helper.apply(this.element[0],[f,this.currentItem])):(g.helper=="clone"?this.currentItem.clone():this.currentItem);if(!e.parents("body").length){a(g.appendTo!="parent"?g.appendTo:this.currentItem[0].parentNode)[0].appendChild(e[0])}if(e[0]==this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(e[0].style.width==""||g.forceHelperSize){e.width(this.currentItem.width())}if(e[0].style.height==""||g.forceHelperSize){e.height(this.currentItem.height())}return e},_adjustOffsetFromHelper:function(e){if(typeof e=="string"){e=e.split(" ")}if(a.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left" in e){this.offset.click.left=e.left+this.margins.left}if("right" in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top" in e){this.offset.click.top=e.top+this.margins.top}if("bottom" in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var h=this.options;if(h.containment=="parent"){h.containment=this.helper[0].parentNode}if(h.containment=="document"||h.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(h.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(h.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(h.containment)){var f=a(h.containment)[0];var g=a(h.containment).offset();var e=(a(f).css("overflow")!="hidden");this.containment=[g.left+(parseInt(a(f).css("borderLeftWidth"),10)||0)+(parseInt(a(f).css("paddingLeft"),10)||0)-this.margins.left,g.top+(parseInt(a(f).css("borderTopWidth"),10)||0)+(parseInt(a(f).css("paddingTop"),10)||0)-this.margins.top,g.left+(e?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(a(f).css("borderLeftWidth"),10)||0)-(parseInt(a(f).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,g.top+(e?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(a(f).css("borderTopWidth"),10)||0)-(parseInt(a(f).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(h,j){if(!j){j=this.position}var f=h=="absolute"?1:-1;var g=this.options,e=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,i=(/(html|body)/i).test(e[0].tagName);return{top:(j.top+this.offset.relative.top*f+this.offset.parent.top*f-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(i?0:e.scrollTop()))*f)),left:(j.left+this.offset.relative.left*f+this.offset.parent.left*f-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:e.scrollLeft())*f))}},_generatePosition:function(h){var k=this.options,e=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,p=(/(html|body)/i).test(e[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}var g=h.pageX;var f=h.pageY;if(this.originalPosition){if(this.containment){if(h.pageX-this.offset.click.left<this.containment[0]){g=this.containment[0]+this.offset.click.left}if(h.pageY-this.offset.click.top<this.containment[1]){f=this.containment[1]+this.offset.click.top}if(h.pageX-this.offset.click.left>this.containment[2]){g=this.containment[2]+this.offset.click.left}if(h.pageY-this.offset.click.top>this.containment[3]){f=this.containment[3]+this.offset.click.top}}if(k.grid){var j=this.originalPageY+Math.round((f-this.originalPageY)/k.grid[1])*k.grid[1];f=this.containment?(!(j-this.offset.click.top<this.containment[1]||j-this.offset.click.top>this.containment[3])?j:(!(j-this.offset.click.top<this.containment[1])?j-k.grid[1]:j+k.grid[1])):j;var i=this.originalPageX+Math.round((g-this.originalPageX)/k.grid[0])*k.grid[0];g=this.containment?(!(i-this.offset.click.left<this.containment[0]||i-this.offset.click.left>this.containment[2])?i:(!(i-this.offset.click.left<this.containment[0])?i-k.grid[0]:i+k.grid[0])):i}}return{top:(f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(p?0:e.scrollTop())))),left:(g-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():p?0:e.scrollLeft())))}},_rearrange:function(k,j,f,h){f?f[0].appendChild(this.placeholder[0]):j.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction=="down"?j.item[0]:j.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var g=this,e=this.counter;window.setTimeout(function(){if(e==g.counter){g.refreshPositions(!h)}},0)},_clear:function(g,h){this.reverting=false;var j=[],e=this;if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var f in this._storedCSS){if(this._storedCSS[f]=="auto"||this._storedCSS[f]=="static"){this._storedCSS[f]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!h){j.push(function(i){this._trigger("receive",i,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!h){j.push(function(i){this._trigger("update",i,this._uiHash())})}if(this!==this.currentContainer){if(!h){j.push(function(i){this._trigger("remove",i,this._uiHash())});j.push((function(i){return function(k){i._trigger("receive",k,this._uiHash(this))}}).call(this,this.currentContainer));j.push((function(i){return function(k){i._trigger("update",k,this._uiHash(this))}}).call(this,this.currentContainer))}}for(var f=this.containers.length-1;f>=0;f--){if(!h){j.push((function(i){return function(k){i._trigger("deactivate",k,this._uiHash(this))}}).call(this,this.containers[f]))}if(this.containers[f].containerCache.over){j.push((function(i){return function(k){i._trigger("out",k,this._uiHash(this))}}).call(this,this.containers[f]));this.containers[f].containerCache.over=0}}if(this._storedCursor){a("body").css("cursor",this._storedCursor)}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!h){this._trigger("beforeStop",g,this._uiHash());for(var f=0;f<j.length;f++){j[f].call(this,g)}this._trigger("stop",g,this._uiHash())}this.fromOutside=false;return false}if(!h){this._trigger("beforeStop",g,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!=this.currentItem[0]){this.helper.remove()}this.helper=null;if(!h){for(var f=0;f<j.length;f++){j[f].call(this,g)}this._trigger("stop",g,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if(a.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(f){var e=f||this;return{helper:e.helper,placeholder:e.placeholder||a([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:f?f.element:null}}});a.extend(a.ui.sortable,{version:"1.8.24"})})(jQuery);
/*
 * jQuery UI Accordion 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Accordion
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var e=this,f=e.options;e.running=0;e.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix");e.headers=e.element.find(f.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){if(f.disabled){return}a(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){if(f.disabled){return}a(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){if(f.disabled){return}a(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){if(f.disabled){return}a(this).removeClass("ui-state-focus")});e.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(f.navigation){var g=e.element.find("a").filter(f.navigationFilter).eq(0);if(g.length){var h=g.closest(".ui-accordion-header");if(h.length){e.active=h}else{e.active=g.closest(".ui-accordion-content").prev()}}}e.active=e._findActive(e.active||f.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");e.active.next().addClass("ui-accordion-content-active");e._createIcons();e.resize();e.element.attr("role","tablist");e.headers.attr("role","tab").bind("keydown.accordion",function(i){return e._keydown(i)}).next().attr("role","tabpanel");e.headers.not(e.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();if(!e.active.length){e.headers.eq(0).attr("tabIndex",0)}else{e.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0})}if(!a.browser.safari){e.headers.find("a").attr("tabIndex",-1)}if(f.event){e.headers.bind(f.event.split(" ").join(".accordion ")+".accordion",function(i){e._clickHandler.call(e,i,this);i.preventDefault()})}},_createIcons:function(){var e=this.options;if(e.icons){a("<span></span>").addClass("ui-icon "+e.icons.header).prependTo(this.headers);this.active.children(".ui-icon").toggleClass(e.icons.header).toggleClass(e.icons.headerSelected);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-icon").remove();this.element.removeClass("ui-accordion-icons")},destroy:function(){var e=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex");this.headers.find("a").removeAttr("tabIndex");this._destroyIcons();var f=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");if(e.autoHeight||e.fillHeight){f.css("height","")}return a.Widget.prototype.destroy.call(this)},_setOption:function(e,f){a.Widget.prototype._setOption.apply(this,arguments);if(e=="active"){this.activate(f)}if(e=="icons"){this._destroyIcons();if(f){this._createIcons()}}if(e=="disabled"){this.headers.add(this.headers.next())[f?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")}},_keydown:function(h){if(this.options.disabled||h.altKey||h.ctrlKey){return}var i=a.ui.keyCode,g=this.headers.length,e=this.headers.index(h.target),f=false;switch(h.keyCode){case i.RIGHT:case i.DOWN:f=this.headers[(e+1)%g];break;case i.LEFT:case i.UP:f=this.headers[(e-1+g)%g];break;case i.SPACE:case i.ENTER:this._clickHandler({target:h.target},h.target);h.preventDefault()}if(f){a(h.target).attr("tabIndex",-1);a(f).attr("tabIndex",0);f.focus();return false}return true},resize:function(){var e=this.options,g;if(e.fillSpace){if(a.browser.msie){var f=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}g=this.element.parent().height();if(a.browser.msie){this.element.parent().css("overflow",f)}this.headers.each(function(){g-=a(this).outerHeight(true)});this.headers.next().each(function(){a(this).height(Math.max(0,g-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else{if(e.autoHeight){g=0;this.headers.next().each(function(){g=Math.max(g,a(this).height("").height())}).height(g)}}return this},activate:function(e){this.options.active=e;var f=this._findActive(e)[0];this._clickHandler({target:f},f);return this},_findActive:function(e){return e?typeof e==="number"?this.headers.filter(":eq("+e+")"):this.headers.not(this.headers.not(e)):e===false?a([]):this.headers.filter(":eq(0)")},_clickHandler:function(e,i){var r=this.options;if(r.disabled){return}if(!e.target){if(!r.collapsible){return}this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(r.icons.headerSelected).addClass(r.icons.header);this.active.next().addClass("ui-accordion-content-active");var k=this.active.next(),h={options:r,newHeader:a([]),oldHeader:r.active,newContent:a([]),oldContent:k},f=(this.active=a([]));this._toggle(f,k,h);return}var j=a(e.currentTarget||i),p=j[0]===this.active[0];r.active=r.collapsible&&p?false:this.headers.index(j);if(this.running||(!r.collapsible&&p)){return}var g=this.active,f=j.next(),k=this.active.next(),h={options:r,newHeader:p&&r.collapsible?a([]):j,oldHeader:this.active,newContent:p&&r.collapsible?a([]):f,oldContent:k},q=this.headers.index(this.active[0])>this.headers.index(j[0]);this.active=p?a([]):j;this._toggle(f,k,h,p,q);g.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(r.icons.headerSelected).addClass(r.icons.header);if(!p){j.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(r.icons.header).addClass(r.icons.headerSelected);j.next().addClass("ui-accordion-content-active")}return},_toggle:function(e,k,i,p,q){var s=this,t=s.options;s.toShow=e;s.toHide=k;s.data=i;var f=function(){if(!s){return}return s._completed.apply(s,arguments)};s._trigger("changestart",null,s.data);s.running=k.size()===0?e.size():k.size();if(t.animated){var h={};if(t.collapsible&&p){h={toShow:a([]),toHide:k,complete:f,down:q,autoHeight:t.autoHeight||t.fillSpace}}else{h={toShow:e,toHide:k,complete:f,down:q,autoHeight:t.autoHeight||t.fillSpace}}if(!t.proxied){t.proxied=t.animated}if(!t.proxiedDuration){t.proxiedDuration=t.duration}t.animated=a.isFunction(t.proxied)?t.proxied(h):t.proxied;t.duration=a.isFunction(t.proxiedDuration)?t.proxiedDuration(h):t.proxiedDuration;var r=a.ui.accordion.animations,g=t.duration,j=t.animated;if(j&&!r[j]&&!a.easing[j]){j="slide"}if(!r[j]){r[j]=function(u){this.slide(u,{easing:j,duration:g||700})}}r[j](h)}else{if(t.collapsible&&p){e.toggle()}else{k.hide();e.show()}f(true)}k.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur();e.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(e){this.running=e?0:--this.running;if(this.running){return}if(this.options.clearStyle){this.toShow.add(this.toHide).css({height:"",overflow:""})}this.toHide.removeClass("ui-accordion-content-active");if(this.toHide.length){this.toHide.parent()[0].className=this.toHide.parent()[0].className}this._trigger("change",null,this.data)}});a.extend(a.ui.accordion,{version:"1.8.24",animations:{slide:function(q,k){q=a.extend({easing:"swing",duration:300},q,k);if(!q.toHide.size()){q.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},q);return}if(!q.toShow.size()){q.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},q);return}var f=q.toShow.css("overflow"),j=0,g={},i={},h=["height","paddingTop","paddingBottom"],e;var p=q.toShow;e=p[0].style.width;p.width(p.parent().width()-parseFloat(p.css("paddingLeft"))-parseFloat(p.css("paddingRight"))-(parseFloat(p.css("borderLeftWidth"))||0)-(parseFloat(p.css("borderRightWidth"))||0));a.each(h,function(r,t){i[t]="hide";var s=(""+a.css(q.toShow[0],t)).match(/^([\d+-.]+)(.*)$/);g[t]={value:s[1],unit:s[2]||"px"}});q.toShow.css({height:0,overflow:"hidden"}).show();q.toHide.filter(":hidden").each(q.complete).end().filter(":visible").animate(i,{step:function(r,s){if(s.prop=="height"){j=(s.end-s.start===0)?0:(s.now-s.start)/(s.end-s.start)}q.toShow[0].style[s.prop]=(j*g[s.prop].value)+g[s.prop].unit},duration:q.duration,easing:q.easing,complete:function(){if(!q.autoHeight){q.toShow.css("height","")}q.toShow.css({width:e,overflow:f});q.complete()}})},bounceslide:function(e){this.slide(e,{easing:e.down?"easeOutBounce":"swing",duration:e.down?1000:200})}}})})(jQuery);
/*
 * jQuery UI Autocomplete 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Autocomplete
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 */
(function(a,b){var e=0;a.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var f=this,h=this.element[0].ownerDocument,g;this.isMultiLine=this.element.is("textarea");this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(i){if(f.options.disabled||f.element.propAttr("readOnly")){return}g=false;var j=a.ui.keyCode;switch(i.keyCode){case j.PAGE_UP:f._move("previousPage",i);break;case j.PAGE_DOWN:f._move("nextPage",i);break;case j.UP:f._keyEvent("previous",i);break;case j.DOWN:f._keyEvent("next",i);break;case j.ENTER:case j.NUMPAD_ENTER:if(f.menu.active){g=true;i.preventDefault()}case j.TAB:if(!f.menu.active){return}f.menu.select(i);break;case j.ESCAPE:f.element.val(f.term);f.close(i);break;default:clearTimeout(f.searching);f.searching=setTimeout(function(){if(f.term!=f.element.val()){f.selectedItem=null;f.search(null,i)}},f.options.delay);break}}).bind("keypress.autocomplete",function(i){if(g){g=false;i.preventDefault()}}).bind("focus.autocomplete",function(){if(f.options.disabled){return}f.selectedItem=null;f.previous=f.element.val()}).bind("blur.autocomplete",function(i){if(f.options.disabled){return}clearTimeout(f.searching);f.closing=setTimeout(function(){f.close(i);f._change(i)},150)});this._initSource();this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",h)[0]).mousedown(function(i){var j=f.menu.element[0];if(!a(i.target).closest(".ui-menu-item").length){setTimeout(function(){a(document).one("mousedown",function(k){if(k.target!==f.element[0]&&k.target!==j&&!a.ui.contains(j,k.target)){f.close()}})},1)}setTimeout(function(){clearTimeout(f.closing)},13)}).menu({focus:function(j,k){var i=k.item.data("item.autocomplete");if(false!==f._trigger("focus",j,{item:i})){if(/^key/.test(j.originalEvent.type)){f.element.val(i.value)}}},selected:function(k,p){var j=p.item.data("item.autocomplete"),i=f.previous;if(f.element[0]!==h.activeElement){f.element.focus();f.previous=i;setTimeout(function(){f.previous=i;f.selectedItem=j},1)}if(false!==f._trigger("select",k,{item:j})){f.element.val(j.value)}f.term=f.element.val();f.close(k);f.selectedItem=j},blur:function(i,j){if(f.menu.element.is(":visible")&&(f.element.val()!==f.term)){f.element.val(f.term)}}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");if(a.fn.bgiframe){this.menu.element.bgiframe()}f.beforeunloadHandler=function(){f.element.removeAttr("autocomplete")};a(window).bind("beforeunload",f.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();a(window).unbind("beforeunload",this.beforeunloadHandler);a.Widget.prototype.destroy.call(this)},_setOption:function(f,g){a.Widget.prototype._setOption.apply(this,arguments);if(f==="source"){this._initSource()}if(f==="appendTo"){this.menu.element.appendTo(a(g||"body",this.element[0].ownerDocument)[0])}if(f==="disabled"&&g&&this.xhr){this.xhr.abort()}},_initSource:function(){var f=this,h,g;if(a.isArray(this.options.source)){h=this.options.source;this.source=function(j,i){i(a.ui.autocomplete.filter(h,j.term))}}else{if(typeof this.options.source==="string"){g=this.options.source;this.source=function(j,i){if(f.xhr){f.xhr.abort()}f.xhr=a.ajax({url:g,data:j,dataType:"json",success:function(p,k){i(p)},error:function(){i([])}})}}else{this.source=this.options.source}}},search:function(g,f){g=g!=null?g:this.element.val();this.term=this.element.val();if(g.length<this.options.minLength){return this.close(f)}clearTimeout(this.closing);if(this._trigger("search",f)===false){return}return this._search(g)},_search:function(f){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:f},this._response())},_response:function(){var g=this,f=++e;return function(h){if(f===e){g.__response(h)}g.pending--;if(!g.pending){g.element.removeClass("ui-autocomplete-loading")}}},__response:function(f){if(!this.options.disabled&&f&&f.length){f=this._normalize(f);this._suggest(f);this._trigger("open")}else{this.close()}},close:function(f){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",f)}},_change:function(f){if(this.previous!==this.element.val()){this._trigger("change",f,{item:this.selectedItem})}},_normalize:function(f){if(f.length&&f[0].label&&f[0].value){return f}return a.map(f,function(g){if(typeof g==="string"){return{label:g,value:g}}return a.extend({label:g.label||g.value,value:g.value||g.label},g)})},_suggest:function(f){var g=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(g,f);this.menu.deactivate();this.menu.refresh();g.show();this._resizeMenu();g.position(a.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next(new a.Event("mouseover"))}},_resizeMenu:function(){var f=this.menu.element;f.outerWidth(Math.max(f.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(h,g){var f=this;a.each(g,function(i,j){f._renderItem(h,j)})},_renderItem:function(f,g){return a("<li></li>").data("item.autocomplete",g).append(a("<a></a>").text(g.label)).appendTo(f)},_move:function(g,f){if(!this.menu.element.is(":visible")){this.search(null,f);return}if(this.menu.first()&&/^previous/.test(g)||this.menu.last()&&/^next/.test(g)){this.element.val(this.term);this.menu.deactivate();return}this.menu[g](f)},widget:function(){return this.menu.element},_keyEvent:function(g,f){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(g,f);f.preventDefault()}}});a.extend(a.ui.autocomplete,{escapeRegex:function(f){return f.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(h,f){var g=new RegExp(a.ui.autocomplete.escapeRegex(f),"i");return a.grep(h,function(i){return g.test(i.label||i.value||i)})}})}(jQuery));(function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(e){if(!a(e.target).closest(".ui-menu-item a").length){return}e.preventDefault();b.select(e)});this.refresh()},refresh:function(){var e=this;var b=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");b.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(f){e.activate(f,a(this).parent())}).mouseleave(function(){e.deactivate()})},activate:function(g,f){this.deactivate();if(this.hasScroll()){var h=f.offset().top-this.element.offset().top,b=this.element.scrollTop(),e=this.element.height();if(h<0){this.element.scrollTop(b+h)}else{if(h>=e){this.element.scrollTop(b+h-e+f.height())}}}this.active=f.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",g,{item:f})},deactivate:function(){if(!this.active){return}this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(b){this.move("next",".ui-menu-item:first",b)},previous:function(b){this.move("prev",".ui-menu-item:last",b)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(g,f,e){if(!this.active){this.activate(e,this.element.children(f));return}var b=this.active[g+"All"](".ui-menu-item").eq(0);if(b.length){this.activate(e,b)}else{this.activate(e,this.element.children(f))}},nextPage:function(f){if(this.hasScroll()){if(!this.active||this.last()){this.activate(f,this.element.children(".ui-menu-item:first"));return}var g=this.active.offset().top,e=this.element.height(),b=this.element.children(".ui-menu-item").filter(function(){var h=a(this).offset().top-g-e+a(this).height();return h<10&&h>-10});if(!b.length){b=this.element.children(".ui-menu-item:last")}this.activate(f,b)}else{this.activate(f,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))}},previousPage:function(f){if(this.hasScroll()){if(!this.active||this.first()){this.activate(f,this.element.children(".ui-menu-item:last"));return}var g=this.active.offset().top,e=this.element.height(),b=this.element.children(".ui-menu-item").filter(function(){var h=a(this).offset().top-g+e-a(this).height();return h<10&&h>-10});if(!b.length){b=this.element.children(".ui-menu-item:first")}this.activate(f,b)}else{this.activate(f,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element[a.fn.prop?"prop":"attr"]("scrollHeight")},select:function(b){this._trigger("selected",b,{item:this.active})}})}(jQuery));
/*
 * jQuery UI Button 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Button
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(h,b){var q,g,a,j,k="ui-button ui-widget ui-state-default ui-corner-all",e="ui-state-hover ui-state-active ",i="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",p=function(){var r=h(this).find(":ui-button");setTimeout(function(){r.button("refresh")},1)},f=function(s){var r=s.name,t=s.form,u=h([]);if(r){if(t){u=h(t).find("[name='"+r+"']")}else{u=h("[name='"+r+"']",s.ownerDocument).filter(function(){return !this.form})}}return u};h.widget("ui.button",{options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",p);if(typeof this.options.disabled!=="boolean"){this.options.disabled=!!this.element.propAttr("disabled")}else{this.element.propAttr("disabled",this.options.disabled)}this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var r=this,t=this.options,u=this.type==="checkbox"||this.type==="radio",v="ui-state-hover"+(!u?" ui-state-active":""),s="ui-state-focus";if(t.label===null){t.label=this.buttonElement.html()}this.buttonElement.addClass(k).attr("role","button").bind("mouseenter.button",function(){if(t.disabled){return}h(this).addClass("ui-state-hover");if(this===q){h(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){if(t.disabled){return}h(this).removeClass(v)}).bind("click.button",function(w){if(t.disabled){w.preventDefault();w.stopImmediatePropagation()}});this.element.bind("focus.button",function(){r.buttonElement.addClass(s)}).bind("blur.button",function(){r.buttonElement.removeClass(s)});if(u){this.element.bind("change.button",function(){if(j){return}r.refresh()});this.buttonElement.bind("mousedown.button",function(w){if(t.disabled){return}j=false;g=w.pageX;a=w.pageY}).bind("mouseup.button",function(w){if(t.disabled){return}if(g!==w.pageX||a!==w.pageY){j=true}})}if(this.type==="checkbox"){this.buttonElement.bind("click.button",function(){if(t.disabled||j){return false}h(this).toggleClass("ui-state-active");r.buttonElement.attr("aria-pressed",r.element[0].checked)})}else{if(this.type==="radio"){this.buttonElement.bind("click.button",function(){if(t.disabled||j){return false}h(this).addClass("ui-state-active");r.buttonElement.attr("aria-pressed","true");var w=r.element[0];f(w).not(w).map(function(){return h(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")})}else{this.buttonElement.bind("mousedown.button",function(){if(t.disabled){return false}h(this).addClass("ui-state-active");q=this;h(document).one("mouseup",function(){q=null})}).bind("mouseup.button",function(){if(t.disabled){return false}h(this).removeClass("ui-state-active")}).bind("keydown.button",function(w){if(t.disabled){return false}if(w.keyCode==h.ui.keyCode.SPACE||w.keyCode==h.ui.keyCode.ENTER){h(this).addClass("ui-state-active")}}).bind("keyup.button",function(){h(this).removeClass("ui-state-active")});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(w){if(w.keyCode===h.ui.keyCode.SPACE){h(this).click()}})}}}this._setOption("disabled",t.disabled);this._resetButton()},_determineButtonType:function(){if(this.element.is(":checkbox")){this.type="checkbox"}else{if(this.element.is(":radio")){this.type="radio"}else{if(this.element.is("input")){this.type="input"}else{this.type="button"}}}if(this.type==="checkbox"||this.type==="radio"){var r=this.element.parents().filter(":last"),t="label[for='"+this.element.attr("id")+"']";this.buttonElement=r.find(t);if(!this.buttonElement.length){r=r.length?r.siblings():this.element.siblings();this.buttonElement=r.filter(t);if(!this.buttonElement.length){this.buttonElement=r.find(t)}}this.element.addClass("ui-helper-hidden-accessible");var s=this.element.is(":checked");if(s){this.buttonElement.addClass("ui-state-active")}this.buttonElement.attr("aria-pressed",s)}else{this.buttonElement=this.element}},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(k+" "+e+" "+i).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle){this.buttonElement.removeAttr("title")}h.Widget.prototype.destroy.call(this)},_setOption:function(r,s){h.Widget.prototype._setOption.apply(this,arguments);if(r==="disabled"){if(s){this.element.propAttr("disabled",true)}else{this.element.propAttr("disabled",false)}return}this._resetButton()},refresh:function(){var r=this.element.is(":disabled");if(r!==this.options.disabled){this._setOption("disabled",r)}if(this.type==="radio"){f(this.element[0]).each(function(){if(h(this).is(":checked")){h(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true")}else{h(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}})}else{if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true")}else{this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false")}}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label)}return}var v=this.buttonElement.removeClass(i),t=h("<span></span>",this.element[0].ownerDocument).addClass("ui-button-text").html(this.options.label).appendTo(v.empty()).text(),s=this.options.icons,r=s.primary&&s.secondary,u=[];if(s.primary||s.secondary){if(this.options.text){u.push("ui-button-text-icon"+(r?"s":(s.primary?"-primary":"-secondary")))}if(s.primary){v.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>")}if(s.secondary){v.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>")}if(!this.options.text){u.push(r?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle){v.attr("title",t)}}}else{u.push("ui-button-text-only")}v.addClass(u.join(" "))}});h.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(r,s){if(r==="disabled"){this.buttons.button("option",r,s)}h.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){var r=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return h(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(r?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(r?"ui-corner-left":"ui-corner-right").end().end()},destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return h(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");h.Widget.prototype.destroy.call(this)}})}(jQuery));
/*
 * jQuery UI Dialog 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Dialog
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *  jquery.ui.button.js
 *	jquery.ui.draggable.js
 *	jquery.ui.mouse.js
 *	jquery.ui.position.js
 *	jquery.ui.resizable.js
 */
(function(f,g){var b="ui-dialog ui-widget ui-widget-content ui-corner-all ",a={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},e={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};f.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",collision:"fit",using:function(i){var h=f(this).css(i).offset().top;if(h<0){f(this).css("top",i.top-h)}}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string"){this.originalTitle=""}this.options.title=this.options.title||this.originalTitle;var t=this,u=t.options,r=u.title||"&#160;",i=f.ui.dialog.getTitleId(t.element),s=(t.uiDialog=f("<div></div>")).appendTo(document.body).hide().addClass(b+u.dialogClass).css({zIndex:u.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(v){if(u.closeOnEscape&&!v.isDefaultPrevented()&&v.keyCode&&v.keyCode===f.ui.keyCode.ESCAPE){t.close(v);v.preventDefault()}}).attr({role:"dialog","aria-labelledby":i}).mousedown(function(v){t.moveToTop(false,v)}),k=t.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(s),j=(t.uiDialogTitlebar=f("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(s),q=f('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){q.addClass("ui-state-hover")},function(){q.removeClass("ui-state-hover")}).focus(function(){q.addClass("ui-state-focus")}).blur(function(){q.removeClass("ui-state-focus")}).click(function(v){t.close(v);return false}).appendTo(j),p=(t.uiDialogTitlebarCloseText=f("<span></span>")).addClass("ui-icon ui-icon-closethick").text(u.closeText).appendTo(q),h=f("<span></span>").addClass("ui-dialog-title").attr("id",i).html(r).prependTo(j);if(f.isFunction(u.beforeclose)&&!f.isFunction(u.beforeClose)){u.beforeClose=u.beforeclose}j.find("*").add(j).disableSelection();if(u.draggable&&f.fn.draggable){t._makeDraggable()}if(u.resizable&&f.fn.resizable){t._makeResizable()}t._createButtons(u.buttons);t._isOpen=false;if(f.fn.bgiframe){s.bgiframe()}},_init:function(){if(this.options.autoOpen){this.open()}},destroy:function(){var h=this;if(h.overlay){h.overlay.destroy()}h.uiDialog.hide();h.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");h.uiDialog.remove();if(h.originalTitle){h.element.attr("title",h.originalTitle)}return h},widget:function(){return this.uiDialog},close:function(k){var h=this,j,i;if(false===h._trigger("beforeClose",k)){return}if(h.overlay){h.overlay.destroy()}h.uiDialog.unbind("keypress.ui-dialog");h._isOpen=false;if(h.options.hide){h.uiDialog.hide(h.options.hide,function(){h._trigger("close",k)})}else{h.uiDialog.hide();h._trigger("close",k)}f.ui.dialog.overlay.resize();if(h.options.modal){j=0;f(".ui-dialog").each(function(){if(this!==h.uiDialog[0]){i=f(this).css("z-index");if(!isNaN(i)){j=Math.max(j,i)}}});f.ui.dialog.maxZ=j}return h},isOpen:function(){return this._isOpen},moveToTop:function(p,k){var h=this,j=h.options,i;if((j.modal&&!p)||(!j.stack&&!j.modal)){return h._trigger("focus",k)}if(j.zIndex>f.ui.dialog.maxZ){f.ui.dialog.maxZ=j.zIndex}if(h.overlay){f.ui.dialog.maxZ+=1;h.overlay.$el.css("z-index",f.ui.dialog.overlay.maxZ=f.ui.dialog.maxZ)}i={scrollTop:h.element.scrollTop(),scrollLeft:h.element.scrollLeft()};f.ui.dialog.maxZ+=1;h.uiDialog.css("z-index",f.ui.dialog.maxZ);h.element.attr(i);h._trigger("focus",k);return h},open:function(){if(this._isOpen){return}var i=this,j=i.options,h=i.uiDialog;i.overlay=j.modal?new f.ui.dialog.overlay(i):null;i._size();i._position(j.position);h.show(j.show);i.moveToTop(true);if(j.modal){h.bind("keydown.ui-dialog",function(q){if(q.keyCode!==f.ui.keyCode.TAB){return}var p=f(":tabbable",this),r=p.filter(":first"),k=p.filter(":last");if(q.target===k[0]&&!q.shiftKey){r.focus(1);return false}else{if(q.target===r[0]&&q.shiftKey){k.focus(1);return false}}})}f(i.element.find(":tabbable").get().concat(h.find(".ui-dialog-buttonpane :tabbable").get().concat(h.get()))).eq(0).focus();i._isOpen=true;i._trigger("open");return i},_createButtons:function(k){var j=this,h=false,i=f("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),p=f("<div></div>").addClass("ui-dialog-buttonset").appendTo(i);j.uiDialog.find(".ui-dialog-buttonpane").remove();if(typeof k==="object"&&k!==null){f.each(k,function(){return !(h=true)})}if(h){f.each(k,function(q,s){s=f.isFunction(s)?{click:s,text:q}:s;var r=f('<button type="button"></button>').click(function(){s.click.apply(j.element[0],arguments)}).appendTo(p);f.each(s,function(t,u){if(t==="click"){return}if(t in r){r[t](u)}else{r.attr(t,u)}});if(f.fn.button){r.button()}});i.appendTo(j.uiDialog)}},_makeDraggable:function(){var h=this,k=h.options,p=f(document),j;function i(q){return{position:q.position,offset:q.offset}}h.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(q,r){j=k.height==="auto"?"auto":f(this).height();f(this).height(f(this).height()).addClass("ui-dialog-dragging");h._trigger("dragStart",q,i(r))},drag:function(q,r){h._trigger("drag",q,i(r))},stop:function(q,r){k.position=[r.position.left-p.scrollLeft(),r.position.top-p.scrollTop()];f(this).removeClass("ui-dialog-dragging").height(j);h._trigger("dragStop",q,i(r));f.ui.dialog.overlay.resize()}})},_makeResizable:function(q){q=(q===g?this.options.resizable:q);var i=this,p=i.options,h=i.uiDialog.css("position"),k=(typeof q==="string"?q:"n,e,s,w,se,sw,ne,nw");function j(r){return{originalPosition:r.originalPosition,originalSize:r.originalSize,position:r.position,size:r.size}}i.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:i.element,maxWidth:p.maxWidth,maxHeight:p.maxHeight,minWidth:p.minWidth,minHeight:i._minHeight(),handles:k,start:function(r,s){f(this).addClass("ui-dialog-resizing");i._trigger("resizeStart",r,j(s))},resize:function(r,s){i._trigger("resize",r,j(s))},stop:function(r,s){f(this).removeClass("ui-dialog-resizing");p.height=f(this).height();p.width=f(this).width();i._trigger("resizeStop",r,j(s));f.ui.dialog.overlay.resize()}}).css("position",h).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var h=this.options;if(h.height==="auto"){return h.minHeight}else{return Math.min(h.minHeight,h.height)}},_position:function(i){var j=[],k=[0,0],h;if(i){if(typeof i==="string"||(typeof i==="object"&&"0" in i)){j=i.split?i.split(" "):[i[0],i[1]];if(j.length===1){j[1]=j[0]}f.each(["left","top"],function(q,p){if(+j[q]===j[q]){k[q]=j[q];j[q]=p}});i={my:j.join(" "),at:j.join(" "),offset:k.join(" ")}}i=f.extend({},f.ui.dialog.prototype.options.position,i)}else{i=f.ui.dialog.prototype.options.position}h=this.uiDialog.is(":visible");if(!h){this.uiDialog.show()}this.uiDialog.css({top:0,left:0}).position(f.extend({of:window},i));if(!h){this.uiDialog.hide()}},_setOptions:function(k){var i=this,h={},j=false;f.each(k,function(p,q){i._setOption(p,q);if(p in a){j=true}if(p in e){h[p]=q}});if(j){this._size()}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option",h)}},_setOption:function(k,p){var i=this,h=i.uiDialog;switch(k){case"beforeclose":k="beforeClose";break;case"buttons":i._createButtons(p);break;case"closeText":i.uiDialogTitlebarCloseText.text(""+p);break;case"dialogClass":h.removeClass(i.options.dialogClass).addClass(b+p);break;case"disabled":if(p){h.addClass("ui-dialog-disabled")}else{h.removeClass("ui-dialog-disabled")}break;case"draggable":var j=h.is(":data(draggable)");if(j&&!p){h.draggable("destroy")}if(!j&&p){i._makeDraggable()}break;case"position":i._position(p);break;case"resizable":var q=h.is(":data(resizable)");if(q&&!p){h.resizable("destroy")}if(q&&typeof p==="string"){h.resizable("option","handles",p)}if(!q&&p!==false){i._makeResizable(p)}break;case"title":f(".ui-dialog-title",i.uiDialogTitlebar).html(""+(p||"&#160;"));break}f.Widget.prototype._setOption.apply(i,arguments)},_size:function(){var p=this.options,i,k,h=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(p.minWidth>p.width){p.width=p.minWidth}i=this.uiDialog.css({height:"auto",width:p.width}).height();k=Math.max(0,p.minHeight-i);if(p.height==="auto"){if(f.support.minHeight){this.element.css({minHeight:k,height:"auto"})}else{this.uiDialog.show();var j=this.element.css("height","auto").height();if(!h){this.uiDialog.hide()}this.element.height(Math.max(j,k))}}else{this.element.height(Math.max(p.height-i,0))}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}}});f.extend(f.ui.dialog,{version:"1.8.24",uuid:0,maxZ:0,getTitleId:function(h){var i=h.attr("id");if(!i){this.uuid+=1;i=this.uuid}return"ui-dialog-title-"+i},overlay:function(h){this.$el=f.ui.dialog.overlay.create(h)}});f.extend(f.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:f.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(h){return h+".dialog-overlay"}).join(" "),create:function(i){if(this.instances.length===0){setTimeout(function(){if(f.ui.dialog.overlay.instances.length){f(document).bind(f.ui.dialog.overlay.events,function(j){if(f(j.target).zIndex()<f.ui.dialog.overlay.maxZ){return false}})}},1);f(document).bind("keydown.dialog-overlay",function(j){if(i.options.closeOnEscape&&!j.isDefaultPrevented()&&j.keyCode&&j.keyCode===f.ui.keyCode.ESCAPE){i.close(j);j.preventDefault()}});f(window).bind("resize.dialog-overlay",f.ui.dialog.overlay.resize)}var h=(this.oldInstances.pop()||f("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});if(f.fn.bgiframe){h.bgiframe()}this.instances.push(h);return h},destroy:function(h){var i=f.inArray(h,this.instances);if(i!=-1){this.oldInstances.push(this.instances.splice(i,1)[0])}if(this.instances.length===0){f([document,window]).unbind(".dialog-overlay")}h.remove();var j=0;f.each(this.instances,function(){j=Math.max(j,this.css("z-index"))});this.maxZ=j},height:function(){var i,h;if(f.browser.msie&&f.browser.version<7){i=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);h=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(i<h){return f(window).height()+"px"}else{return i+"px"}}else{return f(document).height()+"px"}},width:function(){var h,i;if(f.browser.msie){h=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);i=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);if(h<i){return f(window).width()+"px"}else{return h+"px"}}else{return f(document).width()+"px"}},resize:function(){var h=f([]);f.each(f.ui.dialog.overlay.instances,function(){h=h.add(this)});h.css({width:0,height:0}).css({width:f.ui.dialog.overlay.width(),height:f.ui.dialog.overlay.height()})}});f.extend(f.ui.dialog.overlay.prototype,{destroy:function(){f.ui.dialog.overlay.destroy(this.$el)}})}(jQuery));
/*
 * jQuery UI Slider 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Slider
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(b,e){var a=5;b.widget("ui.slider",b.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var g=this,q=this.options,p=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),k="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",f=(q.values&&q.values.length)||1,j=[];this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(q.disabled?" ui-slider-disabled ui-disabled":""));this.range=b([]);if(q.range){if(q.range===true){if(!q.values){q.values=[this._valueMin(),this._valueMin()]}if(q.values.length&&q.values.length!==2){q.values=[q.values[0],q.values[0]]}}this.range=b("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+((q.range==="min"||q.range==="max")?" ui-slider-range-"+q.range:""))}for(var h=p.length;h<f;h+=1){j.push(k)}this.handles=p.add(b(j.join("")).appendTo(g.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(i){i.preventDefault()}).hover(function(){if(!q.disabled){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")}).focus(function(){if(!q.disabled){b(".ui-slider .ui-state-focus").removeClass("ui-state-focus");b(this).addClass("ui-state-focus")}else{b(this).blur()}}).blur(function(){b(this).removeClass("ui-state-focus")});this.handles.each(function(r){b(this).data("index.ui-slider-handle",r)});this.handles.keydown(function(u){var r=b(this).data("index.ui-slider-handle"),v,s,i,t;if(g.options.disabled){return}switch(u.keyCode){case b.ui.keyCode.HOME:case b.ui.keyCode.END:case b.ui.keyCode.PAGE_UP:case b.ui.keyCode.PAGE_DOWN:case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:u.preventDefault();if(!g._keySliding){g._keySliding=true;b(this).addClass("ui-state-active");v=g._start(u,r);if(v===false){return}}break}t=g.options.step;if(g.options.values&&g.options.values.length){s=i=g.values(r)}else{s=i=g.value()}switch(u.keyCode){case b.ui.keyCode.HOME:i=g._valueMin();break;case b.ui.keyCode.END:i=g._valueMax();break;case b.ui.keyCode.PAGE_UP:i=g._trimAlignValue(s+((g._valueMax()-g._valueMin())/a));break;case b.ui.keyCode.PAGE_DOWN:i=g._trimAlignValue(s-((g._valueMax()-g._valueMin())/a));break;case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:if(s===g._valueMax()){return}i=g._trimAlignValue(s+t);break;case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(s===g._valueMin()){return}i=g._trimAlignValue(s-t);break}g._slide(u,r,i)}).keyup(function(r){var i=b(this).data("index.ui-slider-handle");if(g._keySliding){g._keySliding=false;g._stop(r,i);g._change(r,i);b(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},_mouseCapture:function(h){var i=this.options,p,r,g,j,t,q,s,k,f;if(i.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();p={x:h.pageX,y:h.pageY};r=this._normValueFromMouse(p);g=this._valueMax()-this._valueMin()+1;t=this;this.handles.each(function(u){var v=Math.abs(r-t.values(u));if(g>v){g=v;j=b(this);q=u}});if(i.range===true&&this.values(1)===i.min){q+=1;j=b(this.handles[q])}s=this._start(h,q);if(s===false){return false}this._mouseSliding=true;t._handleIndex=q;j.addClass("ui-state-active").focus();k=j.offset();f=!b(h.target).parents().andSelf().is(".ui-slider-handle");this._clickOffset=f?{left:0,top:0}:{left:h.pageX-k.left-(j.width()/2),top:h.pageY-k.top-(j.height()/2)-(parseInt(j.css("borderTopWidth"),10)||0)-(parseInt(j.css("borderBottomWidth"),10)||0)+(parseInt(j.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(h,q,r)}this._animateOff=true;return true},_mouseStart:function(f){return true},_mouseDrag:function(h){var f={x:h.pageX,y:h.pageY},g=this._normValueFromMouse(f);this._slide(h,this._handleIndex,g);return false},_mouseStop:function(f){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(f,this._handleIndex);this._change(f,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal"},_normValueFromMouse:function(g){var f,j,i,h,k;if(this.orientation==="horizontal"){f=this.elementSize.width;j=g.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{f=this.elementSize.height;j=g.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}i=(j/f);if(i>1){i=1}if(i<0){i=0}if(this.orientation==="vertical"){i=1-i}h=this._valueMax()-this._valueMin();k=this._valueMin()+i*h;return this._trimAlignValue(k)},_start:function(h,g){var f={handle:this.handles[g],value:this.value()};if(this.options.values&&this.options.values.length){f.value=this.values(g);f.values=this.values()}return this._trigger("start",h,f)},_slide:function(j,i,h){var f,g,k;if(this.options.values&&this.options.values.length){f=this.values(i?0:1);if((this.options.values.length===2&&this.options.range===true)&&((i===0&&h>f)||(i===1&&h<f))){h=f}if(h!==this.values(i)){g=this.values();g[i]=h;k=this._trigger("slide",j,{handle:this.handles[i],value:h,values:g});f=this.values(i?0:1);if(k!==false){this.values(i,h,true)}}}else{if(h!==this.value()){k=this._trigger("slide",j,{handle:this.handles[i],value:h});if(k!==false){this.value(h)}}}},_stop:function(h,g){var f={handle:this.handles[g],value:this.value()};if(this.options.values&&this.options.values.length){f.value=this.values(g);f.values=this.values()}this._trigger("stop",h,f)},_change:function(h,g){if(!this._keySliding&&!this._mouseSliding){var f={handle:this.handles[g],value:this.value()};if(this.options.values&&this.options.values.length){f.value=this.values(g);f.values=this.values()}this._trigger("change",h,f)}},value:function(f){if(arguments.length){this.options.value=this._trimAlignValue(f);this._refreshValue();this._change(null,0);return}return this._value()},values:function(g,k){var j,f,h;if(arguments.length>1){this.options.values[g]=this._trimAlignValue(k);this._refreshValue();this._change(null,g);return}if(arguments.length){if(b.isArray(arguments[0])){j=this.options.values;f=arguments[0];for(h=0;h<j.length;h+=1){j[h]=this._trimAlignValue(f[h]);this._change(null,h)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(g)}else{return this.value()}}}else{return this._values()}},_setOption:function(g,h){var f,j=0;if(b.isArray(this.options.values)){j=this.options.values.length}b.Widget.prototype._setOption.apply(this,arguments);switch(g){case"disabled":if(h){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.propAttr("disabled",true);this.element.addClass("ui-disabled")}else{this.handles.propAttr("disabled",false);this.element.removeClass("ui-disabled")}break;case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(f=0;f<j;f+=1){this._change(null,f)}this._animateOff=false;break}},_value:function(){var f=this.options.value;f=this._trimAlignValue(f);return f},_values:function(f){var j,h,g;if(arguments.length){j=this.options.values[f];j=this._trimAlignValue(j);return j}else{h=this.options.values.slice();for(g=0;g<h.length;g+=1){h[g]=this._trimAlignValue(h[g])}return h}},_trimAlignValue:function(i){if(i<=this._valueMin()){return this._valueMin()}if(i>=this._valueMax()){return this._valueMax()}var f=(this.options.step>0)?this.options.step:1,h=(i-this._valueMin())%f,g=i-h;if(Math.abs(h)*2>=f){g+=(h>0)?f:(-f)}return parseFloat(g.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var i=this.options.range,h=this.options,s=this,g=(!this._animateOff)?h.animate:false,j,f={},k,q,p,r;if(this.options.values&&this.options.values.length){this.handles.each(function(u,t){j=(s.values(u)-s._valueMin())/(s._valueMax()-s._valueMin())*100;f[s.orientation==="horizontal"?"left":"bottom"]=j+"%";b(this).stop(1,1)[g?"animate":"css"](f,h.animate);if(s.options.range===true){if(s.orientation==="horizontal"){if(u===0){s.range.stop(1,1)[g?"animate":"css"]({left:j+"%"},h.animate)}if(u===1){s.range[g?"animate":"css"]({width:(j-k)+"%"},{queue:false,duration:h.animate})}}else{if(u===0){s.range.stop(1,1)[g?"animate":"css"]({bottom:(j)+"%"},h.animate)}if(u===1){s.range[g?"animate":"css"]({height:(j-k)+"%"},{queue:false,duration:h.animate})}}}k=j})}else{q=this.value();p=this._valueMin();r=this._valueMax();j=(r!==p)?(q-p)/(r-p)*100:0;f[s.orientation==="horizontal"?"left":"bottom"]=j+"%";this.handle.stop(1,1)[g?"animate":"css"](f,h.animate);if(i==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[g?"animate":"css"]({width:j+"%"},h.animate)}if(i==="max"&&this.orientation==="horizontal"){this.range[g?"animate":"css"]({width:(100-j)+"%"},{queue:false,duration:h.animate})}if(i==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[g?"animate":"css"]({height:j+"%"},h.animate)}if(i==="max"&&this.orientation==="vertical"){this.range[g?"animate":"css"]({height:(100-j)+"%"},{queue:false,duration:h.animate})}}}});b.extend(b.ui.slider,{version:"1.8.24"})}(jQuery));
/*
 * jQuery UI Tabs 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Tabs
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(f,h){var e=0,b=0;function g(){return ++e}function a(){return ++b}f.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(true)},_setOption:function(i,j){if(i=="selected"){if(this.options.collapsible&&j==this.options.selected){return}this.select(j)}else{this.options[i]=j;this._tabify()}},_tabId:function(i){return i.title&&i.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+g()},_sanitizeSelector:function(i){return i.replace(/:/g,"\\:")},_cookie:function(){var i=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+a());return f.cookie.apply(null,[i].concat(f.makeArray(arguments)))},_ui:function(j,i){return{tab:j,panel:i,index:this.anchors.index(j)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var i=f(this);i.html(i.data("label.tabs")).removeData("label.tabs")})},_tabify:function(z){var A=this,p=this.options,k=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=f(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return f("a",this)[0]});this.panels=f([]);this.anchors.each(function(D,B){var C=f(B).attr("href");var E=C.split("#")[0],F;if(E&&(E===location.toString().split("#")[0]||(F=f("base")[0])&&E===F.href)){C=B.hash;B.href=C}if(k.test(C)){A.panels=A.panels.add(A.element.find(A._sanitizeSelector(C)))}else{if(C&&C!=="#"){f.data(B,"href.tabs",C);f.data(B,"load.tabs",C.replace(/#.*$/,""));var H=A._tabId(B);B.href="#"+H;var G=A.element.find("#"+H);if(!G.length){G=f(p.panelTemplate).attr("id",H).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(A.panels[D-1]||A.list);G.data("destroy.tabs",true)}A.panels=A.panels.add(G)}else{p.disabled.push(D)}}});if(z){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(p.selected===h){if(location.hash){this.anchors.each(function(C,B){if(B.hash==location.hash){p.selected=C;return false}})}if(typeof p.selected!=="number"&&p.cookie){p.selected=parseInt(A._cookie(),10)}if(typeof p.selected!=="number"&&this.lis.filter(".ui-tabs-selected").length){p.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}p.selected=p.selected||(this.lis.length?0:-1)}else{if(p.selected===null){p.selected=-1}}p.selected=((p.selected>=0&&this.anchors[p.selected])||p.selected<0)?p.selected:0;p.disabled=f.unique(p.disabled.concat(f.map(this.lis.filter(".ui-state-disabled"),function(C,B){return A.lis.index(C)}))).sort();if(f.inArray(p.selected,p.disabled)!=-1){p.disabled.splice(f.inArray(p.selected,p.disabled),1)}this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");if(p.selected>=0&&this.anchors.length){A.element.find(A._sanitizeSelector(A.anchors[p.selected].hash)).removeClass("ui-tabs-hide");this.lis.eq(p.selected).addClass("ui-tabs-selected ui-state-active");A.element.queue("tabs",function(){A._trigger("show",null,A._ui(A.anchors[p.selected],A.element.find(A._sanitizeSelector(A.anchors[p.selected].hash))[0]))});this.load(p.selected)}f(window).bind("unload",function(){A.lis.add(A.anchors).unbind(".tabs");A.lis=A.anchors=A.panels=null})}else{p.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}this.element[p.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");if(p.cookie){this._cookie(p.selected,p.cookie)}for(var s=0,x;(x=this.lis[s]);s++){f(x)[f.inArray(s,p.disabled)!=-1&&!f(x).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled")}if(p.cache===false){this.anchors.removeData("cache.tabs")}this.lis.add(this.anchors).unbind(".tabs");if(p.event!=="mouseover"){var r=function(B,i){if(i.is(":not(.ui-state-disabled)")){i.addClass("ui-state-"+B)}};var u=function(B,i){i.removeClass("ui-state-"+B)};this.lis.bind("mouseover.tabs",function(){r("hover",f(this))});this.lis.bind("mouseout.tabs",function(){u("hover",f(this))});this.anchors.bind("focus.tabs",function(){r("focus",f(this).closest("li"))});this.anchors.bind("blur.tabs",function(){u("focus",f(this).closest("li"))})}var j,t;if(p.fx){if(f.isArray(p.fx)){j=p.fx[0];t=p.fx[1]}else{j=t=p.fx}}function q(i,B){i.css("display","");if(!f.support.opacity&&B.opacity){i[0].style.removeAttribute("filter")}}var v=t?function(i,B){f(i).closest("li").addClass("ui-tabs-selected ui-state-active");B.hide().removeClass("ui-tabs-hide").animate(t,t.duration||"normal",function(){q(B,t);A._trigger("show",null,A._ui(i,B[0]))})}:function(i,B){f(i).closest("li").addClass("ui-tabs-selected ui-state-active");B.removeClass("ui-tabs-hide");A._trigger("show",null,A._ui(i,B[0]))};var w=j?function(B,i){i.animate(j,j.duration||"normal",function(){A.lis.removeClass("ui-tabs-selected ui-state-active");i.addClass("ui-tabs-hide");q(i,j);A.element.dequeue("tabs")})}:function(B,i,C){A.lis.removeClass("ui-tabs-selected ui-state-active");i.addClass("ui-tabs-hide");A.element.dequeue("tabs")};this.anchors.bind(p.event+".tabs",function(){var B=this,D=f(B).closest("li"),i=A.panels.filter(":not(.ui-tabs-hide)"),C=A.element.find(A._sanitizeSelector(B.hash));if((D.hasClass("ui-tabs-selected")&&!p.collapsible)||D.hasClass("ui-state-disabled")||D.hasClass("ui-state-processing")||A.panels.filter(":animated").length||A._trigger("select",null,A._ui(this,C[0]))===false){this.blur();return false}p.selected=A.anchors.index(this);A.abort();if(p.collapsible){if(D.hasClass("ui-tabs-selected")){p.selected=-1;if(p.cookie){A._cookie(p.selected,p.cookie)}A.element.queue("tabs",function(){w(B,i)}).dequeue("tabs");this.blur();return false}else{if(!i.length){if(p.cookie){A._cookie(p.selected,p.cookie)}A.element.queue("tabs",function(){v(B,C)});A.load(A.anchors.index(this));this.blur();return false}}}if(p.cookie){A._cookie(p.selected,p.cookie)}if(C.length){if(i.length){A.element.queue("tabs",function(){w(B,i)})}A.element.queue("tabs",function(){v(B,C)});A.load(A.anchors.index(this))}else{throw"jQuery UI Tabs: Mismatching fragment identifier."}if(f.browser.msie){this.blur()}});this.anchors.bind("click.tabs",function(){return false})},_getIndex:function(i){if(typeof i=="string"){i=this.anchors.index(this.anchors.filter("[href$='"+i+"']"))}return i},destroy:function(){var i=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var j=f.data(this,"href.tabs");if(j){this.href=j}var k=f(this).unbind(".tabs");f.each(["href","load","cache"],function(p,q){k.removeData(q+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){if(f.data(this,"destroy.tabs")){f(this).remove()}else{f(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "))}});if(i.cookie){this._cookie(null,i.cookie)}return this},add:function(p,k,j){if(j===h){j=this.anchors.length}var i=this,r=this.options,t=f(r.tabTemplate.replace(/#\{href\}/g,p).replace(/#\{label\}/g,k)),s=!p.indexOf("#")?p.replace("#",""):this._tabId(f("a",t)[0]);t.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var q=i.element.find("#"+s);if(!q.length){q=f(r.panelTemplate).attr("id",s).data("destroy.tabs",true)}q.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(j>=this.lis.length){t.appendTo(this.list);q.appendTo(this.list[0].parentNode)}else{t.insertBefore(this.lis[j]);q.insertBefore(this.panels[j])}r.disabled=f.map(r.disabled,function(v,u){return v>=j?++v:v});this._tabify();if(this.anchors.length==1){r.selected=0;t.addClass("ui-tabs-selected ui-state-active");q.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){i._trigger("show",null,i._ui(i.anchors[0],i.panels[0]))});this.load(0)}this._trigger("add",null,this._ui(this.anchors[j],this.panels[j]));return this},remove:function(i){i=this._getIndex(i);var k=this.options,p=this.lis.eq(i).remove(),j=this.panels.eq(i).remove();if(p.hasClass("ui-tabs-selected")&&this.anchors.length>1){this.select(i+(i+1<this.anchors.length?1:-1))}k.disabled=f.map(f.grep(k.disabled,function(r,q){return r!=i}),function(r,q){return r>=i?--r:r});this._tabify();this._trigger("remove",null,this._ui(p.find("a")[0],j[0]));return this},enable:function(i){i=this._getIndex(i);var j=this.options;if(f.inArray(i,j.disabled)==-1){return}this.lis.eq(i).removeClass("ui-state-disabled");j.disabled=f.grep(j.disabled,function(p,k){return p!=i});this._trigger("enable",null,this._ui(this.anchors[i],this.panels[i]));return this},disable:function(j){j=this._getIndex(j);var i=this,k=this.options;if(j!=k.selected){this.lis.eq(j).addClass("ui-state-disabled");k.disabled.push(j);k.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[j],this.panels[j]))}return this},select:function(i){i=this._getIndex(i);if(i==-1){if(this.options.collapsible&&this.options.selected!=-1){i=this.options.selected}else{return this}}this.anchors.eq(i).trigger(this.options.event+".tabs");return this},load:function(p){p=this._getIndex(p);var j=this,r=this.options,i=this.anchors.eq(p)[0],k=f.data(i,"load.tabs");this.abort();if(!k||this.element.queue("tabs").length!==0&&f.data(i,"cache.tabs")){this.element.dequeue("tabs");return}this.lis.eq(p).addClass("ui-state-processing");if(r.spinner){var q=f("span",i);q.data("label.tabs",q.html()).html(r.spinner)}this.xhr=f.ajax(f.extend({},r.ajaxOptions,{url:k,success:function(u,t){j.element.find(j._sanitizeSelector(i.hash)).html(u);j._cleanup();if(r.cache){f.data(i,"cache.tabs",true)}j._trigger("load",null,j._ui(j.anchors[p],j.panels[p]));try{r.ajaxOptions.success(u,t)}catch(v){}},error:function(v,t,u){j._cleanup();j._trigger("load",null,j._ui(j.anchors[p],j.panels[p]));try{r.ajaxOptions.error(v,t,p,i)}catch(u){}}}));j.element.dequeue("tabs");return this},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._cleanup();return this},url:function(j,i){this.anchors.eq(j).removeData("cache.tabs").data("load.tabs",i);return this},length:function(){return this.anchors.length}});f.extend(f.ui.tabs,{version:"1.8.24"});f.extend(f.ui.tabs.prototype,{rotation:null,rotate:function(k,q){var i=this,r=this.options;var j=i._rotate||(i._rotate=function(s){clearTimeout(i.rotation);i.rotation=setTimeout(function(){var u=r.selected;i.select(++u<i.anchors.length?u:0)},k);if(s){s.stopPropagation()}});var p=i._unrotate||(i._unrotate=!q?function(s){if(s.clientX){i.rotate(null)}}:function(s){j()});if(k){this.element.bind("tabsshow",j);this.anchors.bind(r.event+".tabs",p);j()}else{clearTimeout(i.rotation);this.element.unbind("tabsshow",j);this.anchors.unbind(r.event+".tabs",p);delete this._rotate;delete this._unrotate}return this}})})(jQuery);
/*
 * jQuery UI Datepicker 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Datepicker
 *
 * Depends:
 *	jquery.ui.core.js
 */
(function($,undefined){$.extend($.ui,{datepicker:{version:"1.8.24"}});var PROP_NAME="datepicker";var dpuuid=new Date().getTime();var instActive;function Datepicker(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){if(this.debug){console.log.apply("",arguments)}},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase();var inline=(nodeName=="div"||nodeName=="span");if(!target.id){this.uuid+=1;target.id="dp"+this.uuid}var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{});if(nodeName=="input"){this._connectDatepicker(target,inst)}else{if(inline){this._inlineDatepicker(target,inst)}}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')))}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return}this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});this._autoSize(inst);$.data(target,PROP_NAME,inst);if(inst.settings.disabled){this._disableDatepicker(target)}},_attachments:function(input,inst){var appendText=this._get(inst,"appendText");var isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove()}if(appendText){inst.append=$('<span class="'+this._appendClass+'">'+appendText+"</span>");input[isRTL?"before":"after"](inst.append)}input.unbind("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove()}var showOn=this._get(inst,"showOn");if(showOn=="focus"||showOn=="both"){input.focus(this._showDatepicker)}if(showOn=="button"||showOn=="both"){var buttonText=this._get(inst,"buttonText");var buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$('<button type="button"></button>').addClass(this._triggerClass).html(buttonImage==""?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput==input[0]){$.datepicker._hideDatepicker()}else{if($.datepicker._datepickerShowing&&$.datepicker._lastInput!=input[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(input[0])}else{$.datepicker._showDatepicker(input[0])}}return false})}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var date=new Date(2009,12-1,20);var dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){var findMax=function(names){var max=0;var maxI=0;for(var i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i}}return maxI};date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))));date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay())}inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return}divSpan.addClass(this.markerClassName).append(inst.dpDiv).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});$.data(target,PROP_NAME,inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target)}inst.dpDiv.css("display","block")},_dialogDatepicker:function(input,date,onSelect,settings,pos){var inst=this._dialogInst;if(!inst){this.uuid+=1;var id="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+id+'" style="position: absolute; top: -100px; width: 0px;"/>');this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],PROP_NAME,inst)}extendRemove(inst.settings,settings||{});date=(date&&date.constructor==Date?this._formatDate(inst,date):date);this._dialogInput.val(date);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){var browserWidth=document.documentElement.clientWidth;var browserHeight=document.documentElement.clientHeight;var scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;var scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],PROP_NAME,inst);return this},_destroyDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();$.removeData(target,PROP_NAME);if(nodeName=="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(nodeName=="div"||nodeName=="span"){$target.removeClass(this.markerClassName).empty()}}},_enableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)})},_disableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)});this._disabledInputs[this._disabledInputs.length]=target},_isDisabledDatepicker:function(target){if(!target){return false}for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]==target){return true}}return false},_getInst:function(target){try{return $.data(target,PROP_NAME)}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var inst=this._getInst(target);if(arguments.length==2&&typeof name=="string"){return(name=="defaults"?$.extend({},$.datepicker._defaults):(inst?(name=="all"?$.extend({},inst.settings):this._get(inst,name)):null))}var settings=name||{};if(typeof name=="string"){settings={};settings[name]=value}if(inst){if(this._curInst==inst){this._hideDatepicker()}var date=this._getDateDatepicker(target,true);var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate)}if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate)}this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst)}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst)}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst)}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault)}return(inst?this._getDate(inst):null)},_doKeyDown:function(event){var inst=$.datepicker._getInst(event.target);var handled=true;var isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:var sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0])}var onSelect=$.datepicker._get(inst,"onSelect");if(onSelect){var dateStr=$.datepicker._formatDate(inst);onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{$.datepicker._hideDatepicker()}return false;break;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target)}handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target)}handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M")}break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D")}handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M")}break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D")}handled=event.ctrlKey||event.metaKey;break;default:handled=false}}else{if(event.keyCode==36&&event.ctrlKey){$.datepicker._showDatepicker(this)}else{handled=false}}if(handled){event.preventDefault();event.stopPropagation()}},_doKeyPress:function(event){var inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){var chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));var chr=String.fromCharCode(event.charCode==undefined?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1)}},_doKeyUp:function(event){var inst=$.datepicker._getInst(event.target);if(inst.input.val()!=inst.lastVal){try{var date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst)}}catch(err){$.datepicker.log(err)}}return true},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!="input"){input=$("input",input.parentNode)[0]}if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput==input){return}var inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!=inst){$.datepicker._curInst.dpDiv.stop(true,true);if(inst&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0])}}var beforeShow=$.datepicker._get(inst,"beforeShow");var beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};if(beforeShowSettings===false){return}extendRemove(inst.settings,beforeShowSettings);inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight}var isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")=="fixed";return !isFixed});if(isFixed&&$.browser.opera){$.datepicker._pos[0]-=document.documentElement.scrollLeft;$.datepicker._pos[1]-=document.documentElement.scrollTop}var offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){var showAnim=$.datepicker._get(inst,"showAnim");var duration=$.datepicker._get(inst,"duration");var postProcess=function(){var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){var borders=$.datepicker._getBorders(inst.dpDiv);cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}};inst.dpDiv.zIndex($(input).zIndex()+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects[showAnim]){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[showAnim||"show"]((showAnim?duration:null),postProcess)}if(!showAnim||!duration){postProcess()}if(inst.input.is(":visible")&&!inst.input.is(":disabled")){inst.input.focus()}$.datepicker._curInst=inst}},_updateDatepicker:function(inst){var self=this;self.maxRows=4;var borders=$.datepicker._getBorders(inst.dpDiv);instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));this._attachHandlers(inst);var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}inst.dpDiv.find("."+this._dayOverClass+" a").mouseover();var numMonths=this._getNumberOfMonths(inst);var cols=numMonths[1];var width=17;inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em")}inst.dpDiv[(numMonths[0]!=1||numMonths[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst==$.datepicker._curInst&&$.datepicker._datepickerShowing&&inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&inst.input[0]!=document.activeElement){inst.input.focus()}if(inst.yearshtml){var origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml)}origyearshtml=inst.yearshtml=null},0)}},_getBorders:function(elem){var convert=function(value){return{thin:1,medium:2,thick:3}[value]||value};return[parseFloat(convert(elem.css("border-left-width"))),parseFloat(convert(elem.css("border-top-width")))]},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth();var dpHeight=inst.dpDiv.outerHeight();var inputWidth=inst.input?inst.input.outerWidth():0;var inputHeight=inst.input?inst.input.outerHeight():0;var viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft());var viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left==inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top==(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight):0);return offset},_findPos:function(obj){var inst=this._getInst(obj);var isRTL=this._get(inst,"isRTL");while(obj&&(obj.type=="hidden"||obj.nodeType!=1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"]}var position=$(obj).offset();return[position.left,position.top]},_hideDatepicker:function(input){var inst=this._curInst;if(!inst||(input&&inst!=$.data(input,PROP_NAME))){return}if(this._datepickerShowing){var showAnim=this._get(inst,"showAnim");var duration=this._get(inst,"duration");var postProcess=function(){$.datepicker._tidyDialog(inst)};if($.effects&&$.effects[showAnim]){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[(showAnim=="slideDown"?"slideUp":(showAnim=="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess)}if(!showAnim){postProcess()}this._datepickerShowing=false;var onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if(!$.datepicker._curInst){return}var $target=$(event.target),inst=$.datepicker._getInst($target[0]);if((($target[0].id!=$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length==0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||($target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=inst)){$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id);var inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return}this._adjustInstDate(inst,offset+(period=="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst)},_gotoToday:function(id){var target=$(id);var inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear}else{var date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear()}this._notifyChange(inst);this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id);var inst=this._getInst(target[0]);inst["selected"+(period=="M"?"Month":"Year")]=inst["draw"+(period=="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target)},_selectDay:function(id,month,year,td){var target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return}var inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear))},_clearDate:function(id){var target=$(id);var inst=this._getInst(target[0]);this._selectDate(target,"")},_selectDate:function(id,dateStr){var target=$(id);var inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(inst.input){inst.input.val(dateStr)}this._updateAlternate(inst);var onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{if(inst.input){inst.input.trigger("change")}}if(inst.inline){this._updateDatepicker(inst)}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof(inst.input[0])!="object"){inst.input.focus()}this._lastInput=null}},_updateAlternate:function(inst){var altField=this._get(inst,"altField");if(altField){var altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");var date=this._getDate(inst);var dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr)})}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""]},iso8601Week:function(date){var checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments"}value=(typeof value=="object"?value.toString():value+"");if(value==""){return null}var shortYearCutoff=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff;shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var year=-1;var month=-1;var day=-1;var doy=-1;var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var getNumber=function(match){var isDoubled=lookAhead(match);var size=(match=="@"?14:(match=="!"?20:(match=="y"&&isDoubled?4:(match=="o"?3:2))));var digits=new RegExp("^\\d{1,"+size+"}");var num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue}iValue+=num[0].length;return parseInt(num[0],10)};var getName=function(match,shortNames,longNames){var names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return -(a[1].length-b[1].length)});var index=-1;$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()==name.toLowerCase()){index=pair[0];iValue+=name.length;return false}});if(index!=-1){return index+1}else{throw"Unknown name at position "+iValue}};var checkLiteral=function(){if(value.charAt(iValue)!=format.charAt(iFormat)){throw"Unexpected literal at position "+iValue}iValue++};var iValue=0;for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{checkLiteral()}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":var date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":var date=new Date((getNumber("!")-this._ticksTo1970)/10000);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral()}else{literal=true}break;default:checkLiteral()}}}if(iValue<value.length){throw"Extra/unparsed characters found in date: "+value.substring(iValue)}if(year==-1){year=new Date().getFullYear()}else{if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+(year<=shortYearCutoff?0:-100)}}if(doy>-1){month=1;day=doy;do{var dim=this._getDaysInMonth(year,month-1);if(day<=dim){break}month++;day-=dim}while(true)}var date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!=year||date.getMonth()+1!=month||date.getDate()!=day){throw"Invalid date"}return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(format,date,settings){if(!date){return""}var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num}}return num};var formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value])};var output="";var literal=false;if(date){for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{output+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*10000+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'"}else{literal=true}break;default:output+=format.charAt(iFormat)}}}}return output},_possibleChars:function(format){var chars="";var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{chars+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'"}else{literal=true}break;default:chars+=format.charAt(iFormat)}}}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()==inst.lastVal){return}var dateFormat=this._get(inst,"dateFormat");var dates=inst.lastVal=inst.input?inst.input.val():null;var date,defaultDate;date=defaultDate=this._getDefaultDate(inst);var settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){this.log(event);dates=(noDefault?"":dates)}inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates?date.getDate():0);inst.currentMonth=(dates?date.getMonth():0);inst.currentYear=(dates?date.getFullYear():0);this._adjustInstDate(inst)},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setDate(date.getDate()+offset);return date};var offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date();var year=date.getFullYear();var month=date.getMonth();var day=date.getDate();var pattern=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;var matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break}matches=pattern.exec(offset)}return new Date(year,month,day)};var newDate=(date==null||date===""?defaultDate:(typeof date=="string"?offsetString(date):(typeof date=="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));newDate=(newDate&&newDate.toString()=="Invalid Date"?defaultDate:newDate);if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0)}return this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){if(!date){return null}date.setHours(date.getHours()>12?date.getHours()+2:0);return date},_setDate:function(inst,date,noChange){var clear=!date;var origMonth=inst.selectedMonth;var origYear=inst.selectedYear;var newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!=inst.selectedMonth||origYear!=inst.selectedYear)&&!noChange){this._notifyChange(inst)}this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst))}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()=="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return startDate},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths");var id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(id,-stepMonths,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(id)},selectDay:function(){window["DP_jQuery_"+dpuuid].datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(id,this,"M");return false},selectYear:function(){window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(id,this,"Y");return false}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var today=new Date();today=this._daylightSavingAdjust(new Date(today.getFullYear(),today.getMonth(),today.getDate()));var isRTL=this._get(inst,"isRTL");var showButtonPanel=this._get(inst,"showButtonPanel");var hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext");var navigationAsDateFormat=this._get(inst,"navigationAsDateFormat");var numMonths=this._getNumberOfMonths(inst);var showCurrentAtPos=this._get(inst,"showCurrentAtPos");var stepMonths=this._get(inst,"stepMonths");var isMultiMonth=(numMonths[0]!=1||numMonths[1]!=1);var currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var drawMonth=inst.drawMonth-showCurrentAtPos;var drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--}if(maxDate){var maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--}}}inst.drawMonth=drawMonth;inst.drawYear=drawYear;var prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)));var prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>"));var nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)));var next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>"));var currentText=this._get(inst,"currentText");var gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));var controls=(!inst.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(inst,"closeText")+"</button>":"");var buttonPanel=(showButtonPanel)?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";var firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=(isNaN(firstDay)?0:firstDay);var showWeek=this._get(inst,"showWeek");var dayNames=this._get(inst,"dayNames");var dayNamesShort=this._get(inst,"dayNamesShort");var dayNamesMin=this._get(inst,"dayNamesMin");var monthNames=this._get(inst,"monthNames");var monthNamesShort=this._get(inst,"monthNamesShort");var beforeShowDay=this._get(inst,"beforeShowDay");var showOtherMonths=this._get(inst,"showOtherMonths");var selectOtherMonths=this._get(inst,"selectOtherMonths");var calculateWeek=this._get(inst,"calculateWeek")||this.iso8601Week;var defaultDate=this._getDefaultDate(inst);var html="";for(var row=0;row<numMonths[0];row++){var group="";this.maxRows=4;for(var col=0;col<numMonths[1];col++){var selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));var cornerClass=" ui-corner-all";var calender="";if(isMultiMonth){calender+='<div class="ui-datepicker-group';if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break}}calender+='">'}calender+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+cornerClass+'">'+(/all|left/.test(cornerClass)&&row==0?(isRTL?next:prev):"")+(/all|right/.test(cornerClass)&&row==0?(isRTL?prev:next):"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var thead=(showWeek?'<th class="ui-datepicker-week-col">'+this._get(inst,"weekHeader")+"</th>":"");for(var dow=0;dow<7;dow++){var day=(dow+firstDay)%7;thead+="<th"+((dow+firstDay+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+dayNames[day]+'">'+dayNamesMin[day]+"</span></th>"}calender+=thead+"</tr></thead><tbody>";var daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear==inst.selectedYear&&drawMonth==inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)}var leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;var curRows=Math.ceil((leadDays+daysInMonth)/7);var numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;var printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(var dRow=0;dRow<numRows;dRow++){calender+="<tr>";var tbody=(!showWeek?"":'<td class="ui-datepicker-week-col">'+this._get(inst,"calculateWeek")(printDate)+"</td>");for(var dow=0;dow<7;dow++){var daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);var otherMonth=(printDate.getMonth()!=drawMonth);var unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);tbody+='<td class="'+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+((printDate.getTime()==selectedDate.getTime()&&drawMonth==inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()==printDate.getTime()&&defaultDate.getTime()==selectedDate.getTime())?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()==currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()==today.getTime()?" ui-datepicker-today":""))+'"'+((!otherMonth||showOtherMonths)&&daySettings[2]?' title="'+daySettings[2]+'"':"")+(unselectable?"":' data-handler="selectDay" data-event="click" data-month="'+printDate.getMonth()+'" data-year="'+printDate.getFullYear()+'"')+">"+(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?'<span class="ui-state-default">'+printDate.getDate()+"</span>":'<a class="ui-state-default'+(printDate.getTime()==today.getTime()?" ui-state-highlight":"")+(printDate.getTime()==currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+'" href="#">'+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate)}calender+=tbody+"</tr>"}drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++}calender+="</tbody></table>"+(isMultiMonth?"</div>"+((numMonths[0]>0&&col==numMonths[1]-1)?'<div class="ui-datepicker-row-break"></div>':""):"");group+=calender}html+=group}html+=buttonPanel+($.browser.msie&&parseInt($.browser.version,10)<7&&!inst.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");inst._keyEvent=false;return html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var changeMonth=this._get(inst,"changeMonth");var changeYear=this._get(inst,"changeYear");var showMonthAfterYear=this._get(inst,"showMonthAfterYear");var html='<div class="ui-datepicker-title">';var monthHtml="";if(secondary||!changeMonth){monthHtml+='<span class="ui-datepicker-month">'+monthNames[drawMonth]+"</span>"}else{var inMinYear=(minDate&&minDate.getFullYear()==drawYear);var inMaxYear=(maxDate&&maxDate.getFullYear()==drawYear);monthHtml+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+='<option value="'+month+'"'+(month==drawMonth?' selected="selected"':"")+">"+monthNamesShort[month]+"</option>"}}monthHtml+="</select>"}if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")}if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+='<span class="ui-datepicker-year">'+drawYear+"</span>"}else{var years=this._get(inst,"yearRange").split(":");var thisYear=new Date().getFullYear();var determineYear=function(value){var year=(value.match(/c[+-].*/)?drawYear+parseInt(value.substring(1),10):(value.match(/[+-].*/)?thisYear+parseInt(value,10):parseInt(value,10)));return(isNaN(year)?thisYear:year)};var year=determineYear(years[0]);var endYear=Math.max(year,determineYear(years[1]||""));year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);inst.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';for(;year<=endYear;year++){inst.yearshtml+='<option value="'+year+'"'+(year==drawYear?' selected="selected"':"")+">"+year+"</option>"}inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null}}html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml}html+="</div>";return html},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period=="Y"?offset:0);var month=inst.drawMonth+(period=="M"?offset:0);var day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period=="D"?offset:0);var date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period=="M"||period=="Y"){this._notifyChange(inst)}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var newDate=(minDate&&date<minDate?minDate:date);newDate=(maxDate&&newDate>maxDate?maxDate:newDate);return newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst])}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths=="number"?[1,numMonths]:numMonths))},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst);var date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()))}return this._isInRange(inst,date)},_isInRange:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");return((!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime()))},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear}var date=(day?(typeof day=="object"?day:this._daylightSavingAdjust(new Date(year,month,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}});function bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.bind("mouseout",function(event){var elem=$(event.target).closest(selector);if(!elem.length){return}elem.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(event){var elem=$(event.target).closest(selector);if($.datepicker._isDisabledDatepicker(instActive.inline?dpDiv.parent()[0]:instActive.input[0])||!elem.length){return}elem.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");elem.addClass("ui-state-hover");if(elem.hasClass("ui-datepicker-prev")){elem.addClass("ui-datepicker-prev-hover")}if(elem.hasClass("ui-datepicker-next")){elem.addClass("ui-datepicker-next-hover")}})}function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null||props[name]==undefined){target[name]=props[name]}}return target}function isArray(a){return(a&&(($.browser.safari&&typeof a=="object"&&a.length)||(a.constructor&&a.constructor.toString().match(/\Array\(\)/))))}$.fn.datepicker=function(options){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv);$.datepicker.initialized=true}var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options=="string"&&(options=="isDisabled"||options=="getDate"||options=="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}if(options=="option"&&arguments.length==2&&typeof arguments[1]=="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}return this.each(function(){typeof options=="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)})};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.8.24";window["DP_jQuery_"+dpuuid]=$})(jQuery);
/*
 * jQuery UI Progressbar 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Progressbar
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove();a.Widget.prototype.destroy.apply(this,arguments)},value:function(e){if(e===b){return this._value()}this._setOption("value",e);return this},_setOption:function(e,f){if(e==="value"){this.options.value=f;this._refreshValue();if(this._value()===this.options.max){this._trigger("complete")}}a.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var e=this.options.value;if(typeof e!=="number"){e=0}return Math.min(this.options.max,Math.max(this.min,e))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var f=this.value();var e=this._percentage();if(this.oldValue!==f){this.oldValue=f;this._trigger("change")}this.valueDiv.toggle(f>this.min).toggleClass("ui-corner-right",f===this.options.max).width(e.toFixed(0)+"%");this.element.attr("aria-valuenow",f)}});a.extend(a.ui.progressbar,{version:"1.8.24"})})(jQuery);
/*
 * jQuery UI Effects 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/
 */
jQuery.effects||(function(j,g){j.effects={};j.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(u,t){j.fx.step[t]=function(v){if(!v.colorInit){v.start=s(v.elem,t);v.end=q(v.end);v.colorInit=true}v.elem.style[t]="rgb("+Math.max(Math.min(parseInt((v.pos*(v.end[0]-v.start[0]))+v.start[0],10),255),0)+","+Math.max(Math.min(parseInt((v.pos*(v.end[1]-v.start[1]))+v.start[1],10),255),0)+","+Math.max(Math.min(parseInt((v.pos*(v.end[2]-v.start[2]))+v.start[2],10),255),0)+")"}});function q(u){var t;if(u&&u.constructor==Array&&u.length==3){return u}if(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(u)){return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)]}if(t=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(u)){return[parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55]}if(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(u)){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}if(t=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(u)){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}if(t=/rgba\(0, 0, 0, 0\)/.exec(u)){return a.transparent}return a[j.trim(u).toLowerCase()]}function s(v,t){var u;do{u=(j.curCSS||j.css)(v,t);if(u!=""&&u!="transparent"||j.nodeName(v,"body")){break}t="backgroundColor"}while(v=v.parentNode);return q(u)}var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};var h=["add","remove","toggle"],e={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function i(){var w=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,x={},u,v;if(w&&w.length&&w[0]&&w[w[0]]){var t=w.length;while(t--){u=w[t];if(typeof w[u]=="string"){v=u.replace(/\-(\w)/g,function(z,A){return A.toUpperCase()});x[v]=w[u]}}}else{for(u in w){if(typeof w[u]==="string"){x[u]=w[u]}}}return x}function b(u){var t,v;for(t in u){v=u[t];if(v==null||j.isFunction(v)||t in e||(/scrollbar/).test(t)||(!(/color/i).test(t)&&isNaN(parseFloat(v)))){delete u[t]}}return u}function k(t,v){var w={_:0},u;for(u in v){if(t[u]!=v[u]){w[u]=v[u]}}return w}j.effects.animateClass=function(t,u,w,v){if(j.isFunction(w)){v=w;w=null}return this.queue(function(){var B=j(this),x=B.attr("style")||" ",C=b(i.call(this)),A,z=B.attr("class")||"";j.each(h,function(D,E){if(t[E]){B[E+"Class"](t[E])}});A=b(i.call(this));B.attr("class",z);B.animate(k(C,A),{queue:false,duration:u,easing:w,complete:function(){j.each(h,function(D,E){if(t[E]){B[E+"Class"](t[E])}});if(typeof B.attr("style")=="object"){B.attr("style").cssText="";B.attr("style").cssText=x}else{B.attr("style",x)}if(v){v.apply(this,arguments)}j.dequeue(this)}})})};j.fn.extend({_addClass:j.fn.addClass,addClass:function(u,t,w,v){return t?j.effects.animateClass.apply(this,[{add:u},t,w,v]):this._addClass(u)},_removeClass:j.fn.removeClass,removeClass:function(u,t,w,v){return t?j.effects.animateClass.apply(this,[{remove:u},t,w,v]):this._removeClass(u)},_toggleClass:j.fn.toggleClass,toggleClass:function(v,u,t,x,w){if(typeof u=="boolean"||u===g){if(!t){return this._toggleClass(v,u)}else{return j.effects.animateClass.apply(this,[(u?{add:v}:{remove:v}),t,x,w])}}else{return j.effects.animateClass.apply(this,[{toggle:v},u,t,x])}},switchClass:function(t,v,u,x,w){return j.effects.animateClass.apply(this,[{add:v,remove:t},u,x,w])}});j.extend(j.effects,{version:"1.8.24",save:function(u,v){for(var t=0;t<v.length;t++){if(v[t]!==null){u.data("ec.storage."+v[t],u[0].style[v[t]])}}},restore:function(u,v){for(var t=0;t<v.length;t++){if(v[t]!==null){u.css(v[t],u.data("ec.storage."+v[t]))}}},setMode:function(t,u){if(u=="toggle"){u=t.is(":hidden")?"show":"hide"}return u},getBaseline:function(u,v){var w,t;switch(u[0]){case"top":w=0;break;case"middle":w=0.5;break;case"bottom":w=1;break;default:w=u[0]/v.height}switch(u[1]){case"left":t=0;break;case"center":t=0.5;break;case"right":t=1;break;default:t=u[1]/v.width}return{x:t,y:w}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper")){return t.parent()}var u={width:t.outerWidth(true),height:t.outerHeight(true),"float":t.css("float")},x=j("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),w=document.activeElement;try{w.id}catch(v){w=document.body}t.wrap(x);if(t[0]===w||j.contains(t[0],w)){j(w).focus()}x=t.parent();if(t.css("position")=="static"){x.css({position:"relative"});t.css({position:"relative"})}else{j.extend(u,{position:t.css("position"),zIndex:t.css("z-index")});j.each(["top","left","bottom","right"],function(z,A){u[A]=t.css(A);if(isNaN(parseInt(u[A],10))){u[A]="auto"}});t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}return x.css(u).show()},removeWrapper:function(t){var u,v=document.activeElement;if(t.parent().is(".ui-effects-wrapper")){u=t.parent().replaceWith(t);if(t[0]===v||j.contains(t[0],v)){j(v).focus()}return u}return t},setTransition:function(u,w,t,v){v=v||{};j.each(w,function(A,z){var B=u.cssUnit(z);if(B[0]>0){v[z]=B[0]*t+B[1]}});return v}});function f(u,t,v,w){if(typeof u=="object"){w=t;v=null;t=u;u=t.effect}if(j.isFunction(t)){w=t;v=null;t={}}if(typeof t=="number"||j.fx.speeds[t]){w=v;v=t;t={}}if(j.isFunction(v)){w=v;v=null}t=t||{};v=v||t.duration;v=j.fx.off?0:typeof v=="number"?v:v in j.fx.speeds?j.fx.speeds[v]:j.fx.speeds._default;w=w||t.complete;return[u,t,v,w]}function r(t){if(!t||typeof t==="number"||j.fx.speeds[t]){return true}if(typeof t==="string"&&!j.effects[t]){return true}return false}j.fn.extend({effect:function(w,v,z,B){var u=f.apply(this,arguments),x={options:u[1],duration:u[2],callback:u[3]},A=x.options.mode,t=j.effects[w];if(j.fx.off||!t){if(A){return this[A](x.duration,x.callback)}else{return this.each(function(){if(x.callback){x.callback.call(this)}})}}return t.call(this,x)},_show:j.fn.show,show:function(u){if(r(u)){return this._show.apply(this,arguments)}else{var t=f.apply(this,arguments);t[1].mode="show";return this.effect.apply(this,t)}},_hide:j.fn.hide,hide:function(u){if(r(u)){return this._hide.apply(this,arguments)}else{var t=f.apply(this,arguments);t[1].mode="hide";return this.effect.apply(this,t)}},__toggle:j.fn.toggle,toggle:function(u){if(r(u)||typeof u==="boolean"||j.isFunction(u)){return this.__toggle.apply(this,arguments)}else{var t=f.apply(this,arguments);t[1].mode="toggle";return this.effect.apply(this,t)}},cssUnit:function(t){var u=this.css(t),v=[];j.each(["em","px","%","pt"],function(w,x){if(u.indexOf(x)>0){v=[parseFloat(u),x]}});return v}});var p={};j.each(["Quad","Cubic","Quart","Quint","Expo"],function(u,t){p[t]=function(v){return Math.pow(v,u+2)}});j.extend(p,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return t===0||t===1?t:-Math.pow(2,8*(t-1))*Math.sin(((t-1)*80-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(v){var t,u=4;while(v<((t=Math.pow(2,--u))-1)/11){}return 1/Math.pow(4,3-u)-7.5625*Math.pow((t*3-2)/22-v,2)}});j.each(p,function(u,t){j.easing["easeIn"+u]=t;j.easing["easeOut"+u]=function(v){return 1-t(1-v)};j.easing["easeInOut"+u]=function(v){return v<0.5?t(v*2)/2:t(v*-2+2)/-2+1}})})(jQuery);
/*
 * jQuery UI Effects Blind 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Blind
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.blind=function(e){return this.queue(function(){var g=a(this),f=["position","top","bottom","left","right"];var k=a.effects.setMode(g,e.options.mode||"hide");var j=e.options.direction||"vertical";a.effects.save(g,f);g.show();var q=a.effects.createWrapper(g).css({overflow:"hidden"});var h=(j=="vertical")?"height":"width";var p=(j=="vertical")?q.height():q.width();if(k=="show"){q.css(h,0)}var i={};i[h]=k=="show"?p:0;q.animate(i,e.duration,e.options.easing,function(){if(k=="hide"){g.hide()}a.effects.restore(g,f);a.effects.removeWrapper(g);if(e.callback){e.callback.apply(g[0],arguments)}g.dequeue()})})}})(jQuery);
/*
 * jQuery UI Effects Bounce 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Bounce
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.bounce=function(e){return this.queue(function(){var h=a(this),s=["position","top","bottom","left","right"];var r=a.effects.setMode(h,e.options.mode||"effect");var u=e.options.direction||"up";var f=e.options.distance||20;var g=e.options.times||5;var k=e.duration||250;if(/show|hide/.test(r)){s.push("opacity")}a.effects.save(h,s);h.show();a.effects.createWrapper(h);var j=(u=="up"||u=="down")?"top":"left";var w=(u=="up"||u=="left")?"pos":"neg";var f=e.options.distance||(j=="top"?h.outerHeight(true)/3:h.outerWidth(true)/3);if(r=="show"){h.css("opacity",0).css(j,w=="pos"?-f:f)}if(r=="hide"){f=f/(g*2)}if(r!="hide"){g--}if(r=="show"){var p={opacity:1};p[j]=(w=="pos"?"+=":"-=")+f;h.animate(p,k/2,e.options.easing);f=f/2;g--}for(var q=0;q<g;q++){var v={},t={};v[j]=(w=="pos"?"-=":"+=")+f;t[j]=(w=="pos"?"+=":"-=")+f;h.animate(v,k/2,e.options.easing).animate(t,k/2,e.options.easing);f=(r=="hide")?f*2:f/2}if(r=="hide"){var p={opacity:0};p[j]=(w=="pos"?"-=":"+=")+f;h.animate(p,k/2,e.options.easing,function(){h.hide();a.effects.restore(h,s);a.effects.removeWrapper(h);if(e.callback){e.callback.apply(this,arguments)}})}else{var v={},t={};v[j]=(w=="pos"?"-=":"+=")+f;t[j]=(w=="pos"?"+=":"-=")+f;h.animate(v,k/2,e.options.easing).animate(t,k/2,e.options.easing,function(){a.effects.restore(h,s);a.effects.removeWrapper(h);if(e.callback){e.callback.apply(this,arguments)}})}h.queue("fx",function(){h.dequeue()});h.dequeue()})}})(jQuery);
/*
 * jQuery UI Effects Clip 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Clip
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.clip=function(e){return this.queue(function(){var i=a(this),q=["position","top","bottom","left","right","height","width"];var p=a.effects.setMode(i,e.options.mode||"hide");var r=e.options.direction||"vertical";a.effects.save(i,q);i.show();var f=a.effects.createWrapper(i).css({overflow:"hidden"});var h=i[0].tagName=="IMG"?f:i;var j={size:(r=="vertical")?"height":"width",position:(r=="vertical")?"top":"left"};var g=(r=="vertical")?h.height():h.width();if(p=="show"){h.css(j.size,0);h.css(j.position,g/2)}var k={};k[j.size]=p=="show"?g:0;k[j.position]=p=="show"?0:g/2;h.animate(k,{queue:false,duration:e.duration,easing:e.options.easing,complete:function(){if(p=="hide"){i.hide()}a.effects.restore(i,q);a.effects.removeWrapper(i);if(e.callback){e.callback.apply(i[0],arguments)}i.dequeue()}})})}})(jQuery);
/*
 * jQuery UI Effects Drop 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Drop
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.drop=function(e){return this.queue(function(){var h=a(this),g=["position","top","bottom","left","right","opacity"];var p=a.effects.setMode(h,e.options.mode||"hide");var k=e.options.direction||"left";a.effects.save(h,g);h.show();a.effects.createWrapper(h);var i=(k=="up"||k=="down")?"top":"left";var f=(k=="up"||k=="left")?"pos":"neg";var q=e.options.distance||(i=="top"?h.outerHeight(true)/2:h.outerWidth(true)/2);if(p=="show"){h.css("opacity",0).css(i,f=="pos"?-q:q)}var j={opacity:p=="show"?1:0};j[i]=(p=="show"?(f=="pos"?"+=":"-="):(f=="pos"?"-=":"+="))+q;h.animate(j,{queue:false,duration:e.duration,easing:e.options.easing,complete:function(){if(p=="hide"){h.hide()}a.effects.restore(h,g);a.effects.removeWrapper(h);if(e.callback){e.callback.apply(this,arguments)}h.dequeue()}})})}})(jQuery);
/*
 * jQuery UI Effects Explode 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Explode
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.explode=function(e){return this.queue(function(){var r=e.options.pieces?Math.round(Math.sqrt(e.options.pieces)):3;var h=e.options.pieces?Math.round(Math.sqrt(e.options.pieces)):3;e.options.mode=e.options.mode=="toggle"?(a(this).is(":visible")?"hide":"show"):e.options.mode;var q=a(this).show().css("visibility","hidden");var s=q.offset();s.top-=parseInt(q.css("marginTop"),10)||0;s.left-=parseInt(q.css("marginLeft"),10)||0;var p=q.outerWidth(true);var f=q.outerHeight(true);for(var k=0;k<r;k++){for(var g=0;g<h;g++){q.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-g*(p/h),top:-k*(f/r)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:p/h,height:f/r,left:s.left+g*(p/h)+(e.options.mode=="show"?(g-Math.floor(h/2))*(p/h):0),top:s.top+k*(f/r)+(e.options.mode=="show"?(k-Math.floor(r/2))*(f/r):0),opacity:e.options.mode=="show"?0:1}).animate({left:s.left+g*(p/h)+(e.options.mode=="show"?0:(g-Math.floor(h/2))*(p/h)),top:s.top+k*(f/r)+(e.options.mode=="show"?0:(k-Math.floor(r/2))*(f/r)),opacity:e.options.mode=="show"?1:0},e.duration||500)}}setTimeout(function(){e.options.mode=="show"?q.css({visibility:"visible"}):q.css({visibility:"visible"}).hide();if(e.callback){e.callback.apply(q[0])}q.dequeue();a("div.ui-effects-explode").remove()},e.duration||500)})}})(jQuery);
/*
 * jQuery UI Effects Fade 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fade
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.fade=function(e){return this.queue(function(){var f=a(this),g=a.effects.setMode(f,e.options.mode||"hide");f.animate({opacity:g},{queue:false,duration:e.duration,easing:e.options.easing,complete:function(){(e.callback&&e.callback.apply(this,arguments));f.dequeue()}})})}})(jQuery);
/*
 * jQuery UI Effects Fold 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fold
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.fold=function(e){return this.queue(function(){var h=a(this),r=["position","top","bottom","left","right"];var k=a.effects.setMode(h,e.options.mode||"hide");var v=e.options.size||15;var u=!(!e.options.horizFirst);var j=e.duration?e.duration/2:a.fx.speeds._default/2;a.effects.save(h,r);h.show();var g=a.effects.createWrapper(h).css({overflow:"hidden"});var p=((k=="show")!=u);var i=p?["width","height"]:["height","width"];var f=p?[g.width(),g.height()]:[g.height(),g.width()];var q=/([0-9]+)%/.exec(v);if(q){v=parseInt(q[1],10)/100*f[k=="hide"?0:1]}if(k=="show"){g.css(u?{height:0,width:v}:{height:v,width:0})}var t={},s={};t[i[0]]=k=="show"?f[0]:v;s[i[1]]=k=="show"?f[1]:0;g.animate(t,j,e.options.easing).animate(s,j,e.options.easing,function(){if(k=="hide"){h.hide()}a.effects.restore(h,r);a.effects.removeWrapper(h);if(e.callback){e.callback.apply(h[0],arguments)}h.dequeue()})})}})(jQuery);
/*
 * jQuery UI Effects Highlight 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Highlight
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.highlight=function(e){return this.queue(function(){var g=a(this),f=["backgroundImage","backgroundColor","opacity"],i=a.effects.setMode(g,e.options.mode||"show"),h={backgroundColor:g.css("backgroundColor")};if(i=="hide"){h.opacity=0}a.effects.save(g,f);g.show().css({backgroundImage:"none",backgroundColor:e.options.color||"#ffff99"}).animate(h,{queue:false,duration:e.duration,easing:e.options.easing,complete:function(){(i=="hide"&&g.hide());a.effects.restore(g,f);(i=="show"&&!a.support.opacity&&this.style.removeAttribute("filter"));(e.callback&&e.callback.apply(this,arguments));g.dequeue()}})})}})(jQuery);
/*
 * jQuery UI Effects Pulsate 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Pulsate
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.pulsate=function(e){return this.queue(function(){var j=a(this),q=a.effects.setMode(j,e.options.mode||"show"),p=((e.options.times||5)*2)-1,k=e.duration?e.duration/2:a.fx.speeds._default/2,f=j.is(":visible"),g=0;if(!f){j.css("opacity",0).show();g=1}if((q=="hide"&&f)||(q=="show"&&!f)){p--}for(var h=0;h<p;h++){j.animate({opacity:g},k,e.options.easing);g=(g+1)%2}j.animate({opacity:g},k,e.options.easing,function(){if(g==0){j.hide()}(e.callback&&e.callback.apply(this,arguments))});j.queue("fx",function(){j.dequeue()}).dequeue()})}})(jQuery);
/*
 * jQuery UI Effects Scale 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Scale
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.puff=function(e){return this.queue(function(){var i=a(this),j=a.effects.setMode(i,e.options.mode||"hide"),h=parseInt(e.options.percent,10)||150,g=h/100,f={height:i.height(),width:i.width()};a.extend(e.options,{fade:true,mode:j,percent:j=="hide"?h:100,from:j=="hide"?f:{height:f.height*g,width:f.width*g}});i.effect("scale",e.options,e.duration,e.callback);i.dequeue()})};a.effects.scale=function(e){return this.queue(function(){var j=a(this);var g=a.extend(true,{},e.options);var q=a.effects.setMode(j,e.options.mode||"effect");var k=parseInt(e.options.percent,10)||(parseInt(e.options.percent,10)==0?0:(q=="hide"?0:100));var p=e.options.direction||"both";var f=e.options.origin;if(q!="effect"){g.origin=f||["middle","center"];g.restore=true}var i={height:j.height(),width:j.width()};j.from=e.options.from||(q=="show"?{height:0,width:0}:i);var h={y:p!="horizontal"?(k/100):1,x:p!="vertical"?(k/100):1};j.to={height:i.height*h.y,width:i.width*h.x};if(e.options.fade){if(q=="show"){j.from.opacity=0;j.to.opacity=1}if(q=="hide"){j.from.opacity=1;j.to.opacity=0}}g.from=j.from;g.to=j.to;g.mode=q;j.effect("size",g,e.duration,e.callback);j.dequeue()})};a.effects.size=function(e){return this.queue(function(){var f=a(this),u=["position","top","bottom","left","right","width","height","overflow","opacity"];var t=["position","top","bottom","left","right","overflow","opacity"];var q=["width","height","overflow"];var w=["fontSize"];var r=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];var i=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];var j=a.effects.setMode(f,e.options.mode||"effect");var p=e.options.restore||false;var h=e.options.scale||"both";var v=e.options.origin;var g={height:f.height(),width:f.width()};f.from=e.options.from||g;f.to=e.options.to||g;if(v){var k=a.effects.getBaseline(v,g);f.from.top=(g.height-f.from.height)*k.y;f.from.left=(g.width-f.from.width)*k.x;f.to.top=(g.height-f.to.height)*k.y;f.to.left=(g.width-f.to.width)*k.x}var s={from:{y:f.from.height/g.height,x:f.from.width/g.width},to:{y:f.to.height/g.height,x:f.to.width/g.width}};if(h=="box"||h=="both"){if(s.from.y!=s.to.y){u=u.concat(r);f.from=a.effects.setTransition(f,r,s.from.y,f.from);f.to=a.effects.setTransition(f,r,s.to.y,f.to)}if(s.from.x!=s.to.x){u=u.concat(i);f.from=a.effects.setTransition(f,i,s.from.x,f.from);f.to=a.effects.setTransition(f,i,s.to.x,f.to)}}if(h=="content"||h=="both"){if(s.from.y!=s.to.y){u=u.concat(w);f.from=a.effects.setTransition(f,w,s.from.y,f.from);f.to=a.effects.setTransition(f,w,s.to.y,f.to)}}a.effects.save(f,p?u:t);f.show();a.effects.createWrapper(f);f.css("overflow","hidden").css(f.from);if(h=="content"||h=="both"){r=r.concat(["marginTop","marginBottom"]).concat(w);i=i.concat(["marginLeft","marginRight"]);q=u.concat(r).concat(i);f.find("*[width]").each(function(){var z=a(this);if(p){a.effects.save(z,q)}var x={height:z.height(),width:z.width()};z.from={height:x.height*s.from.y,width:x.width*s.from.x};z.to={height:x.height*s.to.y,width:x.width*s.to.x};if(s.from.y!=s.to.y){z.from=a.effects.setTransition(z,r,s.from.y,z.from);z.to=a.effects.setTransition(z,r,s.to.y,z.to)}if(s.from.x!=s.to.x){z.from=a.effects.setTransition(z,i,s.from.x,z.from);z.to=a.effects.setTransition(z,i,s.to.x,z.to)}z.css(z.from);z.animate(z.to,e.duration,e.options.easing,function(){if(p){a.effects.restore(z,q)}})})}f.animate(f.to,{queue:false,duration:e.duration,easing:e.options.easing,complete:function(){if(f.to.opacity===0){f.css("opacity",f.from.opacity)}if(j=="hide"){f.hide()}a.effects.restore(f,p?u:t);a.effects.removeWrapper(f);if(e.callback){e.callback.apply(this,arguments)}f.dequeue()}})})}})(jQuery);
/*
 * jQuery UI Effects Shake 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Shake
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.shake=function(e){return this.queue(function(){var h=a(this),s=["position","top","bottom","left","right"];var r=a.effects.setMode(h,e.options.mode||"effect");var u=e.options.direction||"left";var f=e.options.distance||20;var g=e.options.times||3;var k=e.duration||e.options.duration||140;a.effects.save(h,s);h.show();a.effects.createWrapper(h);var j=(u=="up"||u=="down")?"top":"left";var w=(u=="up"||u=="left")?"pos":"neg";var p={},v={},t={};p[j]=(w=="pos"?"-=":"+=")+f;v[j]=(w=="pos"?"+=":"-=")+f*2;t[j]=(w=="pos"?"-=":"+=")+f*2;h.animate(p,k,e.options.easing);for(var q=1;q<g;q++){h.animate(v,k,e.options.easing).animate(t,k,e.options.easing)}h.animate(v,k,e.options.easing).animate(p,k/2,e.options.easing,function(){a.effects.restore(h,s);a.effects.removeWrapper(h);if(e.callback){e.callback.apply(this,arguments)}});h.queue("fx",function(){h.dequeue()});h.dequeue()})}})(jQuery);
/*
 * jQuery UI Effects Slide 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Slide
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.slide=function(e){return this.queue(function(){var h=a(this),g=["position","top","bottom","left","right"];var p=a.effects.setMode(h,e.options.mode||"show");var k=e.options.direction||"left";a.effects.save(h,g);h.show();a.effects.createWrapper(h).css({overflow:"hidden"});var i=(k=="up"||k=="down")?"top":"left";var f=(k=="up"||k=="left")?"pos":"neg";var q=e.options.distance||(i=="top"?h.outerHeight(true):h.outerWidth(true));if(p=="show"){h.css(i,f=="pos"?(isNaN(q)?"-"+q:-q):q)}var j={};j[i]=(p=="show"?(f=="pos"?"+=":"-="):(f=="pos"?"-=":"+="))+q;h.animate(j,{queue:false,duration:e.duration,easing:e.options.easing,complete:function(){if(p=="hide"){h.hide()}a.effects.restore(h,g);a.effects.removeWrapper(h);if(e.callback){e.callback.apply(this,arguments)}h.dequeue()}})})}})(jQuery);
/*
 * jQuery UI Effects Transfer 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Transfer
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.transfer=function(e){return this.queue(function(){var i=a(this),k=a(e.options.to),h=k.offset(),j={top:h.top,left:h.left,height:k.innerHeight(),width:k.innerWidth()},g=i.offset(),f=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(e.options.className).css({top:g.top,left:g.left,height:i.innerHeight(),width:i.innerWidth(),position:"absolute"}).animate(j,e.duration,e.options.easing,function(){f.remove();(e.callback&&e.callback.apply(i[0],arguments));i.dequeue()})})}})(jQuery);(function($){$.ui.timepicker=$.ui.timepicker||{};if($.ui.timepicker.version){return}$.extend($.ui,{timepicker:{version:"1.0.3"}});function Timepicker(){this.regional=[];this.regional[""]={currentText:"Now",closeText:"Done",ampm:false,amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"hh:mm tt",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",timezoneText:"Time Zone"};this._defaults={showButtonPanel:true,timeOnly:false,showHour:true,showMinute:true,showSecond:false,showMillisec:false,showTimezone:false,showTime:true,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,hour:0,minute:0,second:0,millisec:0,timezone:null,useLocalTimezone:false,defaultTimezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:true,separator:" ",altFieldTimeOnly:true,altSeparator:null,altTimeSuffix:null,showTimepicker:true,timezoneIso8601:false,timezoneList:null,addSliderAccess:false,sliderAccessArgs:null,defaultValue:null};$.extend(this._defaults,this.regional[""])}$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,timezone:null,defaultTimezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec"],setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_newInst:function($input,o){var tp_inst=new Timepicker(),inlineSettings={};for(var attrName in this._defaults){if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr("time:"+attrName);if(attrValue){try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}}tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,{beforeShow:function(input,dp_inst){if($.isFunction(o.beforeShow)){return o.beforeShow(input,dp_inst,tp_inst)}},onChangeMonthYear:function(year,month,dp_inst){tp_inst._updateDateTime(dp_inst);if($.isFunction(o.onChangeMonthYear)){o.onChangeMonthYear.call($input[0],year,month,dp_inst,tp_inst)}},onClose:function(dateText,dp_inst){if(tp_inst.timeDefined===true&&$input.val()!==""){tp_inst._updateDateTime(dp_inst)}if($.isFunction(o.onClose)){o.onClose.call($input[0],dateText,dp_inst,tp_inst)}},timepicker:tp_inst});tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(val){return val.toUpperCase()});tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(val){return val.toUpperCase()});if(tp_inst._defaults.timezoneList===null){var timezoneList=["-1200","-1100","-1000","-0930","-0900","-0800","-0700","-0600","-0500","-0430","-0400","-0330","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0330","+0400","+0430","+0500","+0530","+0545","+0600","+0630","+0700","+0800","+0845","+0900","+0930","+1000","+1030","+1100","+1130","+1200","+1245","+1300","+1400"];if(tp_inst._defaults.timezoneIso8601){timezoneList=$.map(timezoneList,function(val){return val=="+0000"?"Z":(val.substring(0,3)+":"+val.substring(3))})}tp_inst._defaults.timezoneList=timezoneList}tp_inst.timezone=tp_inst._defaults.timezone;tp_inst.hour=tp_inst._defaults.hour;tp_inst.minute=tp_inst._defaults.minute;tp_inst.second=tp_inst._defaults.second;tp_inst.millisec=tp_inst._defaults.millisec;tp_inst.ampm="";tp_inst.$input=$input;if(o.altField){tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})}if(tp_inst._defaults.minDate===0||tp_inst._defaults.minDateTime===0){tp_inst._defaults.minDate=new Date()}if(tp_inst._defaults.maxDate===0||tp_inst._defaults.maxDateTime===0){tp_inst._defaults.maxDate=new Date()}if(tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date){tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())}if(tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date){tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())}if(tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date){tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())}if(tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date){tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())}tp_inst.$input.bind("focus",function(){tp_inst._onFocus()});return tp_inst},_addTimePicker:function(dp_inst){var currDT=(this.$altInput&&this._defaults.altFieldTimeOnly)?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(currDT);this._limitMinMaxDateTime(dp_inst,false);this._injectTimePicker()},_parseTime:function(timeString,withDate){if(!this.inst){this.inst=$.datepicker._getInst(this.$input[0])}if(withDate||!this._defaults.timeOnly){var dp_dateFormat=$.datepicker._get(this.inst,"dateFormat");try{var parseRes=parseDateTimeInternal(dp_dateFormat,this._defaults.timeFormat,timeString,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!parseRes.timeObj){return false}$.extend(this,parseRes.timeObj)}catch(err){return false}return true}else{var timeObj=$.datepicker.parseTime(this._defaults.timeFormat,timeString,this._defaults);if(!timeObj){return false}$.extend(this,timeObj);return true}},_injectTimePicker:function(){var $dp=this.inst.dpDiv,o=this.inst.settings,tp_inst=this,litem="",uitem="",max={},gridSize={},size=null;if($dp.find("div.ui-timepicker-div").length===0&&o.showTimepicker){var noDisplay=' style="display:none;"',html='<div class="ui-timepicker-div"><dl><dt class="ui_tpicker_time_label"'+((o.showTime)?"":noDisplay)+">"+o.timeText+'</dt><dd class="ui_tpicker_time"'+((o.showTime)?"":noDisplay)+"></dd>";for(var i=0,l=this.units.length;i<l;i++){litem=this.units[i];uitem=litem.substr(0,1).toUpperCase()+litem.substr(1);max[litem]=parseInt((o[litem+"Max"]-((o[litem+"Max"]-o[litem+"Min"])%o["step"+uitem])),10);gridSize[litem]=0;html+='<dt class="ui_tpicker_'+litem+'_label"'+((o["show"+uitem])?"":noDisplay)+">"+o[litem+"Text"]+'</dt><dd class="ui_tpicker_'+litem+'"><div class="ui_tpicker_'+litem+'_slider"'+((o["show"+uitem])?"":noDisplay)+"></div>";if(o["show"+uitem]&&o[litem+"Grid"]>0){html+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';if(litem=="hour"){for(var h=o[litem+"Min"];h<=max[litem];h+=parseInt(o[litem+"Grid"],10)){gridSize[litem]++;var tmph=(o.ampm&&h>12)?h-12:h;if(tmph<10){tmph="0"+tmph}if(o.ampm){if(h===0){tmph=12+"a"}else{if(h<12){tmph+="a"}else{tmph+="p"}}}html+='<td data-for="'+litem+'">'+tmph+"</td>"}}else{for(var m=o[litem+"Min"];m<=max[litem];m+=parseInt(o[litem+"Grid"],10)){gridSize[litem]++;html+='<td data-for="'+litem+'">'+((m<10)?"0":"")+m+"</td>"}}html+="</tr></table></div>"}html+="</dd>"}html+='<dt class="ui_tpicker_timezone_label"'+((o.showTimezone)?"":noDisplay)+">"+o.timezoneText+"</dt>";html+='<dd class="ui_tpicker_timezone" '+((o.showTimezone)?"":noDisplay)+"></dd>";html+="</dl></div>";var $tp=$(html);if(o.timeOnly===true){$tp.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+o.timeOnlyTitle+"</div></div>");$dp.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()}this.hour_slider=$tp.find(".ui_tpicker_hour_slider").prop("slide",null).slider({orientation:"horizontal",value:this.hour,min:o.hourMin,max:max.hour,step:o.stepHour,slide:function(event,ui){tp_inst.hour_slider.slider("option","value",ui.value);tp_inst._onTimeChange()},stop:function(event,ui){tp_inst._onSelectHandler()}});this.minute_slider=$tp.find(".ui_tpicker_minute_slider").prop("slide",null).slider({orientation:"horizontal",value:this.minute,min:o.minuteMin,max:max.minute,step:o.stepMinute,slide:function(event,ui){tp_inst.minute_slider.slider("option","value",ui.value);tp_inst._onTimeChange()},stop:function(event,ui){tp_inst._onSelectHandler()}});this.second_slider=$tp.find(".ui_tpicker_second_slider").prop("slide",null).slider({orientation:"horizontal",value:this.second,min:o.secondMin,max:max.second,step:o.stepSecond,slide:function(event,ui){tp_inst.second_slider.slider("option","value",ui.value);tp_inst._onTimeChange()},stop:function(event,ui){tp_inst._onSelectHandler()}});this.millisec_slider=$tp.find(".ui_tpicker_millisec_slider").prop("slide",null).slider({orientation:"horizontal",value:this.millisec,min:o.millisecMin,max:max.millisec,step:o.stepMillisec,slide:function(event,ui){tp_inst.millisec_slider.slider("option","value",ui.value);tp_inst._onTimeChange()},stop:function(event,ui){tp_inst._onSelectHandler()}});for(var i=0,l=tp_inst.units.length;i<l;i++){litem=tp_inst.units[i];uitem=litem.substr(0,1).toUpperCase()+litem.substr(1);if(o["show"+uitem]&&o[litem+"Grid"]>0){size=100*gridSize[litem]*o[litem+"Grid"]/(max[litem]-o[litem+"Min"]);$tp.find(".ui_tpicker_"+litem+" table").css({width:size+"%",marginLeft:(size/(-2*gridSize[litem]))+"%",borderCollapse:"collapse"}).find("td").click(function(e){var $t=$(this),h=$t.html(),f=$t.data("for");if(f=="hour"&&o.ampm){var ap=h.substring(2).toLowerCase(),aph=parseInt(h.substring(0,2),10);if(ap=="a"){if(aph==12){h=0}else{h=aph}}else{if(aph==12){h=12}else{h=aph+12}}}tp_inst[f+"_slider"].slider("option","value",parseInt(h,10));tp_inst._onTimeChange();tp_inst._onSelectHandler()}).css({cursor:"pointer",width:(100/gridSize[litem])+"%",textAlign:"center",overflow:"hidden"})}}this.timezone_select=$tp.find(".ui_tpicker_timezone").append("<select></select>").find("select");$.fn.append.apply(this.timezone_select,$.map(o.timezoneList,function(val,idx){return $("<option />").val(typeof val=="object"?val.value:val).text(typeof val=="object"?val.label:val)}));if(typeof(this.timezone)!="undefined"&&this.timezone!==null&&this.timezone!==""){var local_date=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12);var local_timezone=$.timepicker.timeZoneOffsetString(local_date);if(local_timezone==this.timezone){selectLocalTimeZone(tp_inst)}else{this.timezone_select.val(this.timezone)}}else{if(typeof(this.hour)!="undefined"&&this.hour!==null&&this.hour!==""){this.timezone_select.val(o.defaultTimezone)}else{selectLocalTimeZone(tp_inst)}}this.timezone_select.change(function(){tp_inst._defaults.useLocalTimezone=false;tp_inst._onTimeChange()});var $buttonPanel=$dp.find(".ui-datepicker-buttonpane");if($buttonPanel.length){$buttonPanel.before($tp)}else{$dp.append($tp)}this.$timeObj=$tp.find(".ui_tpicker_time");if(this.inst!==null){var timeDefined=this.timeDefined;this._onTimeChange();this.timeDefined=timeDefined}if(this._defaults.addSliderAccess){var sliderAccessArgs=this._defaults.sliderAccessArgs;setTimeout(function(){if($tp.find(".ui-slider-access").length===0){$tp.find(".ui-slider:visible").sliderAccess(sliderAccessArgs);var sliderAccessWidth=$tp.find(".ui-slider-access:eq(0)").outerWidth(true);if(sliderAccessWidth){$tp.find("table:visible").each(function(){var $g=$(this),oldWidth=$g.outerWidth(),oldMarginLeft=$g.css("marginLeft").toString().replace("%",""),newWidth=oldWidth-sliderAccessWidth,newMarginLeft=((oldMarginLeft*newWidth)/oldWidth)+"%";$g.css({width:newWidth,marginLeft:newMarginLeft})})}}},10)}}},_limitMinMaxDateTime:function(dp_inst,adjustSliders){var o=this._defaults,dp_date=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay);if(!this._defaults.showTimepicker){return}if($.datepicker._get(dp_inst,"minDateTime")!==null&&$.datepicker._get(dp_inst,"minDateTime")!==undefined&&dp_date){var minDateTime=$.datepicker._get(dp_inst,"minDateTime"),minDateTimeDate=new Date(minDateTime.getFullYear(),minDateTime.getMonth(),minDateTime.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null){this.hourMinOriginal=o.hourMin;this.minuteMinOriginal=o.minuteMin;this.secondMinOriginal=o.secondMin;this.millisecMinOriginal=o.millisecMin}if(dp_inst.settings.timeOnly||minDateTimeDate.getTime()==dp_date.getTime()){this._defaults.hourMin=minDateTime.getHours();if(this.hour<=this._defaults.hourMin){this.hour=this._defaults.hourMin;this._defaults.minuteMin=minDateTime.getMinutes();if(this.minute<=this._defaults.minuteMin){this.minute=this._defaults.minuteMin;this._defaults.secondMin=minDateTime.getSeconds();if(this.second<=this._defaults.secondMin){this.second=this._defaults.secondMin;this._defaults.millisecMin=minDateTime.getMilliseconds()}else{if(this.millisec<this._defaults.millisecMin){this.millisec=this._defaults.millisecMin}this._defaults.millisecMin=this.millisecMinOriginal}}else{this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal}}else{this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal}}else{this._defaults.hourMin=this.hourMinOriginal;this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal}}if($.datepicker._get(dp_inst,"maxDateTime")!==null&&$.datepicker._get(dp_inst,"maxDateTime")!==undefined&&dp_date){var maxDateTime=$.datepicker._get(dp_inst,"maxDateTime"),maxDateTimeDate=new Date(maxDateTime.getFullYear(),maxDateTime.getMonth(),maxDateTime.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null){this.hourMaxOriginal=o.hourMax;this.minuteMaxOriginal=o.minuteMax;this.secondMaxOriginal=o.secondMax;this.millisecMaxOriginal=o.millisecMax}if(dp_inst.settings.timeOnly||maxDateTimeDate.getTime()==dp_date.getTime()){this._defaults.hourMax=maxDateTime.getHours();if(this.hour>=this._defaults.hourMax){this.hour=this._defaults.hourMax;this._defaults.minuteMax=maxDateTime.getMinutes();if(this.minute>=this._defaults.minuteMax){this.minute=this._defaults.minuteMax;this._defaults.secondMax=maxDateTime.getSeconds()}else{if(this.second>=this._defaults.secondMax){this.second=this._defaults.secondMax;this._defaults.millisecMax=maxDateTime.getMilliseconds()}else{if(this.millisec>this._defaults.millisecMax){this.millisec=this._defaults.millisecMax}this._defaults.millisecMax=this.millisecMaxOriginal}}}else{this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal}}else{this._defaults.hourMax=this.hourMaxOriginal;this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal}}if(adjustSliders!==undefined&&adjustSliders===true){var hourMax=parseInt((this._defaults.hourMax-((this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour)),10),minMax=parseInt((this._defaults.minuteMax-((this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute)),10),secMax=parseInt((this._defaults.secondMax-((this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond)),10),millisecMax=parseInt((this._defaults.millisecMax-((this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec)),10);if(this.hour_slider){this.hour_slider.slider("option",{min:this._defaults.hourMin,max:hourMax}).slider("value",this.hour)}if(this.minute_slider){this.minute_slider.slider("option",{min:this._defaults.minuteMin,max:minMax}).slider("value",this.minute)}if(this.second_slider){this.second_slider.slider("option",{min:this._defaults.secondMin,max:secMax}).slider("value",this.second)}if(this.millisec_slider){this.millisec_slider.slider("option",{min:this._defaults.millisecMin,max:millisecMax}).slider("value",this.millisec)}}},_onTimeChange:function(){var hour=(this.hour_slider)?this.hour_slider.slider("value"):false,minute=(this.minute_slider)?this.minute_slider.slider("value"):false,second=(this.second_slider)?this.second_slider.slider("value"):false,millisec=(this.millisec_slider)?this.millisec_slider.slider("value"):false,timezone=(this.timezone_select)?this.timezone_select.val():false,o=this._defaults;if(typeof(hour)=="object"){hour=false}if(typeof(minute)=="object"){minute=false}if(typeof(second)=="object"){second=false}if(typeof(millisec)=="object"){millisec=false}if(typeof(timezone)=="object"){timezone=false}if(hour!==false){hour=parseInt(hour,10)}if(minute!==false){minute=parseInt(minute,10)}if(second!==false){second=parseInt(second,10)}if(millisec!==false){millisec=parseInt(millisec,10)}var ampm=o[hour<12?"amNames":"pmNames"][0];var hasChanged=(hour!=this.hour||minute!=this.minute||second!=this.second||millisec!=this.millisec||(this.ampm.length>0&&(hour<12)!=($.inArray(this.ampm.toUpperCase(),this.amNames)!==-1))||((this.timezone===null&&timezone!=this.defaultTimezone)||(this.timezone!==null&&timezone!=this.timezone)));if(hasChanged){if(hour!==false){this.hour=hour}if(minute!==false){this.minute=minute}if(second!==false){this.second=second}if(millisec!==false){this.millisec=millisec}if(timezone!==false){this.timezone=timezone}if(!this.inst){this.inst=$.datepicker._getInst(this.$input[0])}this._limitMinMaxDateTime(this.inst,true)}if(o.ampm){this.ampm=ampm}this.formattedTime=$.datepicker.formatTime(this._defaults.timeFormat,this,this._defaults);if(this.$timeObj){this.$timeObj.text(this.formattedTime+o.timeSuffix)}this.timeDefined=true;if(hasChanged){this._updateDateTime()}},_onSelectHandler:function(){var onSelect=this._defaults.onSelect||this.inst.settings.onSelect;var inputEl=this.$input?this.$input[0]:null;if(onSelect&&inputEl){onSelect.apply(inputEl,[this.formattedDateTime,this])}},_formatTime:function(time,format){time=time||{hour:this.hour,minute:this.minute,second:this.second,millisec:this.millisec,ampm:this.ampm,timezone:this.timezone};var tmptime=(format||this._defaults.timeFormat).toString();tmptime=$.datepicker.formatTime(tmptime,time,this._defaults);if(arguments.length){return tmptime}else{this.formattedTime=tmptime}},_updateDateTime:function(dp_inst){dp_inst=this.inst||dp_inst;var dt=$.datepicker._daylightSavingAdjust(new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay)),dateFmt=$.datepicker._get(dp_inst,"dateFormat"),formatCfg=$.datepicker._getFormatConfig(dp_inst),timeAvailable=dt!==null&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(dateFmt,(dt===null?new Date():dt),formatCfg);var formattedDateTime=this.formattedDate;if(this._defaults.timeOnly===true){formattedDateTime=this.formattedTime}else{if(this._defaults.timeOnly!==true&&(this._defaults.alwaysSetTime||timeAvailable)){formattedDateTime+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix}}this.formattedDateTime=formattedDateTime;if(!this._defaults.showTimepicker){this.$input.val(this.formattedDate)}else{if(this.$altInput&&this._defaults.altFieldTimeOnly===true){this.$altInput.val(this.formattedTime);this.$input.val(this.formattedDate)}else{if(this.$altInput){this.$input.val(formattedDateTime);var altFormattedDateTime="",altSeparator=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,altTimeSuffix=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;if(this._defaults.altFormat){altFormattedDateTime=$.datepicker.formatDate(this._defaults.altFormat,(dt===null?new Date():dt),formatCfg)}else{altFormattedDateTime=this.formattedDate}if(altFormattedDateTime){altFormattedDateTime+=altSeparator}if(this._defaults.altTimeFormat){altFormattedDateTime+=$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+altTimeSuffix}else{altFormattedDateTime+=this.formattedTime+altTimeSuffix}this.$altInput.val(altFormattedDateTime)}else{this.$input.val(formattedDateTime)}}}this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var inst=$.datepicker._getInst(this.$input.get(0)),tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst){if(tp_inst._defaults.timeOnly&&(inst.input.val()!=inst.lastVal)){try{$.datepicker._updateDatepicker(inst)}catch(err){$.datepicker.log(err)}}}}}});$.fn.extend({timepicker:function(o){o=o||{};var tmp_args=Array.prototype.slice.call(arguments);if(typeof o=="object"){tmp_args[0]=$.extend(o,{timeOnly:true})}return $(this).each(function(){$.fn.datetimepicker.apply($(this),tmp_args)})},datetimepicker:function(o){o=o||{};var tmp_args=arguments;if(typeof(o)=="string"){if(o=="getDate"){return $.fn.datepicker.apply($(this[0]),tmp_args)}else{return this.each(function(){var $t=$(this);$t.datepicker.apply($t,tmp_args)})}}else{return this.each(function(){var $t=$(this);$t.datepicker($.timepicker._newInst($t,o)._defaults)})}}});$.datepicker.parseDateTime=function(dateFormat,timeFormat,dateTimeString,dateSettings,timeSettings){var parseRes=parseDateTimeInternal(dateFormat,timeFormat,dateTimeString,dateSettings,timeSettings);if(parseRes.timeObj){var t=parseRes.timeObj;parseRes.date.setHours(t.hour,t.minute,t.second,t.millisec)}return parseRes.date};$.datepicker.parseTime=function(timeFormat,timeString,options){var getPatternAmpm=function(amNames,pmNames){var markers=[];if(amNames){$.merge(markers,amNames)}if(pmNames){$.merge(markers,pmNames)}markers=$.map(markers,function(val){return val.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")});return"("+markers.join("|")+")?"};var getFormatPositions=function(timeFormat){var finds=timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z)/g),orders={h:-1,m:-1,s:-1,l:-1,t:-1,z:-1};if(finds){for(var i=0;i<finds.length;i++){if(orders[finds[i].toString().charAt(0)]==-1){orders[finds[i].toString().charAt(0)]=i+1}}}return orders};var o=extendRemove(extendRemove({},$.timepicker._defaults),options||{});var regstr="^"+timeFormat.toString().replace(/h{1,2}/ig,"(\\d?\\d)").replace(/m{1,2}/ig,"(\\d?\\d)").replace(/s{1,2}/ig,"(\\d?\\d)").replace(/l{1}/ig,"(\\d?\\d?\\d)").replace(/t{1,2}/ig,getPatternAmpm(o.amNames,o.pmNames)).replace(/z{1}/ig,"(z|[-+]\\d\\d:?\\d\\d|\\S+)?").replace(/\s/g,"\\s?")+o.timeSuffix+"$",order=getFormatPositions(timeFormat),ampm="",treg;treg=timeString.match(new RegExp(regstr,"i"));var resTime={hour:0,minute:0,second:0,millisec:0};if(treg){if(order.t!==-1){if(treg[order.t]===undefined||treg[order.t].length===0){ampm="";resTime.ampm=""}else{ampm=$.inArray(treg[order.t].toUpperCase(),o.amNames)!==-1?"AM":"PM";resTime.ampm=o[ampm=="AM"?"amNames":"pmNames"][0]}}if(order.h!==-1){if(ampm=="AM"&&treg[order.h]=="12"){resTime.hour=0}else{if(ampm=="PM"&&treg[order.h]!="12"){resTime.hour=parseInt(treg[order.h],10)+12}else{resTime.hour=Number(treg[order.h])}}}if(order.m!==-1){resTime.minute=Number(treg[order.m])}if(order.s!==-1){resTime.second=Number(treg[order.s])}if(order.l!==-1){resTime.millisec=Number(treg[order.l])}if(order.z!==-1&&treg[order.z]!==undefined){var tz=treg[order.z].toUpperCase();switch(tz.length){case 1:tz=o.timezoneIso8601?"Z":"+0000";break;case 5:if(o.timezoneIso8601){tz=tz.substring(1)=="0000"?"Z":tz.substring(0,3)+":"+tz.substring(3)}break;case 6:if(!o.timezoneIso8601){tz=tz=="Z"||tz.substring(1)=="00:00"?"+0000":tz.replace(/:/,"")}else{if(tz.substring(1)=="00:00"){tz="Z"}}break}resTime.timezone=tz}return resTime}return false};$.datepicker.formatTime=function(format,time,options){options=options||{};options=$.extend({},$.timepicker._defaults,options);time=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:"+0000"},time);var tmptime=format;var ampmName=options.amNames[0];var hour=parseInt(time.hour,10);if(options.ampm){if(hour>11){ampmName=options.pmNames[0];if(hour>12){hour=hour%12}}if(hour===0){hour=12}}tmptime=tmptime.replace(/(?:hh?|mm?|ss?|[tT]{1,2}|[lz]|('.*?'|".*?"))/g,function(match){switch(match.toLowerCase()){case"hh":return("0"+hour).slice(-2);case"h":return hour;case"mm":return("0"+time.minute).slice(-2);case"m":return time.minute;case"ss":return("0"+time.second).slice(-2);case"s":return time.second;case"l":return("00"+time.millisec).slice(-3);case"z":return time.timezone;case"t":case"tt":if(options.ampm){if(match.length==1){ampmName=ampmName.charAt(0)}return match.charAt(0)==="T"?ampmName.toUpperCase():ampmName.toLowerCase()}return"";default:return match.replace(/\'/g,"")||"'"}});tmptime=$.trim(tmptime);return tmptime};$.datepicker._base_selectDate=$.datepicker._selectDate;$.datepicker._selectDate=function(id,dateStr){var inst=this._getInst($(id)[0]),tp_inst=this._get(inst,"timepicker");if(tp_inst){tp_inst._limitMinMaxDateTime(inst,true);inst.inline=inst.stay_open=true;this._base_selectDate(id,dateStr);inst.inline=inst.stay_open=false;this._notifyChange(inst);this._updateDatepicker(inst)}else{this._base_selectDate(id,dateStr)}};$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker;$.datepicker._updateDatepicker=function(inst){var input=inst.input[0];if($.datepicker._curInst&&$.datepicker._curInst!=inst&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=input){return}if(typeof(inst.stay_open)!=="boolean"||inst.stay_open===false){this._base_updateDatepicker(inst);var tp_inst=this._get(inst,"timepicker");if(tp_inst){tp_inst._addTimePicker(inst);if(tp_inst._defaults.useLocalTimezone){var date=new Date(inst.selectedYear,inst.selectedMonth,inst.selectedDay,12);selectLocalTimeZone(tp_inst,date);tp_inst._onTimeChange()}}}};$.datepicker._base_doKeyPress=$.datepicker._doKeyPress;$.datepicker._doKeyPress=function(event){var inst=$.datepicker._getInst(event.target),tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst){if($.datepicker._get(inst,"constrainInput")){var ampm=tp_inst._defaults.ampm,dateChars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat")),datetimeChars=tp_inst._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,ampm?"APM":"").replace(/Tt/g,ampm?"AaPpMm":"").replace(/tT/g,ampm?"AaPpMm":"").replace(/T/g,ampm?"AP":"").replace(/tt/g,ampm?"apm":"").replace(/t/g,ampm?"ap":"")+" "+tp_inst._defaults.separator+tp_inst._defaults.timeSuffix+(tp_inst._defaults.showTimezone?tp_inst._defaults.timezoneList.join(""):"")+(tp_inst._defaults.amNames.join(""))+(tp_inst._defaults.pmNames.join(""))+dateChars,chr=String.fromCharCode(event.charCode===undefined?event.keyCode:event.charCode);return event.ctrlKey||(chr<" "||!dateChars||datetimeChars.indexOf(chr)>-1)}}return $.datepicker._base_doKeyPress(event)};$.datepicker._base_doKeyUp=$.datepicker._doKeyUp;$.datepicker._doKeyUp=function(event){var inst=$.datepicker._getInst(event.target),tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst){if(tp_inst._defaults.timeOnly&&(inst.input.val()!=inst.lastVal)){try{$.datepicker._updateDatepicker(inst)}catch(err){$.datepicker.log(err)}}}return $.datepicker._base_doKeyUp(event)};$.datepicker._base_gotoToday=$.datepicker._gotoToday;$.datepicker._gotoToday=function(id){var inst=this._getInst($(id)[0]),$dp=inst.dpDiv;this._base_gotoToday(id);var tp_inst=this._get(inst,"timepicker");selectLocalTimeZone(tp_inst);var now=new Date();this._setTime(inst,now);$(".ui-datepicker-today",$dp).click()};$.datepicker._disableTimepickerDatepicker=function(target){var inst=this._getInst(target);if(!inst){return}var tp_inst=this._get(inst,"timepicker");$(target).datepicker("getDate");if(tp_inst){tp_inst._defaults.showTimepicker=false;tp_inst._updateDateTime(inst)}};$.datepicker._enableTimepickerDatepicker=function(target){var inst=this._getInst(target);if(!inst){return}var tp_inst=this._get(inst,"timepicker");$(target).datepicker("getDate");if(tp_inst){tp_inst._defaults.showTimepicker=true;tp_inst._addTimePicker(inst);tp_inst._updateDateTime(inst)}};$.datepicker._setTime=function(inst,date){var tp_inst=this._get(inst,"timepicker");if(tp_inst){var defaults=tp_inst._defaults,hour=date?date.getHours():defaults.hour,minute=date?date.getMinutes():defaults.minute,second=date?date.getSeconds():defaults.second,millisec=date?date.getMilliseconds():defaults.millisec;var hourEq=hour===defaults.hourMin,minuteEq=minute===defaults.minuteMin,secondEq=second===defaults.secondMin;var reset=false;if(hour<defaults.hourMin||hour>defaults.hourMax){reset=true}else{if((minute<defaults.minuteMin||minute>defaults.minuteMax)&&hourEq){reset=true}else{if((second<defaults.secondMin||second>defaults.secondMax)&&hourEq&&minuteEq){reset=true}else{if((millisec<defaults.millisecMin||millisec>defaults.millisecMax)&&hourEq&&minuteEq&&secondEq){reset=true}}}}if(reset){hour=defaults.hourMin;minute=defaults.minuteMin;second=defaults.secondMin;millisec=defaults.millisecMin}tp_inst.hour=hour;tp_inst.minute=minute;tp_inst.second=second;tp_inst.millisec=millisec;if(tp_inst.hour_slider){tp_inst.hour_slider.slider("value",hour)}if(tp_inst.minute_slider){tp_inst.minute_slider.slider("value",minute)}if(tp_inst.second_slider){tp_inst.second_slider.slider("value",second)}if(tp_inst.millisec_slider){tp_inst.millisec_slider.slider("value",millisec)}tp_inst._onTimeChange();tp_inst._updateDateTime(inst)}};$.datepicker._setTimeDatepicker=function(target,date,withDate){var inst=this._getInst(target);if(!inst){return}var tp_inst=this._get(inst,"timepicker");if(tp_inst){this._setDateFromField(inst);var tp_date;if(date){if(typeof date=="string"){tp_inst._parseTime(date,withDate);tp_date=new Date();tp_date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second,tp_inst.millisec)}else{tp_date=new Date(date.getTime())}if(tp_date.toString()=="Invalid Date"){tp_date=undefined}this._setTime(inst,tp_date)}}};$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker;$.datepicker._setDateDatepicker=function(target,date){var inst=this._getInst(target);if(!inst){return}var tp_date=(date instanceof Date)?new Date(date.getTime()):date;this._updateDatepicker(inst);this._base_setDateDatepicker.apply(this,arguments);this._setTimeDatepicker(target,tp_date,true)};$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker;$.datepicker._getDateDatepicker=function(target,noDefault){var inst=this._getInst(target);if(!inst){return}var tp_inst=this._get(inst,"timepicker");if(tp_inst){var date=this._getDate(inst);if(date&&tp_inst._parseTime($(target).val(),tp_inst.timeOnly)){date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second,tp_inst.millisec)}return date}return this._base_getDateDatepicker(target,noDefault)};$.datepicker._base_parseDate=$.datepicker.parseDate;$.datepicker.parseDate=function(format,value,settings){var splitRes=splitDateTime(format,value,settings);return $.datepicker._base_parseDate(format,splitRes[0],settings)};$.datepicker._base_formatDate=$.datepicker._formatDate;$.datepicker._formatDate=function(inst,day,month,year){var tp_inst=this._get(inst,"timepicker");if(tp_inst){tp_inst._updateDateTime(inst);return tp_inst.$input.val()}return this._base_formatDate(inst)};$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker;$.datepicker._optionDatepicker=function(target,name,value){var inst=this._getInst(target);if(!inst){return null}var tp_inst=this._get(inst,"timepicker");if(tp_inst){var min=null,max=null,onselect=null;if(typeof name=="string"){if(name==="minDate"||name==="minDateTime"){min=value}else{if(name==="maxDate"||name==="maxDateTime"){max=value}else{if(name==="onSelect"){onselect=value}}}}else{if(typeof name=="object"){if(name.minDate){min=name.minDate}else{if(name.minDateTime){min=name.minDateTime}else{if(name.maxDate){max=name.maxDate}else{if(name.maxDateTime){max=name.maxDateTime}}}}}}if(min){if(min===0){min=new Date()}else{min=new Date(min)}tp_inst._defaults.minDate=min;tp_inst._defaults.minDateTime=min}else{if(max){if(max===0){max=new Date()}else{max=new Date(max)}tp_inst._defaults.maxDate=max;tp_inst._defaults.maxDateTime=max}else{if(onselect){tp_inst._defaults.onSelect=onselect}}}}if(value===undefined){return this._base_optionDatepicker(target,name)}return this._base_optionDatepicker(target,name,value)};function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]===null||props[name]===undefined){target[name]=props[name]}}return target}var splitDateTime=function(dateFormat,dateTimeString,dateSettings,timeSettings){try{var separator=timeSettings&&timeSettings.separator?timeSettings.separator:$.timepicker._defaults.separator,format=timeSettings&&timeSettings.timeFormat?timeSettings.timeFormat:$.timepicker._defaults.timeFormat,ampm=timeSettings&&timeSettings.ampm?timeSettings.ampm:$.timepicker._defaults.ampm,timeParts=format.split(separator),timePartsLen=timeParts.length,allParts=dateTimeString.split(separator),allPartsLen=allParts.length;if(!ampm){timeParts=$.trim(format.replace(/t/gi,"")).split(separator);timePartsLen=timeParts.length}if(allPartsLen==1){return allParts}if(allPartsLen>1){return[allParts.splice(0,allPartsLen-timePartsLen).join(separator),allParts.splice(timePartsLen*-1).join(separator)]}}catch(err){if(err.indexOf(":")>=0){var dateStringLength=dateTimeString.length-(err.length-err.indexOf(":")-2),timeString=dateTimeString.substring(dateStringLength);return[$.trim(dateTimeString.substring(0,dateStringLength)),$.trim(dateTimeString.substring(dateStringLength))]}else{throw err}}return[dateTimeString,""]};var parseDateTimeInternal=function(dateFormat,timeFormat,dateTimeString,dateSettings,timeSettings){var date;var splitRes=splitDateTime(dateFormat,dateTimeString,dateSettings,timeSettings);date=$.datepicker._base_parseDate(dateFormat,splitRes[0],dateSettings);if(splitRes[1]!==""){var timeString=splitRes[1],parsedTime=$.datepicker.parseTime(timeFormat,timeString,timeSettings);if(parsedTime===null){throw"Wrong time format"}return{date:date,timeObj:parsedTime}}else{return{date:date}}};var selectLocalTimeZone=function(tp_inst,date){if(tp_inst&&tp_inst.timezone_select){tp_inst._defaults.useLocalTimezone=true;var now=typeof date!=="undefined"?date:new Date();var tzoffset=$.timepicker.timeZoneOffsetString(now);if(tp_inst._defaults.timezoneIso8601){tzoffset=tzoffset.substring(0,3)+":"+tzoffset.substring(3)}tp_inst.timezone_select.val(tzoffset)}};$.timepicker=new Timepicker();$.timepicker.timeZoneOffsetString=function(date){var off=date.getTimezoneOffset()*-1,minutes=off%60,hours=(off-minutes)/60;return(off>=0?"+":"-")+("0"+(hours*101).toString()).substr(-2)+("0"+(minutes*101).toString()).substr(-2)};$.timepicker.timeRange=function(startTime,endTime,options){return $.timepicker.handleRange("timepicker",startTime,endTime,options)};$.timepicker.dateTimeRange=function(startTime,endTime,options){$.timepicker.dateRange(startTime,endTime,options,"datetimepicker")};$.timepicker.dateRange=function(startTime,endTime,options,method){method=method||"datepicker";$.timepicker.handleRange(method,startTime,endTime,options)};$.timepicker.handleRange=function(method,startTime,endTime,options){$.fn[method].call(startTime,$.extend({onClose:function(dateText,inst){checkDates(this,endTime,dateText)},onSelect:function(selectedDateTime){selected(this,endTime,"minDate")}},options,options.start));$.fn[method].call(endTime,$.extend({onClose:function(dateText,inst){checkDates(this,startTime,dateText)},onSelect:function(selectedDateTime){selected(this,startTime,"maxDate")}},options,options.end));if(method!="timepicker"&&options.reformat){$([startTime,endTime]).each(function(){var format=$(this)[method].call($(this),"option","dateFormat"),date=new Date($(this).val());if($(this).val()&&date){$(this).val($.datepicker.formatDate(format,date))}})}checkDates(startTime,endTime,startTime.val());function checkDates(changed,other,dateText){if(other.val()&&(new Date(startTime.val())>new Date(endTime.val()))){other.val(dateText)}}selected(startTime,endTime,"minDate");selected(endTime,startTime,"maxDate");function selected(changed,other,option){if(!$(changed).val()){return}var date=$(changed)[method].call($(changed),"getDate");if(date.getTime){$(other)[method].call($(other),"option",option,date)}}return $([startTime.get(0),endTime.get(0)])};$.timepicker.version="1.0.3"})(jQuery);
/*
 * jQuery Form Plugin
 * version: 3.32.0-2013.04.09
 * @requires jQuery v1.5 or later
 * Copyright (c) 2013 M. Alsup
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses.
 * https://github.com/malsup/form#copyright-and-license
 */
(function(h){var e={};e.fileapi=h("<input type='file'/>").get(0).files!==undefined;e.formdata=window.FormData!==undefined;var g=!!h.fn.prop;h.fn.attr2=function(){if(!g){return this.attr.apply(this,arguments)}var i=this.prop.apply(this,arguments);if((i&&i.jquery)||typeof i==="string"){return i}return this.attr.apply(this,arguments)};h.fn.ajaxSubmit=function(p){if(!this.length){f("ajaxSubmit: skipping submit process - no element selected");return this}var j,G,s,u=this;if(typeof p=="function"){p={success:p}}j=this.attr2("method");G=this.attr2("action");s=(typeof G==="string")?h.trim(G):"";s=s||window.location.href||"";if(s){s=(s.match(/^([^#]+)/)||[])[1]}p=h.extend(true,{url:s,success:h.ajaxSettings.success,type:j||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},p);var A={};this.trigger("form-pre-serialize",[this,p,A]);if(A.veto){f("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(p.beforeSerialize&&p.beforeSerialize(this,p)===false){f("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var t=p.traditional;if(t===undefined){t=h.ajaxSettings.traditional}var x=[];var J,K=this.formToArray(p.semantic,x);if(p.data){p.extraData=p.data;J=h.param(p.data,t)}if(p.beforeSubmit&&p.beforeSubmit(K,this,p)===false){f("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[K,this,p,A]);if(A.veto){f("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var E=h.param(K,t);if(J){E=(E?(E+"&"+J):J)}if(p.type.toUpperCase()=="GET"){p.url+=(p.url.indexOf("?")>=0?"&":"?")+E;p.data=null}else{p.data=E}var M=[];if(p.resetForm){M.push(function(){u.resetForm()})}if(p.clearForm){M.push(function(){u.clearForm(p.includeHidden)})}if(!p.dataType&&p.target){var r=p.success||function(){};M.push(function(q){var k=p.replaceTarget?"replaceWith":"html";h(p.target)[k](q).each(r,arguments)})}else{if(p.success){M.push(p.success)}}p.success=function(P,q,Q){var O=p.context||this;for(var N=0,k=M.length;N<k;N++){M[N].apply(O,[P,q,Q||u,u])}};var I=h('input[type=file]:enabled[value!=""]',this);var v=I.length>0;var H="multipart/form-data";var D=(u.attr("enctype")==H||u.attr("encoding")==H);var C=e.fileapi&&e.formdata;f("fileAPI :"+C);var w=(v||D)&&!C;var B;if(p.iframe!==false&&(p.iframe||w)){if(p.closeKeepAlive){h.get(p.closeKeepAlive,function(){B=L(K)})}else{B=L(K)}}else{if((v||D)&&C){B=z(K)}else{B=h.ajax(p)}}u.removeData("jqxhr").data("jqxhr",B);for(var F=0;F<x.length;F++){x[F]=null}this.trigger("form-submit-notify",[this,p]);return this;function i(P){var Q=h.param(P).split("&");var q=Q.length;var k=[];var O,N;for(O=0;O<q;O++){Q[O]=Q[O].replace(/\+/g," ");N=Q[O].split("=");k.push([decodeURIComponent(N[0]),decodeURIComponent(N[1])])}return k}function z(q){var k=new FormData();for(var N=0;N<q.length;N++){k.append(q[N].name,q[N].value)}if(p.extraData){var Q=i(p.extraData);for(N=0;N<Q.length;N++){if(Q[N]){k.append(Q[N][0],Q[N][1])}}}p.data=null;var P=h.extend(true,{},h.ajaxSettings,p,{contentType:false,processData:false,cache:false,type:j||"POST"});if(p.uploadProgress){P.xhr=function(){var R=jQuery.ajaxSettings.xhr();if(R.upload){R.upload.addEventListener("progress",function(V){var U=0;var S=V.loaded||V.position;var T=V.total;if(V.lengthComputable){U=Math.ceil(S/T*100)}p.uploadProgress(V,S,T,U)},false)}return R}}P.data=null;var O=P.beforeSend;P.beforeSend=function(S,R){R.data=k;if(O){O.call(this,S,R)}};return h.ajax(P)}function L(ak){var Q=u[0],P,ag,aa,ai,ad,S,V,T,U,ae,ah,Y;var an=h.Deferred();if(ak){for(ag=0;ag<x.length;ag++){P=h(x[ag]);if(g){P.prop("disabled",false)}else{P.removeAttr("disabled")}}}aa=h.extend(true,{},h.ajaxSettings,p);aa.context=aa.context||aa;ad="jqFormIO"+(new Date().getTime());if(aa.iframeTarget){S=h(aa.iframeTarget);ae=S.attr2("name");if(!ae){S.attr2("name",ad)}else{ad=ae}}else{S=h('<iframe name="'+ad+'" src="'+aa.iframeSrc+'" />');S.css({position:"absolute",top:"-1000px",left:"-1000px"})}V=S[0];T={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(ao){var ap=(ao==="timeout"?"timeout":"aborted");f("aborting upload... "+ap);this.aborted=1;try{if(V.contentWindow.document.execCommand){V.contentWindow.document.execCommand("Stop")}}catch(aq){}S.attr("src",aa.iframeSrc);T.error=ap;if(aa.error){aa.error.call(aa.context,T,ap,ao)}if(ai){h.event.trigger("ajaxError",[T,aa,ap])}if(aa.complete){aa.complete.call(aa.context,T,ap)}}};ai=aa.global;if(ai&&0===h.active++){h.event.trigger("ajaxStart")}if(ai){h.event.trigger("ajaxSend",[T,aa])}if(aa.beforeSend&&aa.beforeSend.call(aa.context,T,aa)===false){if(aa.global){h.active--}an.reject();return an}if(T.aborted){an.reject();return an}U=Q.clk;if(U){ae=U.name;if(ae&&!U.disabled){aa.extraData=aa.extraData||{};aa.extraData[ae]=U.value;if(U.type=="image"){aa.extraData[ae+".x"]=Q.clk_x;aa.extraData[ae+".y"]=Q.clk_y}}}var Z=1;var W=2;function X(aq){var ap=null;try{if(aq.contentWindow){ap=aq.contentWindow.document}}catch(ao){f("cannot get iframe.contentWindow document: "+ao)}if(ap){return ap}try{ap=aq.contentDocument?aq.contentDocument:aq.document}catch(ao){f("cannot get iframe.contentDocument: "+ao);ap=aq.document}return ap}var O=h("meta[name=csrf-token]").attr("content");var N=h("meta[name=csrf-param]").attr("content");if(N&&O){aa.extraData=aa.extraData||{};aa.extraData[N]=O}function af(){var aq=u.attr2("target"),ao=u.attr2("action");Q.setAttribute("target",ad);if(!j){Q.setAttribute("method","POST")}if(ao!=aa.url){Q.setAttribute("action",aa.url)}if(!aa.skipEncodingOverride&&(!j||/post/i.test(j))){u.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(aa.timeout){Y=setTimeout(function(){ah=true;ac(Z)},aa.timeout)}function ar(){try{var aw=X(V).readyState;f("state = "+aw);if(aw&&aw.toLowerCase()=="uninitialized"){setTimeout(ar,50)}}catch(ax){f("Server abort: ",ax," (",ax.name,")");ac(W);if(Y){clearTimeout(Y)}Y=undefined}}var ap=[];try{if(aa.extraData){for(var av in aa.extraData){if(aa.extraData.hasOwnProperty(av)){if(h.isPlainObject(aa.extraData[av])&&aa.extraData[av].hasOwnProperty("name")&&aa.extraData[av].hasOwnProperty("value")){ap.push(h('<input type="hidden" name="'+aa.extraData[av].name+'">').val(aa.extraData[av].value).appendTo(Q)[0])}else{ap.push(h('<input type="hidden" name="'+av+'">').val(aa.extraData[av]).appendTo(Q)[0])}}}}if(!aa.iframeTarget){S.appendTo("body");if(V.attachEvent){V.attachEvent("onload",ac)}else{V.addEventListener("load",ac,false)}}setTimeout(ar,15);try{console.log(Q.target);Q.submit()}catch(at){var au=document.createElement("form").submit;au.apply(Q)}}finally{Q.setAttribute("action",ao);if(aq){Q.setAttribute("target",aq)}else{u.removeAttr("target")}h(ap).remove()}}if(aa.forceSync){af()}else{setTimeout(af,10)}var al,am,aj=50,R;function ac(av){if(T.aborted||R){return}am=X(V);if(!am){f("cannot access response document");av=W}if(av===Z&&T){T.abort("timeout");an.reject(T,"timeout");return}else{if(av==W&&T){T.abort("server abort");an.reject(T,"error","server abort");return}}if(!am||am.location.href==aa.iframeSrc){if(!ah){return}}if(V.detachEvent){V.detachEvent("onload",ac)}else{V.removeEventListener("load",ac,false)}var at="success",ax;try{if(ah){throw"timeout"}var ar=aa.dataType=="xml"||am.XMLDocument||h.isXMLDoc(am);f("isXml="+ar);if(!ar&&window.opera&&(am.body===null||!am.body.innerHTML)){if(--aj){f("requeing onLoad callback, DOM not available");setTimeout(ac,250);return}}var ay=am.body?am.body:am.documentElement;T.responseText=ay?ay.innerHTML:null;T.responseXML=am.XMLDocument?am.XMLDocument:am;if(ar){aa.dataType="xml"}T.getResponseHeader=function(aB){var aA={"content-type":aa.dataType};return aA[aB]};if(ay){T.status=Number(ay.getAttribute("status"))||T.status;T.statusText=ay.getAttribute("statusText")||T.statusText}var ao=(aa.dataType||"").toLowerCase();var aw=/(json|script|text)/.test(ao);if(aw||aa.textarea){var au=am.getElementsByTagName("textarea")[0];if(au){T.responseText=au.value;T.status=Number(au.getAttribute("status"))||T.status;T.statusText=au.getAttribute("statusText")||T.statusText}else{if(aw){var ap=am.getElementsByTagName("pre")[0];var az=am.getElementsByTagName("body")[0];if(ap){T.responseText=ap.textContent?ap.textContent:ap.innerText}else{if(az){T.responseText=az.textContent?az.textContent:az.innerText}}}}}else{if(ao=="xml"&&!T.responseXML&&T.responseText){T.responseXML=ab(T.responseText)}}try{al=k(T,ao,aa)}catch(aq){at="parsererror";T.error=ax=(aq||at)}}catch(aq){f("error caught: ",aq);at="error";T.error=ax=(aq||at)}if(T.aborted){f("upload aborted");at=null}if(T.status){at=(T.status>=200&&T.status<300||T.status===304)?"success":"error"}if(at==="success"){if(aa.success){aa.success.call(aa.context,al,"success",T)}an.resolve(T.responseText,"success",T);if(ai){h.event.trigger("ajaxSuccess",[T,aa])}}else{if(at){if(ax===undefined){ax=T.statusText}if(aa.error){aa.error.call(aa.context,T,at,ax)}an.reject(T,"error",ax);if(ai){h.event.trigger("ajaxError",[T,aa,ax])}}}if(ai){h.event.trigger("ajaxComplete",[T,aa])}if(ai&&!--h.active){h.event.trigger("ajaxStop")}if(aa.complete){aa.complete.call(aa.context,T,at)}R=true;if(aa.timeout){clearTimeout(Y)}setTimeout(function(){if(!aa.iframeTarget){S.remove()}T.responseXML=null},100)}var ab=h.parseXML||function(ao,ap){if(window.ActiveXObject){ap=new ActiveXObject("Microsoft.XMLDOM");ap.async="false";ap.loadXML(ao)}else{ap=(new DOMParser()).parseFromString(ao,"text/xml")}return(ap&&ap.documentElement&&ap.documentElement.nodeName!="parsererror")?ap:null};var q=h.parseJSON||function(ao){return window["eval"]("("+ao+")")};var k=function(au,ar,aq){var ap=au.getResponseHeader("content-type")||"",ao=ar==="xml"||!ar&&ap.indexOf("xml")>=0,at=ao?au.responseXML:au.responseText;if(ao&&at.documentElement.nodeName==="parsererror"){if(h.error){h.error("parsererror")}}if(aq&&aq.dataFilter){at=aq.dataFilter(at,ar)}if(typeof at==="string"){if(ar==="json"||!ar&&ap.indexOf("json")>=0){at=q(at)}else{if(ar==="script"||!ar&&ap.indexOf("javascript")>=0){h.globalEval(at)}}}return at};return an}};h.fn.ajaxForm=function(i){i=i||{};i.delegation=i.delegation&&h.isFunction(h.fn.on);if(!i.delegation&&this.length===0){var j={s:this.selector,c:this.context};if(!h.isReady&&j.s){f("DOM not ready, queuing ajaxForm");h(function(){h(j.s,j.c).ajaxForm(i)});return this}f("terminating; zero elements found by selector"+(h.isReady?"":" (DOM not ready)"));return this}if(i.delegation){h(document).off("submit.form-plugin",this.selector,b).off("click.form-plugin",this.selector,a).on("submit.form-plugin",this.selector,i,b).on("click.form-plugin",this.selector,i,a);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",i,b).bind("click.form-plugin",i,a)};function b(j){var i=j.data;if(!j.isDefaultPrevented()){j.preventDefault();h(this).ajaxSubmit(i)}}function a(q){var p=q.target;var j=h(p);if(!(j.is("[type=submit],[type=image]"))){var i=j.closest("[type=submit]");if(i.length===0){return}p=i[0]}var k=this;k.clk=p;if(p.type=="image"){if(q.offsetX!==undefined){k.clk_x=q.offsetX;k.clk_y=q.offsetY}else{if(typeof h.fn.offset=="function"){var r=j.offset();k.clk_x=q.pageX-r.left;k.clk_y=q.pageY-r.top}else{k.clk_x=q.pageX-p.offsetLeft;k.clk_y=q.pageY-p.offsetTop}}}setTimeout(function(){k.clk=k.clk_x=k.clk_y=null},100)}h.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};h.fn.formToArray=function(D,k){var C=[];if(this.length===0){return C}var r=this[0];var u=D?r.getElementsByTagName("*"):r.elements;if(!u){return C}var x,w,t,E,s,A,q;for(x=0,A=u.length;x<A;x++){s=u[x];t=s.name;if(!t||s.disabled){continue}if(D&&r.clk&&s.type=="image"){if(r.clk==s){C.push({name:t,value:h(s).val(),type:s.type});C.push({name:t+".x",value:r.clk_x},{name:t+".y",value:r.clk_y})}continue}E=h.fieldValue(s,true);if(E&&E.constructor==Array){if(k){k.push(s)}for(w=0,q=E.length;w<q;w++){C.push({name:t,value:E[w]})}}else{if(e.fileapi&&s.type=="file"){if(k){k.push(s)}var p=s.files;if(p.length){for(w=0;w<p.length;w++){C.push({name:t,value:p[w],type:s.type})}}else{C.push({name:t,value:"",type:s.type})}}else{if(E!==null&&typeof E!="undefined"){if(k){k.push(s)}C.push({name:t,value:E,type:s.type,required:s.required})}}}}if(!D&&r.clk){var z=h(r.clk),B=z[0];t=B.name;if(t&&!B.disabled&&B.type=="image"){C.push({name:t,value:z.val()});C.push({name:t+".x",value:r.clk_x},{name:t+".y",value:r.clk_y})}}return C};h.fn.formSerialize=function(i){return h.param(this.formToArray(i))};h.fn.fieldSerialize=function(j){var i=[];this.each(function(){var r=this.name;if(!r){return}var p=h.fieldValue(this,j);if(p&&p.constructor==Array){for(var q=0,k=p.length;q<k;q++){i.push({name:r,value:p[q]})}}else{if(p!==null&&typeof p!="undefined"){i.push({name:this.name,value:p})}}});return h.param(i)};h.fn.fieldValue=function(s){for(var r=[],p=0,j=this.length;p<j;p++){var q=this[p];var k=h.fieldValue(q,s);if(k===null||typeof k=="undefined"||(k.constructor==Array&&!k.length)){continue}if(k.constructor==Array){h.merge(r,k)}else{r.push(k)}}return r};h.fieldValue=function(j,u){var p=j.name,B=j.type,C=j.tagName.toLowerCase();if(u===undefined){u=true}if(u&&(!p||j.disabled||B=="reset"||B=="button"||(B=="checkbox"||B=="radio")&&!j.checked||(B=="submit"||B=="image")&&j.form&&j.form.clk!=j||C=="select"&&j.selectedIndex==-1)){return null}if(C=="select"){var w=j.selectedIndex;if(w<0){return null}var z=[],k=j.options;var r=(B=="select-one");var x=(r?w+1:k.length);for(var q=(r?w:0);q<x;q++){var s=k[q];if(s.selected){var A=s.value;if(!A){A=(s.attributes&&s.attributes.value&&!(s.attributes.value.specified))?s.text:s.value}if(r){return A}z.push(A)}}return z}return h(j).val()};h.fn.clearForm=function(i){return this.each(function(){h("input,select,textarea",this).clearFields(i)})};h.fn.clearFields=h.fn.clearInputs=function(i){var j=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var p=this.type,k=this.tagName.toLowerCase();if(j.test(p)||k=="textarea"){this.value=""}else{if(p=="checkbox"||p=="radio"){this.checked=false}else{if(k=="select"){this.selectedIndex=-1}else{if(p=="file"){if(/MSIE/.test(navigator.userAgent)){h(this).replaceWith(h(this).clone(true))}else{h(this).val("")}}else{if(i){if((i===true&&/hidden/.test(p))||(typeof i=="string"&&h(this).is(i))){this.value=""}}}}}}})};h.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};h.fn.enable=function(i){if(i===undefined){i=true}return this.each(function(){this.disabled=!i})};h.fn.selected=function(i){if(i===undefined){i=true}return this.each(function(){var j=this.type;if(j=="checkbox"||j=="radio"){this.checked=i}else{if(this.tagName.toLowerCase()=="option"){var k=h(this).parent("select");if(i&&k[0]&&k[0].type=="select-one"){k.find("option").selected(false)}this.selected=i}}})};h.fn.ajaxSubmit.debug=false;function f(){if(!h.fn.ajaxSubmit.debug){return}var i="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(i)}else{if(window.opera&&window.opera.postError){window.opera.postError(i)}}}})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.widget",{options:{mode:"browser"},_create:function(){var e=this,g=this.options,f=this.element;g.mode=g.readonly&&g.mode=="edit"?"browser":g.mode;f.addClass("an-widget "+g.mode)[0].contentEditable=false;g.metadata=f.getMetadata()||{};g.attributes=attributes(f.get(0));g["transient"]=g.attributes["transient"];g.id=f.attr("id");if(g.id){g.id=g.id.replace(/-/g,".")}g.type=f.attr("type");if(a.type(g.parent)=="function"){g.parent=g.parent()}this.content=f.children("div.content");if(this.content.size()==0){this.content=a("<div class='content'/>").appendTo(f)}this._makeResizable();f.bind("metadatachanged.widget",function(j,i,h){j.stopImmediatePropagation();e._reloadMetadata(i,h)}).bind("attributeschanged.widget",function(j,h,i){j.stopImmediatePropagation();g.attributes=h;e._trigger("optionchanged",null,{key:"attributes",value:h,oldValue:i})}).bind("dblclick.widget click.widget change.widget",function(h){if(a(h.target).closest(".widget")[0]==e.element[0]){setTimeout(function(){f.trigger(a.Event(h,{type:"widget"+h.type}),e)},20)}})},_init:function(){this.refresh()},selectable:function(f){return this.options.mode=="design"},_makeResizable:function(){var e=this,h=this.options,g=this.element,f=null;g.removeClass("fill-width auto-width fill-height auto-height");if(h.width=="fill"||h.width=="auto"){g.css("width","").addClass(h.width+"-width")}else{f="e"}if(h.height=="fill"||h.height=="auto"){g.css("height","").addClass(h.height+"-height")}else{f=f?(f+",s,se"):"s"}if(f&&(h.mode=="design"||h.resizable)){g.resizable({handles:f,stop:function(j,i){e._trigger("resize",null,{size:i.size,oldSize:i.originalSize})}})}},option:function(e,f){var g=this.options;if(e==="mode"&&f==="edit"&&g.readonly){f="browser"}if(e==="value"&&f===b){return g.value}if(e==="actionSet"&&f===b){return g.actioSet}return a.Widget.prototype.option.apply(this,arguments)},_setOption:function(f,g){var h=this.options,e=h[f];if(!equals(g,e)){a.Widget.prototype._setOption.apply(this,arguments);this._handleChange(f,g,e);this._trigger("optionchanged",null,{key:f,value:g,oldValue:e,isTransient:h.isTransient})}return this},_handleChange:function(f,g,e){if(f==="mode"||f==="value"){if(f==="mode"){this.element.removeClass(e).addClass(g)}this.refresh()}else{if(f=="width"||f=="height"){this._makeResizable()}else{if(f=="readonly"){if(g){this.option("mode","browser")}else{this.option("mode","edit")}}}}},_reloadMetadata:function(f,e){this.options.metadata=f;this.option(f[this.widgetName]);this.refresh();this._trigger("optionchanged",null,{key:"metadata",value:f,oldValue:e})},_updateMetadata:function(){var g=this.options,f=this.element,e=f.getMetadata();if(!equals(g.metadata,e)){f.setMetadata(g.metadata);this._trigger("optionchanged",null,{key:"metadata",value:g.metadata,oldValue:e})}},refresh:function(){var e=this.options;this["_"+e.mode]&&this["_"+e.mode]()},highlight:function(e){this.element.toggleClass("an-state-hover",e)},scrollTo:function(){var f=this.options,e={onlyIfOutside:true,offsetTop:50,offsetLeft:50};if(f.mode=="design"){f.parent.scrollTo(f.id,e)}else{this.element.ScrollTo(e)}},destroy:function(){this.element.resizable("destroy").unbind(".widget").removeAttr("contenteditable").removeClass("an-widget browser design edit selected");return a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.field",a.an.widget,{options:{value:"",},_create:function(){a.an.widget.prototype._create.apply(this,arguments);var g=this.options,f=this.element;f.addClass("an-field");var e={};if(g.width){e.width=g.width}if(g.height){e.height=g.height}this.content.empty();if(!a.isEmptyObject(e)){this.content.css(e)}g.isTransient=f.attr("transient");this._createControl();this._createLabel()},_createControl:function(){},_createLabel:function(){var f=this.options,e=this.element;if(f.label){a("<label/>").attr("for",f.id).html(f.label).prependTo(e)}},destroy:function(){this.content.remove();this.element.removeClass("an-field").children("label").remove();return a.an.widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.box",a.an.widget,{options:{visibleButtonCount:3,link:"raw"},_create:function(){a.an.widget.prototype._create.apply(this,arguments);var f=this.options,e=this.element;e.addClass("an-box ui-corner-all").addClass(f.link=="raw"?"raw":"link").children(".title-bar").remove();this._showTitleBar(!f.hideTitleBar);this._showFootButtons(f.footAreaButtons||[]);e.bind("contextmenu2.box contextmenu.box",function(g){if((f.contextmenu2&&g.type=="contextmenu2")||(!f.contextmenu2&&g.type=="contextmenu")){var h={};if(f.mode=="design"){h.select={type:"menuItem",text:"Select",handler:function(){e.trigger("click")}}}if(!a.isEmptyObject(h)){a(g.target).menu({autoShow:true,menuPosition:{of:g,my:"left top",at:"left bottom"},actions:h,select:function(j,i){a(this).menu("destroy")},collapseAll:function(i){a(this).menu("destroy")}})}}g.preventDefault()})},selectable:function(g){var h=this.options,f=g.target;if(h.hideTitleBar){return f==this.element[0]}else{return a(f).closest("div.title-bar")[0]==this.titleBar[0]}},_showTitleBar:function(e){var g=this.options,f=this.element;if(e){if(!this.titleBar){this.titleBar=a("<div class='title-bar ui-widget-header ui-corner-top'/>").prependTo(this.element);this.title=a("<div class='title'/>").html(g.title).appendTo(this.titleBar);this.toolbar=a("<div class='toolbar'/>").appendTo(this.titleBar)}this._refreshToolbarButtons()}else{f.removeClass("title-bar");this.titleBar&&this.titleBar.remove();delete this.titleBar}},_refreshToolbarButtons:function(){var g=this,k=this.options,j=k.toolbarButtons||[];a.each(j,function(i,p){if(i>=k.visibleButtonCount){return false}a("<button class='title-button'/>").appendTo(g.toolbar).button({label:p.label}).click(function(q){g.element.trigger("boxtoolbarbuttonclick",[g,p.id]);q.preventDefault();q.stopImmediatePropagation()})});if(j.length>k.visibleButtonCount){var f=[];for(var h=k.visibleButtonCount;h<j.length;h++){f.push({id:j[h].id,type:"menuItem",text:j[h].label,handler:function(){g.element.trigger("toolbarbuttonclick",[g,this.id])},enabled:function(){return true}})}var e=a("<button class='box-menu'/>").button({label:"Box Menu",text:false,icons:{primary:"box-menu-icon"}}).appendTo(g.toolbar);e.menu({triggerEvent:"click",menuPosition:{of:e,my:"right top",at:"right bottom"},actions:f,select:function(){a(this).menu("collapseAll")}}).click(function(i){i.preventDefault()}).blur(function(i){e.menu("collapseAll")})}},_showFootButtons:function(g){var e=this,f=this.element;if(g&&g.length>0){if(!this.footArea){this.footArea=a("<div class='foot-area'/>").appendTo(f)}else{this.footArea.empty()}a.each(g,function(h,i){a("<button class='foot-button'/>").attr("id",i.id).html(i.label).prependTo(e.footArea).button().click(function(j){e.element.trigger("boxfootareabuttonclick",[e,i.id]);j.preventDefault();j.stopImmediatePropagation()})})}else{f.removeClass("foot-area");this.footArea&&this.footArea.remove();delete this.footArea}},newDocument:function(h,i){i=i||{};var f=this,k=this.options,e=i.dbId||k.dbId,g=a("<div class='target'/>").appendTo(this.content.empty()),j=a.extend(true,{},i,{opened:function(p){var q=p.option("document"),r=i.title||q.title||q._id;f._showFootButtons(i.footAreaButtons||[]);f.option("title",r);i.opened&&i.opened(p)}});j.mode=j.mode!="design"?"edit":j.mode;j.mobile=i.mobile;if(i.mobile&&i.mode=="design"){a.ans.getDoc(e,i.parent,null,function(r,t){if(r){console.log("Get parent document "+i.parent+" error:"+r)}else{var q=Model.rootId(h),s=a.extend(true,{},i["default"],{_id:i.id||new ObjectId().toString(),type:h});if(s._path){s._path=s._path.replace(/[^,]+,$/,s._id+",")}else{if(q){s._path=q+","+s._id+","}}if(t&&t._path){s._path=t._path+s._id+","}if(s.type==Model.FORM||s.type==Model.PAGE){g.page({mode:"design",mobile:true,page:s})}else{Model.newDocument(g,e,h,j)}}})}else{Model.newDocument(g,e,h,j)}return this},openDocument:function(g,i){i=i||{};var f=this,k=this.options,e=i.dbId||k.dbId,h=a("<div class='target'/>").appendTo(this.content.empty()),j=a.extend(true,{},i,{opened:function(p){var q=p.option("document"),r=i.title||q.title||q._id;f._showFootButtons(i.footAreaButtons||[]);f.option("title",r);i.opened&&i.opened(p)}});if(k.mobile&&k.mode=="design"){Model.getPages(e,[g],function(p,q){h.page({mode:"design",page:q[0],mobile:true})})}else{Model.openDocument(h,e,g,j)}return this},saveDocument:function(e){e=e||{};var f=this.linkedWidget();if(f&&f.option("isDocumentEditor")){f.save(e)}return this},openForm:function(k,h){h=h||{};a.extend(true,h,{isFormEditor:true});var f=this,j=this.options,e=h.dbId||j.dbId,g=a("<div class='target'/>").appendTo(this.content.empty()),i=a.extend(true,{mode:h.mode!="design"?"edit":h.mode},h,{opened:function(p){var q=p.option("currentForm"),r=h.title||q.title||q._id;f._showFootButtons(h.footAreaButtons||[]);f.option("title",r);h.opened&&h.opened(p)}});if(j.mobile&&j.mode=="design"){Model.getPages(e,[k],function(q,p){g.page({mode:"design",page:p[0],document:p[0],mobile:true})})}else{Model.openPage(g,e,k,i)}return this},openView:function(e,i){i=i||{};var g=this,k=this.options,f=i.dbId||k.dbId,h=a("<div class='target'/>").appendTo(this.content.empty()),j=a.extend(true,{},i,{opened:function(p){var q=p.option("view"),r=i.title||q.title||q._id;g._showFootButtons(i.footAreaButtons||[]);g.option("title",r);i.opened&&i.opened(p)}});Model.openView(h,f,e,j);return this},openPage:function(g,i){i=i||{};a.extend(true,i,{isPageEditor:true});var f=this,k=this.options,e=i.dbId||k.dbId,h=a("<div class='target'/>").appendTo(this.content.empty()),j=a.extend(true,{mode:i.mode!="design"?"edit":i.mode},i,{opened:function(q){var r=q.option("page"),s=i.title||r.title||r._id;f._showFootButtons(i.footAreaButtons||[]);f.option("title",s);i.opened&&i.opened(q)}});if(k.mobile&&k.mode=="design"){Model.getPages(e,[g],function(q,p){h.page({mode:"design",page:p[0],mobile:true})})}else{Model.openPage(h,e,g,j)}return this},openSideView:function(h,i){i=i||{};var f=this,k=this.options,e=i.dbId||k.dbId,g=a("<div class='target'/>").appendTo(this.content.empty()),j=a.extend(true,{},i,{opened:function(p){var q=i.title||p.option("title")||p.option("_id");f._showFootButtons(i.footAreaButtons||[]);f.option("title",q);i.opened&&i.opened(page)}});Model.openSideView(g,e,h,j);return this},_browser:function(){var p=this.options,g=p.link;this.option("contextmenu2",false);this.content[0].contentEditable=false;if(g&&g!="raw"){var k=this.content.children(".target"),j=k.data(),h=false;for(var e in j){if(a.inArray(e,["editor","gridview","formview","customview","customizedview","page","sideview","explorer","mobilelistview"])!=-1){j[e].option("mode","browser");h=true}}if(!h){var f={dbId:p.odbId||p.dbId,mobile:p.mobile},q=p.targetId;if(p.mobile&&p.mode=="design"){f.mode=p.mode}if(g=="documentType"){this.newDocument(q,f)}else{if(g=="document"){this.openDocument(q,f)}else{if(g=="form"){this.openForm(q,f)}else{if(g=="view"){this.openView(q,f)}else{if(g=="page"){this.openPage(q,f)}else{if(g=="sideView"){this.openSideView(q,f)}}}}}}}}},linkedWidget:function(){var f=this.content.children(".an-view,.an-page,.an-editor,.an-mpage").data(),e=null;if(f){a.each(f,function(){if(a.inArray(this.widgetName,["editor","gridview","formview","customview","view","page","mobilelistview"])!=-1){e=this;return false}})}return e},_edit:function(){var h=this.options,q=h.link;this.option("contextmenu2",false);this.content[0].contentEditable=false;if(q&&q!="raw"){var p=this.content.children(".target"),j=p.data(),e=false;for(var k in j){if(k=="editor"){j[k].option("mode","edit");e=true}if(a.inArray(k,["gridview","formview","view","page","sideview","explorer"])!=-1){j[k].option("mode","browser");e=true}}if(!e){var f=h.targetId,g={dbId:h.odbId||h.dbId},r={mode:"edit",dbId:h.odbId||h.dbId};if(q=="documentType"){this.newDocument(f,r)}else{if(q=="document"){this.openDocument(f,r)}else{if(q=="form"){this.openForm(f,r)}else{if(q=="view"){this.openView(f,g)}else{if(q=="page"){this.openPage(f,r)}else{if(q=="sideView"){this.openSideView(f,g)}}}}}}}}},_design:function(){var f=this.options,e=f.link;if(f.mobile){f.mode="design"}this._browser();this.option("contextmenu2",true);if(e=="raw"){this.content[0].contentEditable=true}},_handleChange:function(f,g,e){if(f==="title"){this.title&&this.title.html(g)}else{if(f==="hideTitleBar"){this._showTitleBar(!g)}}return a.an.widget.prototype._handleChange.apply(this,arguments)},destroy:function(){var f=this.options,e=f.link;if(e&&e!="raw"){this.content.remove()}else{this.content.removeAttr("contenteditable")}this.titleBar&&this.titleBar.remove();this.footArea&&this.footArea.remove();this.element.unbind(".box").removeClass("an-box ui-corner-all title-bar");return a.an.widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
 * This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.inputfield",a.an.field,{_create:function(){a.an.field.prototype._create.apply(this,arguments);this.element.addClass("an-inputfield")},_createControl:function(){var e=this,g=this.options;if(g.mobile){var f=this.element.find(".content").eq(0);f.addClass("ui-shadow-inset ui-corner-all ui-btn-shadow ui-body-c ui-input-text");this.input=a("<input type='"+g.type+"'/>").attr({name:g.id}).addClass("ui-body-c ui-input-text").bind("change.inputfield keyup.inputfield",function(j){var i=e.input.val(),h=g.value;if(i!=h){g.value=i;e._trigger("optionchanged",null,{key:"value",value:i,oldValue:h,isTransient:g.isTransient})}}).bind("dblclick.inputfield",function(h){h.stopImmediatePropagation()}).bind("focus.inputfield",function(h){f.addClass("ui-focus")}).bind("blur.inputfield",function(h){f.removeClass("ui-focus")}).bind("keyup.inputfield",function(h){});if(g.placeholder){this.input.attr("placeholder",g.placeholder)}if(g.value){this.input.attr("value",g.value);this._trigger("optionchanged",null,{key:"value",value:g.value,oldValue:"",isTransient:g.isTransient})}if(g.data_mini){this.input.attr("data-mini",g.data_mini)}}else{this.input=a("<input type='"+g.type+"'/>").attr({name:g.id}).addClass("ui-widget-content ui-corner-all").bind("change.inputfield keyup.inputfield",function(j){var i=e.input.val(),h=g.value;if(i!=h){g.value=i;e._trigger("optionchanged",null,{key:"value",value:i,oldValue:h,isTransient:g.isTransient})}}).bind("dblclick.inputfield",function(h){h.stopImmediatePropagation()})}if(!a.isEmptyObject(g.validate)){this.input.addClass(a.toJSON({validate:g.validate}))}this.input.css({width:g.width,height:g.height})},_makeResizable:function(){},_browser:function(){this.input.detach();var e=this.content;if(e.is(".ui-resizable")){e.resizable("destroy")}e.html(this.options.value+"").css("display","")},_edit:function(){this.input.detach().val(this.options.value).appendTo(this.content.empty())},_design:function(){this.input.detach();var e=this,f=this.options,g=this.content;if(g.is(".ui-resizable")){g.resizable("destroy")}g.html(f.value+"").css({width:f.width,height:f.height,display:""}).resizable({stop:function(i,h){f.width=g.width();f.height=g.height();a.extend(true,f.metadata[e.widgetName],{width:f.width,height:f.height});e._updateMetadata();e._trigger("resize",null,{size:h.size,oldSize:h.originalSize})}})},_handleChange:function(f,g,e){if(f==="label"){this.input&&this.input.remove();this.element.children("label").remove();this._createControl();this._createLabel()}else{a.an.field.prototype._handleChange.apply(this,arguments)}},highlight:function(e){(this.options.mode=="edit"?this.input:this.element).toggleClass("an-state-hover",e)},destroy:function(){this.input&&this.input.unbind(".inputfield").remove();this.element.removeClass("an-inputfield");return a.an.field.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(b,e){var a="C:\\fakepath\\";b.widget("an.fileinput",{options:{browserButtonText:"Browse",uploadParams:{},uploadURL:"",uploadButtonText:"Upload",inputText:""},_create:function(){var f=this,g=this.options;this.parent=this.element.parent();this.fileFile=this.element;this.wrapper=b("<div class='wrapper' />").insertAfter(this.fileFile);this.fileWrapper=b("<div class='fileinput-wrapper' />").hover(function(){f.browserButton.addClass("ui-state-hover")},function(){f.browserButton.removeClass("ui-state-hover ui-state-active")}).bind("mousemove.fileinput",function(i){var h=f.fileFile,j=b(this).offset();h.css({left:(i.pageX-j.left)-(h.width()/1.2),top:(i.pageY-j.top)-(h.height()/2)})}).bind("mousedown.fileinput",function(h){f.browserButton.addClass("ui-state-active")}).bind("mouseup.fileinput",function(h){f.browserButton.removeClass("ui-state-active")}).appendTo(this.wrapper);this.fileFile.addClass("fileinput-file").appendTo(this.fileWrapper);this.fileInput=b("<div class='fileinput-input ui-widget-content ui-corner-left' />").text(this._getText()).insertBefore(this.fileFile);this.browserButtonText=b("<span class='fileinput-button-text' />").text(g.browserButtonText);this.browserButton=b("<span class='fileinput-button ui-state-default ui-widget-header ui-corner-right' />").append(this.browserButtonText).insertAfter(this.fileInput);if(g.upload){this.uploadButtonText=b("<span class='fileinput-button-text' />").text(g.uploadButtonText);this.uploadButton=b("<span class='upload-button ui-state-default ui-widget-header ui-corner-right' />").append(this.uploadButtonText).insertAfter(this.fileWrapper).click(function(i){f.fileInput.progressbar();var h=b('<form action="" method="POST"></form>');f.fileFile.clone().attr("name","attachment").appendTo(h);b.each(g.uploadParams,function(p,j){b('<input type="hidden">').attr("name",p).attr("value",j).appendTo(h)});h.ajaxSubmit({url:g.uploadURL,uploadProgress:function(q,j,p,k){f.fileInput.progressbar("option","value",k*100)},success:function(j){f.fileInput.progressbar("destroy").addClass("ui-widget-content");f.element.trigger("uploaded",[j]);f.reset()}})})}this.fileFile.bind("change.fileinput mouseout.fileinput",function(h){f.fileInput.text(f._getText())}).bind("focusin.fileinput",function(){f.browserButton.addClass("ui-state-hover")}).bind("focusout.fileinput",function(){f.browserButton.removeClass("ui-state-hover")})},_getText:function(){var f=this.getValue(),g=this.options.inputText;if(f==""){return g}else{return f}},getValue:function(){return fileValue=this.fileFile.val().replace(a,"")},reset:function(){this.fileInput.text(this.options.inputText)},destroy:function(){this.fileFile.removeClass("fileinput-file").appendTo(this.parent);this.wrapper.remove();b.Widget.prototype.destroy.call(this)},hide:function(){this.wrapper.hide()},show:function(){this.wrapper.show()},_setOption:function(f,g){b.Widget.prototype._setOption.apply(this,arguments);switch(f){case"browserButtonText":this.browserButtonText.text(g);break;case"inputText":this.fileInput.text(this._getText());break}}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.textfield",a.an.inputfield,{_create:function(){a.an.inputfield.prototype._create.apply(this,arguments);this.element.addClass("an-textfield")},destroy:function(){this.element.removeClass("an-textfield");return a.an.inputfield.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.radiofield",a.an.inputfield,{options:{orientation:"horizontal"},_create:function(){a.an.inputfield.prototype._create.apply(this,arguments);this.element.addClass("an-radiofield");this.content.remove()},_createControl:function(){var f=this,i=this.options,g=this.element;if(i.mobile){var h=a("<div class='ui-controlgroup-controls' />");h.append(a("<label />").attr("for",i.id).html(i.label).css("display","block"));a.each(i.selectItems||[],function(p,j){var s=a("<div class='ui-radio' />");a("<input type='radio'/>").attr({id:i.id+p,name:i.id,value:this.value}).addClass("ui-widget-content").appendTo(s);a("<div class='content'/>").hide().appendTo(g);var q='<span class="ui-btn-inner"><span class="ui-btn-text">'+this.label+'</span> 					<span class="ui-icon ui-icon-radio-on ui-icon-shadow"> </span>					</span>';var r=a("<label class='ui-radio-off ui-btn ui-btn-up-c ui-fullsize ui-btn-icon-left' style='margin:0'  />").attr("for",i.id+p);if(!i.data_theme){i.data_theme="c"}if(p==0){r.addClass("ui-first-child")}if(p==(i.selectItems.length-1)){r.addClass("ui-last-child")}r.addClass("ui-btn-up-"+i.data_theme);r.html(q).appendTo(s);s.appendTo(h)});var e=a("<div border='1' class='ui-controlgroup ui-corner-all ui-controlgroup-"+i.orientation+"'/>");if(i.isMini){e.addClass("ui-mini")}h.appendTo(e.appendTo(g));h.delegate(".ui-radio","click",function(k){var j=a(this);if(i.orientation=="vertical"){j.removeClass("ui-icon-radio-off").addClass("ui-radio-on").siblings().removeClass("ui-radio-on")}else{j.find(">label").addClass("ui-btn-active");j.siblings().find(">label").removeClass("ui-btn-active")}j.find("input").attr("checked","checked");j.siblings().find("input").removeAttr("checked");j.find("input").trigger("change.radiofield")})}else{a.each(i.selectItems||[],function(p,j){a("<input type='radio'/>").attr({id:i.id+p,name:i.id,value:this.value}).addClass("ui-widget-content ui-corner-all").appendTo(g);a("<div class='content'/>").hide().appendTo(g);a("<label/>").attr("for",i.id+p).html(this.label).appendTo(g);if(i.orientation=="vertical"){g.append("<br>")}})}this.inputs=g.find("input");this.contents=g.children(".content");if(!a.isEmptyObject(i.validate)){this.inputs.addClass(a.toJSON({validate:i.validate}))}this.inputs.filter("[value="+i.value+"]").prop("checked",true);this.inputs.bind("change.radiofield",function(p){var k=a(p.target).attr("value"),j=i.value;if(k!=j){i.value=k;f._trigger("optionchanged",null,{key:"value",value:k,oldValue:j,isTransient:i.isTransient})}}).bind("dblclick.radiofield",function(j){j.stopImmediatePropagation()})},_createLabel:function(){},_makeResizable:function(){},_handleChange:function(f,g,e){var h=this.options;if(f=="value"){this.inputs.filter("[value="+h.value+"]").prop("checked",true)}else{if(f=="selectItems"){this.inputs.remove();this.contents.remove();this.element.children("label,br").remove();this._createControl()}else{if(f=="orientation"){this.inputs.remove();this.contents.remove();this.element.children("label,br").remove();this._createControl()}else{return a.an.inputfield.prototype._handleChange.apply(this,arguments)}}}},_browser:function(){this.contents.css("display","none");this.inputs.attr("disabled","disabled")},_edit:function(){this.contents.css("display","none");this.inputs.removeAttr("disabled")},_design:function(){if(!this.options.mobile){this.inputs.hide();this.contents.css("display","")}},highlight:function(e){this.element.toggleClass("an-state-hover",e)},destroy:function(){if(this.options.mobile){this.element.children(".ui-controlgroup").unbind(".radiofield").remove()}this.inputs.unbind(".radiofield").remove();this.contents.remove();this.element.removeClass("an-radiofield").children("br").remove();a.an.inputfield.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.checkboxfield",a.an.inputfield,{_create:function(){a.an.inputfield.prototype._create.apply(this,arguments);this.element.addClass("an-checkboxfield");this.content.hide()},_createControl:function(){var f=this,i=this.options,g=this.element,j=this.content;if(i.mobile){var h={};if(i.selectItems.length>1){var e=a("<fieldset data-role='controlgroup' />").appendTo(j);if(i.orientation=="horizontal"){e.attr({"data-type":"horizontal"})}a.each(i.selectItems||[],function(q,p){this.input=a("<input type='checkbox'/>").attr({id:i.id+q,name:i.id+q,value:this.value}).appendTo(e);a("<label />").attr({"for":i.id+q}).html(this.label).appendTo(e)})}else{a.each(i.selectItems||[],function(q,p){this.input=a("<input type='checkbox'/>").attr({id:i.id,name:i.id,value:this.value}).addClass("custom").appendTo(j);a("<label  />").attr({"for":i.id}).html(this.label).appendTo(j)})}if(!i.data_theme){i.data_theme="c"}h.theme=i.data_theme;if(i.isMini){h.mini=true}if(a("input[type='checkbox']").checkboxradio){a("input[type='checkbox']").checkboxradio(h);a("fieldset[data-role='controlgroup']").controlgroup()}}else{this.input=a("<input type='checkbox'/>").attr({name:i.id}).addClass("ui-widget-content ui-corner-all").bind("change.checkboxfield",function(q){var p=f.input.prop("checked"),k=i.value;if(p!=k){i.value=p;f._trigger("optionchanged",null,{key:"value",value:p,oldValue:k,isTransient:i.isTransient})}}).bind("dblclick.checkboxfield",function(k){k.stopImmediatePropagation()});if(!a.isEmptyObject(i.validate)){this.input.addClass(a.toJSON({validate:i.validate}))}this.input.appendTo(this.element)}},_handleChange:function(f,g,e){var h=this.options;if(f=="value"){this.input.filter("[value="+h.value+"]").prop("checked",true)}else{if(f=="selectItems"){this.input.remove();this.contents.remove();this.element.children("label,br").remove();this._createControl()}else{return a.an.inputfield.prototype._handleChange.apply(this,arguments)}}},_makeResizable:function(){},_createLabel:function(){var f=this.options,e=this.element;if(f.label){if(!f.mobile){a("<label/>").attr("for",f.id).html(f.label).appendTo(e)}}},_browser:function(){if(!this.options.mobile){this.input.prop("checked",this.options.value).attr("disabled","disabled")}else{this.content.css("display","")}},_edit:function(){if(!this.options.mobile){this.input.prop("checked",this.options.value).removeAttr("disabled")}else{this.content.css("display","")}},_design:function(){var g=this.options,h=this.content;if(g.mobile){if(!g.data_theme){g.data_theme="c"}h.html("");if(g.selectItems.length>1){var e=a("<fieldset class='ui-corner-all ui-controlgroup' />").appendTo(h);if(g.orientation=="horizontal"){e.addClass("ui-controlgroup-horizontal")}var f=a("<div class='ui-controlgroup-controls' />").appendTo(e);a.each(g.selectItems||[],function(j,i){var q=a("<div class='ui-checkbox' />").html('<input type="checkbox" id="'+g.id+j+'" name="'+g.id+j+'" value="'+i+'">').appendTo(f);var p=a("<label class='ui-checkbox-off ui-btn ui-btn-corner-all ui-fullsize ui-btn-icon-left ui-btn-up-"+g.data_theme+"' />").html('<span class="ui-btn-inner"><span class="ui-btn-text">'+this.label+'</span><span class="ui-icon ui-icon-checkbox-off ui-icon-shadow">&nbsp;</span></span>').appendTo(q);if(j==0){p.addClass("ui-first-child")}if(j==g.selectItems.length-1){p.addClass("ui-last-child")}})}else{a.each(g.selectItems||[],function(j,i){a("<div class='ui-checkbox' />").html('<input type="checkbox" id="'+g.id+j+'" name="'+g.id+j+'" value="'+i+'"><label for="1230" class="ui-checkbox-off ui-btn ui-btn-corner-all ui-fullsize ui-btn-icon-left ui-btn-up-'+g.data_theme+'"><span class="ui-btn-inner"><span class="ui-btn-text">'+this.label+'</span><span class="ui-icon ui-icon-checkbox-off ui-icon-shadow">&nbsp;</span></span></label>').appendTo(h)})}this.content.css("display","")}else{this.input.hide();this.content.css("display","")}},highlight:function(e){this.element.toggleClass("an-state-hover",e)},destroy:function(){if(!this.options.mobile){this.input.unbind(".checkboxfield")}this.element.removeClass("an-checkboxfield");return a.an.inputfield.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.passwordfield",a.an.inputfield,{_create:function(){a.an.inputfield.prototype._create.apply(this,arguments);this.element.addClass("an-passwordfield")},_browser:function(){a.an.inputfield.prototype._browser.apply(this,arguments);this.content.html("********")},_design:function(){this.input.hide();var e=this,f=this.options,g=this.content;if(g.is(".ui-resizable")){g.resizable("destroy")}g.html("********").css({width:f.width,height:f.height,display:""}).resizable({stop:function(i,h){f.width=g.width();f.height=g.height();a.extend(true,f.metadata[e.widgetName],{width:f.width,height:f.height});e._updateMetadata();e._trigger("resize",null,{size:h.size,oldSize:h.originalSize})}})},destroy:function(){this.element.removeClass("an-passwordfield");a.an.inputfield.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.datetimefield",$.an.inputfield,{_create:function(){$.an.inputfield.prototype._create.apply(this,arguments);this.element.addClass("an-datetimefield")},_edit:function(){var date=new Date(),lng=window.database.local,opts={hour:date.getHours(),minute:date.getMinutes(),dateFormat:this.options.dateFormat?this.options.dateFormat:"mm/dd/yy",minDate:this.options.minDate&&eval("("+this.options.minDate+")")||null,maxDate:this.options.maxDate&&eval("("+this.options.maxDate+")")||null,yearRange:this.options.yearRange?this.options.yearRange:"c-10:c+10",changeMonth:true,changeYear:true,onClose:function(){var $this=$(this);$this.valid&&$this.valid()}};if(lng&&lng!="en"){$.extend(opts,$.i18n.datepicker)}$.an.inputfield.prototype._edit.apply(this,arguments);this.input.removeClass("hasDatepicker");if(this.options.time=="y"){this.input.datetimepicker(opts)}else{this.input.datepicker(opts)}},destroy:function(){this.input.datepicker("destroy");this.element.removeClass("an-datetimefield");return $.an.inputfield.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.textareafield",a.an.field,{_create:function(){a.an.field.prototype._create.apply(this,arguments);this.element.addClass("an-textareafield")},_createControl:function(){var e=this,g=this.options,f=this.element;if(g.mobile){f.find(".content").addClass("codiqa-control");this.textarea=a("<textarea type='"+g.type+"'/>").attr("name",g.id).addClass("ui-input-text ui-body-c ui-corner-all ui-shadow-inset");this.textarea.bind("change.textareafield keyup.textareafield",function(j){j.preventDefault();var i=e.textarea.val(),h=g.value;if(i!=h){g.value=i;e._trigger("optionchanged",null,{key:"value",value:i,oldValue:h,isTransient:g.isTransient})}}).bind("dblclick.textareafield",function(h){h.stopImmediatePropagation()}).bind("focus.textareafield",function(h){a(this).addClass("ui-focus")}).bind("blur.textareafield",function(h){a(this).removeClass("ui-focus")})}else{this.textarea=a("<textarea type='"+g.type+"'/>").attr("name",g.id).addClass("ui-widget-content ui-corner-all");this.textarea.bind("change.textareafield keyup.textareafield",function(j){j.preventDefault();var i=e.textarea.val(),h=g.value;if(i!=h){g.value=i;e._trigger("optionchanged",null,{key:"value",value:i,oldValue:h,isTransient:g.isTransient})}}).bind("dblclick.textareafield",function(h){h.stopImmediatePropagation()})}if(g.resizable){this.content.resizable()}if(!a.isEmptyObject(g.validate)){this.textarea.addClass(a.toJSON({validate:g.validate}))}},_makeResizable:function(){},_browser:function(){this.textarea.detach();var e=this.options,f=this.content;if(f.is(".ui-resizable")){f.resizable("destroy")}f.html(e.pre?"<pre>"+e.value+"</pre>":e.value).css("display","")},_edit:function(){this.textarea.detach().val(this.options.value).appendTo(this.content.empty())},_design:function(){this.textarea.detach();var e=this,f=this.options,g=this.content;if(g.is(".ui-resizable")){g.resizable("destroy")}g.html(f.pre?"<pre>"+f.value+"</pre>":f.value).css({width:f.width,height:f.height,display:""}).resizable({stop:function(i,h){f.width=g.width();f.height=g.height();a.extend(true,f.metadata[e.widgetName],{width:f.width,height:f.height});e._updateMetadata();e._trigger("resize",null,{size:h.size,oldSize:h.originalSize})}})},_handleChange:function(f,g,e){if(f==="label"){this.textarea.remove();this.element.children("label").remove();this._createControl();this._createLabel()}else{a.an.field.prototype._handleChange.apply(this,arguments)}},destroy:function(){this.textarea.unbind(".textareafield").parent().remove();this.element.removeClass("an-textareafield");return a.an.field.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.rtefield",a.an.field,{options:{showToolbar:true},_create:function(){a.an.field.prototype._create.apply(this,arguments);this.element.addClass("an-rtefield");var e=this,f=this.options;this.content.bind("change.rtefield",function(i){i.preventDefault();var h=e.content.rte("option","content"),g=f.value;if(h!=g){f.value=h;e._trigger("optionchanged",null,{key:"value",value:h,oldValue:g,isTransient:f.isTransient})}})},_browser:function(){this.content.rte("destroy").html(this.options.value);this.content.find(".widget[type=tabsx]").each(function(){var e=a(this);if(e.is(".an-tabsxwidget")){e.data("tabsxwidget").option("mode","browser")}else{e.tabsxwidget({parent:function(){return self},mode:"browser"})}})},_edit:function(){var e=this.options;this.content.rte({content:e.value,dbId:e.dbId,showToolbar:e.showToolbar,stylesheet:e.stylesheet,cssClass:e.cssClass,resizable:e.resizable,cssfiles:["stylesheets/rte/rte-design.css","stylesheets/jquery-ui-1.8.24.custom.css","stylesheets/base.css"].concat(e.globalCSSFiles).concat(e.localCSSFiles),jsfiles:[].concat(e.globalJSFiles).concat(e.localJSFiles)})},_design:function(){this._browser()},destroy:function(){this.content.rte("destroy");this.element.removeClass("an-rtefield");return a.an.field.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.selectfield",a.an.field,{options:{nativeMenu:true},_create:function(){a.an.field.prototype._create.apply(this,arguments);this.element.addClass("an-selectfield")},_createControl:function(){var e=this,g=this.options;var f=this.select=a("<select />").attr("name",g.id);if(!g.mobile){a("<option/>").attr("value","").html("").appendTo(f)}a.each(g.selectItems||[],function(){a("<option/>").attr("value",this.value).html(this.label).appendTo(f)});f.bind("change.selectfield",function(j){j.preventDefault();var i=f.val(),h=g.value;if(i!=h){g.value=i;e._trigger("optionchanged",null,{key:"value",value:i,oldValue:h,isTransient:g.isTransient})}});if(!a.isEmptyObject(g.validate)){f.addClass(a.toJSON({validate:g.validate}))}if(g.mobile){if(!g.value&&g.selectItems[0]){g.value=g.selectItems[0].value}}},_makeResizable:function(){},_browser:function(){var e=this,f=this.options;this.select.detach();a.each(f.selectItems,function(){if(this.value==f.value){e.content.html('<span style="padding: .6em 20px;display:inline-block;">'+this.label+"</span>").show();return false}})},_edit:function(){var f=this.options;this.select.detach().val(this.options.value).appendTo(this.content.empty());this._trigger("optionchanged",null,{key:"value",value:f.value,oldValue:"",isTransient:f.isTransient});if(f.mobile){var e={};e.icon="arrow-r";if(f.corners){e.conrners=false}if(f.icon){e.icon=f.icon}if(f.iconpos){e.iconpos=f.iconpos}if(f.iconshadow){e.iconshadow=false}if(f.inline){e.inline=true}if(f.mini){e.mini=true}if(f.nativeMenu){e.nativeMenu=false}if(f.overlayTheme){e.overlayTheme=f.overlayTheme}if(f.preventFocusZoom){e.preventFocusZoom=false}if(f.shadow){e.shadow=false}if(f.theme){e.theme=f.theme}if(this.select.data("mobileSelectmenu")){this.select.data("mobileSelectmenu").destroy()}this.select.selectmenu(e)}},_design:function(){this.select.detach();var e=this,f=this.options,g=this.content;if(f.mobile){g.html('<div class="ui-select">					<a class="ui-btn ui-shadow ui-btn-corner-all ui-btn-icon-right ui-btn-up-c">					<span class="ui-btn-inner">					<span class="ui-btn-text"><span>'+f.selectItems[0].label+'</span></span><span class="ui-icon ui-icon-arrow-d ui-icon-shadow">&nbsp;</span></span></a>					<select>					  </select>					    </div>')}else{if(g.is(".ui-resizable")){g.resizable("destroy")}a.each(f.selectItems,function(){if(this.value==f.value){g.html(this.label);return false}});g.css({width:f.width,height:f.height}).resizable({stop:function(i,h){f.width=g.width();f.height=g.height();a.extend(true,f.metadata[e.widgetName],{width:f.width,height:f.height});e._updateMetadata();e._trigger("resize",null,{size:h.size,oldSize:h.originalSize})}})}},_handleChange:function(f,g,e){if(f==="label"){this.element.children("label").remove();this._createLabel()}else{if(f=="selectItems"){this.select.remove();this._createControl()}else{if(this.options.mobile){this.select.remove();this._createControl()}else{a.an.field.prototype._handleChange.apply(this,arguments)}}}},destroy:function(){this.select.unbind(".selectfield").remove();this.element.removeClass("an-selectfield");return a.an.field.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.filefield",a.an.inputfield,{options:{tags:[],sortBy:"name",mode:"browser",value:[],maxCount:Number.MAX_VALUE,itemWidth:64,itemHeight:64},_create:function(){a.an.inputfield.prototype._create.apply(this,arguments);this.element.addClass("an-filefield wrapper")},_createControl:function(){var e=this,f=this.options,g=this.content;this.files=a("<ul class='grid'/>").appendTo(g);g.delegate("li[data-id][data-id!=uploadButton]","hover.filefield",function(h){if(f.mode!="edit"){return}if(h.type=="mouseenter"){a(this).find("img.button").remove();a("<img class='button' width='24' height='24' src='stylesheets/images/delete.png' />").appendTo(this).position({of:a(this),my:"right top",at:"right top"})}else{if(h.type=="mouseleave"){a(this).find("img.button").remove()}}}).delegate("img.button","hover.filefield",function(h){if(h.type=="mouseenter"){a(this).addClass("ui-state-hover")}else{if(h.type=="mouseleave"){a(this).removeClass("ui-state-hover ui-state-active")}}}).delegate("img.button","mousedown.filefield",function(h){a(this).addClass("ui-state-active")}).delegate("img.button","mouseup.filefield",function(h){a(this).removeClass("ui-state-active")}).delegate("img.button","click.filefield",function(k){k.preventDefault();k.stopImmediatePropagation();var p=a(this).closest("li").attr("data-id"),h=[].concat(f.value);for(var j=0;j<f.value.length;j++){if(f.value[j]._id==p){f.value.splice(j,1);break}}e._trigger("optionchanged",null,{key:"value",value:f.value,oldValue:h,isTransient:f.isTransient});e.loadIcons()});this.input=a("<input type='file'/>").hide().appendTo(this.element);this.element.append(a('<input id="btnCancel" type="button" value="Cancel" disabled="disabled" style="display:none;" />'))},_createSwfUpload:function(f,g){var e={flash_url:"javascripts/swfupload/swfupload.swf",button_window_mode:"transparent",upload_url:"/tmp",file_post_name:"file",post_params:{file:""},file_size_limit:"10 MB",file_types:"*.*",file_types_description:"All Files",file_upload_limit:100,file_queue_limit:0,custom_settings:{cancelButtonId:"btnCancel"},debug:false,button_image_url:"stylesheets/images/selection.png",button_width:"64",button_height:"64",button_placeholder:f,button_text:"",button_action:SWFUpload.BUTTON_ACTION.SELECT_FILE,file_queued_handler:fileQueued,file_queue_error_handler:fileQueueError,file_dialog_complete_handler:fileDialogComplete,upload_start_handler:uploadStart,upload_progress_handler:uploadProgress,upload_error_handler:uploadError,upload_success_handler:g,upload_complete_handler:uploadComplete,queue_complete_handler:function(){}};this.swfUpload=new SWFUpload(e)},loadIcons:function(){var f=this,p=this.options,g=this.files.children(),k=0;for(var j=0;j<g.size();j++){if(g.eq(j).attr("data-id")!="uploadButton"){g.eq(j).remove()}}a.each(p.value,function(q,i){k++;f._addIcon(i)});if(p.mode=="edit"||p.mode=="design"){var e=this.files.find('li[data-id="uploadButton"]');if(e.length==0){e=a("<li/>").attr("data-id","uploadButton");var h=a("<img/>");h.css({width:p.itemWidth,height:p.itemHeight}).appendTo(e);e.appendTo(this.files);if(p.mode=="design"){h.css("backgroundImage","url(stylesheets/images/selection.png)")}else{if(!f.swfUpload){f._createSwfUpload(e.children("img")[0],function(q,r){r=a.parseJSON(r);r._tmp=true;if(!p.value){p.value=[]}var i=[].concat(p.value);p.value.push(r);if(f.files.children().size()>=p.maxCount){setTimeout(function(){e.hide()},50)}f._addIcon(r);f._trigger("optionchanged",null,{key:"value",value:p.value,oldValue:i,isTransient:p.isTransient})})}}}if(k>=p.maxCount){e.hide()}else{e.show()}}},_addIcon:function(h){var k=this.options,e=a("<li/>").attr("data-id",h._id),j="stylesheets/images/file.png",g="";var i="jpg,jpeg,png,gif";if(h._tmp){g="/tmp/"+h._id;if(i.match(h.filename.match(/(?=.)[^.]+$/g)[0])){j=g}}else{if(h.metadata){g=k.url+"/"+h.metadata.filepath;if(i.match(h.filename.match(/(?=.)[^.]+$/g)[0])){j=g}else{j+="#"+g}}}var f=a("<img/>").css({width:k.itemWidth,height:k.itemHeight}).attr("src",j);if(k.downloadable){f.wrap("<a target='_blank'/>").parent().attr("href",g).appendTo(e)}else{f.appendTo(e)}if(k.showFileName){a("<strong/>").text(h.filename).appendTo(e)}if(k.showFileSize){a("<span/>").text(h.length).appendTo(e)}e.prependTo(this.files)},_addUploadButton:function(f){var g=this.options;if((f.size()>=g.maxCount)||(f.size()>=1&&g.maxCount==1)){return f}var e=a("<li/>").attr("data-id","uploadButton");a("<img/>").css({width:g.itemWidth,height:g.itemHeight}).attr("src","stylesheets/images/selection.png").appendTo(e);return f.add(e.get())},_delUploadButton:function(){this.files.find("li#uploadButton").remove()},sort:function(f,h){var i=this.options,g=null;if(f&&f.length){g=this.data.find("li."+f.join("."))}else{g=this.data.find("li")}function e(p,j){var k={reversed:false,by:function(q){return q.text()}};a.extend(k,j);arr=p.get();arr.sort(function(s,q){var t=k.by(a(s));var r=k.by(a(q));if(k.reversed){return(t<r)?1:(t>r)?-1:0}else{return(t<r)?-1:(t>r)?1:0}});return a(arr)}if(h=="size"){g=e(g,{by:function(j){return parseFloat(a(j).find("span").text())}})}else{g=e(g,{by:function(j){return a(j).find("strong").text().toLowerCase()}})}if(i.mode=="edit"||i.mode=="design"){g=this._addUploadButton(g)}this.files.quicksand(g,{duration:800,easing:"easeInOutQuad",useScaling:true},function(){})},_handleChange:function(f,g,e){if(f==="sortBy"){var h=this.options;this.sort(h.tags,h.sortBy)}else{if(f=="label"){this.element.children("label").remove();this._createLabel()}else{a.an.inputfield.prototype._handleChange.apply(this,arguments)}}},refresh:function(){var e=this,f=this.options,g=this.content;if(g.is(".ui-resizable")){g.resizable("destroy")}g.css({width:f.width,height:f.height,display:""});if(f.mode=="design"||f.resizable){g.resizable({stop:function(i,h){f.width=g.width();f.height=g.height();a.extend(true,f.metadata[e.widgetName],{width:f.width,height:f.height});e._updateMetadata();e._trigger("resize",null,{size:h.size,oldSize:h.originalSize})}})}this.loadIcons()},destroy:function(){this.swfUpload&&this.swfUpload.destroy();this.content.undelegate(".filefield");this.element.removeClass("an-filefield wrapper");return a.an.inputfield.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.gridfield",$.an.field,{options:{mode:"browser",addItemLabel:"Add",editItemLabel:"Edit",deleteItemLabel:"Delete",value:[]},_create:function(){$.an.field.prototype._create.apply(this,arguments);this.element.addClass("an-gridfield")},_createControl:function(){var self=this,o=this.options,c=this.content;this.titlebar=$("<div class='titlebar ui-widget-header'/>").appendTo(c);this.title=$("<span class='title'/>").html(o.label).appendTo(this.titlebar);this.toolbar=$("<span class='toolbar'/>").appendTo(this.titlebar);if(o.converter){o.converter=eval("("+o.converter+")");if(!$.isFunction(o.converter)){o.converter=function(row,col,v){return v}}}var lng=window.database.local;if(lng&&lng!="en"){$.extend(o,$.i18n.gridfield)}this.grid=$("<div/>").appendTo(c).agilegrid($.extend({dbId:o.dbId,cellRender:function(row,col){var v="",r=o.value[row],cm=this.colModel;if(r){try{v=eval("r."+cm[col].name)}catch(e){}v=v||""}return o.converter?o.converter(row,col,v):v},leftHeaderRender:function(row){return row+1},columnResize:function(e,data){if(o.mode=="design"){self._updateMetadata()}},optionchanged:function(e,data){if(o.mode=="design"&&data.key=="colModel"){self._updateMetadata()}}},o.gridOptions));$.each(["addItem","editItem","deleteItem"],function(k,v){$("<button class='title-button'/>").attr("id",v).html(o[v+"Label"]).appendTo(self.toolbar).button().click(function(e){self["_"+$(e.target).closest("button").attr("id")]();return false})})},_createLabel:function(){},_makeResizable:function(){},_updateMetadata:function(){var opts={colModel:this.grid.agilegrid("option","colModel"),totalColCount:this.grid.agilegrid("option","totalColCount")};$.extend(true,this.options.metadata,{gridfield:{gridOptions:opts}});return $.an.field.prototype._updateMetadata.apply(this,arguments)},_addItem:function(){this._createItemEditor(this.options.formId)},_editItem:function(){var o=this.options,row=0;$.each(this.grid.agilegrid("option","rowSelections"),function(k,v){if(v){row=k;return false}});this._createItemEditor(o.formId,row)},_deleteItem:function(){var o=this.options,sel=this.grid.agilegrid("option","rowSelections"),value=[];$.each(o.value,function(k,v){if(!sel[k]){value.push(v)}});this._setValue(value)},_setValue:function(value){var o=this.options;var oldValue=o.value;o.value=value;this.grid.agilegrid("option","rowCount",value.length).agilegrid("refresh");this.element.trigger("change");this._trigger("optionchanged",null,{key:"value",value:value,oldValue:oldValue,isTransient:o.isTransient})},_createItemEditor:function(formId,row){var self=this,o=this.options;o.value=o.value||[];$.ans.getDoc(o.dbId,formId,null,function(err,form){$("<div/>").dialog($.extend({title:form.title||form.name||form._id,autoOpen:true,height:500,width:600,modal:true,open:function(event,ui){var doc=new DocWrapper(o.value[row]||{});$(this).form({form:form,document:doc,url:o.url,dbId:o.dbId,mode:"edit",ignoreEscape:true})},buttons:{OK:function(){if(!(o.gridOptions.validate)||(o.gridOptions.validate&&$(this).form("validate"))){var $this=$(this),doc=$this.form("option","document").getDoc(),value=[].concat(o.value);if(row!==undefined){value.splice(row,1,doc)}else{value.push(doc)}self._setValue(value);$this.dialog("close")}},Cancel:function(){$(this).dialog("close")}},close:function(){$(this).form("destroy").remove()}},o.dialogOptions))})},_handleChange:function(key,value,oldValue){$.an.field.prototype._handleChange.apply(this,arguments);if(key==="label"){this.title.html(value)}},_browser:function(){var o=this.options;this.grid.agilegrid($.extend(true,{},{rowCount:(o.value&&o.value.length)||0,isColumnResizable:false,isRowResizable:false,contextmenu2:false},o.gridOptions)).agilegrid("refresh");this.toolbar.hide()},_edit:function(){this._browser();this.toolbar.show()},_design:function(){var self=this,o=this.options,c=this.content;if(c.is(".ui-resizable")){c.resizable("destroy")}c.resizable({stop:function(e,ui){o.width=c.width();o.height=c.height();$.extend(true,o.metadata[self.widgetName],{width:o.width,height:o.height});self._updateMetadata();self._trigger("resize",null,{size:ui.size,oldSize:ui.originalSize})}});this.grid.agilegrid($.extend(true,{},{rowCount:(o.value&&o.value.length)||0,isColumnResizable:true,isRowResizable:true,columnEditable:true,contextmenu2:true},o.gridOptions)).agilegrid("refresh");this.toolbar.show()},destroy:function(){$(window).unbind("resize.an-gridfield",this._proxy);this.element.removeClass("an-gridfield");return $.an.field.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.jsrenderfield",$.an.field,{options:{mode:"browser",selector:"",browserTemplate:"",editorTemplate:"",value:[]},_create:function(){$.an.field.prototype._create.apply(this,arguments);var o=this.options,c=this.content;this.element.addClass("an-jsrenderfield");try{c.html(o.content)}catch(e){}if(o.template){o.template=$.templates(o.template)}if(o.converters){var conv={};var tmp=null;for(var j=0;j<o.converters.length;j++){tmp=eval("(0,"+o.converters[j]["function"]+")");if(!$.isFunction(tmp)){conv[o.converters[j]["name"]]=function(v){return v}}else{conv[o.converters[j]["name"]]=tmp}}$.views.converters(conv)}},_notify:function(oldValue,value){var o=this.options;if(value!=oldValue){o.value=value;this._trigger("optionchanged",null,{key:"value",value:value,oldValue:oldValue,isTransient:o.isTransient})}},appendValue:function(value){var o=this.options,oldValue=[].concat(o.value);o.value.push(value);this.refresh();this._notify(oldValue,o.value)},insertValue:function(index,value){var o=this.options,oldValue=[].concat(o.value);o.value.splice(index,1,value);this.refresh();this._notify(oldValue,o.value)},delValue:function(index){var o=this.options,oldValue=[].concat(o.value);o.value.splice(index,1);this.refresh();this._notify(oldValue,o.value)},getValue:function(index){var o=this.options;return o.value[index]},replaceValue:function(index,value){var o=this.options,oldValue=[].concat(o.value);o.value[index]=value;this.refresh();this._notify(oldValue,o.value)},_browser:function(){var o=this.options;if(o.browserTemplate!=undefined&&o.browserTemplate!=""){var html=$.render[o.browserTemplate](o.value);$(o.selector,this.element).html(html)}else{if(o.template){var html=o.template.render(o.value);$(o.selector,this.element).html(html)}}},_edit:function(){var o=this.options;if(o.editorTemplate!=undefined&&o.editorTemplate!=""){var html=$.render[o.editorTemplate](o.value);$(o.selector,this.element).html(html)}else{if(o.template){var html=o.template.render(o.value);$(o.selector,this.element).html(html)}}},_design:function(){this._browser()},destroy:function(){this.element.removeClass("an-jsrenderfield");return $.an.field.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.buttonwidget",a.an.widget,{_create:function(){var g=this.options;a.an.widget.prototype._create.apply(this,arguments);this.element.addClass("an-buttonwidget");var f={label:this.options.label};if(g.mobile){f.corners=true;f.iconshadow=false;if(g.data_transition){f.transition=g.data_transition}if(g.data_icon){f.icon=g.data_icon}if(g.data_iconpos){f.iconpos=g.data_iconpos}if(g.data_theme){f.theme=g.data_theme}if(g.data_inline){f.inline=g.data_inline}if(g.isMini){f.mini=true}var e=this.content.button(f);a(a(a(a(e).parent()).find(">span")).find(">span").eq(0)).html(this.options.label)}else{this.content.button(f)}},_makeResizable:function(){},_handleChange:function(f,g,e){if(f==="label"){this.content.button("option","label",g)}else{a.an.widget.prototype._handleChange.apply(this,arguments)}},_design:function(){var g=this.options;if(g.mobile){var f='<div data-corners="true" data-shadow="true" data-iconshadow="false"				data-wrapperels="span"  data-disabled="true" data-label="'+g.label+'"				aria-disabled="false">				<span class="ui-btn-inner">					<span class="ui-btn-text">'+g.label+"</span>";if(g.data_icon){f+='<span class="ui-icon ui-icon-arrow-d">&nbsp;</span>'}f+='</span>				<div class="content ui-btn-hidden" data-disabled="false"></div>			</div>';var e=a(f);if(g.data_icon){e.addClass("ui-btn-icon-"+g.data_icon)}if(g.data_iconpos){e.addClass("ui-btn-icon-"+g.data_iconpos)}if(g.data_theme){e.addClass("ui-btn-up-"+g.data_theme)}if(g.data_inline){e.addClass("ui-btn-inline")}if(g.isMini){e.addClass("ui-mini")}e.addClass("ui-btn ui-shadow ui-btn-corner-all");this.content.html(e)}},destroy:function(){this.content.button("destroy").remove();this.element.removeClass("an-buttonwidget");return a.an.widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.tabsxwidget",$.an.widget,{_create:function(){$.an.widget.prototype._create.apply(this,arguments);var self=this,o=this.options,el=this.element,c=this.content,ul=c.children("ul");el.addClass("an-tabsxwidget");if(ul.length<=0){ul=$("<ul/>").appendTo(c)}c.tabsx({tabTemplate:"<li><a href='#{href}' hidefocus='true'>#{label}</a></li>",destroyTabs:false,duration:o.duration,slideshow:o.slideshow,fxs:eval("("+o.fx+")"),mode:o.mode}).bind("contextmenu2.tabsxwidget contextmenu.tabsxwidget",function(e){if((o.contextmenu2&&e.type=="contextmenu2")||(!o.contextmenu2&&e.type=="contextmenu")){var t=$(e.target),actions={},index=t.closest("li").index(),ul=t.closest("ul");if(o.mode=="design"){actions.add={type:"menuItem",text:"Add Tab",handler:function(){self.insertTab(index)}};if(ul.size()!=0){actions.edit={type:"menuItem",text:"Edit Tab",handler:function(){self.editTab(index)}};actions.del={type:"menuItem",text:"Delete Tab",handler:function(){self.removeTab(index)}}}}if(!$.isEmptyObject(actions)){t.menu({autoShow:true,menuPosition:{of:e,my:"left top",at:"left bottom"},actions:actions,select:function(e,ui){$(this).menu("destroy")},collapseAll:function(e){$(this).menu("destroy")}})}e.preventDefault()}});this._updateContentHeight();if(o.mode=="design"){this._contentEditable(true)}},selectable:function(e){return e.target==this.content.children(".ui-tabs-nav")[0]||e.target==this.element[0]},select:function(id){this.content.tabsx("select",id)},_updateContentHeight:function(){var o=this.options,c=this.content,css={},ul=c.children("ul");if(o.minHeight){css["min-height"]=o.minHeight-ul.outerHeight(true)-16}else{if(o.height){css.height=o.height-ul.outerHeight(true)-16}}c.children(".ui-tabs-panel").css(css)},_doEditTab:function(index,isNew){var self=this,o=this.options,c=this.content,doc={},a,p;if(!isNew){a=c.children("ul").find("li").eq(index).children("a");doc.id=a.attr("href").substring(1);doc.label=a.html();p=c.find("#"+doc.id)}$("<div/>").dialog({title:isNew?"Insert Tab":"Edit Tab",height:400,width:500,modal:true,create:function(event,ui){var $this=$(this);$.ans.getDoc(o.dbId,"50a4f883d6c6603d0a000018",null,function(err,form){$this.editor({document:doc,forms:[form],dbId:o.dbId,ignoreEscape:true,mode:"edit"})})},buttons:{OK:function(){var $this=$(this),doc=$this.editor("option","document");if(isNew){c.tabsx("add","#"+doc.id,doc.label,index);self._updateContentHeight();c.children("#"+doc.id)[0].contentEditable=true}else{a.attr("href","#"+doc.id).html(doc.label);p.attr("id",doc.id)}self.element.trigger("contentchange");$this.dialog("close")},Cancel:function(){$(this).dialog("close")}},close:function(e,ui){$(this).remove()}})},insertTab:function(index){if(index<0||index>this.content.tabsx("length")){index=this.content.tabsx("length")}this._doEditTab(index,true)},editTab:function(index){if(index>=0&&index<this.content.tabsx("length")){this._doEditTab(index)}},removeTab:function(index){this.content.tabsx("remove",index).trigger("contentchange")},_browser:function(){this.option("contextmenu2",false);this._contentEditable(false)},_edit:function(){this.option("contextmenu2",false);this._contentEditable(false)},_design:function(){this.option("contextmenu2",true);this._contentEditable(true)},_contentEditable:function(editable){this.content.children(".ui-tabs-panel").each(function(){this.contentEditable=editable})},destroy:function(){this.content.children(".ui-tabs-panel").css({height:"","min-height":""});this.content.tabsx("destroy");this.element.unbind(".tabsxwidget").removeClass("an-tabsxwidget");return $.an.widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.tree",{options:{draggable:true,droppable:true,labelProvider:{getText:function(e){return e.text},getClass:function(e){return e["class"]}}},_create:function(){var e=this,f=this.element,g=this.options;f.addClass("an-tree").empty();g.contentProvider=g.contentProvider||this._defaultContentProvider();this._loadChildren(f);f.delegate(".hitarea","click.tree",function(){var h=a(this).parent();e["_do"+(h.is(".expandable")?"Expand":"Collapse")](h)}).delegate("li>span","hover.tree",function(h){a(this).toggleClass("ui-state-hover");e._trigger("nodehover",h,a(this).closest("li").data("node"))}).delegate("li>span","click.tree contextmenu.tree",function(h){f.find("li>span.selected").removeClass("selected");a(this).addClass("selected");if(h.type=="click"){e._trigger("nodeclick",h,a(this).closest("li").data("node"))}else{if(h.type=="contextmenu"){e._trigger("contextmenu",h,a(this).closest("li").data("node"))}}}).delegate("li>span","dblclick.tree",function(h){e._trigger("nodedblclick",h,a(this).closest("li").data("node"))})},_defaultContentProvider:function(){return{getRoots:function(){return[]},getChildren:function(e){return[]},hasChildren:function(e){return false},getId:function(e){return e.id?e.id:null}}},refresh:function(g){var q=this;if(g){var k=this.element.find("#"+g);if(k.length){var f=this.options,h=f.labelProvider,i=f.contentProvider,e=k.attr("id"),j=k.parent().closest("li");function p(r){var t=null;for(var s in r){if(e==r[s].id){t=s;break}}if(t!=null){k.data("node",r[t]).addClass(h.getClass(r[t])).children("span").html(h.getText(r[t]));if(k.is(".expandable")){k.addClass("stale")}else{if(k.is(".collapsable")){q._loadChildren(k)}}}else{k.remove()}}if(j.length){i.getChildren(j.data("node"),p)}else{i.getRoots(p)}}}else{this._loadChildren(this.element)}},add:function(f,e){this._addNode(this.element.find("#"+f).children("ul"),e)},"delete":function(f){var e=this.element.find("#"+f);if(e.is(".last")){e.prev().addClass("last")}e.remove()},expand:function(f){var e=this.element.find("#"+f);if(e.length>0){this._doExpand(e)}},collapse:function(f){var e=this.element.find("#"+f);if(e.length>=0){this._doCollapse(e)}},_doExpand:function(e){if(e.is(".expandable.stale")){this._loadChildren(e)}else{if(e.is(".expandable")){e.children("ul").show();e.removeClass("expandable").addClass("collapsable")}}},_doCollapse:function(e){if(e.is(".collapsable")){e.children("ul").hide();e.removeClass("collapsable").addClass("expandable")}},_addNode:function(k,g){var r=this,f=this.options,h=f.labelProvider,j=f.contentProvider,e=j.getId(g),q=h.getText(g),p=a("<li/>").addClass(h.getClass(g)).attr("id",e);if(f.checkbox){a("<input type='checkbox'/>").prop("checked",a.inArray(e,f.checkedNodes)!=-1).appendTo(p)}a("<span/>").addClass(h.getClass(g)).html(q).appendTo(p);if(j.hasChildren(g)){p.addClass("expandable stale").prepend("<div class='hitarea'/>");var i=a.type(f.droppable)=="function"?f.droppable(g):f.droppable;if(i){p.children("span").droppable({greedy:true,hoverClass:"ui-state-hover",drop:function(t,u){r._trigger("drop",null,{source:u.draggable.data("node"),target:g})}})}}k.children("li.last").removeClass("last");p.data("node",g).addClass("last").appendTo(k);var s=a.type(f.draggable)=="function"?f.draggable(g):f.draggable;if(s){p.draggable({appendTo:"body",helper:"clone",scroll:true,distance:20,scrollSensitivity:100,zIndex:9999})}},_loadChildren:function(i){var f=this,p=this.options,g=i.children("ul"),j=p.contentProvider||this._defaultContentProvider();if(g.length==0){g=a("<ul/>").appendTo(i)}var h=[];g.find(".collapsable").each(function(){h.push(a(this).attr("id"))});g.empty();var e=i.children(".hitarea").addClass("loading");function k(q){a.each(q,function(t,s){f._addNode(g,s)});i.removeClass("expandable stale").addClass("collapsable");for(var r in h){f.expand(h[r])}e.removeClass("loading")}if(i[0]==this.element[0]){j.getRoots(k)}else{j.getChildren(i.data("node"),k)}},option:function(g,h){if(g=="checkedNodes"&&h===b){var f=[];a("input:checked",this.element).each(function(){f.push(a(this).closest("li").data("node"))});return f}else{if(g==="roots"&&h===b){var e=[];this.element.children("ul").children("li").each(function(){e.push(a(this).attr("id"))});return e}else{if(g==="selectedNodes"&&h===b){var f=[];this.element.find(".selected").each(function(){f.push(a(this).closest("li").attr("id"))});return f}}}return a.Widget.prototype.option.apply(this,arguments)},_setOption:function(f,h){a.Widget.prototype._setOption.apply(this,arguments);var e=this,g=this.element;if(f==="contentProvider"){this._loadChildren(this.element)}else{if(f==="checkedNodes"){a.each(h,function(j,i){a("#"+i+" input",e.element).prop("checked",true)})}else{if(f==="selectedNodes"){a.each(h,function(j,i){g.find("li>span.selected").removeClass("selected");g.find("li#"+i+">span").addClass("selected")})}}}return this},destroy:function(){this.element.undelegate(".hitarea",".tree").undelegate("li>span",".tree").removeClass("an-tree");a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);jQuery.cookie=function(b,p,s){if(typeof p!="undefined"){s=s||{};if(p===null){p="";s.expires=-1}var g="";if(s.expires&&(typeof s.expires=="number"||s.expires.toUTCString)){var h;if(typeof s.expires=="number"){h=new Date();h.setTime(h.getTime()+(s.expires*24*60*60*1000))}else{h=s.expires}g="; expires="+h.toUTCString()}var r=s.path?"; path="+(s.path):"";var j=s.domain?"; domain="+(s.domain):"";var a=s.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(p),g,r,j,a].join("")}else{var f=null;if(document.cookie&&document.cookie!=""){var q=document.cookie.split(";");for(var k=0;k<q.length;k++){var e=jQuery.trim(q[k]);if(e.substring(0,b.length+1)==(b+"=")){f=decodeURIComponent(e.substring(b.length+1));break}}}return f}};(function(b){b.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};function a(f){if(typeof f.data!=="string"){return}var e=f.handler,g=f.data.toLowerCase().split(" ");f.handler=function(s){if(this!==s.target&&(/textarea|select/i.test(s.target.nodeName)||s.target.type==="text")){return}var k=s.type!=="keypress"&&b.hotkeys.specialKeys[s.which],t=String.fromCharCode(s.which).toLowerCase(),q,r="",j={};if(s.altKey&&k!=="alt"){r+="alt+"}if(s.ctrlKey&&k!=="ctrl"){r+="ctrl+"}if(s.metaKey&&!s.ctrlKey&&k!=="meta"){r+="meta+"}if(s.shiftKey&&k!=="shift"){r+="shift+"}if(k){j[r+k]=true}else{j[r+t]=true;j[r+b.hotkeys.shiftNums[t]]=true;if(r==="shift+"){j[b.hotkeys.shiftNums[t]]=true}}for(var p=0,h=g.length;p<h;p++){if(j[g[p]]){return e.apply(this,arguments)}}}}b.each(["keydown","keyup","keypress"],function(){b.event.special[this]={add:a}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(b){var a=0;b.widget("an.menu",{defaultElement:"<ul>",delay:100,options:{submenuPosition:{my:"left top",at:"right top"},triggerEvent:"contextmenu",menuPosition:{my:"left top",at:"left bottom"}},_create:function(){var e=this.options;this.element.addClass("an-menu");this.activeMenu=this.menu=this._createMenuContent(e.actions);this.menu.appendTo("body").hide();this.menuId=this.menu.attr("id")||"ui-menu-"+a++;if(this.menu.find(".ui-icon").length){this.menu.addClass("ui-menu-icons")}this.bindings=b();this.menu.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({id:this.menuId,role:"menu"}).css({"z-index":"999999"}).bind("click.menu",b.proxy(function(f){if(e.disabled){f.preventDefault()}},this));this._bind({"click .ui-menu-item:has(a)":function(f){var g=b(f.currentTarget);if(!this.active||(this.active[0]!==g[0])){this.focus(f,g)}this.select(f);f.preventDefault()},"mouseover .ui-menu-item:not(.seperator)":function(f){f.stopImmediatePropagation();var g=b(f.currentTarget);g.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(f,g)},mouseleave:"_mouseleave","mouseleave .ui-menu":"_mouseleave","mouseout .ui-menu-item":"blur",focus:function(f){this.focus(f,b(f.target).children(".ui-menu-item:first"))},blur:"collapseAll"});this.refresh();this.menu.attr("tabIndex",0);this._bind({keydown:function(j){switch(j.keyCode){case b.ui.keyCode.PAGE_UP:this.previousPage(j);j.preventDefault();j.stopImmediatePropagation();break;case b.ui.keyCode.PAGE_DOWN:this.nextPage(j);j.preventDefault();j.stopImmediatePropagation();break;case b.ui.keyCode.HOME:this._move("first","first",j);j.preventDefault();j.stopImmediatePropagation();break;case b.ui.keyCode.END:this._move("last","last",j);j.preventDefault();j.stopImmediatePropagation();break;case b.ui.keyCode.UP:this.previous(j);j.preventDefault();j.stopImmediatePropagation();break;case b.ui.keyCode.DOWN:this.next(j);j.preventDefault();j.stopImmediatePropagation();break;case b.ui.keyCode.LEFT:if(this.collapse(j)){j.stopImmediatePropagation()}j.preventDefault();break;case b.ui.keyCode.RIGHT:if(this.expand(j)){j.stopImmediatePropagation()}j.preventDefault();break;case b.ui.keyCode.ENTER:if(this.active.children("a[aria-haspopup='true']").length){if(this.expand(j)){j.stopImmediatePropagation()}}else{this.select(j);j.stopImmediatePropagation()}j.preventDefault();break;case b.ui.keyCode.ESCAPE:if(this.collapse(j)){j.stopImmediatePropagation()}j.preventDefault();break;default:j.stopPropagation();clearTimeout(this.filterTimer);var f,i=this.previousFilter||"",k=String.fromCharCode(j.keyCode),h=false;if(k==i){h=true}else{k=i+k}function g(p){return p.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}f=this.activeMenu.children(".ui-menu-item").filter(function(){return new RegExp("^"+g(k),"i").test(b(this).children("a").text())});f=h&&f.index(this.active.next())!=-1?this.active.nextAll(".ui-menu-item"):f;if(!f.length){k=String.fromCharCode(j.keyCode);f=this.activeMenu.children(".ui-menu-item").filter(function(){return new RegExp("^"+g(k),"i").test(b(this).children("a").text())})}if(f.length){this.focus(j,f);if(f.length>1){this.previousFilter=k;this.filterTimer=this._delay(function(){delete this.previousFilter},1000)}else{delete this.previousFilter}}else{delete this.previousFilter}}}});if(e.triggerEvent){this.element.unbind(e.triggerEvent+".menu");this.element.bind(e.triggerEvent+".menu",b.proxy(function(h){var f=b.extend({},{of:h,offset:"0 0"},b.type(this.options.menuPosition)=="function"?this.options.menuPosition(this.active):this.options.menuPosition);var g=b(document).data("contextmenu");if(g){g.collapseAll()}b(document).data("contextmenu",this);this.menu.show().position(f);if(this.options.triggerEvent=="contextmenu"){h.preventDefault()}},this))}this.proxy=b.proxy(function(f){var g=b(f.target);if(g.closest(".ui-menu").length||g.closest(".an-menu").get(0)==this.element.get(0)){return}this.collapseAll(f)},this);b(document).bind("click.menu",this.proxy);if(e.autoShow){this.menu.position(b.type(this.options.menuPosition)=="function"?this.options.menuPosition(this.active):this.options.menuPosition).show()}},_createMenuContent:function(g){var e=this,f=b("<ul/>");b.each(g,function(j,i){switch(i.type){case"submenu":var p=e._createMenuContent(i.children);b("<li/>").append(b("<a href='#'/>").text(i.text)).append(p).appendTo(f);break;case"menuItem":b("<a/>").attr("href","#"+j).text(i.text).click(function(k){i.handler(arguments);k.preventDefault()}).wrap("<li/>").parent().appendTo(f);break;case"seperator":b("<li class='seperator'/>").append(b("<a href='#'/>")).appendTo(f);break;case"checkbox":var h=b("<input/>").attr("type","checkbox").attr("name",i.name).prop("checked",i.checked);b("<a/>").attr("href","#"+j).text(i.text).click(function(s){var r=b(s.target),q=false;if(r.is("a")){var k=r.find("input");q=!k.prop("checked");k.prop("checked",q)}else{if(r.is("input")){q=r.prop("checked")}}i.handler(s,q);s.stopImmediatePropagation()}).prepend(h).wrap("<li/>").parent().appendTo(f);break}});return f},refresh:function(){var e=this.menu.find("ul:not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","menu").hide().attr("aria-hidden","true").attr("aria-expanded","false");var f=this.menuId;e.add(this.menu).children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").addClass("ui-corner-all").attr("tabIndex",-1).attr("role","menuitem").attr("id",function(g){return f+"-"+g});e.each(function(){var h=b(this),g=h.prev("a");g.attr("aria-haspopup","true").prepend('<span class="ui-menu-icon ui-icon ui-icon-carat-1-e"></span>');h.attr("aria-labelledby",g.attr("id"))})},focus:function(e,p){this.blur(e);if(this._hasScroll()){var g=parseFloat(b.curCSS(this.activeMenu[0],"borderTopWidth",true))||0,q=parseFloat(b.curCSS(this.activeMenu[0],"paddingTop",true))||0,h=p.offset().top-this.activeMenu.offset().top-g-q,k=this.activeMenu.scrollTop(),i=this.activeMenu.height(),f=p.height();if(h<0){this.activeMenu.scrollTop(k+h)}else{if(h+f>i){this.activeMenu.scrollTop(k+h-i+f)}}}this.active=p.first().children("a").addClass("ui-state-focus").end();this.menu.attr("aria-activedescendant",this.active.children("a").attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");this.timer=this._delay(function(){this._close()},this.delay);var j=b(">ul",p);if(j.length&&(/^mouse/.test(e.type))){this._startOpening(j)}this.activeMenu=p.parent();this._trigger("focus",e,{item:p})},blur:function(e){if(!this.active){return}clearTimeout(this.timer);this.active.children("a").removeClass("ui-state-focus");this.active=null;this._trigger("blur",e,{item:this.active})},_startOpening:function(e){clearTimeout(this.timer);if(e.attr("aria-hidden")!=="true"){return}this.timer=this._delay(function(){this._close();this._open(e)},this.delay)},_open:function(f){clearTimeout(this.timer);this.menu.find(".ui-menu").not(f.parents()).hide().attr("aria-hidden","true");var e=b.extend({},{of:this.active},b.type(this.options.submenuPosition)=="function"?this.options.submenuPosition(this.active):this.options.submenuPosition);f.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(e)},collapseAll:function(e){var f=false;if(e){var g=b(e.target);if(g.is(".ui-menu")){f=g}else{if(g.closest(".ui-menu").length){f=g.closest(".ui-menu")}}}this._close(f);this.blur(e);this.activeMenu=this.menu;this._trigger("collapseAll")},_close:function(e){if(!e){e=this.active?this.active.parent():this.menu}e.find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active");if(e==this.menu){e.hide().attr("aria-hidden","true").attr("aria-expanded","false")}},collapse:function(f){var e=this.active&&this.active.parents("li:not(.ui-menubar-item)").first();if(e&&e.length){this._close();this.focus(f,e);return true}},expand:function(f){var e=this.active&&this.active.children("ul").children("li").first();if(e&&e.length){this._open(e.parent());this._delay(function(){this.focus(f,e)},20);return true}},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(h,f,g){if(!this.active){this.focus(g,this.activeMenu.children(".ui-menu-item")[f]());return}var e;if(h==="first"||h==="last"){e=this.active[h==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1)}else{e=this.active[h+"All"](".ui-menu-item").eq(0)}if(e.length){this.focus(g,e)}else{this.focus(g,this.activeMenu.children(".ui-menu-item")[f]())}},nextPage:function(g){if(this._hasScroll()){if(!this.active){this.focus(g,this.activeMenu.children(".ui-menu-item").first());return}if(this.last()){return}var h=this.active.offset().top,f=this.menu.height(),e;this.active.nextAll(".ui-menu-item").each(function(){e=b(this);return b(this).offset().top-h-f<0});this.focus(g,e)}else{this.focus(g,this.activeMenu.children(".ui-menu-item")[!this.active?"first":"last"]())}},previousPage:function(g){if(this._hasScroll()){if(!this.active){this.focus(g,this.activeMenu.children(".ui-menu-item").first());return}if(this.first()){return}var h=this.active.offset().top,f=this.menu.height(),e;this.active.prevAll(".ui-menu-item").each(function(){e=b(this);return b(this).offset().top-h+f>0});this.focus(g,e)}else{this.focus(g,this.activeMenu.children(".ui-menu-item").first())}},_hasScroll:function(){return this.menu.height()<this.menu.prop("scrollHeight")},_mouseleave:function(e){this.collapseAll(e);this.blur()},select:function(e){var f={item:this.active};this.collapseAll(e);this._trigger("select",e,f)},_bind:function(g,f){if(!f){f=g;g=this.menu}else{g=b(g);this.bindings=this.bindings.add(g)}var e=this;b.each(f,function(q,p){function j(){if(e.options.disabled===true||b(this).hasClass("ui-state-disabled")){return}return(typeof p==="string"?e[p]:p).apply(e,arguments)}var k=q.match(/^(\w+)\s*(.*)$/),i=k[1]+"."+e.widgetName,h=k[2];if(h){e.menu.delegate(h,i,j)}else{g.bind(i,j)}})},_delay:function(h,g){function f(){return(typeof h==="string"?e[h]:h).apply(e,arguments)}var e=this;return setTimeout(f,g||0)},destroy:function(){b(document).unbind(".menu",this.proxy);this.menu.removeAttr("aria-activedescendant").find("ul").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").show();this.menu.find(".ui-menu-item").unbind(".menu").removeClass("ui-menu-item").removeAttr("role").children("a").removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").removeAttr("id").children(".ui-icon").remove();this.bindings.unbind("."+this.widgetName);this.menu.remove();this.element.unbind("."+this.widgetName).removeClass("an-menu");b.Widget.prototype.destroy.apply(this,arguments)}})}(jQuery));
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.border",{options:{center:{minWidth:200,minHeight:20}},_create:function(){this.element.addClass("an-border");this._calculateDimension();this._makeResizable();this._proxy=a.proxy(function(f){if(f.target===window){this._calculateDimension()}},this);a(window).bind("resize.border",this._proxy)},_setOption:function(f,g){var e=a.extend({},this.options[f]);switch(f){case"east":case"south":case"west":case"north":case"center":a.extend(true,this.options[f],g);if(g.width!=e.width||g.height!=e.height){this._calculateDimension(f)}if(g.hasOwnProperty("resizable")){this._makeResizable()}break;default:break}this._trigger("optionchanged",null,{key:f,value:this.options[f],oldValue:e})},_calculateDimension:function(k){var u=this,g=this.options,f=null;if(g.center.selector&&g.center.selector!=""){f=u.element.children(g.center.selector)}if(!f||f.length==0){f=a("<div/>").appendTo(u.element)}u.centerElement=f;var q={pbmWidth:0,pbmHeight:0,minWidth:0,minHeight:0,totalMinWidth:0,totalMinHeight:0},p=a.extend({height:0,totalHeight:0},q),s=a.extend({},p),i=a.extend({width:0,totalWidth:0},q),r=a.extend({},i),h={};h.pbmWidth=(f.outerWidth(true)-f.width());h.pbmHeight=(f.outerHeight(true)-f.height());h.minWidth=parseFloat(g.center.minWidth);h.minHeight=parseFloat(g.center.minHeight);h.totalMinWidth=h.minWidth+h.pbmWidth;h.totalMinHeight=h.minHeight+h.pbmHeight;a.each({north:p,south:s},function(x,w){var z=null;if(g[x]){if(g[x].selector&&g[x].selector!=""){z=u.element.children(g[x].selector)}if(!z||z.length==0){z=a("<div/>").appendTo(u.element)}w.height=parseFloat(g[x].height||w.minHeight||0);w.pbmWidth=z.outerWidth(true)-z.width();w.pbmHeight=z.outerHeight(true)-z.height();w.totalHeight=w.height+w.pbmHeight;w.minWidth=parseFloat(g[x].minWidth);w.minHeight=parseFloat(g[x].minHeight);w.totalMinWidth=w.minWidth+w.pbmWidth;w.totalMinHeight=w.minHeight+w.pbmHeight;u[x+"Element"]=z}});a.each({west:i,east:r},function(x,w){var z=null;if(g[x]){if(g[x].selector&&g[x].selector!=""){z=u.element.children(g[x].selector)}if(!z||z.length==0){z=a("<div/>").appendTo(u.element)}w.width=parseFloat(g[x].width||w.minWidth||0);w.pbmWidth=z.outerWidth(true)-z.width();w.pbmHeight=z.outerHeight(true)-z.height();w.totalWidth=w.width+w.pbmWidth;w.minWidth=parseFloat(g[x].minWidth);w.minHeight=parseFloat(g[x].minHeight);w.totalMinWidth=w.minWidth+w.pbmWidth;w.totalMinHeight=w.minHeight+w.pbmHeight;u[x+"Element"]=z}});var j=u.element.width(),e=u.element.height();if((p.totalHeight+s.totalHeight+h.totalMinHeight>e)&&(p.totalMinHeight+s.totalMinHeight+h.totalMinHeight<e)){var t=p.totalHeight+s.totalHeight+h.totalMinHeight-e;if(!k){s.height=s.height-Math.ceil(t/2);p.height=p.height-Math.floor(t/2);if(s.height<s.minHeight){p.height=p.height-(s.minHeight-s.height);s.height=s.minHeight}if(p.height<p.minHeight){s.height=s.height-(p.minHeight-p.height);p.height=p.minHeight}s.totalHeight=s.height+s.pbmHeight;p.totalHeight=p.height+p.pbmHeight}else{if(k=="north"){s.height=s.height-t;if(s.height<s.minHeight){p.height=p.height-(s.minHeight-s.height);s.height=s.minHeight;p.totalHeight=p.height+p.pbmHeight}s.totalHeight=s.height+s.pbmHeight}else{if(k=="south"){p.height=p.height-t;if(p.height<p.minHeight){s.height=s.height-(p.minHeight-p.height);p.height=p.minHeight;s.totalHeight=s.height+s.pbmHeight}p.totalHeight=p.height+p.pbmHeight}}}}else{if(p.totalMinHeight+s.totalMinHeight+h.totalMinHeight>=e){p.height=p.minHeight;s.height=s.minHeight;p.totalHeight=p.height+p.pbmHeight;s.totalHeight=s.height+s.pbmHeight;e=p.totalMinHeight+s.totalMinHeight+h.totalMinHeight}}if((i.totalWidth+r.totalWidth+h.totalMinWidth>j)&&(i.totalMinWidth+r.totalMinWidth+h.totalMinWidth<j)){var t=i.totalWidth+r.totalWidth+h.totalMinWidth-j;if(!k){r.width=r.width-Math.ceil(t/2);i.width=i.width-Math.floor(t/2);if(r.width<r.minWidth){i.width=i.width-(r.minWidth-r.width);r.width=r.minWidth}if(i.width<i.minWidth){r.width=r.width-(i.minWidth-i.width);i.width=i.minWidth}r.totalWidth=r.width+r.pbmWidth;i.totalWidth=i.width+i.pbmWidth}else{if(k=="west"){r.width=r.width-t;if(r.width<r.minWidth){i.width=i.width-(r.minWidth-r.width);r.width=r.minWidth;i.totalWidth=i.width+i.pbmWidth}r.totalWidth=r.width+r.pbmWidth}else{if(k=="east"){i.width=i.width-t;if(i.width<i.minWidth){r.width=r.width-(i.minWidth-i.width);i.width=i.minWidth;r.totalWidth=r.width+r.pbmWidth}i.totalWidth=i.width+i.pbmWidth}}}}else{if(i.totalMinWidth+r.totalMinWidth+h.totalMinWidth>=j){i.width=i.minWidth;r.width=r.minWidth;i.totalWidth=i.width+i.pbmWidth;r.totalWidth=r.width+r.pbmWidth;j=i.totalMinWidth+r.totalMinWidth+h.totalMinWidth}}h.top=parseFloat(u.element.css("padding-top"));h.left=parseFloat(u.element.css("padding-left"));h.right=parseFloat(u.element.css("padding-right"));h.bottom=parseFloat(u.element.css("padding-bottom"));if(u.northElement){p.top=parseFloat(u.element.css("padding-top"));p.left=parseFloat(u.element.css("padding-left"));p.width=j-p.pbmWidth;h.top+=p.totalHeight}if(u.southElement){s.left=parseFloat(u.element.css("padding-left"));s.width=j-s.pbmWidth;s.top=e-s.totalHeight;h.bottom+=s.totalHeight}if(u.westElement){i.top=h.top;i.left=parseFloat(u.element.css("padding-left"));i.height=e-h.top-h.bottom-i.pbmHeight;h.left+=i.totalWidth}if(u.eastElement){r.top=h.top;r.left=j-r.totalWidth;r.height=e-h.top-h.bottom-r.pbmHeight;h.right+=r.totalWidth}h.width=j-h.left-h.right-h.pbmWidth;h.height=e-h.top-h.bottom-h.pbmHeight;a.each({north:p,south:s,west:i,east:r,center:h},function(x,w){if(u[x+"Element"]){u[x+"Element"].css(a.extend({position:"absolute"},{top:w.top+"px",left:w.left+"px",overflow:x=="north"?"visible":"hidden",width:w.width+"px",height:w.height+"px"}))}});u.element.trigger("resize")},_makeResizable:function(){var e=this,f=this.options;if(this.northElement){this.northElement.resizable(f.north.resizable?{handles:"s",containment:e.element,resize:function(i,h){var g=Math.max(ui.size.height,f.north.minHeight||0);g=Math.min(g,f.north.maxHeight||Number.MAX_VALUE);e._setOption("north",{height:g})},start:function(g,h){a("body").append('<div id="mask" style="position: absolute; z-index: 999999; left: 0pt; top: 0pt; right: 0pt; bottom: 0pt;"></div>')},stop:function(g,h){a("#mask").remove()}}:"destroy")}if(this.southElement){this.southElement.resizable(f.south.resizable?{handles:"n",containment:e.element,resize:function(h,i){var g=Math.max(i.size.height,f.south.minHeight||0);g=Math.min(g,f.south.maxHeight||Number.MAX_VALUE);e._setOption("south",{height:g})},start:function(g,h){a("body").append('<div id="mask" style="position: absolute; z-index: 999999; left: 0pt; top: 0pt; right: 0pt; bottom: 0pt;"></div>')},stop:function(g,h){a("#mask").remove()}}:"destroy")}if(this.westElement){this.westElement.resizable(f.west.resizable?{handles:"e",containment:e.element,resize:function(h,i){var g=Math.max(i.size.width,f.west.minWidth||0);g=Math.min(g,f.west.maxWidth||Number.MAX_VALUE);e._setOption("west",{width:g})},start:function(g,h){a("body").append('<div id="mask" style="position: absolute; z-index: 999999; left: 0pt; top: 0pt; right: 0pt; bottom: 0pt;"></div>')},stop:function(g,h){a("#mask").remove()}}:"destroy")}if(this.eastElement){this.eastElement.resizable(f.east.resizable?{handles:"w",containment:e.element,resize:function(h,i){var g=Math.max(i.size.width,f.east.minWidth||0);g=Math.min(g,f.east.maxWidth||Number.MAX_VALUE);e._setOption("east",{width:g})},start:function(g,h){a("body").append('<div id="mask" style="position: absolute; z-index: 999999; left: 0pt; top: 0pt; right: 0pt; bottom: 0pt;"></div>')},stop:function(g,h){a("#mask").remove()}}:"destroy")}},refresh:function(){this._calculateDimension()},destroy:function(){this.element.removeClass("ui-border");a(window).unbind("resize.border",this._proxy);return a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.rte",{options:{doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssFiles:[],jsFiles:[],mode:"design",lang:"en",absoluteURLs:true,styleWithCSS:false,history:[],undoable:false,redoable:false,formIds:{standard:"5080143085ac60df09000001",link:"508251eb0b27990c0a000001",image:"5082d29f0b27990c0a000005",table:"5085f383eeeac1e909000001",cell:"5086b873eeeac1e909000002",tabsx:["5080143085ac60df09000001","51306faad58d1c129f000000"]}},_create:function(){var e=this,i=this.options,g=this.element;g.addClass("an-rte").empty();this.url=this._parseURL(window.location.href);this.lang=(""+i.lang);i.iframe=a("<iframe/>").addClass("container").attr({frameborder:0}).appendTo(g);i.win=i.iframe[0].contentWindow;var h=(i.doc=i.win.document);if(i.resizable){g.resizable()}this.source=a("<textarea class='content'/>").appendTo(g);this.source[i.mode=="sourcecode"?"show":"hide"]();i.actions=this._createActions();a(i.win).bind("focus.rte blur.rte",function(k){e._trigger(k.type,k,g)});a(h).bind("dragend.rte",function(k){setTimeout(function(){try{i.win.focus();sel.moveToBookmark(sel.getBookmark());e.updatePath()}catch(p){}},200)});i.iframe.load(function(){var k=a(this).contents().find("body")[0];if(a.browser.msie){k.contentEditable=true}else{try{k.contentEditable=true;h.execCommand("styleWithCSS",false,i.styleWithCSS)}catch(q){}}if(i.mobile){var p=this;this.width="100%";setTimeout(function(){var s=p.contentWindow.document.body.scrollHeight;var t=p.contentWindow.document.documentElement.scrollHeight;var r=Math.max(s,t);p.height=r},500)}e.$body=a(k);if(i.cssClass){e.$body.addClass(i.cssClass)}i.onload&&i.onload();i.restore&&i.restore(e.$body);e._restore()});var f='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';a.each(i.cssFiles,function(){f+="<link rel='stylesheet' type='text/css' href='"+this+"'/>"});a.each(i.jsFiles,function(){f+="<script type='text/javascript' language='javascript' src='"+this+"'><\/script>"});f+='<style id="stylesheet" type="text/css">'+(i.stylesheet||"")+"</style>";h.open();h.write(i.doctype+f+"</head><body>"+a.trim(i.content||"")+"</body></html>");h.close();i.dom=new rteDom(this);i.selection=new rteSelection(this);this.showToolbar(i.showToolbar);this.source.bind("change.rte keyup.rte",function(k){k.preventDefault();k.stopImmediatePropagation();e.element.trigger("change")}).bind("keydown.rte",function(s){if(s.keyCode==a.ui.keyCode.TAB){s.preventDefault();if(a.browser.msie){var k=document.selection.createRange();k.text="\t"+k.text;this.focus()}else{var q=this.value,p=q.substr(0,this.selectionStart),t=q.substr(this.selectionEnd);this.value=p+"\t"+t;this.setSelectionRange(p.length+1,p.length+1)}}});var j=null;a(h).bind("keydown.rte",function(p){var k=i.selection;if(p.keyCode==13){var q=k.getNode();if(i.dom.selfOrParent(q,/^PRE$/)){k.insertNode(i.doc.createTextNode("\r\n"))}else{if(a.browser.safari&&p.shiftKey){k.insertNode(i.doc.createElement("br"))}}}if(p.keyCode==32&&a.browser.opera){k.insertNode(i.doc.createTextNode(" "))}if((p.keyCode>=48&&p.keyCode<=57)||p.keyCode==61||p.keyCode==109||(p.keyCode>=65&&p.keyCode<=90)||(p.keyCode>=188&&p.keyCode<=190)||p.keyCode==191||(p.keyCode>=219&&p.keyCode<=222)||p.keyCode==8||p.keyCode==46||p.keyCode==32||p.keyCode==13){e.element.trigger("change")}if((p.keyCode>=8&&p.keyCode<=13)||(p.keyCode>=32&&p.keyCode<=40)||p.keyCode==46||(p.keyCode>=96&&p.keyCode<=111)||(p.keyCode==65)&&(p.metaKey||p.ctrlKey)){e.updatePath()}e.element.trigger(p)}).bind("contextmenu.rte",function(r){r.preventDefault();r.stopImmediatePropagation();var s=i.iframe.offset(),p=s.left+r.clientX,k=s.top+r.clientY,q=a.extend(a.Event(),{type:"contextmenu2",pageX:p,pageY:k});a(h).find(r.target).trigger(q)}).bind("paste.rte",function(k){if(i.denyPaste){k.stopPropagation();k.preventDefault()}}).bind("mousedown.rte",function(k){j="down"}).bind("mousemove.rte",function(k){if(j=="down"){j="moving"}e.element.trigger(k)}).bind("mouseup.rte dblclick.rte",function(k){if(j=="moving"||k.type=="dblclick"){j=null;e.element.trigger("selectionChanged")}e.updatePath();e.element.trigger(k)}).bind("click.rte newwidget.rte contentchange.rte",function(k){e.element.trigger(k)}).bind("treenodeclick.rte",function(p,k){e.element.trigger(p,k)});if(a.browser.msie){a(h).bind("keyup.rte",function(p){var k=i.selection;if(p.keyCode==86&&(p.metaKey||p.ctrlKey)){k.saveIERange();i.content=e.$body.html();k.restoreIERange();e.$body.mouseup();e.updatePath()}})}if(a.browser.safari){a(h).bind("click.rte",function(k){content.find(".rte-webkit-hl").removeClass("rte-webkit-hl");if(k.target.nodeName=="IMG"){a(k.target).addClass("rte-webkit-hl")}}).bind("keyup.rte",function(k){content.find(".rte-webkit-hl").removeClass("rte-webkit-hl")})}i.win.focus()},option:function(e,f){if(/^can.*/.test(e)){this.options[e]=this["_"+e]?this["_"+e]():false}if(e==="actionSets"&&f===b){return this._createActionSets()}else{if(e==="content"&&f===b){return this._getContent()}}return a.Widget.prototype.option.apply(this,arguments)},_setOption:function(f,g){var h=this.options,e=this.option(f);if(!equals(g,e)){a.Widget.prototype._setOption.apply(this,arguments);if(f=="mode"){if(g=="design"){h.iframe.show();this.$body.html(this.source.hide().val());h.restore&&h.restore(this.$body);this._restore();h.win.focus()}else{h.clean&&h.clean(this.$body);this._clean();this.source.val(this.$body.html()).show();h.iframe.hide();if(a.browser.msie){}else{this.source[0].setSelectionRange(0,0)}}}else{if(f=="content"){if(h.mode=="design"){this.$body.html(g)}else{if(h.mode=="sourcecode"){this.source.val(g)}}}else{if(f=="stylesheet"){a(h.doc).find("#stylesheet").text(g)}else{if(f=="height"){this.element.css("height",g)}else{if(f=="width"){this.element.css("width",g)}else{if(f=="showToolbar"){this.showToolbar(g)}else{if(f=="path"){this.toolbar&&this.toolbar.toolbar("refresh")}}}}}}}this._trigger("optionchanged",null,{key:f,value:g,oldValue:e})}return this},history:function(){var e=this,g=e.options,f=g.history;if(g.mode=="design"){clearTimeout(g.historyT);g.historyT=setTimeout(function(){f.push(e._getContent());e.htStep=f.length-1;e.option("undoable",true)},400)}},undo:function(){var e=this,f=e.options.history;if(f.length<=1){return}e.htStep=e.htStep-1;if(e.htStep<0){e.htStep=0}e.$body.html(f[e.htStep]);e._restore();e.option("redoable",true);e.htStep==0&&e.option("undoable",false)},redo:function(){var e=this,f=e.options.history;if(f.length<=1){return}e.htStep++;if(e.htStep>(f.length-1)){e.htStep=f.length-1}e.$body.html(f[e.htStep]);e._restore();e.option("undoable",true);(e.htStep==f.length-1)&&e.option("redoable",false)},showToolbar:function(e){if(e){if(!this.toolbar){var f=this,g=this.options;this.toolbar=a("<div/>").toolbar({actionSets:this._createActionSets()}).prependTo(this.element);function h(){if(f.toolbar.is(":visible")){var i=f.element.height()-f.toolbar.outerHeight(true);g.iframe.css({height:i});f.source.css({height:i})}}h();this._proxy=a.proxy(function(i){h()},this);a(window).bind("resize.rte",this._proxy)}}else{if(this.toolbar){a(window).unbind("resize.rte",this._proxy);this.toolbar.remove();delete this.toolbar}}},_getContent:function(){var f=this.options,e=f.content;if(f.mode=="design"&&this.$body){f.clean&&f.clean(this.$body);this._clean();e=this.$body.html();f.restore&&f.restore(this.$body);this._restore()}else{if(f.mode=="sourcecode"){e=this.source.val()}}return e},_clean:function(){a("table",this.$body).each(function(){if(a(this).data("resizable")){a(this).data("resizable").destroy()}});a("img",this.$body).unbind("dblclick");this.$body.find(".widget[type=tabsx]").each(function(){var e=a(this).data("tabsxwidget");if(e){e.destroy()}})},_restore:function(){var e=this,h=this.options,f=h.formIds,g=h.selection;a("table",this.$body).resizable({stop:function(j,i){e.element.trigger("contentchange");j.preventDefault();j.stopImmediatePropagation()}});a("img",this.$body).each(function(){var i=this;a(this).dblclick(function(){var j=attributes(i);j.width=a(i).css("width").replace(/px/g,"");j.height=a(i).css("height").replace(/px/g,"");e._showDialog("Image",j,[f.standard,f.image],function(k){a.each(k,function(q,p){if(q=="width"||q=="height"){p=a.trim(p)?$img.css(q,p):$img.removeAttr(q)}else{p=a.trim(p)?$img.attr(q,p):$img.removeAttr(q)}});if(!i.parentNode){g.insertNode(i)}e.element.trigger("contentchange")})})});this.$body.find(".widget[type=tabsx]").each(function(){var i=a(this);if(i.is(".an-tabsxwidget")){i.data("tabsxwidget").option("mode",h.mode)}else{i.tabsxwidget({parent:function(){return e},mode:h.mode,dbId:h.dbId,optionchanged:function(k,j){if(j.key=="metadata"||j.key=="attributes"){e.element.trigger("contentchange")}}})}})},_createActionSets:function(){var f=this.options,e=f.mode;if(e=="design"){return[this._controlActionSet(),this._formatActionSet(),this._tableActionSet(),this._widgetActionSet(),this._modeActionSet()]}else{if(e=="sourcecode"){return[this._modeActionSet()]}}},_controlActionSet:function(){return this._createActionSet(["properties","cleanFormat"])},_formatActionSet:function(){return this._createActionSet(["bold","italic","underline","strikethrough","subscript","superscript","alignLeft","alignCenter","alignRight","alignFull","font","fontSize","format","leftToRight","rightToLeft","fontColor","backgroundColor","outdent","indent","orderedList","unorderedList","link","deleteLink","horizontalRule","blockQuote","blockElement","stopFloat","image"])},_tableActionSet:function(){return this._createActionSet(["table","tableProps","deleteTable","rowBefore","rowAfter","deleteRow","columnBefore","columnAfter","deleteColumn","cellProps","mergeCells","splitCells"])},_widgetActionSet:function(){return this._createActionSet(["tabsx"])},_modeActionSet:function(){return this._createActionSet(["sourcecode"])},_createActionSet:function(e){var g=this.options.actions,f={};a.each(e,function(){f[this]=g[this]});return f},_doCCP:function(h){this.addHistory();try{this.options.doc.execCommand(h,false,null)}catch(g){if(a.browser.mozilla){var f=" Ctl + C";if(h=="cut"){f=" Ctl + X"}else{if(h=="paste"){f=" Ctl + V"}}a("<div class='rte-dialog'/>").dialog({title:"Warning",height:260,width:380,modal:true,open:function(e,i){a(this).append("This operation is disabled in your browser on security reason. Use shortcut instead.: "+f)},buttons:{OK:function(){a(this).dialog("close")}},close:function(j,i){a(this).remove()}})}else{window.console.log("commands failed: "+h)}}this.updatePath()},_canCCP:function(i){var h=this.options,f=false;try{f=h.mode=="design"&&h.doc.queryCommandEnabled(i)}catch(g){}return f},_canCut:function(){return this._canCCP("cut")},_canCopy:function(){return this._canCCP("copy")},_canPaste:function(){return this._canCCP("paste")},cut:function(){this._doCCP("cut")},copy:function(){this._doCCP("copy")},paste:function(){this._doCCP("paste")},updatePath:function(q){var f=this.options,g=f.selection,j=f.dom;q&&g.cleanCache();var h=g.getNode(),e=j.parents(h,"*"),r=f.rtl,u=r?" &laquo; ":" &raquo; ",t="",k;function s(v){var i=v.nodeName.toLowerCase();v=a(v);if(i=="img"||i=="div"){if(v.is(".widget")){var p=v.attr("id");if(p){p=p.replace(/-/g,".")}i=p+" ("+v.attr("type")+")"}}return i}if(h&&h.nodeType==1&&h.nodeName!="BODY"){e.unshift(h)}if(!r){e=e.reverse()}for(k=0;k<e.length;k++){t+=(k>0?u:"")+s(e[k])}return this.option("path",t)},removeFormat:function(){this.options.doc.execCommand("removeformat",false,null);return this},bold:function(){this.options.doc.execCommand("bold",false,null);this.element.trigger("contentchange");return this},italic:function(){this.options.doc.execCommand("italic",false,null);this.element.trigger("contentchange");return this},underline:function(){this.options.doc.execCommand("underline",false,null);this.element.trigger("contentchange");return this},strikethrough:function(){this.options.doc.execCommand("strikethrough",false,null);this.element.trigger("contentchange");return this},subscript:function(){this.options.doc.execCommand("subscript",false,null);this.element.trigger("contentchange");return this},superscript:function(){this.options.doc.execCommand("superscript",false,null);this.element.trigger("contentchange");return this},align:function(f){var h=this.options,g=h.selection.selected({collapsed:true,blocks:true,tag:"div"}),e=g.length;while(e--){h.dom.filter(g[e],"textNodes")&&a(g[e]).css("text-align",f)}this.element.trigger("contentchange");return this},leftToRight:function(){var g=this.options,f=g.dom,e=g.selection,h=e.getNode();if(a(h).attr("dir")=="ltr"||a(h).parents('[dir="ltr"]').length||a(h).find('[dir="ltr"]').length){a(h).removeAttr("dir");a(h).parents('[dir="ltr"]').removeAttr("dir");a(h).find('[dir="ltr"]').removeAttr("dir")}else{if(f.is(h,"textNodes")&&f.is(h,"block")){a(h).attr("dir","ltr")}else{a.each(f.parents(h,"textNodes"),function(j,k){if(f.is(k,"block")){a(k).attr("dir","ltr");return false}})}}this.element.trigger("contentchange");return this},rightToLeft:function(){var f=this.options,e=f.dom,g=f.selection.getNode();if(a(g).attr("dir")=="rtl"||a(g).parents('[dir="rtl"]').length||a(g).find('[dir="rtl"]').length){a(g).removeAttr("dir");a(g).parents('[dir="rtl"]').removeAttr("dir");a(g).find('[dir="rtl"]').removeAttr("dir")}else{if(e.is(g,"textNodes")&&e.is(g,"block")){a(g).attr("dir","rtl")}else{a.each(e.parents(g,"textNodes"),function(h,j){if(e.is(j,"block")){a(j).attr("dir","rtl");return false}})}}this.element.trigger("contentchange");return this},outdent:function(){var i=this.options,f=i.selection,h=i.dom;function g(p){function j(t){var q={type:"",val:0},r;if((r=h.attr(t,"style"))){q.type=r.indexOf("padding-left")!=-1?"padding-left":(r.indexOf("margin-left")!=-1?"margin-left":"");q.val=q.type?parseInt(a(t).css(q.type))||0:0}return q}var p=f.getNode(),k=j(p);if(k.val){k.node=p}else{a.each(h.parents(p,"*"),function(){k=j(this);if(k.val){k.node=this;return k}})}return k}var e=g();if(e.node){a(e.node).css(e.type,(e.val>40?e.val-40:0)+"px");this.updatePath()}this.element.trigger("contentchange");return this},indent:function(){var p=this.options,h=p.selection,k=p.dom,j=p.doc,f=h.selected({collapsed:true,blocks:true,wrap:"inline",tag:"p"});function e(s){var i=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(s.nodeName)?"margin-left":"padding-left";var r=k.attr(s,"style").indexOf(i)!=-1?parseInt(a(s).css(i))||0:0;a(s).css(i,r+40+"px")}for(var g=0;g<f.length;g++){if(/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(f[g].nodeName)){a(f[g]).find("td,th").each(function(){e(this)})}else{if(/^LI$/.test(f[g].nodeName)){var q=a(f[g]);a(j.createElement(f[g].parentNode.nodeName)).append(a(j.createElement("li")).html(q.html()||"")).appendTo(q.html("&nbsp;"))}else{e(f[g])}}}this.updatePath();this.element.trigger("contentchange");return this},orderedList:function(){this.options.doc.execCommand("insertorderedlist",false,null);this.updatePath();this.element.trigger("contentchange");return this},unorderedList:function(){this.options.doc.execCommand("insertunorderedlist",false,null);this.updatePath();this.element.trigger("contentchange");return this},_showDialog:function(j,k,e,p,i){var q=this,g=this.options,h=g.selection,f=h.getBookmark();h.saveIERange();a("<div class='rte-dialog'/>").dialog({title:j,height:400,width:500,modal:true,create:function(r,s){var t=a(this);Model.getPages(g.dbId,e,function(v,u){if(u){t.editor({document:k,forms:u,dbId:g.dbId,mode:"edit",ignoreEscape:true})}})},buttons:{OK:function(){var r=a(this);h.moveToBookmark(f);p(r.editor("option","document"));q.updatePath();r.dialog("close")},Cancel:function(){a(this).dialog("close")}},open:function(r,s){if(typeof i=="function"){i()}},close:function(s,r){h.removeBookmark(f);a.browser.msie&&h.restoreIERange();a(this).remove()}})},link:function(){var s=this,f=this.options,g=f.selection,k=f.dom,r=f.doc,h=g.getNode(),q=k.selfOrParentLink(h),e=f.formIds;function j(i){return i.nodeName=="A"&&i.href}if(!q){sn=a.browser.msie?g.selected():g.selected({wrap:false});if(sn.length){for(var p=0;p<sn.length;p++){if(j(sn[p])){q=sn[p];break}}if(!q){q=k.parent(sn[0],j)||k.parent(sn[g.length-1],j)}}}q=q||r.createElement("a");this._showDialog("Link",attributes(q),[e.standard,e.link],function(u){var t=s._absoluteURL(u.href),v,i=h.nodeName=="IMG"?h:null;if(i&&i.parentNode){q=a(r.createElement("a")).attr("href",t);k.wrap(i,q[0])}else{if(!q.parentNode){v="#--el-editor---"+Math.random();r.execCommand("createLink",false,v);q=a('a[href="'+v+'"]',r).each(function(){var w=a(this);if(!a.trim(w.html())&&!a.trim(w.text())){w.replaceWith(w.text())}})}}u.href=t;q=a(q);a.each(u,function(x,w){w=a.trim(w)?q.attr(x,w):q.removeAttr(x)});i&&g.select(i)});this.element.trigger("contentchange");return this},blockQuote:function(){var h=this.options,f=h.selection,g=h.dom,i,e;if(f.collapsed()&&(i=g.selfOrParent(f.getNode(),/^BLOCKQUOTE$/))){a(i).replaceWith(a(i).html())}else{e=f.selected({wrap:"all",tag:"blockquote"});e.length&&f.select(e[0],e[e.length-1])}this.updatePath();this.element.trigger("contentchange");return this},blockElement:function(){var h=this.options,f=h.selection,g=h.dom,i,e;if(f.collapsed()){i=g.selfOrParent(f.getNode(),/^DIV$/);if(i){a(i).replaceWith(a(i).html())}}else{e=f.selected({wrap:"all",tag:"div"});e.length&&f.select(e[0],e[e.length-1])}this.updatePath();this.element.trigger("contentchange");return this},stopFloat:function(){var i=this.options,e=i.selection,h=i.dom,f=i.doc;function g(){if(e.collapsed()){var k=h.selfOrParent(e.getEnd(),/^DIV$/);if(k&&(h.attr(k,"clear")||a(k).css("clear")!="none")){return k}}}var j=g();if(j){j=a(j);if(!j.children().length&&!a.trim(j.text()).length){j.remove()}else{j.removeAttr("clear").css("clear","")}}else{e.insertNode(a(f.createElement("div")).css("clear","both")[0],true)}this.updatePath();this.element.trigger("contentchange");return this},deleteTable:function(){a(this.options.dom.parent(this.options.selection.getNode(),/^TABLE$/)).remove();this.updatePath();this.element.trigger("contentchange");return this},insertTableRow:function(k){var u=this.options,A=u.dom,w=u.selection,v=w.getNode(),C=u.doc,B=A.selfOrParent(v,/^(TD|TH)$/),t=A.selfOrParent(B,/^TR$/),s=A.tableMatrix(A.selfOrParent(B,/^TABLE$/));if(B&&t&&s){var q="before"==k,p=a(t).prevAll("tr").length,x=0,g=[];function h(i,r){while(r>0){r--;if(s[r]&&s[r][i]&&s[r][i].nodeName){return s[r][i]}}}for(var z=0;z<s[p].length;z++){if(s[p][z]&&s[p][z].nodeName){var e=a(s[p][z]);var f=parseInt(e.attr("colspan")||1);if(parseInt(e.attr("rowspan")||1)>1){if(q){x+=f}else{g.push(e)}}else{x+=f}}else{if(s[p][z]=="-"){e=h(z,p);e&&g.push(a(e))}}}var j=a(C.createElement("tr"));for(var z=0;z<x;z++){j.append("<td>&nbsp;</td>")}if(q){j.insertBefore(t)}else{j.insertAfter(t)}a.each(g,function(){a(this).attr("rowspan",parseInt(a(this).attr("rowspan")||1)+1)});this.updatePath()}this.element.trigger("contentchange");return this},deleteRow:function(){var t=this.options,w=t.selection,A=t.dom,v=w.getNode(),B=A.selfOrParent(v,/^(TD|TH)$/),s=A.selfOrParent(B,/^TR$/),k=A.selfOrParent(B,/^TABLE$/),q=A.tableMatrix(k);if(B&&s&&q.length){if(q.length==1){a(k).remove();this.updatePath()}var f=[],p=a(s).prevAll("tr").length;function g(i,r){while(r>0){r--;if(q[r]&&q[r][i]&&q[r][i].nodeName){return q[r][i]}}}function j(r,i){y=p+1;var E=null;if(q[y]){for(var D=0;D<i;D++){if(q[y][D]&&q[y][D].nodeName){E=q[y][D]}}r=r.remove();if(E){r.insertAfter(E)}else{r.prependTo(a(s).next("tr").eq(0))}}}function x(D){for(var r=0;r<D.length;r++){if(D[r]==B){return r<D.length-1?D[r+1]:D[r-1]}}}for(var z=0;z<q[p].length;z++){var e=null;var u=false;if(q[p][z]&&q[p][z].nodeName){e=q[p][z];u=true}else{if(q[p][z]=="-"&&(e=g(z,p))){u=false}}if(e){e=a(e);var C=parseInt(e.attr("rowspan")||1);if(C>1){e.attr("rowspan",C-1);u&&j(e,z,p)}}}var h=x(A.tableColumn(B));if(h){w.selectContents(h).collapse(true)}a(s).remove()}this.updatePath();this.element.trigger("contentchange");return this},insertTableColumn:function(j){var i=this.options,g=i.doc,h=i.dom,f=i.selection,e=h.tableColumn(f.getNode(),false,true);if(e.length){a.each(e,function(){var p=a(this);var k=parseInt(p.attr("colspan")||1);if(k>1){p.attr("colspan",k+1)}else{var q=a(g.createElement(this.nodeName)).html("&nbsp;");if(j=="before"){q.insertBefore(this)}else{q.insertAfter(this)}}})}this.updatePath();this.element.trigger("contentchange");return this},deleteColumn:function(){var e=this.options,f=e.selection,i=e.dom,g=f.getNode(),p=i.selfOrParent(g,/^(TD|TH)$/),h=a(p).prev("td,th")[0],k=a(p).next("td,th")[0],j=i.parent(g,/^TABLE$/),q=i.tableColumn(g,false,true);if(q.length){a.each(q,function(){var s=a(this),r=parseInt(s.attr("colspan")||1);if(r>1){s.attr("colspan",r-1)}else{s.remove()}});i.fixTable(j);if(h||k){f.selectContents(h?h:k).collapse(true)}}this.updatePath();this.element.trigger("contentchange");return this},mergeCells:function(){var v=this.options,x=v.selection,z=v.dom,g=null,w=z.selfOrParent(x.getStart(),/^(TD|TH)$/),u=z.selfOrParent(x.getEnd(),/^(TD|TH)$/);if(w&&u&&w!=u&&a(w).parents("table")[0]==a(u).parents("table")[0]){g=[w,u]}if(g){var A=z.indexOf(a(g[0]).parent("tr")[0]),h=z.indexOf(a(g[1]).parent("tr")[0]),r=Math.min(A,h),t=Math.max(A,h)-r+1,k=z.tableColumn(g[0],true,true),j=z.tableColumn(g[1],true),q=a.inArray(g[0],k.column),p=a.inArray(g[1],j.column),f=k.info.offset[q]<j.info.offset[p]?k:j,e=k.info.offset[q]>=j.info.offset[p]?k:j,i=0,B=null,s="";a(a(g[0]).parents("table").eq(0).find("tr").get().slice(r,r+t)).each(function(E){var D=s.length,C=false;a(this).children("td,th").each(function(){var K=a(this),I=a.inArray(this,f.column),H=a.inArray(this,e.column);if(I!=-1||H!=-1){C=I!=-1&&H==-1;var G=parseInt(K.attr("colspan")||1);if(E==0){i+=G}if(I!=-1&&E>0){var L=f.info.delta[I],F;if(L>0){if(K.css("text-align")=="left"){F=K.clone(true);K.html("&nbsp;")}else{F=K.clone().html("&nbsp;")}F.removeAttr("colspan").removeAttr("id").insertBefore(this);if(L>1){F.attr("colspan",L)}}}if(H!=-1){var L=e.info.delta[H],F;if(G-L>1){var J=G-L-1;if(K.css("text-align")=="right"){F=K.clone(true);K.html("&nbsp;")}else{F=K.clone().html("&nbsp;")}F.removeAttr("colspan").removeAttr("id").insertAfter(this);if(J>1){F.attr("colspan",J)}}}if(!B){B=K}else{s+=K.html();K.remove()}}else{if(C){if(E==0){i+=parseInt(K.attr("colspan")||1)}s+=K.html();K.remove()}}});s+=D!=s.length?"<br/>":""});B.removeAttr("colspan").removeAttr("rowspan").html(B.html()+s);if(i>1){B.attr("colspan",i)}if(t>1){B.attr("rowspan",t)}z.fixTable(a(g[0]).parents("table").get(0))}this.updatePath();this.element.trigger("contentchange");return this},splitCells:function(){var h=this.options,j=h.selection,u=h.dom,z=h.doc,k=u.selfOrParent(j.getNode(),/^(TD|TH)$/);if(k){var p=parseInt(u.attr(k,"colspan")),q=parseInt(u.attr(k,"rowspan"));if(p>1||q>1){var w=p-1,x=q-1,t=u.parent(k,/^TABLE$/),s=u.tableMatrix(t);if(w){for(var v=0;v<w;v++){a(z.createElement(k.nodeName)).html("&nbsp;").insertAfter(k)}}if(x){var B=u.indexesOfCell(k,s),g=B[0],f=B[1];for(var e=g+1;e<g+x+1;e++){var A=null;if(!s[e][f].nodeName){if(s[e][f-1].nodeName){A=s[e][f-1]}else{for(var v=f-1;v>=0;v--){if(s[e][v].nodeName){A=s[e][v];break}}}if(A){for(var v=0;v<=w;v++){a(z.createElement(A.nodeName)).html("&nbsp;").insertAfter(A)}}}}}a(k).removeAttr("colspan").removeAttr("rowspan");u.fixTable(t)}}this.updatePath();this.element.trigger("contentchange");return this},fontColor:function(h){var g=this.options,f=g.selection;if(!f.collapsed()){var e=f.selected({collapse:false,wrap:"text"});a.each(e,function(){if(/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)){a(this).find("td,th").each(function(){a(this).css("color",h).find("*").css("color","")})}else{a(this).css("color",h).find("*").css("color","")}});this.updatePath();this.element.trigger("contentchange")}return this},backgroundColor:function(h){var g=this.options,f=g.selection;if(!f.collapsed()){var e=f.selected({collapse:false,wrap:"text"});a.each(e,function(){if(/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)){a(this).find("td,th").each(function(){a(this).css("background-color",h).find("*").css("background-color","")})}else{a(this).css("background-color",h).find("*").css("background-color","")}});this.updatePath();this.element.trigger("contentchange")}return this},font:function(f){var h=this.options,g=h.selection,e=g.selected({filter:"textContainsNodes"});a.each(e,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?a(this).find("td,th"):a(this);a(this).css("font-family",f).find("[style]").css("font-family","")});this.updatePath();this.element.trigger("contentchange");return this},fontSize:function(f){var g=this.options,e=g.selection.selected({filter:"textContainsNodes"});a.each(e,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?a(this).find("td,th"):a(this);$this.css("font-size",f).find("[style]").css("font-size","")});this.updatePath();this.element.trigger("contentchange");return this},format:function(B){var j=this.options,k=j.selection,r=j.dom,A=j.doc;function u(i,e){function f(s){a(s).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){a(this).replaceWith(a(this).html())});return s}if(/^(LI|DT|DD|TD|TH|CAPTION)$/.test(i.nodeName)){!r.isEmpty(i)&&r.wrapContents(f(i),e)}else{if(/^(UL|OL|DL|TABLE)$/.test(i.nodeName)){r.wrap(i,e)}else{!r.isEmpty(i)&&a(f(i)).replaceWith(a(A.createElement(e)).html(a(i).html()))}}}var D=B.toUpperCase(),t,p,z,x=k.collapsed(),h=k.getBookmark(),g=k.selected({collapsed:true,blocks:true,filter:"textContainsNodes",wrap:"inline",tag:"span"}),q=g.length,C=a(g[0]).prev(),w=a(g[g.length-1]).next();while(q--){p=g[q];z=a(p);if(D=="DIV"||D=="SPAN"){if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(p.nodeName)){z.replaceWith(a(A.createElement("div")).html(z.html()||""))}}else{if(/^(THEAD|TBODY|TFOOT|TR)$/.test(p.nodeName)){z.find("td,th").each(function(){u(this,D)})}else{if(p.nodeName!=D){u(p,D)}}}}k.moveToBookmark(h);this.updatePath();this.element.trigger("contentchange");return this},deleteLink:function(){var p=this.options,h=p.selection,k=p.dom,j=p.doc,q=h.getNode(),e=k.selfOrParentLink(q);function g(i){return i.nodeName=="A"&&i.href}if(e){h.select(e);j.execCommand("unlink",false,null)}else{h=a.browser.msie?h.selected():h.selected({wrap:false});if(h.length){for(var f=0;f<h.length;f++){if(g(h[f])){e=h[f];break}}if(!e){e=k.parent(h[0],g)||k.parent(h[h.length-1],g)}}}this.updatePath();this.element.trigger("contentchange");return this},horizontalRule:function(){var g=this.options,e=g.selection,h=e.getEnd(),f=g.doc;h=(h&&(h.nodeName=="HR"))?h:f.createElement("hr");this._showDialog("Horizontal Rule",attributes(h),[g.formIds.standard],function(i){var j=a(h);a.each(i,function(q,p){p=a.trim(p)?j.attr(q,p):j.removeAttr(q)});if(!j.parent().length){e.insertNode(h)}});this.element.trigger("contentchange");return this},properties:function(){var e=this,g=this.options,f=g.selection,h=f.getNode();if(h.nodeType==3){h=h.parentNode}if(h.nodeType!=1||h.nodeName=="BODY"){return}this._showDialog("Standard Properties",attributes(h),[g.formIds.standard],function(i){var j=a(h);a.each(i,function(q,p){p=a.trim(p)?j.attr(q,p):j.removeAttr(q)});e.element.trigger("contentchange")});return this},image:function(){var g=this,p=this.options,j=p.selection,f=j.getEnd(),k=p.doc,i=p.formIds;if(a(f).is(".widget,:not(img)")){f=k.createElement("img")}if(f.width&&a(f).attr("style")){f.width=f.offsetWidth;a(f).attr("style",a(f).attr("style").replace(/width:\s*\d+px/,"width:"+f.offsetWidth+"px"))}if(f.height&&a(f).attr("style")){f.height=f.offsetHeight;a(f).attr("style",a(f).attr("style").replace(/height:\s*\d+px/,"height:"+f.offsetHeight+"px"))}var e=attributes(f),h=a.extend(true,{},e);this._showDialog("Image",attributes(f),[i.standard,i.image],function(q){var r=a(f);if(q.width&&q.style){q.style=q.style.replace(/width:\s*\d+px/,"width:"+q.width+"px")}if(q.height&&q.style){q.style=q.style.replace(/height:\s*\d+px/,"height:"+q.height+"px")}a.each(q,function(t,s){s=a.trim(s)?r.attr(t,s):r.removeAttr(t)});if(!f.parentNode){j.insertNode(f)}g.element.trigger("contentchange");if(!equals(q,h)){g.element.trigger("contentchange")}r.dblclick(function(){var s=attributes(f);s.width=a(f).css("width").replace(/px/g,"");s.height=a(f).css("height").replace(/px/g,"");g._showDialog("Image",s,[i.standard,i.image],function(t){a.each(t,function(w,u){if(w=="width"||w=="height"){u=a.trim(u)?r.css(w,u):r.removeAttr(w)}else{u=a.trim(u)?r.attr(w,u):r.removeAttr(w)}});if(!f.parentNode){j.insertNode(f)}g.element.trigger("contentchange")})})});return this},rteWidget:function(p,f,e){var g=this.options,h=g.selection,i=h.getStart(),q=a(i);if(!q.is(".widget[type="+p+"]")){q=a("<div class='widget'/>").attr("type",p).css((e&&e.style)||{});q.toggleClass("field",a.inArray(p,["text","checkbox","radio","select","datetime","mobiledate","codearea","textarea","file","grid","jsrender","password","rte","search","toggle","listview","customhtml"])!=-1);q.toggleClass("box",a.inArray(p,["box","editor","page","view"])!=-1);i=q.get(0)}var k=a.extend(true,e,q.getMetadata()),j=attributes(i),r=p.substring(0,1).toUpperCase()+p.substring(1)+" Properties";if(j.id){j.id=j.id.replace(/-/g,".")}this._showDialog(r,a.extend({},k,j),f,function(s){var t={};if(q.is(".field")&&s[p+"field"]){t[p+"field"]=s[p+"field"];delete s[p+"field"]}else{if(q.is("[type=widget]")){t.widget=s.widget;delete s.widget}else{if(q.is("[type=box]")){t.box=s.box;delete s.box;if(k&&k.box&&!(k.box.link==t.box.link&&t.box.link=="raw")){q.children(".content").empty()}}else{if(q.is("[type=tabsx]")){t.tabsxwidget=s.tabsxwidget;delete s.tabsxwidget}else{if(q.is("[type=button]")){t.buttonwidget=s.buttonwidget;delete s.buttonwidget}else{if(q.is(".box")&&s[p+"box"]){t[p+"box"]=s[p+"box"];delete s[p+"box"]}else{if(q.is(".widget")&&s[p+"widget"]){t[p+"widget"]=s[p+"widget"];delete s[p+"widget"]}}}}}}}if(!equals(t,k)){q.setMetadata(t);q.trigger("metadatachanged",[t,k])}if(!equals(s,j)){if(s.id){s.id=s.id.replace(/\./g,"-")}a.each(s,function(w,u){u=a.trim(u)?q.attr(w,u):q.removeAttr(w)});if(q.parent().length==0){h.insertNode(i);q.trigger("newwidget",[i])}else{q.trigger("attributeschanged",[s,j])}}});return this},rteWidgetActive:function(e){var f=this.options.selection.getEnd();if(f&&f.nodeName=="DIV"){return a(f).is(".widget[type="+e+"]")}return false},_alignEnable:function(){var f=this.options;if(f.mode!="design"){return false}var e=f.selection.getNode();return e&&e.nodeName=="BODY"?e:f.dom.selfOrParent(e,"textNodes")||(e&&e.parentNode&&e.parentNode.nodeName=="BODY"?e.parentNode:null)?true:false},_alignActive:function(h){var f=this.options;if(f.mode!="design"){return false}var e=f.selection.getNode(),g=e.nodeName=="BODY"?e:f.dom.selfOrParent(e,"textNodes")||(e.parentNode&&e.parentNode.nodeName=="BODY"?e.parentNode:null);return a(g).css("text-align")==h},_commandEnabled:function(g){var i=this.options,f=false;try{f=(i.mode=="design")&&i.doc.queryCommandEnabled(g)}catch(h){}return f},_commandState:function(g){var i=this.options,f=false;try{f=(i.mode=="design")&&i.doc.queryCommandState(g)}catch(h){}return f},_directionActive:function(e){var f=a(this.options.selection.getNode());return f.attr("dir")==e||f.parents("[dir="+e+"]").length||f.find("[dir="+e+"]").length},_colorEnable:function(f,e){var g=this.options;if(g.mode!="design"){return false}var i=g.selection.getNode();if(i){var h=a(i.nodeType!=1?i.parentNode:i).css(e);f.data("select").val(this._color2Hex(""+h)||(e=="color"?"#000000":"#FFFFFF"));return true}return false},_fontEnable:function(f){var g=this.options;if(g.mode!="design"){return false}var h=g.selection.getNode();if(h){if(h.nodeType!=1){h=h.parentNode}var e=a(h).css("font-family");e=e?e.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"";f.element.data("select").val(f.src[e]?e:"");return true}return false},_fontSizeEnable:function(e){var f=this.options;if(f.mode!="design"){return false}var g=f.selection.getNode();e.element.data("select").val((m=f.dom.attr(g,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"");return true},_formatEnable:function(e){var f=this.options;if(f.mode!="design"){return false}var g=f.dom.selfOrParent(f.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);e.element.data("select").val(g?g.nodeName.toLowerCase():"span");return true},_outdentEnable:function(){var j=this.options;if(j.mode!="design"){return false}var g=j.selection,i=j.dom;function e(r){var p={type:"",val:0},q;if((q=i.attr(r,"style"))){p.type=q.indexOf("padding-left")!=-1?"padding-left":(q.indexOf("margin-left")!=-1?"margin-left":"");p.val=p.type?parseInt(a(r).css(p.type))||0:0}return p}var k=g.getNode(),h=e(k),f=null;if(h.val){f=k}else{a.each(i.parents(k,"*"),function(){h=e(this);if(h.val){f=this}})}return f?true:false},_linkEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,h=e.getNode();if(h){var f=g.dom;return f.selfOrParentLink(h)||f.selectionHas(e,function(i){return i.nodeName=="A"&&i.href})||!e.collapsed()||h.nodeName=="IMG"}return false},_linkActive:function(){var g=this.options,e=g.selection;if(g.mode!="design"){return false}var h=e.getNode();if(h){var f=g.dom;return f.selfOrParentLink(h)||f.selectionHas(e,function(i){return i.nodeName=="A"&&i.href})}return false},_deleteLinkEnable:function(){var g=this.options,e=g.selection;if(g.mode!="design"){return false}var h=e.getNode();if(h){var f=g.dom;return f.selfOrParentLink(h)||f.selectionHas(e,function(i){return i.nodeName=="A"&&i.href})}return false},_blockQuoteEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;if(!e.collapsed()){return true}return f.selfOrParent(e.getNode(),/^BLOCKQUOTE$/)},_blockElementEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return !e.collapsed()||f.selfOrParent(e.getNode(),/^DIV$/)},_blockElementActive:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return e.collapsed()&&f.selfOrParent(e.getNode(),/^DIV$/)},_stopFloatActive:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;if(!e.collapsed()){return false}var h=f.selfOrParent(e.getEnd(),/^DIV$/);return h&&(f.attr(h,"clear")||a(h).css("clear")!="none")},_propertiesEnable:function(){var f=this.options,e=f.selection,g=e.getNode();if(f.mode!="design"){return false}if(g&&g.nodeType==3){g=g.parentNode}g=(g&&g.nodeType==1&&g.nodeName!="BODY")?g:null;return g?true:false},_imageActive:function(){var f=this.options;if(f.mode!="design"){return false}var g=f.selection.getEnd();if(g){var e=a(g);return g.nodeName=="IMG"&&!e.is(".widget")&&!e.is(".rte-media")}return false},_tablePropsEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return f.selfOrParent(e.getNode(),/^TABLE$/)},_deleteTableEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return f.parent(e.getNode(),/^TABLE$/)},_rowBeforeEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return f.selfOrParent(e.getNode(),/^TR$/)},_rowAfterEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return f.selfOrParent(e.getNode(),/^TR$/)},_deleteRowEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return f.selfOrParent(e.getNode(),/^TR$/)},_columnBeforeEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return f.selfOrParent(e.getNode(),/^(TD|TH)$/)},_columnAfterEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return f.selfOrParent(e.getNode(),/^(TD|TH)$/)},_deleteColumnEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return f.selfOrParent(e.getNode(),/^(TD|TH)$/)},_cellPropsEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom;return f.parent(e.getNode(),/^TABLE$/)},_mergeCellsEnable:function(){var i=this.options;if(i.mode!="design"){return false}var g=i.selection,h=i.dom,f=h.selfOrParent(g.getStart(),/^(TD|TH)$/),e=h.selfOrParent(g.getEnd(),/^(TD|TH)$/);return f&&e&&f!=e&&a(f).parents("table").get(0)==a(e).parents("table").get(0)},_splitCellsEnable:function(){var g=this.options;if(g.mode!="design"){return false}var e=g.selection,f=g.dom,h=f.selfOrParent(e.getNode(),/^(TD|TH)$/);return h&&(parseInt(f.attr(h,"colspan"))>1||parseInt(f.attr(h,"rowspan"))>1)},_parseURL:function(g){var h=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var f=g.match(h);var e={};a.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(j){e[this]=f[j]});if(!e.host.match(/[a-z0-9]/i)){e.host=""}return e},_absoluteURL:function(f){var g=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:"");var h=!this.url.file?this.url.path:this.url.path.substring(0,this.url.path.length-this.url.file.length);f=a.trim(f);if(!f){return""}if(f[0]=="#"){return f}var e=this._parseURL(f);if(!e.host&&!e.path&&!e.anchor){return""}if(!this.options.absoluteURLs){return f}if(e.protocol){return f}if(e.host&&(e.host.indexOf(".")!=-1||e.host=="localhost")){return this.url.protocol+"://"+f}if(f[0]=="/"){f=g+f}else{if(f.indexOf("./")==0){f=f.substring(2)}f=g+h+f}return f},_color2Hex:function(j){var f={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#fffffff",yellow:"#ffff00"};var i=/\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*/i;var g=/aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\s*\([^\)]+\)/i;var e;j=j||"";if(j.indexOf("#")===0){return j}function h(k){k=parseInt(k).toString(16);return k.length>1?k:"0"+k}if(f[j]){return f[j]}if((e=j.match(i))){return"#"+h(e[1])+h(e[2])+h(e[3])}return""},_trimEventCallback:function(e){e=e?e.toString():"";return a.trim(e.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))},_toPixels:function(f){var e=f.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);if(e){f=e[1];unit=e[2]}if(f[0]=="."){f="0"+f}f=parseFloat(f);if(isNaN(f)){return""}var g=parseInt(a(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(f*g);case"pt":return parseInt(f*g/12);case"%":return parseInt(f*g/100)}return f},_parseStyle:function(h){var f={},g,j,e,i;if(typeof(h)=="string"&&h.length){a.each(h.replace(/&quot;/gi,"'").split(";"),function(k,p){if((i=p.indexOf(":"))!==-1){j=a.trim(p.substr(0,i));e=a.trim(p.substr(i+1));if(j=="color"||j=="background-color"){e=e.toLowerCase()}if(j&&e){f[j]=e}}})}return f},_encode:function(g){var i={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};var f=/[<>&\"]/g;var h=i;return(""+g).replace(f,function(e){return h[e]})},_edittable:function(k){var g=this.options,h=g.selection,j=g.dom,p=g.doc,f=g.formIds,r=this;var q=k?p.createElement("table"):j.selfOrParent(h.getNode(),/^TABLE$/);q=q||p.createElement("table");if(q.width&&a(q).attr("style")){q.width=q.offsetWidth;a(q).attr("style",a(q).attr("style").replace(/width:\s*\d+px/,"width:"+q.offsetWidth+"px"))}if(q.height&&a(q).attr("style")){q.height=q.offsetHeight;a(q).attr("style",a(q).attr("style").replace(/height:\s*\d+px/,"height:"+q.offsetHeight+"px"))}var i=attributes(q);if(k){a.extend(i,{rows:2,columns:2,_isNew:true})}var e=a.extend(true,{},i);this._showDialog("Table",i,[f.standard,f.table],function(v){var u=a(q);if(!u.parents().length){var x=parseInt(v.rows)||0;var A=parseInt(v.columns)||0;if(x<=0||A<=0){return}var s=a(p.createElement("tbody")).appendTo(q);for(var w=0;w<x;w++){var z="<tr>";for(var t=0;t<A;t++){z+="<td>&nbsp;</td>"}s.append(z+"</tr>")}}else{u.removeAttr("width").removeAttr("border").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style")}delete v.rows;delete v.columns;delete v._isNew;if(v.width&&v.style){v.style=v.style.replace(/width:\s*\d+px/,"width:"+v.width+"px")}if(v.height&&v.style){v.style=v.style.replace(/height:\s*\d+px/,"height:"+v.height+"px")}a.each(v,function(C,B){B=a.trim(B)?u.attr(C,B):u.removeAttr(C)});if(!q.parentNode){h.insertNode(q)}u.resizable({stop:function(C,B){r.element.trigger("contentchange");C.preventDefault();C.stopImmediatePropagation()}});if(!equals(v,e)){r.element.trigger("contentchange")}});return this},_cellProperties:function(){var g=this,p=this.options,j=p.selection,k=p.dom,h=p.formIds;var e=k.selfOrParent(j.getNode(),/^(TD|TH)$/);if(!e){return}var i=a(e),f=attributes(e);a.extend(f,{type:e.nodeName.toLowerCase(),width:i.css("width")||i.attr("width"),height:i.css("height")||i.attr("height")});this._showDialog("Cell",f,[h.standard,h.cell],function(q){var r=i;switch(q.apply){case"row":r=i.parent("tr").children("td,th");break;case"column":r=a(k.tableColumn(e));break;case"table":r=i.closest("table").find("td,th");break}delete q.apply;if(e.nodeName.toLowerCase()!=q.type){a.each(r.get(),function(){a(this).replaceWith(a("<"+q.type+" />").html(a(this).html()))})}delete q.type;g.element.trigger("contentchange");a.each(q,function(t,s){s=a.trim(s)?r.attr(t,s):r.removeAttr(t)})});return this},addClass:function(e,f){this.$body.find(e).addClass(f)},removeClass:function(e,f){this.$body.find(e).removeClass(f)},toggleClass:function(f,g,e){this.$body.find(f).toggleClass(g,e)},_createActions:function(){var e=this,g=this.options;var f={properties:{type:"button",label:"Properties",icons:{primary:"ui-icon-css"},handler:function(){e.properties()},enabled:function(){return e._propertiesEnable()}},cleanFormat:{type:"checkbox",label:"Clean Format",icons:{primary:"ui-icon-clean-format"},handler:function(){e.removeFormat()},enabled:function(){return e._commandEnabled("removeformat")},checked:function(){return e._commandState("removeformat")}},bold:{type:"checkbox",label:"Bold",icons:{primary:"ui-icon-bold"},handler:function(){e.bold()},enabled:function(){return e._commandEnabled("bold")},checked:function(){return e._commandState("bold")}},italic:{type:"checkbox",label:"Italic",icons:{primary:"ui-icon-italic"},handler:function(){e.italic()},enabled:function(){return e._commandEnabled("italic")},checked:function(){return e._commandState("italic")}},underline:{type:"checkbox",label:"Underline",icons:{primary:"ui-icon-underline"},handler:function(){e.underline()},enabled:function(){return e._commandEnabled("underline")},checked:function(){return e._commandState("underline")}},strikethrough:{type:"checkbox",label:"Strikethrough",icons:{primary:"ui-icon-strikethrough"},handler:function(){e.strikethrough()},enabled:function(){return e._commandEnabled("strikethrough")},checked:function(){return e._commandState("strikethrough")}},subscript:{type:"checkbox",label:"Subscript",icons:{primary:"ui-icon-subscript"},handler:function(){e.subscript()},enabled:function(){return e._commandEnabled("subscript")},checked:function(){return e._commandState("subscript")}},superscript:{type:"checkbox",label:"Superscript",icons:{primary:"ui-icon-superscript"},handler:function(){e.superscript()},enabled:function(){return e._commandEnabled("superscript")},checked:function(){return e._commandState("superscript")}},alignLeft:{name:"align",type:"radio",label:"Align left",icons:{primary:"ui-icon-align-left"},handler:function(){e.align("left")},enabled:function(){return e._alignEnable()},checked:function(){return e._alignActive("left")}},alignCenter:{name:"align",type:"radio",label:"Align center",icons:{primary:"ui-icon-align-center"},handler:function(){e.align("center")},enabled:function(){return e._alignEnable()},checked:function(){return e._alignActive("center")}},alignRight:{name:"align",type:"radio",label:"Align right",icons:{primary:"ui-icon-align-right"},handler:function(){e.align("right")},enabled:function(){return e._alignEnable()},checked:function(){return e._alignActive("right")}},alignFull:{name:"align",type:"radio",label:"Align full",icons:{primary:"ui-icon-align-full"},handler:function(){e.align("justify")},enabled:function(){return e._alignEnable()},checked:function(){return e._alignActive("justify")}},leftToRight:{name:"direction",type:"radio",label:"Left to right",icons:{primary:"ui-icon-left-to-right"},handler:function(){e.leftToRight()},checked:function(){return e._directionActive("ltr")}},rightToLeft:{name:"direction",type:"radio",label:"Right to left",icons:{primary:"ui-icon-right-to-left"},handler:function(){e.rightToLeft()},checked:function(){return e._directionActive("rtl")}},fontColor:{type:"colorPicker",label:"Font color",icons:{primary:"ui-icon-font-color"},handler:function(h){e.fontColor(h)},enabled:function(){return e._colorEnable(this.element,"color")}},backgroundColor:{type:"colorPicker",label:"Background color",color:"#FFFFFF",icons:{primary:"ui-icon-background-color"},handler:function(h){e.backgroundColor(h)},enabled:function(){return e._colorEnable(this.element,"background-color")}},font:{type:"select",label:"Font",tpl:'<span style="font-family:%val">%label</span>',src:{"":"Font","andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"},select:function(h){e.font(h)},enabled:function(){return e._fontEnable(this)}},fontSize:{type:"select",label:"Font size",labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label</span>',src:{"":"Font size","xx-small":"Small (8pt)","x-small":"Small (10px)",small:"Small (12pt)",medium:"Normal (14pt)",large:"Large (18pt)","x-large":"Large (24pt)","xx-large":"Large (36pt)"},select:function(h){e.fontSize(h)},enabled:function(){return e._fontSizeEnable(this)}},format:{type:"select",label:"Format",labelTpl:"%label",tpls:{"":"%label"},src:{span:"Format",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6",p:"Paragraph",address:"Address",pre:"Preformatted",div:"Normal (DIV)"},select:function(h){e.format(h)},enabled:function(){return e._formatEnable(this)}},outdent:{type:"button",label:"Outdent",icons:{primary:"ui-icon-outdent"},handler:function(){e.outdent()},enabled:function(){return e._outdentEnable()}},indent:{type:"button",label:"Indent",icons:{primary:"ui-icon-indent"},handler:function(){e.indent()}},orderedList:{type:"button",label:"Ordered list",icons:{primary:"ui-icon-ordered-list"},handler:function(){e.orderedList()},enabled:function(){return e._commandEnabled("insertorderedlist")},checked:function(){return e._commandState("insertorderedlist")}},unorderedList:{type:"button",label:"Unordered List",icons:{primary:"ui-icon-unordered-list"},handler:function(){e.unorderedList()},enabled:function(){return e._commandEnabled("insertunorderedlist")},checked:function(){return e._commandState("insertunorderedlist")}},link:{type:"checkbox",label:"Link",icons:{primary:"ui-icon-link"},handler:function(){e.link()},enabled:function(){return e._linkEnable()},checked:function(){return e._linkActive()}},deleteLink:{type:"checkbox",label:"Delete Link",icons:{primary:"ui-icon-del-link"},handler:function(){e.deleteLink()},enabled:function(){return e._deleteLinkEnable()},checked:function(){return e._deleteLinkEnable()}},horizontalRule:{type:"checkbox",label:"Horizontal rule",icons:{primary:"ui-icon-horizontal-rule"},handler:function(){e.horizontalRule()},checked:function(){return g.mode=="design"&&g.selection.getEnd()&&g.selection.getEnd().nodeName=="HR"}},blockQuote:{type:"checkbox",label:"Block quote",icons:{primary:"ui-icon-block-quote"},handler:function(){e.blockQuote()},enabled:function(){return e._blockQuoteEnable()},checked:function(){return e._blockQuoteEnable()}},blockElement:{type:"checkbox",label:"Block element (DIV)",icons:{primary:"ui-icon-block-element"},handler:function(){e.blockElement()},enabled:function(){return e._blockElementEnable()},checked:function(){return e._blockElementActive()}},stopFloat:{type:"checkbox",label:"Stop element floating",icons:{primary:"ui-icon-stop-float"},handler:function(){e.stopFloat()},checked:function(){return e._stopFloatActive()}},image:{type:"checkbox",label:"Image",icons:{primary:"ui-icon-image"},handler:function(){e.image()},checked:function(){return e._imageActive()}},table:{type:"button",label:"Table",icons:{primary:"ui-icon-table"},handler:function(){e._edittable(true)}},tableProps:{type:"button",label:"Table properties",icons:{primary:"ui-icon-table-props"},handler:function(){e._edittable()},enabled:function(){return e._tablePropsEnable()}},deleteTable:{type:"button",label:"Delete table",icons:{primary:"ui-icon-del-table"},handler:function(){e.deleteTable()},enabled:function(){return e._deleteTableEnable()}},rowBefore:{type:"button",label:"Insert row before",icons:{primary:"ui-icon-row-before"},handler:function(){e.insertTableRow("before")},enabled:function(){return e._rowBeforeEnable()}},rowAfter:{type:"button",label:"Insert row after",icons:{primary:"ui-icon-row-after"},handler:function(){e.insertTableRow("after")},enabled:function(){return e._rowAfterEnable()}},deleteRow:{type:"button",label:"Delete row",icons:{primary:"ui-icon-del-row"},handler:function(){e.deleteRow()},enabled:function(){return e._deleteRowEnable()}},columnBefore:{type:"button",label:"Insert column before",icons:{primary:"ui-icon-col-before"},handler:function(){e.insertTableColumn("before")},enabled:function(){return e._columnBeforeEnable()}},columnAfter:{type:"button",label:"Insert column after",icons:{primary:"ui-icon-col-after"},handler:function(){e.insertTableColumn("after")},enabled:function(){return e._columnAfterEnable()}},deleteColumn:{type:"button",label:"Delete column",icons:{primary:"ui-icon-del-column"},handler:function(){e.deleteColumn()},enabled:function(){return e._deleteColumnEnable()}},cellProps:{type:"button",label:"Table cell properties",icons:{primary:"ui-icon-cell-props"},handler:function(){e._cellProperties()},enabled:function(){return e._cellPropsEnable()}},mergeCells:{type:"button",label:"Merge table cells",icons:{primary:"ui-icon-merge-cells"},handler:function(){e.mergeCells()},enabled:function(){return e._mergeCellsEnable()}},splitCells:{type:"button",label:"Split table cells",icons:{primary:"ui-icon-split-cells"},handler:function(){e.splitCells()},enabled:function(){return e._splitCellsEnable()}},tabsx:{type:"checkbox",label:"Tabsx",icons:{primary:"ui-icon-tabsx"},handler:function(){e.rteWidget("tabsx",g.formIds.tabsx,{style:{width:400,height:300}})},checked:function(){return e.rteWidgetActive("tabsx")}},sourcecode:{type:"checkbox",label:"Source Code",icons:{primary:"ui-icon-sourcecode"},handler:function(){e.option("mode",g.mode=="sourcecode"?"design":"sourcecode")},checked:function(){return g.mode=="sourcecode"},enabled:function(){return true}}};a.each(f,function(){this.text=false;if(!this.enabled){this.enabled=function(){return g.mode=="design"}}});return f},destroy:function(){var f=this.options,e=f.doc;f.history=[];this.toolbar&&this.toolbar.remove();this.source.unbind(".rte");a(e).unbind(".rte");this.$body.unbind(".rte");a(f.win).unbind(".rte");a(window).unbind("resize.rte",this._proxy);this.element.removeClass("an-rte");return a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.tabsx",a.ui.tabs,{options:{duration:2000,slideshow:false,fxs:null},_create:function(){var e=this,f=this.options;if((f.mode=="edit"||f.mode=="browser")&&f.slideshow){f.fx=f.fxs?f.fxs:{opacity:"toggle",duration:200}}a.ui.tabs.prototype._create.apply(this,arguments);this.element.addClass("an-tabsx");this._navMenu=a("<div id='nav-menu'>>><span>0</span></div>");this._navMenu.css({position:"relative","float":"left",width:"18px",height:"22px","font-size":"60%",border:"1px solid #CCCCCC",margin:"0px",padding:"0px"});this._navMenu.find("span").css({position:"absolute",right:"0px",bottom:"0px","font-size":"11px"});this._navMenu.hover(function(g){e._navMenu.css({border:"1px solid #AAAAAA",cursor:"pointer",margin:"0px",padding:"0px"})},function(){e._navMenu.css({border:"1px solid #CCCCCC",margin:"0px",padding:"0px"})});if((f.mode=="edit"||f.mode=="browser")&&f.slideshow){this._slideshow(f.duration)}else{this.element.bind("tabsxadd.tabsx",a.proxy(this,"_showMenu"));this.element.bind("tabsxshow.tabsx",a.proxy(this,"_showMenu"));this.element.bind("tabsxremove.tabsx",a.proxy(this,"_showMenu"));this._proxy=a.proxy(this,"_showMenu");a(window).bind("resize.tabsx",this._proxy)}if(f.showTabsContextMenu){this.list.menu({triggerEvent:"contextmenu",menuPosition:{my:"left top",at:"left bottom"},delay:false,actions:{close:{type:"menuItem",text:"Close",handler:a.proxy(e,"closeCurrent")},closeOthers:{type:"menuItem",text:"Close Others",handler:a.proxy(e,"closeOthers")},closeAll:{type:"menuItem",text:"Close All",handler:a.proxy(e,"closeAll")}},select:function(h,g){a(this).menu("collapseAll")}})}},_slideshow:function(i){var e=this,j=this.options,k=null,h=0;this.lis.each(function(){h+=a(this).outerWidth(true)});this.list.css({width:h}).addClass("ui-tabs-slideshow-nav").removeClass("ui-widget-header");var f=function(p){g();e._rotation=setTimeout(function(){var q=j.selected;if(k!=null&&k==q){g();return false}e.select(++q<e.anchors.length?q:0);f()},i)};function g(){clearTimeout(e._rotation);e._rotation=null}if(i){this.anchors.bind("click",g);this.anchors.bind("mouseover",function(){var p=e.anchors.index(this);if(j.selected==p){g()}else{k=p}});this.anchors.bind("mouseout",function(){f();k=null});this.anchors.bind("mouseup",function(){a(this).parent().hasClass("ui-state-focus")&&a(this).parent().removeClass("ui-state-focus")});f()}else{g()}return this},closeCurrent:function(){this.remove(this.option("selected"))},closeOthers:function(){var e=this.option("selected");while(this.length()-1>e){this.remove(this.length()-1)}while(this.length()>1){this.remove(0)}},closeAll:function(){while(this.length()>0){this.remove(0)}},option:function(e,f){if(e==="selectedPanel"&&f===b){return this.panels.get(this.options.selected)}else{if(e==="panels"&&f===b){return this.panels}}return a.Widget.prototype.option.apply(this,arguments)},_showMenu:function(k,j){if(this.list.is(":hidden")){return}var f=this;if(k.type=="tabsxshow"){this.lis.each(function(r,e){var t=a(e),s=parseInt(t.attr("hit"))||0;t.attr("hit",t.is(".ui-tabs-selected")?0:s+1)})}var q=this.lis.toArray();q.sort(function(e,t){var s=parseInt(a(e).attr("hit")),r=parseInt(a(t).attr("hit"));return s-r});this._navMenu.appendTo(this.list);var i=this.list.width()-this._navMenu.outerWidth(true);this._navMenu.menu("destroy").detach();a.each(q,function(r,e){i-=a(e).outerWidth(true);a(e)[i>0?"show":"hide"]()});var h=this.lis.filter(":hidden"),g=h.size();if(g>0){this._navMenu.find("span").html(g);var p={};h.each(function(){var r=a(this),e=r.find("a:first"),s=e.attr("href").slice(1);p[s]={type:"menuItem",text:e.text(),handler:function(){f.element.tabsx("select","#"+s)}}});f._navMenu.appendTo(this.list);f._navMenu.menu({triggerEvent:"click",menuPosition:{of:f._navMenu,my:"left top",at:"left bottom"},delay:false,actions:p,select:function(s,r){a(this).menu("collapseAll")}})}},remove:function(e){if(this._getIndex(e)==-1){return}return a.ui.tabs.prototype.remove.apply(this,arguments)},panel:function(e){return a(this.panels[this._getIndex(e)])},_trigger:function(e,f,g){var j,i,h=this.options[e];g=g||{};f=a.Event(f);f.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase();f.target=this.element[0];i=f.originalEvent;if(i){for(j in i){if(!(j in f)){f[j]=i[j]}}}!(a.isFunction(h)&&h.call(this.element[0],f,g)===false||f.isDefaultPrevented());return this.element.trigger(f,g)},destroy:function(){var e=this.options;if(!e.destroyTabs){this.lis.add(this.panels).each(function(){a.removeData(this,"destroy.tabs")})}a(window).unbind("resize.tabsx",this._proxy);this.list.unbind(".tabsx");this.element.removeClass("an-tabsx").unbind(".tabsx").removeData("tabsx");return a.ui.tabs.prototype.destroy.apply(this,arguments)}})}(jQuery));
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.explorer",a.an.tree,{_create:function(){a.an.tree.prototype._create.apply(this,arguments);var e=this;a(document).bind("documentCreated.explorer documentChanged.explorer documentDeleted.explorer",function(g,f){a.each(a.isArray(f)?f:[f],function(i,h){if(g.type=="documentCreated"&&h._path){var j=h._path.split(","),p=j[j.length-3];e.refresh(p)}else{e.refresh(h._id);e.refresh(Model.GROUP_ROOT)}})})},_defaultContentProvider:function(){var e=this.options;return{getRoots:function(g){var f={$or:[]};a.each(e.roots,function(){f.$or.push({_id:this})});a.ans.getDoc(e.dbId,null,{selector:f},function(i,j){var h=[];a.each(j.docs||[],function(q,p){h.push({id:p._id,text:p.title,data:p,"class":"folder root"})});g(h)})},getChildren:function(f,i){var h=f.data,g;if(h._id==Model.EXTENSION_ROOT){g={type:Model.EXTENSION_POINT}}else{if(h.type==Model.EXTENSION_POINT){g={extensionPoint:h._id}}else{g={_path:{$regex:"^"+h._path+"[^,]+,$"}};if(e.showUser&&(h.type==Model.GROUP)){g={$or:[g,{type:Model.USER,_groupPaths:h._path}]}}else{if(!e.showUser){g={$and:[g,{type:{$ne:Model.USER}}]}}}}}a.ans.getDoc(e.dbId,null,{selector:g},function(k,p){var j=[];a.each(p.docs,function(q,r){j.push({id:r._id,text:r.title,data:r,parent:f,"class":(r.type==Model.CATEGORY||r.type==Model.OU||r.type==Model.GROUP||r.type==Model.ROLE||r.type==Model.EXTENSION_POINT)?"folder":"file"})});i(j)})},hasChildren:function(g){var f=g.data.type;return f==Model.CATEGORY||f==Model.OU||f==Model.GROUP||f==Model.ROLE||f==Model.EXTENSION_POINT},getId:function(f){return f.id?f.id:null}}},destroy:function(){a(document).unbind(".explorer");a.an.tree.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.page",{options:{mode:"browser",actionSets:[],wrapper:"<div/>",modelType:"page",formIds:{button:["5080143085ac60df09000001","50de596da092007b11000001"],tabsx:["5080143085ac60df09000001","51306faad58d1c129f000000"],box:["5080143085ac60df09000001","50de56d0a092007b11000000","50ea38efa0920073870000ef"],codearea:["5080143085ac60df09000001","51d66f5fedad572a8b0001ad"]},mFormIds:{tabsx:["5080143085ac60df09000001","51306faad58d1c129f000000"],box:["5080143085ac60df09000001","50de56d0a092007b11000000","50ea38efa0920073870000ef"],text:["5080143085ac60df09000001","519095a03bcccb65f400008b"],search:["5080143085ac60df09000001","51932b05ac8f2725e1000048"],password:["5080143085ac60df09000001","5185ac02a092006ca6000048"],checkbox:["5080143085ac60df09000001","519dbd9c3bcccb444800008c","51a2ffeeac8f275c2700013b"],button:["5080143085ac60df09000001","51933105ac8f2712ab000069"],slider:["5080143085ac60df09000001","51a5a62dac8f2755d2000069"],datetime:["5080143085ac60df09000001","50af2da26cec663c0a00000b"],textarea:["5080143085ac60df09000001","50af2ca66cec663c0a000008"],tabsx:["5080143085ac60df09000001","51306faad58d1c129f000000"],file:["5080143085ac60df09000001","50ceb75ba092004120000000"],grid:["5080143085ac60df09000001","5089e21f2b2255080a000005"],jsrender:["5080143085ac60df09000001","514d0a46caa05a669e0005c8","514d0e9dcaa05a26e30001af","514d0825caa05a669e0002ae","514d5ef3ac8f27413200014e"],radio:["5080143085ac60df09000001","51a2b48dac8f2770b7000001","51850c1ca092003b12000024"],select:["5080143085ac60df09000001","51af125321c7d61a65000024","508259700b27990c0a000003"],box:["5080143085ac60df09000001","50de56d0a092007b11000000","50ea38efa0920073870000ef"],rte:["5080143085ac60df09000001"],collapsible:["5080143085ac60df09000001","51a8639ebd94293c2f000081"],mobiledate:["5080143085ac60df09000001","51c967a3ba4682122900004a"],toggle:["5080143085ac60df09000001","51a565753bcccb5b0e0000ac"],navbar:["5080143085ac60df09000001","51c17808caa05a042500004a","51c02b6eac8f274167000120"],listview:["5080143085ac60df09000001","51ad5e1f21c7d6296100006c","51ad54a921c7d63144000144"],customhtml:["5080143085ac60df09000001","51c175e221c7d6118800023a"],swipe:["5080143085ac60df09000001","51ca58ebedad5734e8000023"],codearea:["5080143085ac60df09000001","51d66f5fedad572a8b0001ad"]}},_create:function(){this.element.addClass("an-page");var o=this.options,page=o[this.widgetName];$.extend(this,eval("try{("+(page.methods||"{}")+")}catch(e){}"));o.cssFiles=o.cssFiles||[];o.jsFiles=o.jsFiles||[];if(o.mobile){o.cssFiles=["stylesheets/jquery.mobile-1.3.1.min.css","stylesheets/jquery.an.mwidget.css"].concat(o.cssFiles);o.jsFiles=["javascripts/jquery-1.8.2.js","javascripts/jquery.scrollto.js"].concat(o.jsFiles);o.formIds=o.mFormIds}else{o.cssFiles=["stylesheets/rte/rte-design.css","stylesheets/jquery-ui-1.8.24.custom.css","stylesheets/jquery.ui.timepicker.css","stylesheets/jquery.an.menu.css","stylesheets/jquery.an.agilegrid.css","stylesheets/jquery.an.tree.css","stylesheets/jquery.an.border.css","stylesheets/jquery.an.tabsx.css","stylesheets/jquery.an.toolbar.css","stylesheets/jquery.an.page.css","stylesheets/jquery.an.editor.css","stylesheets/jquery.an.formview.css","stylesheets/jquery.an.widget.css","stylesheets/jquery.an.tabsxwidget.css","stylesheets/jquery.an.box.css","stylesheets/jquery.an.fileinput.css","stylesheets/jquery.an.filefield.css","stylesheets/jquery.an.gridfield.css","stylesheets/jquery.colorpicker.css","stylesheets/jquery.ui.select.css","stylesheets/rte/paddinginput.css","stylesheets/jquery.an.rte.css","stylesheets/base.css"].concat(o.cssFiles);o.jsFiles=["javascripts/jquery-1.8.2.js","javascripts/jquery.scrollto.js"].concat(o.jsFiles)}this._initPage()},_initPage:function(){this.refresh()},_createOutline:function(){var self=this,page=this.options[this.widgetName],root=this._getPage();return{getRoots:function(mountNodes){var nodes=new Array();nodes.push({id:"root",text:page.title||page.name||page._id,"class":"folder"});mountNodes(nodes)},getChildren:function(parentNode,mountNodes){var nodes=new Array();if(parentNode.id=="root"){root.find(".widget").each(function(){var $this=$(this),id=$this.attr("id");if($this.parent().closest(".widget").length==0){nodes.push({id:id,text:id,"class":self._isContainer($this)?"folder":"file",data:self._getWidgetObj($this)})}})}else{root.find("#"+parentNode.id).find(".widget").each(function(){var $this=$(this),id=$this.attr("id");if($this.parent().closest(".widget").attr("id")==parentNode.id){nodes.push({id:id,text:id,"class":self._isContainer($this)?"folder":"file",data:self._getWidgetObj($this)})}})}mountNodes(nodes)},hasChildren:function(node){return node["class"]=="folder"},getId:function(node){return node.id?node.id:null}}},_isContainer:function(el){return el.is("[type=tabsx], [type=box]")},_getWidgetObj:function(el){var widget=null,type=el.attr("type");if(el.is(".box")){widget=el.data(type)}else{if(el.is(".widget")){widget=el.data(type+"widget")}}return widget},option:function(key,value){var o=this.options;if(key==="actionSets"&&value===undefined){return this._createActionSets()}else{if(key==="outline"&&value===undefined){return this._createOutline()}else{if(key=="content"&&value==undefined){if(o.isDirty){this._syncPageContent()}return o[this.widgetName].content}}}var ret=$.Widget.prototype.option.apply(this,arguments);return ret===undefined?null:ret},_setOption:function(key,value){var o=this.options,oldValue=o[key];if(!equals(value,oldValue)){$.Widget.prototype._setOption.apply(this,arguments);this._handleChange(key,value,oldValue);this._trigger("optionchanged",null,{key:key,value:value,oldValue:oldValue})}return this},_handleChange:function(key,value,oldValue){var o=this.options;if(key==="mode"){if(o.isDirty){this._syncPageContent()}this.refresh()}else{if(key==="page"){var page=o[this.widgetName];this.element.children("style").text(page.stylesheet);this.$page&&!o.isDirty&&this.$page.empty().html(page.content);if(this.rte){!o.isDirty&&this.rte.rte("option","content",page.content);this.rte.rte("option","stylesheet",page.stylesheet)}this.refresh()}}},refresh:function(){var o=this.options;this["_"+o.mode]&&this["_"+o.mode]()},_browser:function(){this.rte&&this.rte.hide();if(!this.$page){this._createPage()}else{this.$page.show();this._refreshWidgets()}},_edit:function(){this.rte&&this.rte.hide();if(!this.$page){this._createPage()}else{this.$page.show();this._refreshWidgets()}},_design:function(){this.$page&&this.$page.hide();if(!this.rte){var self=this,o=this.options,page=o[this.widgetName];Model.getDb(o.dbId,function(error,db){self._createRTE(db&&db.globalCss?db.globalCss+page.stylesheet:page.stylesheet)})}else{this.rte.show();this._refreshWidgets()}},getWidget:function(id){var self=this,o=this.options,page=o[this.widgetName],widget=null;this._getPage().find("#"+id).each(function(){var $this=$(this),filter=(o.mode=="design"?".an-box:not(.raw),."+page.name:".an-page");$this.parent().closest(filter).each(function(){if($(this).is("."+page.name)||this==self.element[0]){widget=self._getWidgetObj($this);return false}});if(widget){return false}});return widget},showWidget:function(){var self=this;$.each(arguments,function(){var w=self.getWidget(this);w&&w.widget().show()})},hideWidget:function(){var self=this;$.each(arguments,function(){var w=self.getWidget(this);w&&w.widget().hide()})},_createPage:function(){var o=this.options,page=o[this.widgetName],el=this.element;$('<style type="text/css">'+(page.stylesheet||"")+"</style>").appendTo(el);this.$page=$(o.wrapper).addClass(page.name).html(page.content).appendTo(el);var data={};data[this.widgetName]=this;$.each(eval("("+(o[this.widgetName].actions||"[]")+")"),function(k,action){el.bind(action.events,data,action.handler)});if(o.mobile){this._refreshMobileToolbar()}this._refreshWidgets()},_refreshMobileToolbar:function(){try{var $page=this.element.parents(".ui-page-active"),o=$page.data("mobile-page").options,pageRole=$page.jqmData("role"),pageTheme=o.theme;$(":jqmData(role='header'), :jqmData(role='footer'), :jqmData(role='content')",$page).jqmEnhanceable().each(function(){var $this=$(this),role=$this.jqmData("role"),theme=$this.jqmData("theme"),contentTheme=theme||o.contentTheme||(pageRole==="dialog"&&pageTheme),$headeranchors,leftbtn,rightbtn,backBtn;$this.addClass("ui-"+role);if(role==="header"||role==="footer"){var thisTheme=theme||(role==="header"?o.headerTheme:o.footerTheme)||pageTheme;$this.addClass("ui-bar-"+thisTheme).attr("role",role==="header"?"banner":"contentinfo");if(role==="header"){$headeranchors=$this.children("a, button");leftbtn=$headeranchors.hasClass("ui-btn-left");rightbtn=$headeranchors.hasClass("ui-btn-right");leftbtn=leftbtn||$headeranchors.eq(0).not(".ui-btn-right").addClass("ui-btn-left").length;rightbtn=rightbtn||$headeranchors.eq(1).addClass("ui-btn-right").length}if(o.addBackBtn&&role==="header"&&$(".ui-page").length>1&&$page.jqmData("url")!==$.mobile.path.stripHash(location.hash)&&!leftbtn){backBtn=$("<a href='javascript:void(0);' class='ui-btn-left' data-"+$.mobile.ns+"rel='back' data-"+$.mobile.ns+"icon='arrow-l'>"+o.backBtnText+"</a>").attr("data-"+$.mobile.ns+"theme",o.backBtnTheme||thisTheme).prependTo($this)}$this.children("h1, h2, h3, h4, h5, h6").addClass("ui-title").attr({role:"heading","aria-level":"1"})}else{if(role==="content"){if(contentTheme){$this.addClass("ui-body-"+(contentTheme))}$this.attr("role","main")}}})}catch(e){}},_createRTE:function(stylesheet){var self=this,o=this.options,page=o[this.widgetName];this.rte=$("<div class = 'rte'/>").appendTo(this.element).rte({content:page.content,cssFiles:o.cssFiles,jsFiles:o.jsFiles,dbId:o.dbId,mobile:o.mobile,modelType:o.modelType,stylesheet:stylesheet,cssClass:page.name,restore:function(page){self._refreshWidgets(page)},clean:function(page){page.find(".widget").each(function(){var $this=$(this),wid;wid=self._getWidgetObj($this);wid&&wid.destroy()})},onload:function(){var sel=self.rte.rte("option","selection"),$doc=$(self.rte.rte("option","doc"));$doc.bind("paste.page",function(e){setTimeout(function(){self._refreshWidgets();self.rte.rte("updatePath");self._trigger("change",null,self)},20)}).bind("widgetdblclick.page widgetclick.page widgetchange.page click.page",function(e,widget){$doc.find(".widget.selected").removeClass("selected");if(e.type=="widgetclick"||e.type=="widgetdblclick"){if(widget.selectable(e.originalEvent)){var el=widget.widget();el.addClass("selected");!$.browser.chrome&&sel.select(el[0]);self._trigger("widgetselect",null,widget)}self.rte.rte("updatePath");if(e.type=="widgetdblclick"){var type=widget.option("type");if(self.rteWidgetActive(type)){self.rteWidget(type)}}}self.rte.trigger(e,widget)});self._refreshWidgets();var data={};data[self.widgetName]=self;self._trigger(self.widgetName+"create",null,data)}}).bind("change.page contentchange.page",function(e){self.option("isDirty",true);setTimeout(function(){self._trigger("change",null,self)},20)}).bind("newwidget.page",function(e,widget){e.stopImmediatePropagation();self.refresh();self.option("isDirty",true);setTimeout(function(){self._trigger("change",null,self)},20)})},_getPage:function(){return this.options.mode=="design"?$(this.rte.rte("option","doc")):this.$page},_refreshWidgets:function(page){var self=this;(page||this._getPage()).find(".widget").each(function(){self._refreshWidget($(this))});return this},_refreshWidget:function(el){var self=this,o=this.options,type=el.attr("type");if(el.is(".box")){var actions=[],id=el.attr("id");$.each(o.boxToolbarActions||[],function(){if(this.boxName==id){actions.push(this)}});if(el.is(".an-box")){el.data("box").option("mode",o.mode)}else{el.box({parent:function(){return self},mode:o.mode,dbId:o.dbId,mobile:o.mobile,toolbarActions:actions,optionchanged:function(e,data){if(data.key=="metadata"||data.key=="attributes"){self.option("isDirty",true);setTimeout(function(){self._trigger("change",null,self)},20)}}})}}else{if(el.is("[type="+type+"]")){if(el.is(".an-"+type+"widget")){el.data(type+"widget").option("mode",o.mode)}else{el[type+"widget"]({parent:function(){return self},mode:o.mode,dbId:o.dbId,mobile:o.mobile,optionchanged:function(e,data){if(data.key=="metadata"||data.key=="attributes"){self.option("isDirty",true);setTimeout(function(){self._trigger("change",null,self)},20)}}})}}}},_createActionSets:function(){if(this.options.mode=="design"){return[this._controlActionSet(),this._formatActionSet(),this._tableActionSet()]}},_controlActionSet:function(){var actions=this.rte.rte("option","actions");return this._createActionSet(["properties","cleanFormat"],actions)},_formatActionSet:function(){var actions=this.rte.rte("option","actions");return this._createActionSet(["bold","italic","underline","strikethrough","subscript","superscript","alignLeft","alignCenter","alignRight","alignFull","font","fontSize","format","leftToRight","rightToLeft","fontColor","backgroundColor","outdent","indent","orderedList","unorderedList","link","deleteLink","horizontalRule","blockQuote","blockElement","stopFloat","image"],actions)},_tableActionSet:function(){var actions=this.rte.rte("option","actions");return this._createActionSet(["table","tableProps","deleteTable","rowBefore","rowAfter","deleteRow","columnBefore","columnAfter","deleteColumn","cellProps","mergeCells","splitCells"],actions)},_createActionSet:function(actionNames,actions){var actionSet={};$.each(actionNames,function(){actionSet[this]=actions[this]});return actionSet},_syncPageContent:function(){var page=this.options[this.widgetName];page.content=this.rte.rte("option","content");this.$page&&this.$page.empty().html(page.content)},rteWidget:function(type,opts){this.rte&&this.rte.rte("rteWidget",type,this.options.formIds[type],opts);return this},rteWidgetActive:function(type){return this.rte&&this.rte.rte("rteWidgetActive",type)},labelActive:function(){return this.rte&&this.rte.rte("labelActive")},sourceCode:function(){if(this.rte){var mode=this.rte.rte("option","mode");this.rte.rte("option","mode",mode=="sourcecode"?"design":"sourcecode")}},sourceCodeActive:function(){return this.rte&&this.rte.rte("option","mode")=="sourcecode"},handler:function(){self.option("mode",o.mode=="sourcecode"?"design":"sourcecode")},checked:function(){return o.mode=="sourcecode"},highlightWidget:function(id,highlight){var w=this.getWidget(id);w&&w.highlight(highlight);return this},scrollTo:function(id,opts){var o=this.options;if(o.mode=="design"){var win=this.rte.rte("option","win");win.$("#"+id.replace(/\./g,"-")).ScrollTo(opts)}else{this.$page.find("#"+id).scrollTo(opts)}},save:function(){var self=this,o=this.options,page=o[this.widgetName];if(o.isDirty){this._syncPageContent();ModelupdateDocument(o.dbId,page._id,page,null,function(err,result){self.option("isDirty",false)})}return this},print:function(){var o=this.options,loc=window.location,url=loc.protocol+"//"+loc.host+"/pdfs?dbid="+o.dbId+"&pageid="+o[this.widgetName]._id;print(url);return this},destroy:function(){$(this.options.document).unbind(".page");this.element.unbind(".page").removeClass("an-page").children("style").remove();return $.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.form",$.an.page,{options:{document:{},printable:true,formIds:{text:["5080143085ac60df09000001","5092733215ca72150a000001"],password:["5080143085ac60df09000001","5185ac02a092006ca6000048"],checkbox:["5080143085ac60df09000001","50af2d266cec663c0a000009"],datetime:["5080143085ac60df09000001","50af2da26cec663c0a00000b"],mobiledate:["5080143085ac60df09000001","51c967a3ba4682122900004a"],textarea:["5080143085ac60df09000001","50af2ca66cec663c0a000008"],tabsx:["5080143085ac60df09000001","51306faad58d1c129f000000"],file:["5080143085ac60df09000001","50ceb75ba092004120000000"],grid:["5080143085ac60df09000001","5089e21f2b2255080a000005"],jsrender:["5080143085ac60df09000001","514d0a46caa05a669e0005c8","514d0e9dcaa05a26e30001af","514d0825caa05a669e0002ae","514d5ef3ac8f27413200014e"],radio:["5080143085ac60df09000001","50af2d626cec663c0a00000a","51850c1ca092003b12000024"],select:["5080143085ac60df09000001","51850b35a09200784a000122","508259700b27990c0a000003"],box:["5080143085ac60df09000001","50de56d0a092007b11000000","50ea38efa0920073870000ef"],rte:["5080143085ac60df09000001"]},wrapper:"<form/>"},_create:function(){$.an.page.prototype._create.apply(this,arguments)},_initPage:function(){var self=this,o=this.options,el=this.element;el.addClass("an-form");o.cssFiles=o.cssFiles||[];o.cssFiles.push("stylesheets/jquery.an.form.css");o.document=$.type(o.document)=="function"?o.document():o.document;$(o.document).bind("docchanged.form",function(e,doc,oldDoc){self.refresh();el.trigger("documentchanged",e,[doc,oldDoc])}).bind("propchanged.form",function(e,id,value,oldValue,trans){self.field(id,value)});$.an.page.prototype._initPage.apply(this,arguments)},option:function(key,value){var o=this.options;if(key==="mode"&&o.readonly){return}else{if(key==="isValid"&&value===undefined&&o.mode=="edit"){return this.validator.form()}}return $.an.page.prototype.option.apply(this,arguments)},_getWidgetObj:function(el){if(el.is(".field")){return el.data(el.attr("type")+"field")}return $.an.page.prototype._getWidgetObj.apply(this,arguments)},_handleChange:function(key,value,oldValue){var o=this.options;if(key==="document"){this.refresh()}else{if(key==="url"){this.$page.find(".field.file").filefield("option","url",o.url);this.$page.find(".field.grid").gridfield("option","url",o.url)}}return $.an.page.prototype._handleChange.apply(this,arguments)},_createPage:function(){$.an.page.prototype._createPage.apply(this,arguments);this.validator=this.$page.validate($.extend({meta:"validate",ignore:"",errorPlacement:function(error,el){error.insertAfter(el.closest("div.field"))}},eval("("+(this.options[this.widgetName].validator||"{}")+")")))},_refreshWidget:function(el){var self=this,o=this.options,type=el.attr("type");if(el.is(".field")){var id=el.attr("id");if(id){id=id.replace(/-/g,".")}var doc=o.document,value=doc&&doc.prop&&doc.prop(id),field=el.data(type+"field");if(field){field.option("mode",o.mode).option("value",value);field.refresh()}else{var opts={dbId:o.dbId,parent:function(){return self},value:value,url:o.url,mode:o.mode,mobile:o.mobile,optionchanged:function(e,data){if(data.key=="value"&&doc.prop){var id=$(e.target).attr("id");id=id&&id.replace(/-/g,".");var curValue=doc.prop(id);if(curValue!=data.value){doc.prop(id,data.value,data["transient"])}}else{if(data.key=="metadata"||data.key=="attributes"){self.option("isDirty",true);setTimeout(function(){self._trigger("change",null,self)},20)}}},resize:function(e,data){self.option("isDirty",true)}};if(type=="button"){el[type+"widget"]({parent:function(){return self},label:el.attr("label")})}else{el[type+"field"]&&el[type+"field"](opts)}}}else{$.an.page.prototype._refreshWidget.apply(this,arguments)}},field:function(id,value){var field=this._getPage().find("#"+id.replace(/\./g,"-")+".field");if(field.size()==0){return}if(value===undefined){var v=null;field.each(function(){var $this=$(this),type=$this.attr("type");v=$this[type+"field"]("option","value");if(type=="radio"&&v!=null){return false}});return v}else{field[field.attr("type")+"field"]("option","value",value)}},label:function(){this.rte&&this.rte.rte("label");return this},reset:function(){var o=this.options,staticAttr=["type","_path"],doc=o.document._doc,_this=this;this.element.find("form")[0].reset();for(var q in doc){if(q=="_id"){doc[q]=new ObjectId().toString()}else{if(q!="type"&&q!="_path"){delete doc[q]}}}var field=this._getPage().find(".field");if(field.size()==0){return}field.each(function(){if($(this).attr("type")=="select"){_this.field(this.id,$(this).find("select").val())}else{if($.isFunction($(this)[$(this).attr("type")+"field"])){_this.field(this.id,"")}}_this.getWidget(this.id)&&_this.getWidget(this.id).element.trigger("change")})},validate:function(){return this.validator?this.validator.form():true},print:function(){var o=this.options,docId=o.document.prop("_id"),loc=window.location,url=loc.protocol+"//"+loc.host+"/pdfs?dbid="+o.dbId+"&docid="+docId+"&formid="+o[this.widgetName]._id;print(url);return this},destroy:function(){this.element.removeClass("an-form");return $.an.page.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.agilegrid",{options:{selectionMode:"row",showTopHeader:true,showLeftHeader:true,isColumnResizable:false,isRowResizable:false,topHeaderHeight:28,leftHeaderWidth:50,defaultColWidth:80,defaultRowHeight:28,cellSelections:[],colSelections:{},rowSelections:{},focus:{row:0,col:0},pagerHeight:28,currentPage:0,totalPage:0,colModel:{},rowModel:{},rowOffset:0,limit:30,rowCount:0,totalRowCount:0,totalColCount:3,topHeaderRender:function(f,e){return e&&e.label?e.label:f},leftHeaderRender:function(e){return e},cellRender:function(f,e){return f+","+e}},_create:function(){this.element.addClass("an-agilegrid").empty();var e=this,f=this.options;if(f.showLeftHeader&&f.showTopHeader){this.topLeftCorner=a("<div class='top-left ui-widget-header'/>").css({left:0,top:0,width:f.leftHeaderWidth,height:f.topHeaderHeight}).appendTo(this.element)}if(f.showTopHeader){this.topHeaderTable=a("<table cellspacing='0' cellpadding='0'><thead><tr/></thead></table>");this.topHeaderArea=a("<div class='top-header ui-widget-header'/>").css({left:f.showLeftHeader?f.leftHeaderWidth+1:0,top:0,right:0,height:f.topHeaderHeight+1}).append(this.topHeaderTable).appendTo(this.element).disableSelection()}if(f.showLeftHeader){this.leftHeaderTable=a("<table cellspacing='0' cellpadding='0'><thead></thead></table>");this.leftHeaderArea=a("<div class='left-header ui-widget-header'/>").css({left:0,top:f.showTopHeader?f.topHeaderHeight+1:0,bottom:f.showPager?f.pagerHeight:0,width:f.leftHeaderWidth+1}).append(this.leftHeaderTable).appendTo(this.element).disableSelection()}this.contentArea=a("<div class='content-area'/>").css({left:f.showLeftHeader?f.leftHeaderWidth+1:0,top:f.showTopHeader?f.topHeaderHeight+1:0,bottom:f.showPager?f.pagerHeight:0,right:0}).appendTo(this.element).disableSelection();this.contentTable=a("<table class='content' cellspacing='0' cellpadding='0'><tbody/></table>").appendTo(this.contentArea);if(f.showPager){this.pager=a("<div class='pager ui-widget-header'/>").css({left:0,right:0,bottom:0,height:f.pagerHeight}).appendTo(this.element);a.each(["first","prev","goto","next","last"],function(h,g){if(g=="goto"){e.pager.append("<div class='goto-page'>Page<input class='current-page' type='text' value='"+f.currentPage+"'>of<div class='total-page'>"+f.totalPage+"</div></div>");e.pager.delegate("input","change.agilegrid",function(){var j=a(this),i=a(this).val();if(i<=0){i=1;j.val(i)}else{if(i>f.totalPage){i=f.totalPage;j.val(i)}}e._trigger("gotopage",null,{page:i})})}else{a("<button class='pager-button'/>").attr("id",g).appendTo(e.pager).button({label:g,icons:{primary:"ui-icon-"+g+"-page"},text:false,disabled:true}).click(function(i){i.preventDefault();i.stopImmediatePropagation();e._trigger(g+"page",null,{currentPage:f.currentPage})})}});this.pager.append("<div class='info'>")}this.contentArea.scroll(function(){var g=e.contentTable.position();if(f.showTopHeader){e.topHeaderTable.css("left",g.left)}if(f.showLeftHeader){e.leftHeaderTable.css("top",g.top)}});this.element.delegate(".top-header th>div","hover.agilegrid",function(g){if(f.isColumnResizable){a(this).resizable({handles:"e",resize:function(h,i){e._columnWidth(parseInt(i.element.parent().attr("index")),i.size.width)}})}}).delegate(".left-header th>div","hover.agilegrid",function(g){if(f.isRowResizable){a(this).resizable({handles:"s",resize:function(h,i){e._rowHeight(f.rowOffset,parseInt(i.element.parent().attr("index")),i.size.height)}})}}).delegate(".top-header th","mousedown.agilegrid",function(k){if(f.selectionMode=="row"){return}var h=parseInt(a(this).attr("index"));if(k.ctrlKey){if(f.colSelections[h]){delete f.colSelections[h]}else{f.colSelections[h]=true}e.contentTable.find("td[colindex="+h+"]").toggleClass("selected",f.colSelections[h]==true?true:false);f.focus=a.extend(f.focus,{col:h})}else{if(k.shiftKey){var p=Math.min(f.focus.col,h),g=Math.max(f.focus.col,h);e.clearSelection();for(var j=p;j<=g;j++){f.colSelections[j]=true;e.contentTable.find("td[colindex="+j+"]").addClass("selected")}}else{e.clearSelection();f.focus=a.extend(f.focus,{col:h});f.colSelections[h]=true;e.contentTable.find("td[colindex="+h+"]").addClass("selected");f.focus=a.extend(f.focus,{col:h})}}e.mouseDownTopHeader=true}).delegate(".top-header th","mousemove.agilegrid",function(k){if(e.mouseDownTopHeader){var h=parseInt(a(this).attr("index")),p=Math.min(f.focus.col,h),g=Math.max(f.focus.col,h);if(!k.ctrlKey){e.clearSelection()}for(var j=p;j<=g;j++){f.colSelections[j]=true;e.contentTable.find("td[colindex="+h+"]").addClass("selected")}}}).delegate(".left-header th","mousedown.agilegrid",function(k){if(f.selectionMode=="column"){return}var q=parseInt(a(this).attr("index")),p=f.rowOffset+q;if(k.ctrlKey){if(f.rowSelections[p]){delete f.rowSelections[p]}else{f.rowSelections[p]=true}e.contentTable.find("tr[rowindex="+q+"]").toggleClass("selected",f.rowSelections[p]==true?true:false);f.focus=a.extend(f.focus,{row:p})}else{if(k.shiftKey){var h=Math.min(f.focus.row,p),j=Math.max(f.focus.row,p);e.clearSelection();for(var g=h;g<=j;g++){f.rowSelections[g]=true;e.contentTable.find("tr[rowindex="+(g-f.rowOffset)+"]").addClass("selected")}}else{e.clearSelection();f.focus=a.extend(f.focus,{row:p});f.rowSelections[p]=true;e.contentTable.find("tr[rowindex="+q+"]").addClass("selected");f.focus=a.extend(f.focus,{row:p})}}e.mouseDownLeftHeader=true}).delegate(".left-header th","mousemove.agilegrid",function(k){if(e.mouseDownLeftHeader){var q=parseInt(a(this).attr("index")),p=f.rowOffset+q,h=Math.min(f.focus.row,p),j=Math.max(f.focus.row,p);if(!k.ctrlKey){e.clearSelection()}for(var g=h;g<=j;g++){f.rowSelections[g]=true;e.contentTable.find("tr[rowindex="+(g-f.rowOffset)+"]").addClass("selected")}}}).delegate(".content td","mousedown.agilegrid",function(j){var i=a(this),p=parseInt(i.attr("rowindex")),h=parseInt(i.attr("colindex")),k=f.rowOffset+p,g=h;e.select(k,g,j.ctrlKey?"ctrl":(j.shiftKey?"shift":null));e.mouseDownContent=true}).delegate(".content td","mousemove.agilegrid",function(p){if(e.mouseDownContent){var r=a(this),s=parseInt(r.attr("rowindex")),t=parseInt(r.attr("colindex")),v=f.rowOffset+s,g=t;if(!p.ctrlKey){e.clearSelection()}if(f.selectionMode=="row"){var h=Math.min(f.focus.row,v),q=Math.max(f.focus.row,v);for(var k=h;k<=q;k++){f.rowSelections[k]=true;e.contentTable.find("tr[rowindex="+(k-f.rowOffset)+"]").addClass("selected")}}else{if(f.selectionMode=="column"){var j=Math.min(f.focus.col,g),u=Math.max(f.focus.col,g);for(var k=j;k<=u;k++){f.colSelections[k]=true;e.contentTable.find("td[colindex="+k+"]").addClass("selected")}}else{var h=Math.min(f.focus.row,v),q=Math.max(f.focus.row,v),j=Math.min(f.focus.col,g),u=Math.max(f.focus.col,g);for(var v=h;v<=q;v++){if(!f.cellSelections[v]){f.cellSelections[v]=[]}for(var g=j;g<=u;g++){f.cellSelections[v][g]=true;e.contentTable.find("td[rowindex="+(v-f.rowOffset)+"][colindex="+g+"]").addClass("selected")}}}}}}).delegate(".content td","dblclick.agilegrid click.agilegrid",function(i){var h=a(this),j=parseInt(h.attr("rowindex")),g=parseInt(h.attr("colindex"));e._trigger(i.type=="dblclick"?"celldblclick":"cellclick",i,{row:f.rowOffset+j,column:g})});f.topHeaderActions=f.topHeaderActions||function(h,g){var j={};j.hide={type:"menuItem",text:"Hide",handler:function(){e.hideColumn(g)}};if(f.columnEditable){j.add={type:"menuItem",text:"Add",handler:function(){e.editColumn(g,"add")}};j.edit={type:"menuItem",text:"Edit",handler:function(){e.editColumn(g)}};j.del={type:"menuItem",text:"Delete",handler:function(){e.removeColumn(g)}}}if(!a.isEmptyObject(h)){var i={};a.each(h,function(q,p){i[p.name]={name:p.name,type:"checkbox",text:p.label,checked:!p.hide,handler:function(s,r){var k=e.option("visibleColCount");if(k<=1&&!r){a(s.target).prop("checked",true)}else{e[r?"showColumn":"hideColumn"](q)}}}});j.show={type:"submenu",text:"Show",children:i}}return j};f.leftHeaderActions=f.leftHeaderActions||function(h){var g={};return g};f.contentActions=f.contentActions||function(i,g){var h={};return h};this.element.bind("mouseup.agilegrid",function(){delete e.mouseDownContent;delete e.mouseDownLeftHeader;delete e.mouseDownTopHeader}).bind("contextmenu2.agilegrid contextmenu.agilegrid",function(p){if((f.contextmenu2&&p.type=="contextmenu2")||(!f.contextmenu2&&p.type=="contextmenu")){var s=a(p.target),k=s.closest(".top-header table"),g=s.parent("th"),j={},r=f.colModel;if(k.length>0&&g.length>0){a.extend(j,f.topHeaderActions(r,parseInt(s.closest("th").attr("index"))))}var q=s.closest(".content"),i=s.closest("td");if(q.length>0&&i.length>0){var u=f.rowOffset+parseInt(i.attr("rowindex")),h=parseInt(i.attr("rowindex"));a.extend(j,f.contentActions(u,h))}if(!a.isEmptyObject(j)){s.menu({autoShow:true,menuPosition:{of:p,my:"left top",at:"left bottom"},actions:j,select:function(v,t){a(this).menu("destroy")},collapseAll:function(t){a(this).menu("destroy")}})}p.preventDefault()}}).attr("tabIndex",-1).css("outline",0).bind("keydown.agilegrid",function(g){e._keydown(g)})},_init:function(){this.refresh()},_refreshLeftHeader:function(){var k=this.options,j=k.rowModel,f=k.rowOffset,h=this.leftHeaderTable.find("thead");h.empty();for(var e=0;e<k.rowCount;e++){var g=a("<tr/>");a("<th/>").attr("index",f+e).css("display",j[f+e]&&j[f+e].hide?"none":"block").append(a("<div/>").css({width:k.leftHeaderWidth,height:(j[f+e]&&j[f+e].height)||k.defaultRowHeight,"line-height":(j[f+e]&&j[f+e].height)||k.defaultRowHeight+"px"}).html((j[f+e]&&j[f+e].render)||k.leftHeaderRender(f+e,j[f+e]))).appendTo(g);g.appendTo(h)}},_refreshTopHeader:function(){var h=this.options,e=h.colModel,g=this.topHeaderTable.find("tr");g.empty();for(var f=0;f<h.totalColCount;f++){a("<th/>").attr("index",f).css("display",e[f]&&e[f].hide?"none":"table-cell").append(a("<div/>").css({width:(e[f]&&e[f].width)||h.defaultColWidth,height:h.topHeaderHeight,"line-height":h.topHeaderHeight+"px"}).html((e[f]&&e[f].render)||h.topHeaderRender(f,e[f]))).appendTo(g)}},_refreshContent:function(){var e=this.options,r=e.colModel,j=e.rowModel,h=e.rowOffset,g=this.contentTable.children("tbody"),q=a("<tr/>");g.detach().empty();for(var p=0;p<e.totalColCount;p++){td=a("<td/>").attr("colindex",p).css("display",r[p]&&r[p].hide?"none":"table-cell").append(a("<div/>").css("width",r[p]&&r[p].width?r[p].width:e.defaultColWidth)).appendTo(q)}for(var f=0;f<e.rowCount;f++){var s=j[h+f]&&j[h+f].height?j[h+f].height:e.defaultRowHeight,k=q.clone();k.css("display",j[h+f]&&j[h+f].hide?"none":"table-row").attr("rowindex",f).toggleClass("selected",e.rowSelections[h+f]||(e.selectionMode=="row"&&e.focus.row==h+f)).children("td").attr("rowindex",f).each(function(){var i=a(this),t=parseInt(i.attr("colindex"));i.toggleClass("selected",(e.cellSelections[h+f]&&e.cellSelections[h+f][t])||e.colSelections[t]||(e.focus.row==h+f&&e.focus.col==t)||(e.focus.col==t&&e.selectionMode=="column"));i.children("div").css({height:s,"line-height":s+"px"}).html(e.cellRender(h+f,t))});k.appendTo(g)}this.contentTable.append(g)},option:function(e,f){if(e==="visibleColCount"&&f===b){return this.topHeaderTable.find("th:visible").length}return a.Widget.prototype.option.apply(this,arguments)},_setOption:function(f,g){var h=this.options,e=h[f];if(!equals(g,e)){a.Widget.prototype._setOption.apply(this,arguments);if(h.showPager&&(f=="currentPage"||f=="totalPage")){this._refreshPager()}this._trigger("optionchanged",null,{key:f,value:g,oldValue:e})}return this},_refreshPager:function(){var e=this.options;if(e.totalPage<=1){this.pager.find(".pager-button").button("disable")}else{this.pager.find(".pager-button").button("enable");if(e.currentPage<=1){this.pager.find("#first").button("disable");this.pager.find("#prev").button("disable")}else{if(e.currentPage>=e.totalPage){this.pager.find("#last").button("disable");this.pager.find("#next").button("disable")}}}this.pager.find("input.current-page").val(e.currentPage);this.pager.find(".total-page").html(e.totalPage);this.pager.find(".info").html("Displaying "+(e.rowOffset+1)+" to "+(e.rowOffset+e.rowCount)+" of "+e.totalRowCount+" items.")},select:function(u,g,s){var f=this.options;if(s=="ctrl"){if(f.selectionMode=="row"){if(f.rowSelections[u]){delete f.rowSelections[u]}else{f.rowSelections[u]=true}this.contentTable.find("tr[rowindex="+(u-f.rowOffset)+"]").toggleClass("selected",f.rowSelections[u]==true?true:false)}else{if(f.selectionMode=="column"){if(f.colSelections[g]){delete f.colSelections[g]}else{f.colSelections[g]=true}this.contentTable.find("td[colindex="+g+"]").toggleClass("selected",f.colSelections[g]==true?true:false)}else{if(!f.cellSelections[u]){f.cellSelections[u]=[];f.cellSelections[u][g]=true}else{if(f.cellSelections[u][g]){delete f.cellSelections[u][g]}else{f.cellSelections[u][g]=true}}this.contentTable.find("td[rowindex="+(u-f.rowOffset)+"][colindex="+g+"]").toggleClass("selected",f.cellSelections[u][g]=true?true:false)}}f.focus=a.extend(f.focus,{row:u,col:g})}else{if(s=="shift"){if(f.selectionMode=="row"){var h=Math.min(f.focus.row,u),p=Math.max(f.focus.row,u);this.clearSelection();for(var k=h;k<=p;k++){f.rowSelections[k]=true;this.contentTable.find("tr[rowindex="+(k-f.rowOffset)+"]").addClass("selected")}}else{if(f.selectionMode=="column"){var j=Math.min(f.focus.col,g),t=Math.max(f.focus.col,g);this.clearSelection();for(var k=j;k<=t;k++){f.colSelections[k]=true;this.contentTable.find("td[colindex="+k+"]").addClass("selected")}}else{var h=Math.min(f.focus.row,u),p=Math.max(f.focus.row,u),j=Math.min(f.focus.col,g),t=Math.max(f.focus.col,g);this.clearSelection();for(var e=h;e<=p;e++){f.cellSelections[e]=f.cellSelections[e]||[];for(var q=j;q<=t;q++){f.cellSelections[e][q]=true;this.contentTable.find("td[rowindex="+(e-f.rowOffset)+"][colindex="+q+"]").addClass("selected")}}}}}else{this.clearSelection();if(f.selectionMode=="row"){f.rowSelections[u]=true;this.contentTable.find("tr[rowindex="+(u-f.rowOffset)+"]").addClass("selected")}else{if(f.selectionMode=="column"){f.colSelections[g]=true;this.contentTable.find("td[colindex="+g+"]").addClass("selected")}else{f.cellSelections[u]=[];f.cellSelections[u][g]=true;this.contentTable.find("td[rowindex="+(u-f.rowOffset)+"][colindex="+g+"]").addClass("selected")}}f.focus=a.extend(f.focus,{row:u,col:g})}}},clearSelection:function(){var e=this.options;e.cellSelections=[];e.rowSelections={};e.colSelections={};if(e.showTopHeader){this.topHeaderTable.find(".selected").removeClass("selected")}if(e.showLeftHeader){this.leftHeaderTable.find(".selected").removeClass("selected")}this.contentTable.find(".selected").removeClass("selected")},_keydown:function(e){var f=a.ui.keyCode,g=this.options;if(e.shiftKey&&!this.shiftKeyDown){this.shiftKeyDown={row:g.focus.row,col:g.focus.col}}else{if(!e.shiftKey){delete this.shiftKeyDown}}switch(e.keyCode){case f.LEFT:if(g.focus.col>0){this.select(g.focus.row,e.shiftKey?--this.shiftKeyDown.col:g.focus.col-1,e.shiftKey?"shift":null)}break;case f.RIGHT:if(g.focus.col<g.totalColCount-1){this.select(g.focus.row,e.shiftKey?++this.shiftKeyDown.col:g.focus.col+1,e.shiftKey?"shift":null)}break;case f.UP:if(g.focus.row>0){this.select(e.shiftKey?--this.shiftKeyDown.row:g.focus.row-1,g.focus.col,e.shiftKey?"shift":null)}break;case f.DOWN:if(g.focus.row<g.rowCount-1){this.select(e.shiftKey?++this.shiftKeyDown.row:g.focus.row+1,g.focus.col,e.shiftKey?"shift":null)}break;case f.SPACE:case f.ENTER:break}return true},_columnWidth:function(f,g){var i=this.options,e=i.colModel,h=a.extend({},e);e[f]=e[f]||{name:f,label:f};oldWidth=e[f].width||i.defaultColWidth;e[f].width=g;if(i.showTopHeader){this.topHeaderTable.find("th[index="+f+"]>div").css("width",g)}this.contentTable.find("td[colindex="+f+"]>div").css("width",g);this._trigger("optionchanged",null,{key:"colModel",value:e,oldValue:h})},_rowHeight:function(g,f,e){var k=this.options,i=k.rowModel,j=g+f,h=a.extend({},i);i[j]=i[j]||{};oldHeight=i[j].height||k.defaultRowHeight;i[j].height=e;if(k.showLeftHeader){this.leftHeaderTable.find("th[index="+f+"]>div").css({height:e,"line-height":e+"px"})}this.contentTable.find("td[rowindex="+f+"]>div").css("height",e);this._trigger("optionchanged",null,{key:"rowModel",value:i,oldValue:h})},insertColumn:function(g,e){var i=this.options,h=a.extend(true,{},i.colModel),f={};a.each(h,function(p,j){if(p<g){f[p]=j}else{f[parseInt(p)+1]=j}});f[g]=e;i.colModel=f;i.totalColCount=i.totalColCount+1;this._adjustWidth();this._trigger("optionchanged",null,{key:"colModel",value:f,oldValue:h})},removeColumn:function(f){var h=this.options,e=h.colModel,g=a.extend(true,{},e);a.each(e,function(j,i){if(j>=f&&j<h.totalColCount-1){e[j]=g[parseInt(j)+1]}else{if(j==h.totalColCount-1){delete e[j]}}});h.totalColCount=h.totalColCount-1;this._adjustWidth();this._trigger("optionchanged",null,{key:"colModel",value:e,oldValue:g})},showColumn:function(f){var h=this.options,e=h.colModel,g=a.extend(true,{},e);if(e[f]&&e[f].hide){e[f].hide=false}else{return}this.topHeaderTable.find("th[index="+f+"]").show();this.contentTable.find("td[colindex="+f+"]").show();this._trigger("optionchanged",null,{key:"colModel",value:e,oldValue:g})},editColumn:function(h,k){var g=this,j=this.options,e=j.colModel,i=a.extend(true,{},e),f=(k=="add"?{name:"",label:""}:e[h]);a("<div/>").dialog({title:k=="add"?"Add Column":"Edit Column",height:260,width:380,modal:true,create:function(p,q){var r=a(this);a.ans.getDoc(j.dbId,"50acda5e9555dbe125000004",null,function(t,s){r.editor({document:f,forms:[s],dbId:j.dbId,mode:"edit",ignoreEscape:true})})},buttons:{OK:function(){var q=a(this),p=q.editor("option","document");if(k=="add"){g.insertColumn(h,p)}else{e[h]=e[h]||{};a.extend(e[h],p);g._refreshTopHeader();g._trigger("optionchanged",null,{key:"colModel",value:e,oldValue:i})}g.option("isDirty",true);q.dialog("close")},Cancel:function(){a(this).dialog("close")}},close:function(q,p){a(this).remove()}})},hideColumn:function(f){var h=this.options,e=h.colModel,g=a.extend(true,{},e);e[f]=e[f]||{name:f,label:f};e[f].hide=true;this.topHeaderTable.find("th[index="+f+"]").hide();this.contentTable.find("td[colindex="+f+"]").hide();this._trigger("optionchanged",null,{key:"colModel",value:e,oldValue:g})},showRow:function(h){var g=this.options,f=g.rowModel,e=a.extend(true,{},f);if(f[h]&&f[h].hide){delete f[h].hide}else{return}this.leftHeaderTable.find("th[index="+h+"]").hide();this.contentTable.find("td[rowindex="+h+"]").hide();this._trigger("optionchanged",null,{key:"rowModel",value:f,oldValue:e})},hideRow:function(h){var g=this.options,f=g.rowModel,e=a.extend(true,{},f);f[h]=f[h]?f[h]:{};f[h].hide=true;this._adjustHeight();this._trigger("optionchanged",null,{key:"rowModel",value:f,oldValue:e})},_adjustWidth:function(){this._refreshTopHeader();this._refreshContent();return this},_adjustHeight:function(){this._refreshLeftHeader();this._refreshContent();return this},refresh:function(){var e=this.options;if(e.showTopHeader){this._refreshTopHeader()}if(e.showLeftHeader){this._refreshLeftHeader()}this._refreshContent();if(e.showPager){this._refreshPager()}return this},destroy:function(){this.element.removeClass("an-agilegrid").unbind(".agilegrid").undelegate(".top-header th>div",".agilegrid").undelegate(".left-header th>div",".agilegri").undelegate(".content td>div",".agilegrid");a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.toolbar",{options:{},_create:function(){this.element.addClass("an-toolbar");var e=this.options;if(e.startAction||e.globalActionSet||e.actionSets){this.element.empty();this._createActionSets();this.refresh()}},_createActionSets:function(){var f=this,g=this.options,e=[];if(g.startAction){e.push(g.startAction)}if(g.globalActionSet){e.push(g.globalActionSet)}e=e.concat(g.actionSets||[]);this.actionSets=e;a.each(e,function(k,h){a.each(h,function(q,p){var s=null;switch(p.type){case"button":if(q=="startAction"){p.element=a("<button class='action start-menu'/>").button({label:p.label,icons:{primary:"ui-icon-home",secondary:"ui-icon-triangle-1-s"}}).prependTo(f.element);p.element.menu({triggerEvent:"click",menuPosition:{of:p.element,my:"left top",at:"left bottom"},actions:p.actions,select:function(){a(this).menu("collapseAll")}})}else{p.element=a("<button class='action'/>").button({label:p.label,text:p.text,icons:p.icons}).appendTo(f.element).click(function(t){if(p.handler){p.handler(t)}t.preventDefault();t.stopImmediatePropagation()})}break;case"checkbox":var j=a("<input class='action' type='checkbox' id = '"+new ObjectId().toString()+"'/>").appendTo(f.element);a("<label for='"+j.attr("id")+"' class='action'></label>").insertAfter(j);p.element=j.button({label:p.label,text:p.text,icons:p.icons}).click(function(t){if(p.handler){p.handler(t)}t.preventDefault();t.stopImmediatePropagation()});break;case"radio":var j=a("<input class='action' type='radio' name = '"+p.name+"' id = '"+new ObjectId().toString()+"'/>").appendTo(f.element);a("<label for='"+j.attr("id")+"' class='action'></label>").insertAfter(j);p.element=j.button({label:p.label,text:p.text,icons:p.icons}).click(function(t){if(p.handler){p.handler(t)}t.preventDefault();t.stopImmediatePropagation()});break;case"select":s=a("<acronym class='action'/>").attr("title",p.label).elSelect({labelTpl:p.labelTpl,tpl:p.tpl,select:p.select,src:p.src}).appendTo(f.element);s.data("select",s);p.element=s;break;case"colorPicker":s=a("<button class='action'/>").button({label:p.label,text:p.text,icons:p.icons}).appendTo(f.element).ColorPicker({color:p.color,handler:p.handler});s.data("select",s);p.element=s;break;default:break}if(p.iconFile){var r;if(p.type=="checkbox"){var i=p.element.attr("id");r=p.element.siblings("label[for="+i+"]").find("."+p.icons.primary)}else{r=p.element.find("."+p.icons.primary)}r.css("background-image","url("+p.iconFile+")")}})})},refresh:function(){a.each(this.actionSets,function(f,e){a.each(e,function(h,g){switch(g.type){case"button":case"checkbox":case"radio":if(g.enabled()){g.element.button("enable");if(g.type=="checkbox"||g.type=="radio"){g.element.prop("checked",g.checked());g.element.button("refresh")}}else{g.element.button("disable")}break;case"colorPicker":case"select":g.element.toggleClass("disabled",!g.enabled());break}})})},value:function(e,f){this.element.find("#"+e).data("select").val(f);return this},option:function(e,f){if(e=="isEmpty"&&f===b){return this.element.children().length==0}return a.Widget.prototype.option.apply(this,arguments)},_setOption:function(f,g){var h=this.options,e=h[f];if(!equals(g,e)){a.Widget.prototype._setOption.apply(this,arguments);if(f=="actionSets"){this.element.empty();this._createActionSets();this.refresh()}this._trigger("optionchanged",null,{key:f,value:g,oldValue:e,"transient":h["transient"]})}return this},destroy:function(){this.element.removeClass("an-toolbar");a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.view",{options:{mode:"browser",actionSets:[]},_create:function(){var o=this.options,el=this.element;el.addClass("an-view").addClass(o.view.name).empty();$('<style type="text/css">'+(o.view.stylesheet||"")+"</style>").appendTo(el);o.limit=o.limit||parseInt(o.view.limit)||10;o.skip=o.skip||parseInt(o.view.skip)||0;o.total=o.total||parseInt(o.view.total)||0;o.filter=o.filter||o.view.filter;o.showPager=o.showPager||o.view.showPager;try{$.extend(this,eval("("+(o.view.methods||"{}")+")"))}catch(e){console.log(e)}var data={};data[this.widgetName]=this;$.each(eval("("+(o.view.actions||"[]")+")"),function(k,action){el.bind(action.events,data,action.handler)});o.showPager&&this._createPager();this.docs=[];this._loadDocs()},option:function(key,value){var ret=$.Widget.prototype.option.apply(this,arguments);return ret===undefined?null:ret},_setOption:function(key,value){var oldValue=this.options[key];if(!equals(value,oldValue)){$.Widget.prototype._setOption.apply(this,arguments);this._handleChange&&this._handleChange(key,value,oldValue);this._trigger("optionchanged",null,{key:key,value:value,oldValue:oldValue})}return this},_handleChange:function(key,value,oldValue){if(key==="mode"||key==="view"){this.refresh()}},_createPager:function(){var o=this.options,self=this;this.pager=$("<div style='display:none;' class='pager'/>").css({left:0,right:0,bottom:0,height:o.pagerHeight}).appendTo(this.element);this.pager.addClass(o.className);$.each(["first","prev","goto","next","last"],function(k,v){if(v=="goto"){self.pager.append("<div class='goto-page'>Page<input class='current-page' type='text' value='"+o.currentPage+"'>of<div class='total-page'>"+o.totalPage+"</div></div>");self.pager.delegate("input","change.pager",function(){var $this=$(this),p=$(this).val();if(p<=0){p=1;$this.val(p)}else{if(p>o.totalPage){p=o.totalPage;$this.val(p)}}self.gotopage(p)})}else{$("<button class='pager-button'/>").attr("id",v).appendTo(self.pager).button({label:$.i18n.pager?$.i18n.pager[v]:v,icons:{primary:"ui-icon-"+v+"-page"},text:false,disabled:true}).click(function(e){e.preventDefault();e.stopImmediatePropagation();self[v+"page"]()})}});this.pager.append("<div class='info'>")},firstpage:function(e,data){this.options.skip=0;this._loadDocs()},prevpage:function(){var o=this.options;o.skip=o.skip-o.limit;this._loadDocs()},gotopage:function(page){var o=this.options;o.skip=(page-1)*o.limit;this._loadDocs()},nextpage:function(){var o=this.options;o.skip=o.skip+o.limit;this._loadDocs()},lastpage:function(){var o=this.options;o.skip=Math.floor(o.total/o.limit)*o.limit;this._loadDocs()},refresh:function(){var o=this.options;this["_"+o.mode]&&this["_"+o.mode]();this._refreshPager()},_refreshPager:function(){var o=this.options;if(this.pager){if(o.totalPage<=1){this.pager.hide();return this}this.pager.show();this.pager.find(".pager-button").button("enable");if(o.currentPage<=1){this.pager.find("#first").button("disable");this.pager.find("#prev").button("disable")}else{if(o.currentPage>=o.totalPage){this.pager.find("#last").button("disable");this.pager.find("#next").button("disable")}}this.pager.find("input.current-page").val(o.currentPage);this.pager.find(".total-page").html(o.totalPage);var currentNums=o.currentPage==o.totalPage?(o.limit*(o.currentPage-1)+o.total%o.limit):o.limit*o.currentPage,info="";if($.i18n.pager){info=$.i18n.pager.display.replace(/{total}/,o.total).replace(/{currentPagerFirst}/,(o.limit*(o.currentPage-1)+1)).replace(/{currentPagerLast}/,currentNums)}else{info="Displaying "+(o.limit*(o.currentPage-1)+1)+" to "+currentNums+" of "+o.total+" items."}this.pager.find(".info").html(info)}},reload:function(){this._loadDocs()},_loadDocs:function(){var self=this,o=this.options,sel=o.view.selector,filter=o.filter,opts={skip:o.skip,limit:o.limit},selectorStr,taskUrl=o.view.taskUrl;if($.type(o.view.sort)=="string"){opts.sort=eval("("+o.view.sort+")")}if($.type(taskUrl)=="string"&&taskUrl.replace(/(^\s*)|(\s*$)/g,"")!=""){var param={};param.taskFilter=typeof filter=="string"?eval("("+filter+")"):filter;param.skip=o.skip;param.limit=o.limit;param.sort=opts.sort||o.view.sort;param.options={exec:true,redirect:true};$.ans.getDoc(o.dbId,taskUrl,param,function(err,data){self.docs=data.docs;try{self._docsLoaded&&self._docsLoaded()}catch(e){}self._trigger("documentloaded",null,data)});return}if($.type(sel)=="string"&&sel.replace(/\s/g,"")){sel=eval("("+sel+")");if($.type(filter)=="string"){selectorStr=filter.replace(/\s/g,"")?{selector:sel,filter:eval("("+filter+")"),options:opts}:{selector:sel,options:opts}}else{selectorStr=filter?{selector:sel,filter:filter,options:opts}:{selector:sel,options:opts}}$.ans.getDoc(o.dbId,null,selectorStr,function(err,data){self.docs=data.docs;o.total=data.total;if(self.pager){o.currentPage=Math.floor(o.skip/o.limit+1);o.totalPage=Math.ceil(o.total/o.limit)}try{self._docsLoaded&&self._docsLoaded()}catch(e){}self._trigger("documentloaded",null,data)})}},_getRow:function(row){return this.docs[row-this.options.skip]},_delRow:function(row){var self=this,o=this.options;Model.deleteDocument(o.dbId,this.docs[row-o.skip]._id,null,function(err,result){self._loadDocs()})},save:function(){var self=this,o=this.options,view=o.view;Model.updateDocument(o.dbId,view._id,view,null,function(err,result){self.option("isDirty",false)})},destroy:function(){this.element.children("style").remove();this.element.unbind(".view").empty();$.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.gridview",$.an.view,{options:{printable:false},_create:function(){$.an.view.prototype._create.apply(this,arguments);this.element.addClass("an-gridview");var self=this,o=this.options;if(o.view.cellRender){o.cellRender=eval("("+o.view.cellRender+")")}this.element.agilegrid($.extend({rowOffset:o.skip,showPager:o.showPager,dbId:o.dbId,leftHeaderRender:function(row){return row+1},cellRender:function(row,col){var value="",r=self._getRow(row),cm=this.colModel,c=cm[col];if(o.cellRender){value=o.cellRender(row,col,doc,cm)}else{if(r&&c){value=eval("try{r['"+c.name+"']}catch(e){}")}}return value?value+"":""},firstpage:function(e,data){o.skip=0;self._loadDocs()},prevpage:function(e,data){o.skip=o.skip-o.limit;self._loadDocs()},gotopage:function(e,data){o.skip=(data.page-1)*o.limit;self._loadDocs()},nextpage:function(e,data){o.skip=o.skip+o.limit;self._loadDocs()},lastpage:function(e,data){o.skip=Math.floor(o.total/o.limit)*o.limit;self._loadDocs()},celldblclick:function(e,data){self._trigger("docdblclick",e,self.docs[data.row-o.skip])},cellclick:function(e,data){self._trigger("docclick",e,self.docs[data.row-o.skip])},contentActions:function(row,col){return o.contentActions(self.docs[row-o.skip])},optionchanged:function(e,data){if(data.key=="colModel"&&o.mode=="design"){self.option("isDirty",true)}}},o.view.options));this.refresh()},_docsLoaded:function(){var o=this.options,rc=this.docs.length;this.element.agilegrid({currentPage:Math.floor(o.skip/o.limit+1),totalPage:Math.ceil(o.total/o.limit),rowOffset:o.skip,rowCount:rc,totalRowCount:o.total})},_design:function(){this.element.agilegrid({columnEditable:true,isColumnResizable:true,isRowResizable:true})},_browser:function(){this.element.agilegrid($.extend({columnEditable:false,isColumnResizable:false,isRowResizable:false},this.options.view.options))},_createPager:function(){},save:function(){$.extend(this.options.view.options,this._viewOptions());return $.an.view.prototype.save.apply(this,arguments)},option:function(key,value){if(key==="viewOptions"&&value===undefined){return this._viewOptions()}return $.an.view.prototype.option.apply(this,arguments)},_viewOptions:function(){var self=this,value={};$.each(["showTopHeader","showLeftHeader","isColumnResizable","isRowResizable","topHeaderHeight","leftHeaderWidth","defaultColWidth","defaultRowHeight","colModel","rowModel","totalColCount"],function(k,v){value[v]=self.element.agilegrid("option",v)});return value},print:function(){var o=this.options,loc=window.location,url=loc.protocol+"//"+loc.host+"/pdfs?dbid="+o.dbId+"&viewid="+o.view._id;print(url)},destroy:function(){this.element.agilegrid("destroy").unbind(".gridview").removeClass("an-gridview");$.an.view.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.formview",a.an.view,{options:{printable:false,pagerPosition:"bottom",itemWidth:320,itemHeight:280},_create:function(){a.an.view.prototype._create.apply(this,arguments);var f=this.options,e=this.element;f.showPager=f.view.showPager;f.itemWidth=f.view.itemWidth;f.itemHeight=f.view.itemHeight;e.addClass("an-formview");this.documents=a("<div class='content'/>").prependTo(e)},_showDocuments:function(){var e=this,g=this.options;this.documents.empty();var f=document.createDocumentFragment();a.each(this.docs,function(i,j){var h=a("<div class='grid-item'/>").css({width:g.itemWidth,height:g.itemHeight});f.appendChild(h[0]);h.editor({dbId:g.dbId,document:j,forms:[g.form],readOnly:true})});e.documents[0].appendChild(f)},_docsLoaded:function(e){if(a.isArray(e)){this.docs=e}this.refresh()},_design:function(){this._showDocuments()},_browser:function(){this._showDocuments()},save:function(){var e=this,f={};a.extend(this.options.view.options,f);return a.an.view.prototype.save.apply(this,arguments)},print:function(){var g=this.options,f=window.location,e=f.protocol+"//"+f.host+"/pdfs?dbid="+g.dbId+"&viewid="+g.view._id;print(e)},destroy:function(){this.element.unbind(".formview").removeClass("an-formview show-pager");a.an.view.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.customview",$.an.view,{options:{printable:false,pagerPosition:"bottom"},_create:function(){$.an.view.prototype._create.apply(this,arguments);var o=this.options,el=this.element;el.addClass("an-customview");o.templateTemp=o.view.templateTemp;o.templateSelector=o.view.templateSelector;o.templateConverts=o.view.templateConverts;o.templateContent=o.view.templateContent;this.documents=$(o.templateContent).prependTo(el);if(o.templateTemp){o.templateTemp=$.templates(o.templateTemp)}if(o.templateConverts&&typeof o.templateConverts=="string"){o.templateConverts=eval("("+o.templateConverts+")");$.views.converters(o.templateConverts)}},_showDocuments:function(){var self=this,o=this.options;if(o.templateTemp){var html=o.templateTemp.render(self.docs);$(o.templateSelector,this.documents).html(html)}if(o.templateConverts&&typeof o.templateConverts=="string"){o.templateConverts=eval("("+o.templateConverts+")");$.views.converters(o.templateConverts)}},_docsLoaded:function(){this.refresh()},_design:function(){this._showDocuments()},_browser:function(){this._showDocuments()},save:function(){var value={};$.extend(this.options.view.options,value);return $.an.view.prototype.save.apply(this,arguments)},print:function(){var o=this.options,loc=window.location,url=loc.protocol+"//"+loc.host+"/pdfs?dbid="+o.dbId+"&viewid="+o.view._id;print(url)},destroy:function(){this.element.unbind(".formview").removeClass("an-formview show-pager");$.an.view.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.editor",{options:{printable:true,mode:"browser",document:{},forms:[],actionSets:[],parseDot:true,isDocDirty:false},_create:function(){this.element.addClass("an-editor");var self=this,o=this.options,el=this.element,doc=o.document,docType=doc.type,forms={};this.doc=new DocWrapper(doc,o.parseDot);var id=doc._id;if(id){o.url="/dbs/"+o.dbId+"/"+id+"/attachments"}if(o.forms.length<=1){el.addClass("tabs-nav-hide")}if(o.design&&(docType==Model.FORM||docType==Model.PAGE||docType==Model.VIEW)){forms[doc._id+"-design"]=doc}$.each(o.forms||[],function(k,v){forms[v._id]=v});el.append("<ul />").tabsx({tabTemplate:"<li><a href='#{href}' hidefocus='true'>#{label}</a></li>",show:function(event,ui){var $p=$(ui.panel),id=$p.attr("id"),d=forms[id],type=d.type;if($p.is(".an-form,.an-page,.an-view,.an-mpage")){var data=$p.data();for(var i in data){if($.inArray(i,["form","page","mpage","gridview","formview","customview","view","mobilelistview"])!=-1){if(!o.design||!(/-design$/.test(id))){data[i].option("mode",o.mode)}data[i].option("mobile",o.mobile);self._trigger("tabshow",event,data[i]);break}}}else{var opt={dbId:o.dbId,mode:(o.design&&/-design$/.test(id))?"design":o.mode,ignoreEscape:o.ignoreEscape,change:function(){o.change&&o.change()},mobile:o.mobile,readOnly:o.readOnly,widgetselect:o.widgetselect,optionchanged:function(e,data){if(data.key=="isDirty"){if(data.value){self.option("isFormDirty",true)}else{var isFormDirty=false;el.tabsx("option","panels").each(function(){var data=$(this).data();for(var i in data){if($.inArray(i,["form","page","gridview","formview","customview","view","mobilelistview"])!=-1){isFormDirty=data[i].option("isDirty");if(isFormDirty){break}}}});self.option("isFormDirty",isFormDirty)}}else{if(data.key=="mode"){self.option(data.key,data.value)}}}};if(type==Model.FORM){$p.form($.extend(true,{form:d,document:(o.design&&/-design$/.test(id))?{}:function(){return self.doc},url:o.url,editor:self,create:function(){self._trigger("tabcreated",event,$(this).data("form"))}},opt))}else{if(type==Model.PAGE){$p.page($.extend(true,{page:d,create:function(){self._trigger("tabcreated",event,$(this).data("page"))}},opt))}else{if(type==Model.VIEW){var vt=d.viewType||"gridview",vt=vt.toLowerCase();vt=(vt=="customizedview"?"view":vt);var optsx={view:d,create:function(){self._trigger("tabcreated",event,$(this).data(vt))}};if(vt=="formview"||vt=="customview"||vt=="mobilelistview"){optsx.form=o.form}$p[vt]($.extend(true,optsx,opt))}}}}}});$.each(forms||[],function(k,v){el.tabsx("add","#"+k,v.title)});if(o.tabsPosition=="bottom"){el.addClass("tabs-bottom").children(".ui-tabs-nav, .ui-tabs-nav > *").removeClass("ui-corner-all ui-corner-top").addClass("ui-corner-bottom")}el.attr("tabIndex",-1).css("outline",0).keydown(function(e){var form=self._currentForm();if(e.keyCode===$.ui.keyCode.ESCAPE&&!o.ignoreEscape&&!e.isDefaultPrevented()&&form.validate()){e.preventDefault();self.option("mode","browser");form.option("mode","browser")}}).bind("dblclick.form",function(e){var form=self._currentForm();if(o.mode=="browser"&&!o.readOnly){self.option("mode","edit");form.option("mode","edit")}});$(this.doc).bind("propchanged.editor",function(e,id,value,oldValue,trans){if(!trans){self.option("isDocDirty",true)}if(o.design&&(docType==Model.FORM||docType==Model.PAGE||docType==Model.VIEW)){var docId=doc._id+"-design",dd=$.extend(true,{},doc);el.children("#"+docId+".ui-tabs-panel").each(function(){var $this=$(this);if($this.is(".an-form,.an-page,.an-view,.an-mpage")){var data=$this.data();for(var i in data){if($.inArray(i,["form","page","mpage"])!=-1){$this[i]("option",i,dd)}else{if($.inArray(i,["gridview","formview","customview","view","mobilelistview"])!=-1){$this[i]("option","view",dd)}}}}})}self._trigger("docpropchanged",e,{id:id,value:value,oldValue:oldValue,"transient":trans})});$(document).bind("documentChanged.editor",function(e,data){var ds=$.isArray(data)?data:[data],id;for(var i in ds){id=ds[i]._id;if(id==o.document._id){$.extend(true,o.document,ds[i]);el.children(".ui-tabs-panel").each(function(){var $this=$(this);$this.is(".an-form")&&$this.form("refresh")})}if(forms[id]||forms[id+"-design"]){if(forms[id+"-design"]){id=id+"-design"}forms[id]=$.extend(true,{},ds[i]);for(var j in o.forms){if(o.forms[j]._id==ds[i]._id){o.forms[j]=forms[id];break}}el.children("#"+id+".ui-tabs-panel").each(function(){var $this=$(this);if($this.is(".an-form,.an-page,.an-view,.an-mpage")){var data=$this.data();for(var i in data){if($.inArray(i,["form","page","mpage"])!=-1){$this[i]("option",i,forms[id])}else{if($.inArray(i,["gridview","formview","customview","view","mobilelistview"])!=-1){$this[i]("option","view",forms[id])}}}}})}}}).bind("documentDeleted.editor",function(e,data){var ds=$.isArray(data)?data:[data],id;for(var i in ds){id=ds[i]._id;if(forms[id]||forms[id+"-design"]){if(forms[id+"-design"]){id=id+"-design"}for(var j in o.forms){if(o.forms[j]._id==ds[i]._id){o.forms.splice(j,1);delete forms[id];el.tabsx("remove",id);break}}}}})},_validate:function(){var self=this,valid=true;this.element.tabsx("option","panels").each(function(){var data=$(this).data();for(var i in data){if($.inArray(i,["form","page"])!=-1&&data[i].option("mode")!="design"&&!data[i].option("isValid")){self.element.tabsx("select",data[i].option("form")._id);valid=false;return false}}});return valid},save:function(opts){opts=opts||{};var self=this,o=this.options,dbId=o.dbId,valid=true;this.element.tabsx("option","panels").each(function(){var data=$(this).data();for(var i in data){if($.inArray(i,["form","page"])!=-1){if(data[i].option("isDirty")){if(data[i].option(i)._id==o.document._id){o.document.content=data[i].option("content");data[i].option("isDirty",false);o.isDocDirty=true}else{data[i].save()}}if(opts.validate&&valid&&form.option("mode")!="design"){valid=form.option("isValid");if(!valid){self.element.tabsx("select",form.option("form")._id)}}}else{if($.inArray(i,["gridview","formview","customview","view","mobilelistview"])!=-1){if(data[i].option("isDirty")){if(data[i].option("view")._id==o.document._id){o.document.options=$.extend(true,o.document.options,data[i].option("viewOptions"));data[i].option("isDirty",false);o.isDocDirty=true}else{data[i].save()}}}}}});this.option("isFormDirty",false);if(valid&&o.isDocDirty){var doc=this._getDocument(),opNew={options:{}},tags=false;if($.type(opts.beforesave)=="function"){opts.beforesave(doc)}if(o.formIds){doc.formIds=o.formIds}if(o.task||opts.task){opNew.options["task"]=o.task||opts.task;tags=true}if(o.isNew){var def=o["default"]&&o["default"]._id;if(def){opNew.options["default"]=def;tags=true}Model.postDocument(dbId,doc,tags?opNew:null,function(err,result){if(!err){delete o.isNew;$.extend(o.document,result);self.option("option","url","/dbs/"+dbId+"/"+doc._id+"/attachments");self.option("isDocDirty",false)}if($.type(opts.saved)=="function"){opts.saved(err,doc,true)}else{o.saved&&o.saved(err,doc,true)}})}else{Model.updateDocument(dbId,doc._id,doc,tags?opNew:null,function(err,result){if(!err){$.extend(o.document,result);self.option("isDocDirty",false)}if($.type(opts.saved)=="function"){opts.saved(err,doc,true)}else{o.saved&&o.saved(err,doc,true)}})}}},_getDocument:function(){var o=this.options,doc=$.extend(true,{},o.document);$.each(o.forms,function(){$(this.content).find(".field[transient=true]").each(function(){var $this=$(this),id=$this.attr("id");if(id){id=id.replace(/-/g,".");if($this.attr("transient")){try{delete eval("doc."+id)}catch(e){}}}})});return doc},print:function(){this._currentForm().print()},option:function(key,value){var self=this,o=this.options;if(key==="actionSets"&&value===undefined){var cf=this._currentForm();return cf&&cf.option("actionSets")}else{if(key==="outline"&&value===undefined){var form=this._currentForm();if(form){return form.option("outline")}}else{if(key==="document"&&value===undefined){return this._getDocument()}else{if(key==="namedValues"&&value===undefined){var nv={};$.each(o.forms,function(k,form){$(form.form).find(".field:not(.button)").each(function(){var id=$(this).attr("id");if(id){id=id.replace(/-/g,".");nv[id]=self.doc.prop(id)}})});return nv}else{if(key=="currentForm"&&value==undefined){return this._currentForm()}else{if(key=="isValid"&&value==undefined){return this._validate()}}}}}}var ret=$.Widget.prototype.option.apply(this,arguments);return ret===undefined?null:ret},_setOption:function(key,value){var oldValue=this.options[key];if(!equals(value,oldValue)){$.Widget.prototype._setOption.apply(this,arguments);if(key==="document"){this.doc.setDoc(value);this._setOption("isDocDirty",false)}else{if(key==="url"){this.element.tabsx("option","panels").each(function(){$(this).form("option",key,value)})}else{if(key==="mode"){this._currentForm().option(key,value)}}}this._trigger("optionchanged",null,{key:key,value:value,oldValue:oldValue})}return this},getForm:function(id){var o=this.options;if(o.design&&(id==o.document._id)){id=id+"-design"}var data=this.element.tabsx("panel",id).data();for(var i in data){if($.inArray(i,["form","page","gridview","formview","customview","view","mobilelistview"])!=-1){return data[i]}}return null},_currentForm:function(){var data=$(this.element.tabsx("option","selectedPanel")).data();for(var i in data){if($.inArray(i,["form","page","gridview","formview","customview","view","mobilelistview"])!=-1){return data[i]}}return null},refresh:function(){this._currentForm().refresh();return this},highlightWidget:function(id,highlight){return this._currentForm().highlightWidget(id,highlight)},destroy:function(){$(document).unbind(".editor");this.element.tabsx("destroy").removeClass("an-editor tabs-bottom").unbind(".editor").undelegate(".an-form",".editor").empty();$.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.sideview",{_create:function(){var o=this.options,el=this.element;if(o.name){el.addClass(o.name)}$('<style type="text/css">'+(o.stylesheet||"")+"</style>").appendTo(el);$.extend(this,eval("try{("+(o.methods||"{}")+")}catch(e){}"));var data={};data[this.widgetName]=this;o.actions=eval("("+(o.actions||"[]")+")");$.each(o.actions,function(k,action){el.bind(action.events,data,action.handler)});this.createContent&&this.createContent()},destroy:function(){var o=this.options,el=this.element;$.each(o.actions,function(k,action){el.unbind(action.events)});this.clean&&this.clean();$.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.workbench",{options:{westWidth:320,eastWidth:260,westViews:"",eastViews:"",sideViews:[{id:"50b19b6449987bc16db5a1b8",anchor:"west"}],extensionPoints:{startNew:"51959a88a092003a0f000011",toolbarGlobal:"519598d2a092003a0f000005",toolbarHeader:"5195994da092003a0f000008",toolbarCenter:"5195989ea092003a0f000001",toolbarTail:"51959981a092003a0f00000b",showSideView:"51959a53a092003a0f00000e",documentClick:"519ad731a092001a75000001",documentDoubleClick:"51998379a092001104000078",documentContextMenuNew:"51949426a092000480000001",documentContextMenuMiddle:"519ad76ba092001a75000004",documentContextMenuTop:"519ad8f8a092001a7500000f",documentContextMenuBottom:"519ad916a092001a75000012"},openedDocuments:[]},_create:function(){this.element.addClass("an-workbench");var self=this,o=this.options;document.title=o.title||"Agile Notes";this.element.border({north:{selector:".north",height:28},west:{selector:".west",width:0,resizable:false},east:{selector:".east",width:0,resizable:false},south:{selector:".south",height:18},center:{selector:".center"},optionchanged:function(e,data){if(data.key=="west"||data.key=="east"){if(data.value.width){o[data.key+"Width"]=data.value.width}self._saveOptions()}}});$(["center","west","east"]).each(function(k,v){var node=$("#"+v+"-tabs",self.element);node.tabsx({tabTemplate:"<li><a href='#{href}' hidefocus='true'>#{label}</a> <span class='ui-icon ui-icon-close'>Remove Tab</span></li>",showTabsContextMenu:true,add:function(e,ui){if(v=="center"){node.tabsx("select","#"+ui.panel.id)}},show:function(e,ui){var panel=$(ui.panel),editor;$.each(["editor","gridview","formview","customview","view","page","mobilelistview"],function(k,v){editor=panel.data(v);if(editor){var title=editor.option("title");document.title=o.title+" - "+title;self.reloadToolbar();self._notifyOutline();return false}})},remove:function(e,ui){if(v=="center"){if(node.tabsx("length")==0){document.title=o.title;self.reloadToolbar();self._notifyOutline()}self._afterCloseEditor({workbench:self,id:$(ui.panel).attr("id")})}else{if(v=="west"||v=="east"){var id=$(ui.panel).attr("id"),index=-1;$.each(o.sideViews,function(k,sv){if(id==sv.id&&v==sv.anchor){index=k;return false}});o.sideViews.splice(index,1);self._saveOptions();if(node.tabsx("length")==0){self.element.border("option",v,{width:0,resizable:false})}}}}});node.delegate("span.ui-icon-close","click",function(){var index=$("li",node).index($(this).parent());var saveBtn=self.toolbar.find('button[title="Save"]');if(!saveBtn.attr("disabled")&&$("li",node).eq(index).hasClass("ui-tabs-selected")){showDialog("Confirm","Do you want to save the changes?",{buttons:[{text:"OK",handler:function(dialog){saveBtn.trigger("click");node.tabsx("remove",index);dialog.close()}},{text:"Cancel",handler:function(dialog){node.tabsx("remove",index);dialog.close()}}]});return}node.tabsx("remove",index)});self[v+"Tabs"]=node});this.statusBar=$(".south",self.element);this.element.ajaxComplete(function(event,request,settings){switch(request.status){case 401:self._login();break;default:break}});$.ans.getDoc(o.dbId,null,{selector:{type:Model.VALIDATE_METHOD}},function(err,data){if(err){console.log("Load validate methods error: "+err)}else{$.each(data.docs,function(){$.validator.addMethod(this.name,eval("(0,"+this.handler+")"),this.message)})}});this._loadExtensions(function(){self._initMainToolbar();$.each(o.openedDocuments||[],function(){if(typeof(this.method)!="undefined"){self[this.method](this.id,this.options)}});$.each(o.sideViews,function(){self.showSideView(this.id,this.anchor,this.options)})});this.element.bind("rteoptionchanged.workbench",function(e,data){if(data.key=="path"){self.statusBar.html(data.value);self.toolbar.toolbar("refresh")}else{if(data.key=="undoable"||data.key=="redoable"){self.toolbar.toolbar("refresh")}}}).bind("selectionChanged.workbench",function(e){self.toolbar.toolbar("refresh")});this._proxy=$.proxy(function(e){if(e.target===window){if(this.toolbar.toolbar("option","isEmpty")){$(this.element).border("option",{north:{height:"0"}})}else{var height=this.toolbar.outerHeight(true);$(this.element).border("option","north",{height:height?height:0})}}},this);$(window).bind("resize.workbench",this._proxy);$(document).bind("documentChanged.workbench documentCreated.workbench",function(e,data){var hit=false;$.each($.isArray(data)?data:[data],function(k,v){self.centerTabs.find("a[href^=#"+v._id+"]").html(v.title);if(v.extensionPoint){hit=true}});if(hit){self._loadExtensions(function(){self._initMainToolbar()})}}).bind("documentDeleted.workbench",function(e,data){$.each($.isArray(data)?data:[data],function(k,v){self.centerTabs.find("a[href^=#"+v._id+"]").each(function(){var href=$(this).attr("href");if(href){self.centerTabs.tabsx("remove",href.substring(1))}})});self._loadExtensions(function(){self._initMainToolbar()})});window.workbench=this},_afterOpenEditor:function(data){var o=this.options,hit=false;o.openedDocuments=o.openedDocuments||[];$.each(o.openedDocuments,function(){if(this.id==data.id&&this.method==data.method){hit=true}});if(!hit&&!(data.options&&data.options.isNew)){o.openedDocuments.push(data);this._saveOptions()}},_afterCloseEditor:function(data){var o=this.options,m=data.id.match(/([^-]+)-([^-]+)/),index=-1,type=m[2].substring(0,1).toUpperCase()+m[2].substring(1);$.each(o.openedDocuments,function(k,v){if(v.method==("open"+type)&&v.id==m[1]){index=k;return false}});o.openedDocuments.splice(index,1);this._saveOptions()},_afterShowSideView:function(data){var o=this.options,hit=false;$.each(o.sideViews,function(){if(this.id==data.id&&this.anchor==data.anchor){hit=true}});if(!hit){o.sideViews.push(data);this._saveOptions()}},_loadExtensions:function(afterLoad){var self=this,o=this.options,eps=[];$.each(o.extensionPoints,function(k,v){eps.push(v)});Model.loadExtensions(o.dbId,eps,function(err,exts){self.extensions=exts;afterLoad()})},_initMainToolbar:function(){var self=this,o=this.options,eps=o.extensionPoints;var startActions=[],children=[];var sna=this.extensions[eps.startNew]||[];$.each(sna,function(k,v){children.push({id:k,type:"menuItem",text:v.title||v.name||k,handler:eval("(0,"+(v.handler||"function(){}")+")"),enabled:eval("(0,"+(v.enabled||"function(){return false;}")+")")})});if(sna.length>0){children.push({type:"seperator"})}children.push({id:"others",type:"menuItem",text:"Others ...",handler:function(){$("<div class='workbench'/>").dialog({title:"New Document",height:460,width:320,modal:true,create:function(event,ui){var $this=$(this);$this.explorer({dbId:o.dbId,roots:[Model.META_ROOT],docdblclick:function(e,doc){self.newDocument(doc._id);$this.dialog("close")}});setTimeout(function(){$this.explorer("expand",Model.META_ROOT)},200)},buttons:{OK:function(){var $this=$(this),docIds=$this.explorer("option","selectedNodes");$.each(docIds,function(){self.newDocument(this)});$this.dialog("close")},Cancel:function(){$(this).dialog("close")}},close:function(e,ui){$(this).remove()}})},enabled:function(){return true}});startActions.push({type:"submenu",text:"New",children:children});children=[];var ssv=this.extensions[eps.showSideView]||[];$.each(ssv,function(k,v){children.push({id:k,type:"menuItem",text:v.title||v.name||k,handler:eval("(0,"+(v.handler||"function(){}")+")"),enabled:eval("(0,"+(v.enabled||"function(){return false;}")+")")})});if(ssv.length>0){children.push({type:"seperator"})}children.push({id:"others",type:"menuItem",text:"Others ...",handler:function(){$("<div class='workbench'/>").dialog({title:"Show Side View",height:460,width:320,modal:true,create:function(event,ui){var $this=$(this);$this.explorer({dbId:o.dbId,roots:[Model.SIDE_VIEW_ROOT],docdblclick:function(e,doc){self.showSideView(doc._id);$this.dialog("close")}});setTimeout(function(){$this.explorer("expand",Model.SIDE_VIEW_ROOT)},200)},buttons:{OK:function(){var $this=$(this);$.each($this.explorer("option","selectedNodes"),function(){self.showSideView(this)});$this.dialog("close")},Cancel:function(){$(this).dialog("close")}},close:function(e,ui){$(this).remove()}})},enabled:function(){return true}});startActions.push({type:"submenu",text:$.i18n.showSideView,children:children});startActions.push({type:"seperator"});startActions.push({id:"login",type:"menuItem",text:"Login ...",handler:function(){self._login()},enabled:function(){return true}});startActions.push({id:"logout",type:"menuItem",text:"Logout",handler:function(){self._logout()},enabled:function(){return true}});var globalActions={},tga=this.extensions[eps.toolbarGlobal]||[];$.each(tga,function(k,v){globalActions[v._id]={_id:v._id,type:"button",label:v.title||v.name,text:false,icons:{primary:"ui-icon-"+v.name},handler:eval("(0,"+(v.handler||"function(){}")+")"),enabled:eval("(0,"+(v.enabled||"function(){return false;}")+")")};if(v.icon&&(v.icon.length>0)&&v.icon[0].metadata){globalActions[v._id].iconFile="/dbs/"+o.dbId+"/"+v._id+"/attachments/"+v.icon[0].metadata.filepath}});if(this.toolbar){this.toolbar.remove()}this.toolbar=$("<div id='main' class='ui-corner-all'/>").appendTo($(".north",self.element)).toolbar({startAction:{startAction:{type:"button",label:"Agile Notes",icons:{primary:"ui-icon-home",secondary:"ui-icon-triangle-1-s"},actions:startActions,enabled:function(){return true}}},globalActionSet:globalActions});this.reloadToolbar()},reloadToolbar:function(){var self=this,eps=this.options.extensionPoints;clearTimeout(this.time);this.time=setTimeout(function(){console.log("reloadToolbar............................!");var editor=self.currentEditor(),actionSets=[];if(editor){function createActionSet(actions,context){var actionSet={};$.each(actions,function(k,v){filter=eval("(0,"+(v.filter||"function(){return true}")+")");if(filter(context)){actionSet[v._id]={_id:v._id,type:v.actionType||"button",label:v.title||v.name,text:false,icons:{primary:"ui-icon-"+v.name},iconFile:v.icon,handler:eval("(0,"+(v.handler||"function(){}")+")"),enabled:eval("(0,"+(v.enabled||"function(){return false;}")+")"),checked:eval("(0,"+(v.checked||"function(){return false;}")+")")};if(v.icon&&(v.icon.length>0)&&v.icon[0].metadata){actionSet[v._id].iconFile="/dbs/"+context.dbId+"/"+v._id+"/attachments/"+v.icon[0].metadata.filepath}}});return actionSet}var tas=editor.widget().data("toolbarActions"),dbId=editor.widget().data("dbid")||self.options.dbId,context={editor:editor,dbId:dbId},ass=editor.option("actionSets"),actionSet={},filter;actionSet=createActionSet((tas&&tas[eps.toolbarHeader])||self.extensions[eps.toolbarHeader],context);if(!$.isEmptyObject(actionSet)){actionSets.push(actionSet)}if($.isArray(ass)){actionSets=actionSets.concat(ass)}actionSet=createActionSet((tas&&tas[eps.toolbarCenter])||self.extensions[eps.toolbarCenter],context);if(!$.isEmptyObject(actionSet)){actionSets.push(actionSet)}actionSet=createActionSet((tas&&tas[eps.toolbarTail])||self.extensions[eps.toolbarTail],context);if(!$.isEmptyObject(actionSet)){actionSets.push(actionSet)}}self.toolbar.toolbar("option","actionSets",actionSets);if(self.toolbar.toolbar("option","isEmpty")){self.element.border("option","north",{height:"0"})}else{var height=self.toolbar.outerHeight(true);self.element.border("option","north",{height:height?height:"0"})}},800)},currentEditor:function(){var panel=$(this.centerTabs.tabsx("option","selectedPanel")),data=panel.data(),editor=null;$.each(data||{},function(k,v){if($.inArray(k,["editor","gridview","formview","customview","view","page","mobilelistview"])!=-1){editor=v;return false}});return editor},_saveOptions:function(){var o=this.options,opts={};if(o.openedDocuments.length){opts.openedDocuments=o.openedDocuments}if(o.westWidth){opts.westWidth=o.westWidth}if(o.eastWidth){opts.eastWidth=o.eastWidth}if(o.sideViews.length){opts.sideViews=o.sideViews}$.cookie(o.dbId,$.toJSON(opts))},_login:function(){var o=this.options;var login=function($this){$.ans.login($this.editor("option","document"),function(err,result,real){if(real.success){window.location.reload()}else{showDialog("Login Failed","Login failed: "+real.msg)}$this.dialog("close")})};$("<div class='workbench'/>").dialog({title:"Login",height:260,width:380,modal:true,create:function(event,ui){var $this=$(this);$.ans.getDoc(o.dbId,"50accac59555dbe125000002",null,function(err,form){if(err){console.log("Load Form Error","Load form error: "+err)}else{$this.editor({document:{},forms:[form],dbId:o.dbId,mode:"edit",ignoreEscape:true})}});$this.bind("keyup",function(e){if(e.keyCode==$.ui.keyCode.ENTER){login($(this))}})},buttons:{OK:function(){login($(this))},Cancel:function(){$(this).dialog("close")}},close:function(e,ui){$(this).remove()}})},_logout:function(){$.ans.logout(function(err,result){window.location.reload()})},showSideView:function(viewId,anchor,opts){var self=this,o=this.options,dbId=(opts&&opts.dbId)||o.dbId;$.ans.getDoc(dbId,viewId,null,function(err,sideView){if(sideView){self._doShowSideView(sideView,anchor||"west",opts)}else{console.log("Load view "+viewId+"error: "+err)}})},_docClick:function(context,actions){var filter,action={};$.each(actions||[],function(k,v){filter=eval("(0,"+(v.filter||"function(){return true}")+")");if(filter(context)){$.extend(true,action,v);action.context=context;action.handler=eval("(0,"+(v.handler||"function(){}")+")");action.handler();return false}})},_docDblClick:function(context,actions){var filter,action={},hit=false;$.each(actions||[],function(k,v){filter=eval("(0,"+(v.filter||"function(){return true}")+")");if(filter(context)){$.extend(true,action,v);action.context=context;action.handler=eval("(0,"+(v.handler||"function(){}")+")");action.handler();hit=true;return false}});if(!hit){this.openDocument(context.document._id,{dbId:context.dbId})}},_docContextMenuActions:function(inActions,context,outActions){if(!inActions){return outActions}var eps=this.options.extensionPoints;function addAction(v){filter=eval("(0,"+(v.filter||"function(){return true}")+")");if(filter(context)){outActions.push({type:"menuItem",text:v.title,context:context,handler:eval("(0,"+(v.handler||"function(){}")+")")})}}$.each(inActions[eps.documentContextMenuTop]||[],function(k,v){addAction(v)});if(outActions.length>0){outActions.push({type:"seperator"})}$.each(inActions[eps.documentContextMenuMiddle]||[],function(k,v){addAction(v)});if(outActions.length>=1&&outActions[outActions.length-1].type!="seperator"){outActions.push({type:"seperator"})}$.each(inActions[eps.documentContextMenuBottom]||[],function(k,v){addAction(v)});if(outActions.length>=1&&outActions[outActions.length-1].type=="seperator"){outActions.pop()}return outActions},_doShowSideView:function(sideView,anchor,opts){var self=this,o=this.options,title=sideView.title||sideView.name||sideView._id,dbId=(opts&&opts.dbId)||o.dbId,tabs=this[anchor+"Tabs"],id=sideView._id,el=this.element,panel=tabs.children("#"+id);if(panel.size()>0){return}var a=el.border("option",anchor);if(!a.width){el.border("option",anchor,{width:o[anchor+"Width"],resizable:o[anchor+"Width"]>0})}tabs.tabsx("add","#"+id,title);$("#"+id,tabs).sideview($.extend({dbId:dbId,create:function(e,data){self._afterShowSideView({id:sideView._id,anchor:anchor,options:opts})}},sideView,opts))},authorization:function(docId,opts){var o=this.options,dbId=(opts&&opts.dbId)||o.dbId;$.ans.getDoc(dbId,docId,null,function(err,doc){if(err){console.log("Load document "+docId+" error: "+err)}else{var sel;if(doc.type==Model.META){sel={$or:[{_id:"a417d20f9fa10c25dad56974"},{_id:"e2922e5edc79a1b28c0199e9"}]}}else{sel={_id:"a417d20f9fa10c25dad56974"}}$.ans.getDoc(Model.ADMINDBID,null,{selector:sel},function(err,data){if(err){console.log("Load forms error: "+err)}else{$("<div/>").authorization({title:"Authorization - "+(doc.title||doc.name||doc._id),dbId:Model.ADMINDBID,document:doc,forms:data.docs,buttons:[{text:"Save",click:function(){var $this=$(this),doc=$this.authorization("option","document");Model.updateDocument(dbId,doc._id,doc,null,function(err,result){if(err){console.log("Save authorization error: "+err)}$this.authorization("close")})}},{text:"Cancel",click:function(){$(this).authorization("close")}}],close:function(e,ui){$(this).remove()}})}})}})},execute:function(doc,opts){var self=this,o=this.options,dbId=(opts&&opts.dbId)||o.dbId;$.ans.getDoc(dbId,doc._id,{options:{exec:true}},function(err,doc){if(opts.notify){self.statusBar.html("Execute "+doc.name+" "+(doc.result||doc.error))}})},_notifyOutline:function(){$(window).trigger($.Event("outline",{workbench:this}))},_notifyWidgetSelect:function(widget){$(window).trigger($.Event("widgetselect",{workbench:this}),widget)},status:function(status){this.statusBar.html(status)},newDocument:function(typeId,opts){opts=opts||{};var self=this,o=this.options,dbId=opts.dbId||o.dbId,id=new ObjectId().toString(),title=opts.title||id,pid=id,optsx=$.extend(true,{id:id,tabsPosition:"bottom",optionchanged:function(e,data){if(data.key=="isDocDirty"||data.key=="isFormDirty"){self.toolbar.toolbar("refresh")}else{if(data.key=="mode"){self.reloadToolbar()}}},change:function(e,form){self._notifyOutline()},tabshow:function(e,target){self.reloadToolbar();self._notifyOutline()},tabcreated:function(e,target){self.reloadToolbar();self._notifyOutline()},saved:function(err,doc,bl){var data={id:doc._id,method:"openDocument",options:{mode:"edit"}};if(doc.type==Model.FORM){$.extend(true,data,{method:"openForm",options:{mode:"design"}})}else{if(doc.type==Model.PAGE){$.extend(true,data,{method:"openPage",options:{mode:"design"}})}else{if(doc.type==Model.VIEW){$.extend(true,data,{method:"openView",options:{mode:"design"}})}}}if(bl){self.options.openedDocuments.push(data);self._saveOptions()}}},opts);if(typeId==Model.FORM){pid=pid+"-form";optsx.isFormEditor=true}else{if(typeId==Model.PAGE){pid=pid+"-page";optsx.isPageEditor=true}else{if(typeId==Model.VIEW){pid=pid+"-view"}else{pid=pid+"-document"}}}var el=this.centerTabs.tabsx("add","#"+pid,title).children("#"+pid);optsx.opened=function(editor){document.title=o.title+" - "+title;self.reloadToolbar();opts.opened&&opts.opened(editor)};Model.newDocument(el,dbId,typeId,optsx)},copyDocument:function(docId,opts){opts=opts||{};var self=this,o=this.options,dbId=opts.dbId||o.dbId;$.ans.getDoc(dbId,docId,null,function(err,doc){if(err){console.log("Load document "+docId+" error: "+err)}else{self.newDocument(doc.type,$.extend(true,{"default":doc,title:doc.title||doc.name},opts))}})},openDocument:function(docId,opts){opts=opts||{};var self=this,o=this.options,dbId=opts.dbId||o.dbId,tabs=this.centerTabs,pid=docId+"-document";if(tabs.tabsx("panel",pid).size()>0){tabs.tabsx("select",pid);return}function doOpenDoc(el,dbId,docId,opts){var optsx=$.extend(true,{id:docId,tabsPosition:"bottom",optionchanged:function(e,data){if(data.key=="isDocDirty"||data.key=="isFormDirty"){self.toolbar.toolbar("refresh")}else{if(data.key=="mode"){self.reloadToolbar()}}},change:function(e,form){self._notifyOutline()},tabshow:function(e,target){self.reloadToolbar();self._notifyOutline()},tabcreated:function(e,target){self.reloadToolbar();self._notifyOutline()}},opts);optsx.opened=function(editor){var doc=editor.option("document"),title=doc.title||doc.name||docId;tabs.find(".ui-tabs-nav>li>a[href=#"+pid+"]").html(title);document.title=o.title+" - "+title;self._afterOpenEditor({method:"openDocument",id:docId,options:opts});opts.opened&&opts.opened(editor)};Model.openDocument(el,dbId,docId,optsx)}var el=tabs.tabsx("add","#"+pid,"...").children("#"+pid);if(dbId!=o.dbId){var eps=o.extensionPoints;Model.loadExtensions(dbId,[eps.toolbarHeader,eps.toolbarCenter,eps.toolbarTail],function(err,toolbarActions){if(err){showDialog("Load Toolbar Actions","Load toolbar actions: "+err)}else{el.data("toolbarActions",toolbarActions).data("dbId",dbId)}doOpenDoc(el,dbId,docId,opts)})}else{doOpenDoc(el,dbId,docId,opts)}},openForm:function(formId,opts){opts=opts||{};$.extend(true,opts,{isFormEditor:true});var self=this,o=this.options,dbId=opts.dbId||o.dbId,tabs=this.centerTabs,pid=formId+"-form";if(!opts.preview&&tabs.tabsx("panel",pid).size()>0){tabs.tabsx("select",pid);return}function doOpenForm(el,dbId,formId,opts){var optsx=$.extend(true,{tabsPosition:"bottom",optionchanged:function(e,data){if(data.key=="isDocDirty"||data.key=="isFormDirty"){self.toolbar.toolbar("refresh")}else{if(data.key=="mode"){self.reloadToolbar()}}},widgetselect:function(e,widget){self._notifyWidgetSelect(widget)},change:function(e,form){self._notifyOutline()},tabshow:function(e,target){self.reloadToolbar();self._notifyOutline()},tabcreated:function(e,target){self.reloadToolbar();self._notifyOutline()}},opts);optsx.opened=function(editor){var doc=editor.option("document"),title=doc.title||doc.name||formId;tabs.find(".ui-tabs-nav>li>a[href=#"+pid+"]").html(title);document.title=o.title+" - "+title;self._afterOpenEditor({method:"openForm",id:formId,options:opts});opts.opened&&opts.opened(editor)};Model.openPage(el,dbId,formId,optsx)}var el=null;if(!opts.preview){el=this.centerTabs.tabsx("add","#"+pid,"...").children("#"+pid)}if(dbId!=o.dbId){var eps=o.extensionPoints;Model.loadExtensions(dbId,[eps.toolbarHeader,eps.toolbarCenter,eps.toolbarTail],function(err,toolbarActions){if(err){showDialog("Load Toolbar Actions","Load toolbar actions: "+err)}else{el.data("toolbarActions",toolbarActions).data("dbId",dbId)}doOpenForm(el,dbId,formId,opts)})}else{doOpenForm(el,dbId,formId,opts)}return this},openPage:function(pageId,opts){opts=opts||{};$.extend(true,opts,{isPageEditor:true});var self=this,o=this.options,dbId=opts.dbId||o.dbId,tabs=this.centerTabs,pid=pageId+"-page";if(!opts.preview&&tabs.tabsx("panel",pid).size()>0){tabs.tabsx("select",pid);return}function doOpenPage(el,dbId,pageId,opts){var optsx=$.extend(true,{tabsPosition:"bottom",optionchanged:function(e,data){if(data.key=="isFormDirty"){self.toolbar.toolbar("refresh")}else{if(data.key=="mode"){self.reloadToolbar()}}},widgetselect:function(e,widget){self._notifyWidgetSelect(widget)},change:function(e,form){self._notifyOutline()},tabshow:function(e,target){self.reloadToolbar();self._notifyOutline()},tabcreated:function(e,target){self.reloadToolbar();self._notifyOutline()}},opts);optsx.opened=function(editor){var doc=editor.option("document"),title=doc.title||doc.name||doc._id;tabs.find(".ui-tabs-nav>li>a[href=#"+pid+"]").html(title);document.title=o.title+" - "+title;self._afterOpenEditor({method:"openPage",id:pageId,options:opts});opts.opened&&opts.opened(editor)};Model.openPage(el,dbId,pageId,optsx)}var el=null;if(!opts.preview){el=this.centerTabs.tabsx("add","#"+pid,"...").children("#"+pid)}if(dbId!=o.dbId){var eps=o.extensionPoints;Model.loadExtensions(dbId,[eps.toolbarHeader,eps.toolbarCenter,eps.toolbarTail],function(err,toolbarActions){if(err){showDialog("Load Toolbar Actions","Load toolbar actions: "+err)}else{el.data("toolbarActions",toolbarActions).data("dbId",dbId)}doOpenPage(el,dbId,pageId,opts)})}else{doOpenPage(el,dbId,pageId,opts)}return this},openView:function(viewId,opts){opts=opts||{};var self=this,o=this.options,dbId=opts.dbId||o.dbId,tabs=this.centerTabs,pid=viewId+"-view",el=tabs.tabsx("panel",pid),eps=o.extensionPoints;if(el.size()>0){tabs.tabsx("select",pid);$.each(["editor","gridview","formview","customview","view","mobilelistview"],function(k,v){editor=el.data(v);if(editor&&((v=="editor"&&opts.mode!="design")||(v!="editor"&&opts.mode=="design"))){editor.destroy()}else{return}})}else{el=tabs.tabsx("add","#"+pid,"...").children("#"+pid)}function doOpenView(el,dbId,viewId,actions,opts){var optsx=$.extend(true,{tabsPosition:"bottom",optionchanged:function(e,data){if(data.key=="isDocDirty"||data.key=="isFormDirty"){self.toolbar.toolbar("refresh")}else{if(data.key=="mode"){self.reloadToolbar()}}},tabshow:function(e,target){self.reloadToolbar();self._notifyOutline()},tabcreated:function(e,target){self.reloadToolbar();self._notifyOutline()}},opts);var tas={};$.each(["Header","Center","Tail"],function(){var name="toolbar"+this;if(actions[eps[name]]){tas[eps[name]]=actions[eps[name]]}});tas=$.isEmptyObject(tas)?undefined:tas;el.data("toolbarActions",tas).data("dbId",dbId);optsx.opened=function(editor){var view=editor;if(editor.widgetName=="editor"){view=editor.getForm(viewId)}var v=view.option("view"),title=v.title||v.name||viewId,viewType=v.viewType||"gridview";tabs.find(".ui-tabs-nav>li>a[href=#"+pid+"]").html(title);document.title=o.title+" - "+title;viewType=viewType.toLowerCase();view.option("docclick",function(e,doc){self._docClick({dbId:dbId,view:el.data(viewType),document:doc},actions[eps.documentClick]||self.extensions[eps.documentClick])});view.option("docdblclick",function(e,doc){self._docDblClick({dbId:dbId,view:el.data(viewType),document:doc},actions[eps.documentDoubleClick]||self.extensions[eps.documentDoubleClick])});view.option("contentActions",function(doc){return self._docContextMenuActions(actions,{dbId:dbId,view:el.data(viewType),document:doc},[])});self.reloadToolbar();self._afterOpenEditor({method:"openView",id:viewId,options:opts});opts.opened&&opts.opened(view)};Model.openView(el,dbId,viewId,optsx)}if(dbId!=o.dbId){var epids=[];$.each(["toolbarHeader","toolbarCenter","toolbarTail","documentClick","documentDoubleClick","documentContextMenuMiddle","documentContextMenuTop","documentContextMenuBottom"],function(){epids.push(eps[this])});Model.loadExtensions(dbId,epids,function(err,exts){if(err){console.log("Load actions error: "+err)}else{doOpenView(el,dbId,viewId,exts,opts)}})}else{doOpenView(el,dbId,viewId,this.extensions,opts)}return this},openDatabase:function(dbId,opts){window.open("workbench.html?dbid="+dbId);return this},removeDocument:function(doc,opts){opts=opts||{};var dbId=(opts&&opts.dbId)||this.options.dbId,targetName=doc.title||doc.name||doc._id,title="Remove "+targetName,message="Are you sure to remove "+targetName;message+=(doc.type==Model.CATEGORY)?" and all its child nodes?":"?";showDialog(title,message,{buttons:[{text:"OK",handler:function(dialog){if(doc.type==Model.CATEGORY){Model.deleteDocument(dbId,null,{selector:{_path:{$regex:"^"+doc._path}}},function(err,result){if(err){console.log("Remove document error: "+err)}else{if($.type(opts.removed)=="function"){opts.removed()}}})}else{Model.deleteDocument(dbId,doc._id,null,function(err,result){if(err){console.log("Remove document error: "+err)}else{if($.type(opts.removed)=="function"){opts.removed()}}})}dialog.close()}},{text:"Cancel",handler:function(dialog){dialog.close()}}]});return this},joinInGroup:function(userId,opts){var o=this.options,dbId=(opts&&opts.dbId)||o.dbId;$.ans.getDoc(dbId,userId,null,function(err,user){if(err){console.log("Load user document "+userId+" error: "+err)}else{$("<div class='workbench'/>").dialog({title:"Join In Group",height:460,width:320,modal:true,create:function(event,ui){var $this=$(this),ids=[];$.each(user._groupPaths||[],function(k,v){var a=v.split(",");ids.push(a[a.length-2])});$this.explorer({dbId:dbId,roots:[Model.GROUP_ROOT],checkbox:true,checkedNodes:ids});setTimeout(function(){$this.explorer("expand",Model.GROUP_ROOT)},200)},buttons:{OK:function(){var $this=$(this),nodes=$this.explorer("option","checkedNodes");user._groupPaths=[];$.each(nodes||[],function(k,node){user._groupPaths.push(node.data._path)});Model.updateDocument(dbId,userId,user,null,function(err,result){if(err){console.log("Join in group error: "+err)}$this.dialog("close")})},Cancel:function(){$(this).dialog("close")}},close:function(e,ui){$(this).remove()}})}});return this},quitGroup:function(userId,groupId,opts){var o=this.options,dbId=(opts&&opts.dbId)||o.dbId;$.ans.getDoc(dbId,userId,null,function(err,user){if(err){console.log("Load user document "+userId+" error: "+err)}else{var paths=[];$.each(user._groupPaths||[],function(k,path){var matcher=new RegExp(groupId+",$");if(!matcher.test(path)){paths.push(path)}});user._groupPaths=paths;Model.updateDocument(dbId,userId,user,null,function(err,result){if(err){console.log("Quit group error: "+err)}})}});return this},assignRole:function(docId,opts){var o=this.options,dbId=(opts&&opts.dbId)||o.dbId;$.ans.getDoc(dbId,docId,null,function(err,doc){if(err){console.log("Load document "+docId+" error: "+err)}else{$("<div class='workbench'/>").dialog({title:"Assign Roles",height:460,width:320,modal:true,create:function(event,ui){var $this=$(this),ids=[];$.each(doc._rolePaths||[],function(k,v){var a=v.split(",");ids.push(a[a.length-2])});$this.explorer({dbId:dbId,roots:[Model.ROLE_ROOT],checkbox:true,checkedNodes:ids});setTimeout(function(){$this.explorer("expand",Model.ROLE_ROOT)},200)},buttons:{OK:function(){var $this=$(this),nodes=$this.explorer("option","checkedNodes"),paths=doc._rolePaths=[];$.each(nodes||[],function(k,node){paths.push(node.data._path)});Model.updateDocument(dbId,docId,doc,null,function(err,result){if(err){console.log("Assign role error:"+err)}$this.dialog("close")})},Cancel:function(){$(this).dialog("close")}},close:function(){$(this).remove()}})}});return this},destroy:function(){this.element.border("destroy");$(window).unbind("resize.workbench",this._proxy);$(document).unbind(".workbench");this.element.removeClass("an-workbench");return $.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.authorization",a.ui.dialog,{options:{title:"Authorization",westWidth:220,width:620,height:480,forms:[]},_create:function(){a.ui.dialog.prototype._create.apply(this,arguments);var e=this.element.addClass("an-authorization");this.west=a("<div class='west'/>").appendTo(e);this.organization=a("<div class='organization ui-corner-all'/>").appendTo(this.west);this.center=a("<div class='center'/>").appendTo(e);this.operation=a("<div class='operation ui-corner-all'><h4 class='title'/></div>").appendTo(this.center);this.content=a("<div class='content'/>").appendTo(this.operation)},_init:function(){a.ui.dialog.prototype._init.apply(this,arguments);var e=this,f=this.options;this.element.border({west:{selector:".west",width:f.westWidth,resizable:true},center:{selector:".center"}});this.organization.explorer({dbId:f.dbId,roots:[Model.OU_ROOT,Model.GROUP_ROOT,Model.ROLE_ROOT],nodeclick:function(i,g){var h=g.data;e.center.find(".title").html(h.title||h.name||h._id);e.content.editor({document:e._getACLAuthz(h),forms:f.forms,dbId:f.dbId,mode:"edit",ignoreEscape:true,docpropchanged:function(k,j){e._updateDocument(h,j)}})}});f.resize=function(){e.element.border("refresh")}},_getACLAuthz:function(i){var f=this.options,p=f.document,u=(i.type==Model.USER?i._id:i._path),t=null,e={title:p.title||p.name||p._id,typeName:"Document"},h=this._getPathsName(i),s=p._acl,k=p._authz,g,q,j,r;if(s){t=s.get&&s.get[h];g=t&&(a.inArray(u,t)!=-1)?true:false;t=s.put&&s.put[h];j=t&&(a.inArray(u,t)!=-1)?true:false;t=s["delete"]&&s["delete"][h];r=t&&(a.inArray(u,t)!=-1)?true:false;e._acl={get:g,put:j,"delete":r}}if(p.type==Model.META){e.typeName=p.title||p.name||p._id||"Document";if(k){t=k.post&&k.post[h];q=t&&(a.inArray(u,t)!=-1)?true:false;t=k.get&&k.get[h];g=t&&(a.inArray(u,t)!=-1)?true:false;t=k.put&&k.put[h];j=t&&(a.inArray(u,t)!=-1)?true:false;t=k["delete"]&&k["delete"][h];r=t&&(a.inArray(u,t)!=-1)?true:false;e._authz={get:g,post:q,put:j,"delete":r}}}return e},_updateDocument:function(h,i){var p=this.options.document,f=i.id.split("."),k=p[f[0]]=p[f[0]]||{},e=k[f[1]]=k[f[1]]||{},g=this._getPathsName(h),r=e[g]=e[g]||[],q=(h.type==Model.USER?h._id:h._path),j=a.inArray(q,r);if(i.value&&(j==-1)){r.push(q)}else{if(!i.value&&j!=-1){r.splice(j,1);if(r.length<=0){delete e[g];if(a.isEmptyObject(e)){delete k[f[1]];if(a.isEmptyObject(k)){}}}}}},_getPathsName:function(e){var f=null;if(e.type==Model.USER){f="users"}else{if(e.type==Model.OU){f="ouPaths"}else{if(e.type==Model.GROUP){f="groupPaths"}else{if(e.type==Model.ROLE){f="rolePaths"}}}}return f},destroy:function(){this.element.border("destroy").removeClass("an-authorization");a.ui.dialog.prototype.destroy.apply(this,arguments)}})})(jQuery);(function(b){function f(h){var g=["transform","WebkitTransform","msTransform","MozTransform","OTransform"];var i;while(i=g.shift()){if(typeof h.style[i]!="undefined"){return i}}return"transform"}var e=null;var a=b.fn.css;b.fn.css=function(g,h){if(e===null){if(typeof b.cssProps!="undefined"){e=b.cssProps}else{if(typeof b.props!="undefined"){e=b.props}else{e={}}}}if(typeof e.transform=="undefined"&&(g=="transform"||(typeof g=="object"&&typeof g.transform!="undefined"))){e.transform=f(this.get(0))}if(e.transform!="transform"){if(g=="transform"){g=e.transform;if(typeof h=="undefined"&&jQuery.style){return jQuery.style(this.get(0),g)}}else{if(typeof g=="object"&&typeof g.transform!="undefined"){g[e.transform]=g.transform;delete g.transform}}}return a.apply(this,arguments)}})(jQuery);jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,f,a,h,g){return jQuery.easing[jQuery.easing.def](e,f,a,h,g)},easeInQuad:function(e,f,a,h,g){return h*(f/=g)*f+a},easeOutQuad:function(e,f,a,h,g){return -h*(f/=g)*(f-2)+a},easeInOutQuad:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f+a}return -h/2*((--f)*(f-2)-1)+a},easeInCubic:function(e,f,a,h,g){return h*(f/=g)*f*f+a},easeOutCubic:function(e,f,a,h,g){return h*((f=f/g-1)*f*f+1)+a},easeInOutCubic:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f+a}return h/2*((f-=2)*f*f+2)+a},easeInQuart:function(e,f,a,h,g){return h*(f/=g)*f*f*f+a},easeOutQuart:function(e,f,a,h,g){return -h*((f=f/g-1)*f*f*f-1)+a},easeInOutQuart:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f+a}return -h/2*((f-=2)*f*f*f-2)+a},easeInQuint:function(e,f,a,h,g){return h*(f/=g)*f*f*f*f+a},easeOutQuint:function(e,f,a,h,g){return h*((f=f/g-1)*f*f*f*f+1)+a},easeInOutQuint:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f*f+a}return h/2*((f-=2)*f*f*f*f+2)+a},easeInSine:function(e,f,a,h,g){return -h*Math.cos(f/g*(Math.PI/2))+h+a},easeOutSine:function(e,f,a,h,g){return h*Math.sin(f/g*(Math.PI/2))+a},easeInOutSine:function(e,f,a,h,g){return -h/2*(Math.cos(Math.PI*f/g)-1)+a},easeInExpo:function(e,f,a,h,g){return(f==0)?a:h*Math.pow(2,10*(f/g-1))+a},easeOutExpo:function(e,f,a,h,g){return(f==g)?a+h:h*(-Math.pow(2,-10*f/g)+1)+a},easeInOutExpo:function(e,f,a,h,g){if(f==0){return a}if(f==g){return a+h}if((f/=g/2)<1){return h/2*Math.pow(2,10*(f-1))+a}return h/2*(-Math.pow(2,-10*--f)+2)+a},easeInCirc:function(e,f,a,h,g){return -h*(Math.sqrt(1-(f/=g)*f)-1)+a},easeOutCirc:function(e,f,a,h,g){return h*Math.sqrt(1-(f=f/g-1)*f)+a},easeInOutCirc:function(e,f,a,h,g){if((f/=g/2)<1){return -h/2*(Math.sqrt(1-f*f)-1)+a}return h/2*(Math.sqrt(1-(f-=2)*f)+1)+a},easeInElastic:function(f,h,e,q,k){var i=1.70158;var j=0;var g=q;if(h==0){return e}if((h/=k)==1){return e+q}if(!j){j=k*0.3}if(g<Math.abs(q)){g=q;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(q/g)}return -(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e},easeOutElastic:function(f,h,e,q,k){var i=1.70158;var j=0;var g=q;if(h==0){return e}if((h/=k)==1){return e+q}if(!j){j=k*0.3}if(g<Math.abs(q)){g=q;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(q/g)}return g*Math.pow(2,-10*h)*Math.sin((h*k-i)*(2*Math.PI)/j)+q+e},easeInOutElastic:function(f,h,e,q,k){var i=1.70158;var j=0;var g=q;if(h==0){return e}if((h/=k/2)==2){return e+q}if(!j){j=k*(0.3*1.5)}if(g<Math.abs(q)){g=q;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(q/g)}if(h<1){return -0.5*(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e}return g*Math.pow(2,-10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j)*0.5+q+e},easeInBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*(f/=h)*f*((g+1)*f-g)+a},easeOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*((f=f/h-1)*f*((g+1)*f+g)+1)+a},easeInOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}if((f/=h/2)<1){return i/2*(f*f*(((g*=(1.525))+1)*f-g))+a}return i/2*((f-=2)*f*(((g*=(1.525))+1)*f+g)+2)+a},easeInBounce:function(e,f,a,h,g){return h-jQuery.easing.easeOutBounce(e,g-f,0,h,g)+a},easeOutBounce:function(e,f,a,h,g){if((f/=g)<(1/2.75)){return h*(7.5625*f*f)+a}else{if(f<(2/2.75)){return h*(7.5625*(f-=(1.5/2.75))*f+0.75)+a}else{if(f<(2.5/2.75)){return h*(7.5625*(f-=(2.25/2.75))*f+0.9375)+a}else{return h*(7.5625*(f-=(2.625/2.75))*f+0.984375)+a}}}},easeInOutBounce:function(e,f,a,h,g){if(f<g/2){return jQuery.easing.easeInBounce(e,f*2,0,h,g)*0.5+a}return jQuery.easing.easeOutBounce(e,f*2-g,0,h,g)*0.5+h*0.5+a}});(function(f){var e="deg";f.fn.rotate=function(i){var h=f(this).css("transform")||"none";if(typeof i=="undefined"){if(h){var g=h.match(/rotate\(([^)]+)\)/);if(g&&g[1]){return g[1]}}return 0}var g=i.toString().match(/^(-?\d+(\.\d+)?)(.+)?$/);if(g){if(g[3]){e=g[3]}f(this).css("transform",h.replace(/none|rotate\([^)]*\)/,"")+"rotate("+g[1]+e+")")}return this};f.fn.scale=function(k,j,h){var i=f(this).css("transform");if(typeof k=="undefined"){if(i){var g=i.match(/scale\(([^)]+)\)/);if(g&&g[1]){return g[1]}}return 1}f(this).css("transform",i.replace(/none|scale\([^)]*\)/,"")+"scale("+k+")");return this};var b=f.fx.prototype.cur;f.fx.prototype.cur=function(){if(this.prop=="rotate"){return parseFloat(f(this.elem).rotate())}else{if(this.prop=="scale"){return parseFloat(f(this.elem).scale())}}return b.apply(this,arguments)};f.fx.step.rotate=function(g){f(g.elem).rotate(g.now+e)};f.fx.step.scale=function(g){f(g.elem).scale(g.now)};var a=f.fn.animate;f.fn.animate=function(h){if(typeof h.rotate!="undefined"){var g=h.rotate.toString().match(/^(([+-]=)?(-?\d+(\.\d+)?))(.+)?$/);if(g&&g[5]){e=g[5]}h.rotate=g[1]}return a.apply(this,arguments)}})(jQuery);(function(a){a.fn.quicksand=function(g,b){var f={duration:750,easing:"swing",attribute:"data-id",adjustHeight:"auto",useScaling:true,enhancement:function(h){},selector:"> *",dx:0,dy:0};a.extend(f,b);if(a.browser.msie||(typeof(a.fn.scale)=="undefined")){f.useScaling=false}var e;if(typeof(arguments[1])=="function"){var e=arguments[1]}else{if(typeof(arguments[2]=="function")){var e=arguments[2]}}return this.each(function(A){var F;var D=[];var k=a(g).clone();var E=a(this);var j=a(this).css("height");var t;var p=false;var q=a(E).offset();var r=[];var C=a(this).find(f.selector);if(a.browser.msie&&a.browser.version.substr(0,1)<7){E.html("").append(k);return}var s=0;var w=function(){if(!s){s=1;$toDelete=E.find("> *");E.prepend(x.find("> *"));$toDelete.remove();if(p){E.css("height",t)}f.enhancement(E);if(typeof e=="function"){e.call(this)}}};var B=E.offsetParent();var z=B.offset();if(B.css("position")=="relative"){if(B.get(0).nodeName.toLowerCase()=="body"){}else{z.top+=(parseFloat(B.css("border-top-width"))||0);z.left+=(parseFloat(B.css("border-left-width"))||0)}}else{z.top-=(parseFloat(B.css("border-top-width"))||0);z.left-=(parseFloat(B.css("border-left-width"))||0);z.top-=(parseFloat(B.css("margin-top"))||0);z.left-=(parseFloat(B.css("margin-left"))||0)}if(isNaN(z.left)){z.left=0}if(isNaN(z.top)){z.top=0}z.left-=f.dx;z.top-=f.dy;E.css("height",a(this).height());C.each(function(G){r[G]=a(this).offset()});a(this).stop();var v=0;var u=0;C.each(function(G){a(this).stop();var H=a(this).get(0);if(H.style.position=="absolute"){v=-f.dx;u=-f.dy}else{v=f.dx;u=f.dy}H.style.position="absolute";H.style.margin="0";H.style.top=(r[G].top-parseFloat(H.style.marginTop)-z.top+u)+"px";H.style.left=(r[G].left-parseFloat(H.style.marginLeft)-z.left+v)+"px"});var x=a(E).clone();var h=x.get(0);h.innerHTML="";h.setAttribute("id","");h.style.height="auto";h.style.width=E.width()+"px";x.append(k);x.insertBefore(E);x.css("opacity",0);h.style.zIndex=-1;h.style.margin="0";h.style.position="absolute";h.style.top=q.top-z.top+"px";h.style.left=q.left-z.left+"px";if(f.adjustHeight==="dynamic"){E.animate({height:x.height()},f.duration,f.easing)}else{if(f.adjustHeight==="auto"){t=x.height();if(parseFloat(j)<parseFloat(t)){E.css("height",t)}else{p=true}}}C.each(function(G){var H=[];if(typeof(f.attribute)=="function"){F=f.attribute(a(this));k.each(function(){if(f.attribute(this)==F){H=a(this);return false}})}else{H=k.filter("["+f.attribute+"="+a(this).attr(f.attribute)+"]")}if(H.length){if(!f.useScaling){D.push({element:a(this),animation:{top:H.offset().top-z.top,left:H.offset().left-z.left,opacity:1}})}else{D.push({element:a(this),animation:{top:H.offset().top-z.top,left:H.offset().left-z.left,opacity:1,scale:"1.0"}})}}else{if(!f.useScaling){D.push({element:a(this),animation:{opacity:"0.0"}})}else{D.push({element:a(this),animation:{opacity:"0.0",scale:"0.0"}})}}});k.each(function(I){var H=[];var K=[];if(typeof(f.attribute)=="function"){F=f.attribute(a(this));C.each(function(){if(f.attribute(this)==F){H=a(this);return false}});k.each(function(){if(f.attribute(this)==F){K=a(this);return false}})}else{H=C.filter("["+f.attribute+"="+a(this).attr(f.attribute)+"]");K=k.filter("["+f.attribute+"="+a(this).attr(f.attribute)+"]")}var J;if(H.length===0){if(!f.useScaling){J={opacity:"1.0"}}else{J={opacity:"1.0",scale:"1.0"}}d=K.clone();var G=d.get(0);G.style.position="absolute";G.style.margin="0";G.style.top=K.offset().top-z.top+"px";G.style.left=K.offset().left-z.left+"px";d.css("opacity",0);if(f.useScaling){d.css("transform","scale(0.0)")}d.appendTo(E);D.push({element:a(d),animation:J})}});x.remove();f.enhancement(E);for(A=0;A<D.length;A++){D[A].element.animate(D[A].animation,f.duration,f.easing,w)}})}})(jQuery);(function(a){a.fn.ColorPicker=function(h){var b=this;var f=a.extend({},a.fn.ColorPicker.defaults,h);this.hidden=a('<input type="hidden" />').attr("name",f.name).appendTo(this);this.palette=null;this.preview=null;this.input=null;this.indicator=a("<div />").addClass("color-indicator").appendTo(this);function e(i){b.val(i);f.handler&&f.handler(b.val());b.palette.slideUp()}function g(){b.palette=a("<div />").addClass(f.paletteClass+" rounded-3");for(var j=0;j<f.colors.length;j++){a("<div />").addClass("color").css("background-color",f.colors[j]).attr({title:f.colors[j],unselectable:"on"}).appendTo(b.palette).mouseenter(function(){var i=a(this).attr("title");b.input.val(i);b.preview.css("background-color",i)}).click(function(i){i.stopPropagation();e(a(this).attr("title"))})}b.input=a('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(i){i.stopPropagation();a(this).focus()}).keydown(function(p){if(p.ctrlKey||p.metaKey){return true}var i=p.keyCode;if(i==27){return b.mouseleave()}if(i!=8&&i!=13&&i!=46&&i!=37&&i!=39&&(i<48||i>57)&&(i<65||i>70)){return false}var q=a(this).val();if(q.length==7||q.length==0){if(i==13){p.stopPropagation();p.preventDefault();e(q);b.palette.slideUp()}if(p.keyCode!=8&&p.keyCode!=46&&i!=37&&i!=39){return false}}}).keyup(function(i){var k=a(this).val();k.length==7&&/^#[0-9abcdef]{6}$/i.test(k)&&b.val(k)});b.preview=a("<div />").addClass("preview rounded-3").click(function(i){i.stopPropagation();e(b.input.val())});b.palette.append(a("<div />").addClass("clearfix")).append(a("<div />").addClass("panel").append(b.input).append(b.preview));if(f.palettePosition=="outer"){b.palette.hide().appendTo(b.parents("body").eq(0)).mouseleave(function(){if(!b.palette.is(":animated")){a(this).slideUp();b.val(b.val())}});b.mouseleave(function(i){if(i.relatedTarget!=b.palette.get(0)){if(!b.palette.is(":animated")){b.palette.slideUp();b.val(b.val())}}})}else{b.append(b.palette.hide()).mouseleave(function(i){b.palette.slideUp();b.val(b.val())})}b.val(b.val())}this.click(function(k){if(!b.hasClass("disabled")){!b.palette&&g();if(f.palettePosition=="outer"&&b.palette.css("display")=="none"){var p=a(this).offset(),j=b.palette.width();var i=b.parents("body").width()-p.left>=j?p.left:p.left+a(this).outerWidth()-j;b.palette.css({left:i+"px",top:p.top+a(this).height()+1+"px"})}b.palette.slideToggle()}});this.val=function(i){if(!i&&i!==""){return this.hidden.val()}else{this.hidden.val(i);if(f.update){f.update.apply(this,[this.hidden.val()])}else{this.css("background-color",i)}if(b.palette){b.preview.css("background-color",i);b.input.val(i)}}return this};this.val(f.color||"");return this};a.fn.ColorPicker.defaults={"class":"colorpicker",paletteClass:"palette",palettePosition:"outer",name:"color",color:"",update:function(b){this.indicator.css("background-color",b)},handler:function(b){},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}})(jQuery);(function(a){a.fn.elBorderSelect=function(h){var j=this;var p=this.eq(0);var b=a.extend({},a.fn.elBorderSelect.defaults,h);var f=a('<input type="text" />').attr({name:b.name+"[width]",size:3}).css("text-align","right").change(function(){j.change()});var i=a("<div />").css("position","relative").ColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:b.name+"[color]",palettePosition:"outer",change:function(){j.change()}});var e=a("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> </div>',tpls:{"":"%label"},maxHeight:b.styleHeight||null,select:function(){j.change()},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted","double":"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});p.empty().addClass(b["class"]).attr("name",b.name||"").append(a("<table />").attr("cellspacing",0).append(a("<tr />").append(a("<td />").append(f).append(" px")).append(a("<td />").append(e)).append(a("<td />").append(i))));function g(s){function r(t){hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return !t?"00":hexDigits[(t-t%16)/16]+hexDigits[t%16]}var q=(s||"").match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return q?"#"+r(q[1])+r(q[2])+r(q[3]):""}function k(r){if(!r){return r}var q=r.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);if(q){r=q[1];unit=q[2]}if(r[0]=="."){r="0"+r}r=parseFloat(r);if(isNaN(r)){return""}var s=parseInt(a(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(r*s);case"pt":return parseInt(r*s/12);case"%":return parseInt(r*s/100)}return r}this.change=function(){b.change&&b.change(this.val())};this.val=function(u){var t,x,z,r,q;if(!u&&u!==""){t=parseInt(f.val());t=!isNaN(t)?t+"px":"";x=e.val();z=i.val();return{width:t,style:x,color:z,css:a.trim(t+" "+x+" "+z)}}else{r="";if(u.nodeName||u.css){if(!u.css){u=a(u)}r=u.css("border");if((r=u.css("border"))){t=x=z=r}else{t=u.css("border-width");x=u.css("border-style");z=u.css("border-color")}}else{t=u.width||"";x=u.style||"";z=u.color||""}f.val(k(t));q=x?x.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i):"";e.val(q?q[1]:"");i.val(z.indexOf("#")===0?z:g(z));return this}};this.val(b.value);return this};a.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}})(jQuery);(function(a){a.fn.elPaddingInput=function(g){var e=this;var f=a.extend({},a.fn.elPaddingInput.defaults,{name:this.attr("name")},g);this.regexps={main:new RegExp(f.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(f.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(f.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(f.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(f.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")};a.each(["left","top","right","bottom"],function(){e[this]=a('<input type="text" />').attr("size",3).css("text-align","right").css("border-"+this,"2px solid red").bind("change",function(){a(this).val(b(a(this).val()));h()}).attr("name",f.name+"["+this+"]")});a.each(["uleft","utop","uright","ubottom"],function(){e[this]=a("<select />").append('<option value="px">px</option>').append('<option value="em">em</option>').append('<option value="pt">pt</option>').bind("change",function(){h()}).attr("name",f.name+"["+this+"]");if(f.percents){e[this].append('<option value="%">%</option>')}});this.empty().addClass(f["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom);this.val=function(x){if(!x&&x!==""){var q=b(this.left.val());var z=b(this.top.val());var i=b(this.right.val());var w=b(this.bottom.val());var u={left:q=="auto"||q==0?q:(q!==""?q+this.uleft.val():""),top:z=="auto"||z==0?z:(z!==""?z+this.utop.val():""),right:i=="auto"||i==0?i:(i!==""?i+this.uright.val():""),bottom:w=="auto"||w==0?w:(w!==""?w+this.ubottom.val():""),css:""};if(u.left!==""&&u.right!==""&&u.top!==""&&u.bottom!==""){if(u.left==u.right&&u.top==u.bottom){u.css=u.top+" "+u.left}else{u.css=u.top+" "+u.right+" "+u.bottom+" "+u.left}}return u}else{if(x.nodeName||x.css){if(!x.css){x=a(x)}var k={left:"",top:"",right:"",bottom:""};var j=(x.attr("style")||"").toLowerCase();if(j){j=a.trim(j);var p=j.match(this.regexps.main);if(p){var s=a.trim(p[1]).replace(/\s+/g," ").split(" ",4);k.top=s[0];k.right=s[1]&&s[1]!==""?s[1]:k.top;k.bottom=s[2]&&s[2]!==""?s[2]:k.top;k.left=s[3]&&s[3]!==""?s[3]:k.right}else{a.each(["left","top","right","bottom"],function(){var r=this.toString();p=j.match(e.regexps[r]);if(p){k[r]=p[1]}})}}var x=k}a.each(["left","top","right","bottom"],function(){var t=this.toString();e[t].val("");e["u"+t].val();if(typeof(x[t])!="undefined"&&x[t]!==null){x[t]=x[t].toString();var v=b(x[t]);e[t].val(v);var r=x[t].match(/(px|em|pt|%)/i);e["u"+t].val(r?r[1]:"px")}});return this}};function b(i){i=a.trim(i.toString());if(i[0]=="."){i="0"+i}n=parseFloat(i);return !isNaN(n)?n:(i=="auto"?i:"")}function h(){f.change&&f.change(e)}this.val(f.value);return this};a.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:true,change:null}})(jQuery);(function(a){a.fn.elSelect=function(e){var q=this;var t=this.eq(0);var b=a.extend({},a.fn.elSelect.defaults,e);var g=a('<input type="hidden" />').attr("name",b.name);var p=a("<label />").attr({unselectable:"on"}).addClass("rounded-left-3");var h=null;var k=null;if(t.get(0).nodeName=="SELECT"){b.src={};t.children("option").each(function(){b.src[a(this).val()]=a(this).text()});b.value=t.val();b.name=t.attr("name");t.replaceWith((t=a("<div />")))}if(!b.value||!b.src[b.val]){b.value=null;var f=0;for(var r in b.src){if(f++==0){b.value=r}}}this.val=function(i){if(!i&&i!==""){return g.val()}else{if(b.src[i]){g.val(i);j(i);if(h){h.children().each(function(){if(a(this).attr("name")==i){a(this).addClass("active")}else{a(this).removeClass("active")}})}}return this}};function j(i){var u=b.labelTpl||b.tpls[i]||b.tpl;p.html(u.replace(/%val/g,i).replace(/%label/,b.src[i])).children().attr({unselectable:"on"})}t.empty().addClass(b["class"]+" rounded-3").attr({unselectable:"on"}).append(g).append(p).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).click(function(i){!h&&s();h.slideToggle();if(a.browser.msie&&!k){h.children().each(function(){k=Math.max(k,a(this).width())});if(k>h.width()){h.width(k+40)}}});this.val(b.value);function s(){h=a("<div style='z-index:99999;'/>").addClass(b.listClass+" rounded-3").hide().appendTo(t.mouseleave(function(v){h.slideUp()}));for(var u in b.src){var x=b.tpls[u]||b.tpl;a('<div class="item"/>').attr("name",u).append(a(x.replace(/%val/g,u).replace(/%label/g,b.src[u])).attr({unselectable:"on"})).appendTo(h).click(function(A){A.stopPropagation();A.preventDefault();var w=a(this).attr("name");q.val(w);b.select(w);h.slideUp()})}var i=t.outerWidth();if(h.width()<i){h.width(i)}var z=h.height();if(b.maxHeight>0&&z>b.maxHeight){h.height(b.maxHeight)}q.val(g.val())}return this};a.fn.elSelect.defaults={name:"rte-select","class":"rte-select",listClass:"list",labelTpl:null,tpl:"<%val>%label</%val>",tpls:{},value:null,src:{},select:function(b){window.console&&window.console.log&&window.console.log("selected: "+b)},maxHeight:410}})(jQuery);function rteDom(a){this.rte=a;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/}}rteDom.prototype.createBookmark=function(){var a=this.rte.options.doc.createElement("span");a.id="rte-bm-"+Math.random().toString().substr(2);$(a).addClass("rtebm rte-protected");return a};rteDom.prototype.attr=function(e,a){var b="";if(e&&e.nodeType==1){b=$(e).attr(a);if(b&&a!="src"&&a!="href"&&a!="title"&&a!="alt"){b=b.toString().toLowerCase()}}return b||""};rteDom.prototype.findCommonAncestor=function(f,e){if(!f||!e){return}if(f==e){return f}else{if(f.nodeName=="BODY"||e.nodeName=="BODY"){return this.rte.options.doc.body}}var h=$(f).parents(),g=$(e).parents(),a=g.length-1,j=g[a];for(var b=h.length-1;b>=0;b--,a--){if(h[b]==g[a]){j=h[b]}else{break}}return j};rteDom.prototype.isEmpty=function(a){if(a.nodeType==1){return this.regExp.textNodes.test(a.nodeName)?$.trim($(a).text()).length==0:false}else{if(a.nodeType==3){return/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(a.parentNode.nodeName)||a.nodeValue==""||($.trim(a.nodeValue).length==0&&!(a.nextSibling&&a.previousSibling&&a.nextSibling.nodeType==1&&a.previousSibling.nodeType==1&&!this.regExp.block.test(a.nextSibling.nodeName)&&!this.regExp.block.test(a.previousSibling.nodeName)))}}return true};rteDom.prototype.next=function(a){while(a.nextSibling&&(a=a.nextSibling)){if(a.nodeType==1||(a.nodeType==3&&!this.isEmpty(a))){return a}}return null};rteDom.prototype.prev=function(a){while(a.previousSibling&&(a=a.previousSibling)){if(a.nodeType==1||(a.nodeType==3&&!this.isEmpty(a))){return a}}return null};rteDom.prototype.isPrev=function(b,a){while((b=this.prev(b))){if(b==a){return true}}return false};rteDom.prototype.nextAll=function(b){var a=[];while((b=this.next(b))){a.push(b)}return a};rteDom.prototype.prevAll=function(b){var a=[];while((b=this.prev(b))){a.push(b)}return a};rteDom.prototype.toLineEnd=function(b){var a=[];while((b=this.next(b))&&b.nodeName!="BR"&&b.nodeName!="HR"&&this.isInline(b)){a.push(b)}return a};rteDom.prototype.toLineStart=function(b){var a=[];while((b=this.prev(b))&&b.nodeName!="BR"&&b.nodeName!="HR"&&this.isInline(b)){a.unshift(b)}return a};rteDom.prototype.isFirstNotEmpty=function(a){while((a=this.prev(a))){if(a.nodeType==1||(a.nodeType==3&&$.trim(a.nodeValue)!="")){return false}}return true};rteDom.prototype.isLastNotEmpty=function(a){while((a=this.next(a))){if(!this.isEmpty(a)){return false}}return true};rteDom.prototype.isOnlyNotEmpty=function(a){return this.isFirstNotEmpty(a)&&this.isLastNotEmpty(a)};rteDom.prototype.findLastNotEmpty=function(a){if(a.nodeType==1&&(l=a.lastChild)){if(!this.isEmpty(l)){return l}while(l.previousSibling&&(l=l.previousSibling)){if(!this.isEmpty(l)){return l}}}return false};rteDom.prototype.isInline=function(e){if(e.nodeType==3){return true}else{if(e.nodeType==1){e=$(e);var b=e.css("display");var a=e.css("float");return b=="inline"||b=="inline-block"||a=="left"||a=="right"}}return true};rteDom.prototype.is=function(b,a){if(b&&b.nodeName){if(typeof(a)=="string"){a=this.regExp[a]||/.?/}if(a instanceof RegExp&&b.nodeName){return a.test(b.nodeName)}else{if(typeof(a)=="function"){return a(b)}}}return false};rteDom.prototype.filter=function(f,e){var a=[],b;if(!f.push){return this.is(f,e)?f:null}for(b=0;b<f.length;b++){if(this.is(f[b],e)){a.push(f[b])}}return a};rteDom.prototype.parents=function(e,b){var a=[];while(e&&(e=e.parentNode)&&e.nodeName!="BODY"&&e.nodeName!="HTML"){if(this.is(e,b)){a.push(e)}}return a};rteDom.prototype.parent=function(b,a){return this.parents(b,a)[0]||null};rteDom.prototype.selfOrParent=function(e,b,a){return this.is(e,b)?e:this.parent(e,a||b)};rteDom.prototype.selfOrParentLink=function(a){a=this.selfOrParent(a,/^A$/);return a?a:null};rteDom.prototype.selfOrParentAnchor=function(a){a=this.selfOrParent(a,/^A$/);return a&&!a.href&&a.name?a:null};rteDom.prototype.childLinks=function(b){var a=[];$("a[href]",b).each(function(){a.push(this)});return a};rteDom.prototype.selectionHas=function(e,b){var g=e.cloneContents(),a;if(g&&g.childNodes&&g.childNodes.length){for(a=0;a<g.childNodes.length;a++){if(typeof(b)=="function"){if(b(g.childNodes[a])){return true}}else{if(g instanceof RegExp){if(b.test(g.childNodes[a].nodeName)){return true}}}}}return false};rteDom.prototype.wrap=function(b,a){b=$.isArray(b)?b:[b];a=a.nodeName?a:this.rte.options.doc.createElement(a);if(b[0]&&b[0].nodeType&&b[0].parentNode){a=b[0].parentNode.insertBefore(a,b[0]);$(b).each(function(){if(this!=a){a.appendChild(this)}})}return a};rteDom.prototype.unwrap=function(a){if(a&&a.parentNode){while(a.firstChild){a.parentNode.insertBefore(a.firstChild,a)}a.parentNode.removeChild(a)}};rteDom.prototype.wrapContents=function(e,a){a=a.nodeName?a:this.rte.options.doc.createElement(a);for(var b=0;b<e.childNodes.length;b++){a.appendChild(e.childNodes[b])}e.appendChild(a);return a};rteDom.prototype.cleanNode=function(a){if(a.nodeType!=1){return}if(/^(P|LI)$/.test(a.nodeName)&&(l=this.findLastNotEmpty(a))&&l.nodeName=="BR"){$(l).remove()}$n=$(a);$n.children().each(function(){this.cleanNode(this)});if(a.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(a)&&this.isEmpty(a)){return $n.remove()}if($n.attr("style")===""){$n.removeAttr("style")}if($.browser.safari&&$n.hasClass("Apple-span")){$n.removeClass("Apple-span")}if(a.nodeName=="SPAN"&&!$n.attr("style")&&!$n.attr("class")&&!$n.attr("id")){$n.replaceWith($n.html())}};rteDom.prototype.cleanChildNodes=function(b){var a=this.cleanNode;$(b).children().each(function(){a(this)})};rteDom.prototype.tableMatrix=function(f){var e=[];if(f&&f.nodeName=="TABLE"){var b=0;function a(h){for(var g=0;g<=b;g++){if(!e[h][g]){return g}}}$(f).find("tr").each(function(g){if(!$.isArray(e[g])){e[g]=[]}$(this).children("td,th").each(function(){var k=parseInt($(this).attr("colspan")||1);var r=parseInt($(this).attr("rowspan")||1);var q=a(g);for(var t=0;t<r;t++){for(var j=0;j<k;j++){var p=g+t;if(!$.isArray(e[p])){e[p]=[]}var s=j==0&&t==0?this:(t==0?j:"-");e[p][q+j]=s}}b=Math.max(b,e[g].length)})})}return e};rteDom.prototype.indexesOfCell=function(f,e){for(var a=0;a<e.length;a++){for(var b=0;b<e[a].length;b++){if(e[a][b]==f){return[a,b]}}}};rteDom.prototype.fixTable=function(b){if(b&&b.nodeName=="TABLE"){var g=$(b);var k=this.tableMatrix(b);var j=0;$.each(k,function(){j=Math.max(j,this.length)});if(j==0){return g.remove()}for(var a=0;a<k.length;a++){var f=k[a].length;if(f==0){g.find("tr").eq(a).remove()}else{if(f<j){var e=j-f;var p=g.find("tr").eq(a);for(var h=0;h<e;h++){p.append("<td>&nbsp;</td>")}}}}}};rteDom.prototype.tableColumn=function(e,b,h){e=this.selfOrParent(e,/^TD|TH$/);var f=this.selfOrParent(e,/^TABLE$/);ret=[];info={offset:[],delta:[]};if(e&&f){h&&this.fixTable(f);var p=this.tableMatrix(f);var q=false;var k;for(var a=0;a<p.length;a++){for(var j=0;j<p[a].length;j++){if(p[a][j]==e){k=j;q=true;break}}if(q){break}}if(k>=0){for(var a=0;a<p.length;a++){var g=p[a][k]||null;if(g){if(g.nodeName){ret.push(g);if(b){info.delta.push(0);info.offset.push(k)}}else{var i=parseInt(g);if(!isNaN(i)&&p[a][k-i]&&p[a][k-i].nodeName){ret.push(p[a][k-i]);if(b){info.delta.push(i);info.offset.push(k)}}}}}}}return !b?ret:{column:ret,info:info}};function rteSelection(b){this.rte=b;this.w3cRange=null;var a=this,e=b.options.doc;$(e).keyup(function(f){if(f.ctrlKey||f.metaKey||(f.keyCode>=8&&f.keyCode<=13)||(f.keyCode>=32&&f.keyCode<=40)||f.keyCode==46||(f.keyCode>=96&&f.keyCode<=111)){a.cleanCache()}}).mousedown(function(f){a.start=(f.target.nodeName=="HTML"?e.body:f.target);a.end=a.node=null}).mouseup(function(f){a.end=(f.target.nodeName=="HTML"?e.body:f.target);a.node=null}).click()}rteSelection.prototype.getSelection=function(){var a=this.rte.options.win;return a.getSelection?a.getSelection():a.document.selection};rteSelection.prototype.realSelected=function(f,b,a){var e=this.rte.options.dom;while(f.nodeName!="BODY"&&f.parentNode&&f.parentNode.nodeName!="BODY"&&(b?f!==b&&f.parentNode!=b:1)&&((a=="left"&&e.isFirstNotEmpty(f))||(a=="right"&&e.isLastNotEmpty(f))||(e.isFirstNotEmpty(f)&&e.isLastNotEmpty(f)))){f=f.parentNode}return f};rteSelection.prototype.collapsed=function(){return this.getRangeAt().isCollapsed()};rteSelection.prototype.collapse=function(a){var b=this.getRangeAt();b.collapse(a?true:false);if(!$.browser.msie){this.getSelection().removeAllRanges();this.getSelection().addRange(b)}return this};rteSelection.prototype.getRangeAt=function(e){if($.browser.msie){if(!this.w3cRange){this.w3cRange=new w3cRange(this.rte.options.win)}e&&this.w3cRange.update();return this.w3cRange}var a=this.getSelection(),b=a&&a.rangeCount>0?a.getRangeAt(0):this.rte.options.win.document.createRange();b.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer};b.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer};b.isCollapsed=function(){return this.collapsed};return b};rteSelection.prototype.saveIERange=function(){if($.browser.msie){bm=this.getRangeAt().getBookmark()}};rteSelection.prototype.restoreIERange=function(){$.browser.msie&&bm&&this.getRangeAt().moveToBookmark(bm)};rteSelection.prototype.cloneContents=function(){var g=this.rte.options.doc,j=g.createElement("div"),b,h,a;if($.browser.msie){try{b=this.getSelection().createRange()}catch(f){b=g.body.createTextRange()}$(j).html(b.htmlText)}else{h=this.getRangeAt().cloneContents();for(a=0;a<h.childNodes.length;a++){j.appendChild(h.childNodes[a].cloneNode(true))}}return j};rteSelection.prototype.select=function(f,i){i=i||f;if($.browser.msie){var g=this.rte.options.doc.body.createTextRange(),b=g.duplicate(),a=g.duplicate();b.moveToElementText(f);a.moveToElementText(i);g.setEndPoint("StartToStart",b);g.setEndPoint("EndToEnd",a);g.select()}else{var h=this.getSelection(),g=this.getRangeAt();g.setStartBefore(f);g.setEndAfter(i);h.removeAllRanges();h.addRange(g)}return this.cleanCache()};rteSelection.prototype.selectContents=function(g){var b=this.getRangeAt();if(g&&g.nodeType==1){if($.browser.msie){b.range();b.r.moveToElementText(g.parentNode);b.r.select()}else{try{b.selectNodeContents(g)}catch(f){return}var a=this.getSelection();a.removeAllRanges();a.addRange(b)}}return this};rteSelection.prototype.deleteContents=function(){if(!$.browser.msie){this.getRangeAt().deleteContents()}return this};rteSelection.prototype.insertNode=function(f,e){if(e&&!this.collapsed()){this.collapse()}if($.browser.msie){var b=this.getRangeAt();b.insertNode(f.nodeType==3?f.nodeValue:$("span").append($(f)).html())}else{var b=this.getRangeAt();b.insertNode(f);b.setStartAfter(f);b.setEndAfter(f);var a=this.getSelection();a.removeAllRanges();a.addRange(b)}return this.cleanCache()};rteSelection.prototype.insertHtml=function(a,b){if(b&&!this.collapsed()){this.collapse()}if($.browser.msie){this.getRangeAt().range().pasteHTML(a)}else{var e=$(this.rte.options.doc.create("span")).html(a||"").get(0);this.insertNode(e);$(e).replaceWith($(e).html())}return this.cleanCache()};rteSelection.prototype.insertText=function(b,a){var e=this.rte.options.doc.createTextNode(b);return this.insertHtml(e.nodeValue)};rteSelection.prototype.getBookmark=function(){this.rte.options.win.focus();var a,h,f,q,j,i=this.rte.options.dom,t=i.createBookmark(),k=i.createBookmark(),p=this.rte.options.doc;if($.browser.msie){try{a=this.getSelection().createRange()}catch(k){a=p.body.createTextRange()}if(a.item){var g=a.item(0);a=p.body.createTextRange();a.moveToElementText(g)}h=a.duplicate();f=a.duplicate();q=p.createElement("span");j=p.createElement("span");q.appendChild(t);j.appendChild(k);h.collapse(true);h.pasteHTML(q.innerHTML);f.collapse(false);f.pasteHTML(j.innerHTML)}else{var b=this.getSelection(),a=b&&b.rangeCount>0?b.getRangeAt(0):p.createRange();h=a.cloneRange();f=a.cloneRange();f.collapse(false);f.insertNode(k);h.collapse(true);h.insertNode(t);this.select(t,k)}return[t.id,k.id]};rteSelection.prototype.moveToBookmark=function(a){this.rte.options.win.focus();if(a&&a.length==2){var j=this.rte.options.doc,f=j.getElementById(a[0]),i=j.getElementById(a[1]),h,g;if(f&&i){this.select(f,i);if(this.rte.options.dom.next(f)==i){this.collapse(true)}if(!$.browser.msie){h=this.getSelection();g=h.rangeCount>0?h.getRangeAt(0):j.createRange();h.removeAllRanges();h.addRange(g)}f.parentNode.removeChild(f);i.parentNode.removeChild(i)}}return this};rteSelection.prototype.removeBookmark=function(a){this.rte.options.win.focus();if(a.length==2){var h=this.rte.options.doc,f=h.getElementById(a[0]),g=h.getElementById(a[1]);if(f&&g){f.parentNode.removeChild(f);g.parentNode.removeChild(g)}}};rteSelection.prototype.cleanCache=function(){this.start=this.end=this.node=null;return this};rteSelection.prototype.getStart=function(){if(!this.start){this.start=this.getRangeAt().getStart()}return this.start};rteSelection.prototype.getEnd=function(){if(!this.end){this.end=this.getRangeAt().getEnd()}return this.end};rteSelection.prototype.getNode=function(){if(!this.node){this.node=this.rte.options.dom.findCommonAncestor(this.getStart(),this.getEnd())}return this.node};rteSelection.prototype.selected=function(e){var a={collapsed:false,blocks:false,filter:false,wrap:"text",tag:"span"},j=this.rte.options.dom;a=$.extend({},a,e);if(a.blocks){var h=this.getNode(),g=null;if(g=j.selfOrParent(h,"selectionBlock")){return[g]}}var f=this.selectedRaw(a.collapsed,a.blocks),r=[],k=[],s=null;function b(){function t(){for(var v=0;v<k.length;v++){if(k[v].nodeType==1&&(j.selfOrParent(k[v],/^P$/)||$(k[v]).find("p").length>0)){return false}}return true}if(k.length>0){var i=a.tag=="p"&&!t()?"div":a.tag;var u=j.wrap(k,i);r[s]=u;s=null;k=[]}}function q(u){if(u.nodeType==1){if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(u.nodeName)){$(u).find("td,th").each(function(){var v=a.tag=="p"&&$(this).find("p").length>0?"div":a.tag;var w=j.wrapContents(this,v);return r.push(w)})}else{if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(u.nodeName)){var i=a.tag=="p"&&$(u).find("p").length>0?"div":a.tag;var u=j.wrapContents(u,i);return r.push(u)}}}var t=k.length>0?k[k.length-1]:null;if(t&&t!=j.prev(u)){b()}k.push(u);if(s===null){s=r.length;r.push("dummy")}}if(f.nodes.length>0){for(var p=0;p<f.nodes.length;p++){var h=f.nodes[p];if(h.nodeType==3&&(p==0||p==f.nodes.length-1)&&$.trim(h.nodeValue).length>0){if(p==0&&f.so>0){h=h.splitText(f.so)}if(p==f.nodes.length-1&&f.eo>0){h.splitText(p==0&&f.so>0?f.eo-f.so:f.eo)}}switch(a.wrap){case"text":if((h.nodeType==1&&h.nodeName=="BR")||(h.nodeType==3&&$.trim(h.nodeValue).length>0)){q(h)}else{if(h.nodeType==1){r.push(h)}}break;case"inline":if(j.isInline(h)){q(h)}else{if(h.nodeType==1){r.push(h)}}break;case"all":if(h.nodeType==1||!j.isEmpty(h)){q(h)}break;default:if(h.nodeType==1||!j.isEmpty(h)){r.push(h)}}}b()}if(r.length){this.rte.options.win.focus();this.select(r[0],r[r.length-1])}return a.filter?j.filter(r,a.filter):r};rteSelection.prototype.selectedRaw=function(p,a){var x={so:null,eo:null,nodes:[]};var b=this.getRangeAt(true);var i=b.commonAncestorContainer;var A,w;var v=false;var t=false;var k=this.rte.options.dom;function u(C,r,B){if(C.nodeType==3){B=B>=0?B:C.nodeValue.length;return(r==0&&B==C.nodeValue.length)||$.trim(C.nodeValue).length==$.trim(C.nodeValue.substring(r,B)).length}return true}function j(C,r,B){if(C.nodeType==1){return k.isEmpty(C)}else{if(C.nodeType==3){return $.trim(C.nodeValue.substring(r||0,B>=0?B:C.nodeValue.length)).length==0}}return true}if(b.startContainer.nodeType==1){if(b.startOffset<b.startContainer.childNodes.length){A=b.startContainer.childNodes[b.startOffset];x.so=A.nodeType==1?null:0}else{A=b.startContainer.childNodes[b.startOffset-1];x.so=A.nodeType==1?null:A.nodeValue.length}}else{A=b.startContainer;x.so=b.startOffset}if(b.collapsed){if(p){if(a){A=this.realSelected(A);if(!k.isEmpty(A)||(A=k.next(A))){x.nodes=[A]}if(k.isInline(A)){x.nodes=k.toLineStart(A).concat(x.nodes,k.toLineEnd(A))}if(x.nodes.length>0){x.so=x.nodes[0].nodeType==1?null:0;x.eo=x.nodes[x.nodes.length-1].nodeType==1?null:x.nodes[x.nodes.length-1].nodeValue.length}}else{if(!k.isEmpty(A)){x.nodes=[A]}}}return x}if(b.endContainer.nodeType==1){w=b.endContainer.childNodes[b.endOffset-1];x.eo=w.nodeType==1?null:w.nodeValue.length}else{w=b.endContainer;x.eo=b.endOffset}if(A.nodeType==1||a||u(A,x.so,A.nodeValue.length)){A=this.realSelected(A,i,"left");v=true;x.so=A.nodeType==1?null:0}if(w.nodeType==1||a||u(w,0,x.eo)){w=this.realSelected(w,i,"right");t=true;x.eo=w.nodeType==1?null:w.nodeValue.length}if(a){if(A.nodeType!=1&&A.parentNode!=i&&A.parentNode.nodeName!="BODY"){A=A.parentNode;x.so=null}if(w.nodeType!=1&&w.parentNode!=i&&w.parentNode.nodeName!="BODY"){w=w.parentNode;x.eo=null}}if(A.parentNode==w.parentNode&&A.parentNode.nodeName!="BODY"&&(v&&k.isFirstNotEmpty(A))&&(t&&k.isLastNotEmpty(w))){A=w=A.parentNode;x.so=A.nodeType==1?null:0;x.eo=w.nodeType==1?null:w.nodeValue.length}if(A==w){if(!k.isEmpty(A)){x.nodes.push(A)}return x}var f=A;while(f.nodeName!="BODY"&&f.parentNode!==i&&f.parentNode.nodeName!="BODY"){f=f.parentNode}var z=w;while(z.nodeName!="BODY"&&z.parentNode!==i&&z.parentNode.nodeName!="BODY"){z=z.parentNode}if(!j(A,x.so,A.nodeType==3?A.nodeValue.length:null)){x.nodes.push(A)}var h=A;while(h!==f){var g=h;while((g=k.next(g))){x.nodes.push(g)}h=h.parentNode}h=f;while((h=k.next(h))&&h!=z){x.nodes.push(h)}var q=[];h=w;while(h!==z){var g=h;while((g=k.prev(g))){q.push(g)}h=h.parentNode}if(q.length){x.nodes=x.nodes.concat(q.reverse())}if(!j(w,0,w.nodeType==3?x.eo:null)){x.nodes.push(w)}if(a){if(k.isInline(A)){x.nodes=k.toLineStart(A).concat(x.nodes);x.so=x.nodes[0].nodeType==1?null:0}if(k.isInline(w)){x.nodes=x.nodes.concat(k.toLineEnd(w));x.eo=x.nodes[x.nodes.length-1].nodeType==1?null:x.nodes[x.nodes.length-1].nodeValue.length}}return x};function w3cRange(a){this.win=a;this.r=null;this.collapsed=true;this.startContainer=null;this.endContainer=null;this.startOffset=0;this.endOffset=0;this.commonAncestorContainer=null}w3cRange.prototype.range=function(){doc=this.win.document;try{this.r=doc.selection.createRange()}catch(a){this.r=doc.body.createTextRange()}return this.r};w3cRange.prototype.insertNode=function(a){this.range();this.r.collapse(false);var b=this.r.duplicate();b.pasteHTML(a)};w3cRange.prototype.getBookmark=function(){this.range();if(this.r.item){var a=this.r.item(0);this.r=this.win.document.body.createTextRange();this.r.moveToElementText(a)}return this.r.getBookmark()};w3cRange.prototype.moveToBookmark=function(a){this.win.focus();this.range().moveToBookmark(a);this.r.select()};w3cRange.prototype.update=function(){var b=this,f=this.win.document;function g(w){var j="\uFEFF";var k=offset=0;var s=b.r.duplicate();s.collapse(w);var t=s.parentElement();if(!t||t.nodeName=="HTML"){return{parent:f.body,ndx:k,offset:offset}}s.pasteHTML(j);childs=t.childNodes;for(var q=0;q<childs.length;q++){var v=childs[q];if(q>0&&(v.nodeType!==3||childs[q-1].nodeType!==3)){k++}if(v.nodeType!==3){offset=0}else{var u=v.nodeValue.indexOf(j);if(u!==-1){offset+=u;break}offset+=v.nodeValue.length}}s.moveStart("character",-1);s.text="";return{parent:t,ndx:Math.min(k,t.childNodes.length-1),offset:offset}}this.range();this.startContainer=this.endContainer=null;if(this.r.item){this.collapsed=false;var e=this.r.item(0);this.setStart(e.parentNode,$(e).index());this.setEnd(e.parentNode,this.startOffset+1)}else{this.collapsed=this.r.boundingWidth==0;var h=g(true),a=g(false);h.parent.normalize();a.parent.normalize();h.ndx=Math.min(h.ndx,h.parent.childNodes.length-1);a.ndx=Math.min(a.ndx,a.parent.childNodes.length-1);if(h.parent.childNodes[h.ndx].nodeType&&h.parent.childNodes[h.ndx].nodeType==1){this.setStart(h.parent,h.ndx)}else{this.setStart(h.parent.childNodes[h.ndx],h.offset)}if(a.parent.childNodes[a.ndx].nodeType&&a.parent.childNodes[a.ndx].nodeType==1){this.setEnd(a.parent,a.ndx)}else{this.setEnd(a.parent.childNodes[a.ndx],a.offset)}this.select()}return this};w3cRange.prototype.isCollapsed=function(){this.range();this.collapsed=this.r.item?false:this.r.boundingWidth==0;return this.collapsed};w3cRange.prototype.collapse=function(a){this.range();if(this.r.item){var b=this.r.item(0);this.r=this.win.document.body.createTextRange();this.r.moveToElementText(b)}this.r.collapse(a);this.r.select();this.collapsed=true};w3cRange.prototype.getStart=function(){this.range();if(this.r.item){return this.r.item(0)}var b=this.r.duplicate();b.collapse(true);var a=b.parentElement();return a&&a.nodeName=="BODY"?a.firstChild:a};w3cRange.prototype.getEnd=function(){this.range();if(this.r.item){return this.r.item(0)}var a=this.r.duplicate();a.collapse(false);var b=a.parentElement();return b&&b.nodeName=="BODY"?b.lastChild:b};w3cRange.prototype.setStart=function(a,b){this.startContainer=a;this.startOffset=b;if(this.endContainer){this.commonAncestorContainer=this.findCommonAncestor(this.startContainer,this.endContainer)}};w3cRange.prototype.setEnd=function(a,b){this.endContainer=a;this.endOffset=b;if(this.startContainer){this.commonAncestorContainer=this.findCommonAncestor(this.startContainer,this.endContainer)}};w3cRange.prototype.setStartBefore=function(a){if(a.parentNode){this.setStart(a.parentNode,$(a).index())}};w3cRange.prototype.setStartAfter=function(a){if(a.parentNode){this.setStart(a.parentNode,$(a).index()+1)}};w3cRange.prototype.setEndBefore=function(a){if(a.parentNode){this.setEnd(a.parentNode,$(a).index())}};w3cRange.prototype.setEndAfter=function(a){if(a.parentNode){this.setEnd(a.parentNode,$(a).index()+1)}};w3cRange.prototype.select=function(){var j=this.win.document.body;function i(x,v){if(x.nodeType!=3){return -1}var w="\uFEFF",u=x.nodeValue,e=j.createTextRange();x.nodeValue=u.substring(0,v)+w+u.substring(v);e.moveToElementText(x.parentNode);e.findText(w);var s=Math.abs(e.moveStart("character",-1048575));x.nodeValue=u;return s}this.r=j.createTextRange();var h=this.startOffset,b=this.endOffset;var t=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(h,this.startContainer.childNodes.length-1)]:this.startContainer;var k=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(h==b?b:b-1,this.endContainer.childNodes.length-1)]:this.endContainer;if(this.collapsed){if(t.nodeType==3){var g=i(t,h);this.r.move("character",g)}else{this.r.moveToElementText(t);this.r.collapse(true)}}else{var a=j.createTextRange();var f=i(t,h);var q=i(k,b);if(t.nodeType==3){this.r.move("character",f)}else{this.r.moveToElementText(t)}if(k.nodeType==3){a.move("character",q)}else{a.moveToElementText(k)}this.r.setEndPoint("EndToEnd",a)}try{this.r.select()}catch(k){}if(a){a=null}};w3cRange.prototype.findCommonAncestor=function(f,e){if(!f||!e){return}if(f==e){return f}else{if(f.nodeName=="BODY"||e.nodeName=="BODY"){return doc.body}}var h=$(f).parents(),g=$(e).parents(),a=g.length-1,j=g[a];for(var b=h.length-1;b>=0;b--,a--){if(h[b]==g[a]){j=h[b]}else{break}}return j};if(typeof JSON!=="object"){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/* JsRender v1.0pre: http://github.com/BorisMoore/jsrender */
(function(a,E,v){if(E&&E.views||a.jsviews){return}var ao="v1.0pre",T,ak,A,F,t="{",s="{",i="}",h="}",ag="^",G=/^(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,ah=/(\()(?=\s*\()|(?:([([])\s*)?(?:([#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*((\))(?=\s*\.|\s*\^)|\)|\])([([]?))|(\s+)/g,ab=/\s*\n/g,g=/\\(['"])/g,am=/([\\'"])/g,u=/\x08(~)?([^\x08]+)\x08/g,p=/^if\s/,x=/<(\w+)[>\s]/,V=/<(\w+)[^>\/]*>[^>]*$/,W=/[<"'&]/g,R=/[><"'&]/g,ap=0,an=0,S={"&":"&amp;","<":"&lt;",">":"&gt;","\x00":"&#0;","'":"&#39;",'"':"&#34;"},ae="data-jsv-tmpl",z=[].slice,X={},aa={template:{compile:b},tag:{compile:w},helper:{},converter:{}},U={jsviews:ao,render:X,View:al,settings:{delimiters:C,debugMode:true,tryCatch:true},sub:{Error:L,tmplFn:J,parse:D,extend:B,error:N,syntaxError:Z},_cnvt:O,_tag:e,_err:function(aq){return ac.debugMode?("Error: "+(aq.message||aq))+". ":""}};function L(ar,aq){if(aq&&aq.onError){if(aq.onError(ar)===false){return}}this.name="JsRender Error";this.message=ar||"JsRender error"}function B(at,ar){var aq;at=at||{};for(aq in ar){at[aq]=ar[aq]}return at}(L.prototype=new Error()).constructor=L;function C(aq,at,ar){if(!ad.rTag||arguments.length){t=aq?aq.charAt(0):t;s=aq?aq.charAt(1):s;i=at?at.charAt(0):i;h=at?at.charAt(1):h;ag=ar||ag;aq="\\"+t+"(\\"+ag+")?\\"+s;at="\\"+i+"\\"+h;A="(?:(?:(\\w+(?=[\\/\\s\\"+i+"]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))\\s*((?:[^\\"+i+"]|\\"+i+"(?!\\"+h+"))*?)";ad.rTag=A+")";A=new RegExp(aq+A+"(\\/)?|(?:\\/(\\w+)))"+at,"g");F=new RegExp("<.*>|([^\\\\]|^)[{}]|"+aq+".*"+at)}return[t,s,i,h,ag]}function Q(av,ax){if(!ax){ax=av;av=v}var au,aw,at,ay,ar=this,aq=!ax||ax==="root";if(av){ay=ar.type===ax?ar:v;if(!ay){au=ar.views;if(ar._.useKey){for(aw in au){if(ay=au[aw].get(av,ax)){break}}}else{for(aw=0,at=au.length;!ay&&aw<at;aw++){ay=au[aw].get(av,ax)}}}}else{if(aq){while(ar.parent.parent){ay=ar=ar.parent}}else{while(ar&&!ay){ay=ar.type===ax?ar:v;ar=ar.parent}}}return ay}function P(){var aq=this.get("item");return aq?aq.index:v}P.depends=function(){return[this.get("item"),"index"]};function af(au){var ar,aq=this,at=(aq.ctx||{})[au];at=at===v?aq.getRsc("helpers",au):at;if(at){if(typeof at==="function"){ar=function(){return at.apply(aq,arguments)};B(ar,at)}}return ar||at}function O(aw,au,av){var at,ar,ay,ax=+av===av&&av,aq=au.linkCtx;if(ax){av=(ax=au.tmpl.bnds[ax-1])(au.data,au,U)}ay=av.args[0];if(aw||ax){ar=aq&&aq.tag||{_:{inline:!aq},tagName:aw+":",flow:true,_is:"tag"};ar._.bnd=ax;if(aq){aq.tag=ar;ar.linkCtx=aq;av.ctx=aj(av.ctx,aq.view.ctx)}ar.tagCtx=av;av.view=au;ar.ctx=av.ctx||{};delete av.ctx;au._.tag=ar;aw=aw!=="true"&&aw;if(aw&&((at=au.getRsc("converters",aw))||N("Unknown converter: {{"+aw+":"))){ar.depends=at.depends;ay=at.apply(ar,av.args)}ay=ax&&au._.onRender?au._.onRender(ay,au,ax):ay;au._.tag=v}return ay}function H(at,av){var au,aq=this,ar=U[at];au=ar&&ar[av];while((au===v)&&aq){ar=aq.tmpl[at];au=ar&&ar[av];aq=aq.parent}return au}function e(at,av,ay,az){var aN,aO,aB,aD,aL,aH,aI,aF,aK,aA,aq,aG,aJ,ax,aM="",aw=+az===az&&az,au=av.linkCtx||0,aE=av.ctx,ar=ay||av.tmpl,aC=av._;if(at._is==="tag"){aO=at;at=aO.tagName}if(aw){az=(aJ=ar.bnds[aw-1])(av.data,av,U)}aF=az.length;aO=aO||au.tag;for(aI=0;aI<aF;aI++){aA=az[aI];aG=aA.tmpl;aG=aA.content=aG&&ar.tmpls[aG-1];ay=aA.props.tmpl;if(!aI&&(!ay||!aO)){ax=av.getRsc("tags",at)||N("Unknown tag: {{"+at+"}}")}ay=ay||!aI&&ax.template||aG;ay=""+ay===ay?av.getRsc("templates",ay)||M(ay):ay;B(aA,{tmpl:ay,render:r,index:aI,view:av,ctx:aj(aA.ctx,aE)});if(!aO){if(ax.init){aO=new ax.init(aA,au,aE);aO.attr=aO.attr||ax.attr||v}else{aO={render:ax.render}}aO._={inline:!au};if(au){au.attr=aO.attr=au.attr||aO.attr;au.tag=aO;aO.linkCtx=au}if(aO._.bnd=aJ||au){aO._.arrVws={}}aO.tagName=at;aO.parent=aH=aE&&aE.tag,aO._is="tag"}aC.tag=aO;aA.tag=aO;aO.tagCtxs=az;aO.rendering={};if(!aO.flow){aq=aA.ctx=aA.ctx||{};aB=aq.parentTags=aE&&aj(aq.parentTags,aE.parentTags)||{};if(aH){aB[aH.tagName]=aH}aq.tag=aO}}for(aI=0;aI<aF;aI++){aA=aO.tagCtx=az[aI];aO.ctx=aA.ctx;if(aN=aO.render){aK=aN.apply(aO,aA.args)}aM+=aK!==v?aK:aA.tmpl?aA.render():""}delete aO.rendering;aO.tagCtx=aO.tagCtxs[0];aO.ctx=aO.tagCtx.ctx;if(aO._.inline&&(aD=aO.attr)&&aD!=="html"){aM=aD==="text"?ai.html(aM):""}return aM=aw&&av._.onRender?av._.onRender(aM,av,aw):aM}function al(aq,aw,aC,ar,ax,ay,aB,aE){var az,av,aD,au=aw==="array",at={key:0,useKey:au?0:1,id:""+an++,onRender:aE,bnds:{}},aA={data:ar,tmpl:ax,content:aB,views:au?[]:{},parent:aC,ctx:aq,type:aw,get:Q,getIndex:P,getRsc:H,hlp:af,_:at,_is:"view"};if(aC){az=aC.views;av=aC._;if(av.useKey){az[at.key="_"+av.useKey++]=aA;aD=av.tag;at.bnd=au&&(!aD||!!aD._.bnd&&aD)}else{az.splice(at.key=aA.index=ay!==v?ay:az.length,0,aA)}aA.ctx=aq||aC.ctx}return aA}function q(av){var aq,aw,ar,at,au;for(aq in aa){at=aa[aq];if((au=at.compile)&&(aw=av[aq+"s"])){for(ar in aw){aw[ar]=au(ar,aw[ar],av,aq,at)}}}}function w(ar,at,au){var av,aq;if(typeof at==="function"){at={depends:at.depends,render:at}}else{if(aq=at.template){at.template=""+aq===aq?(M[aq]||M(aq)):aq}if(at.init!==false){av=at.init=at.init||function(aw){};av.prototype=at;(av.prototype=at).constructor=av}}if(au){at._parentTmpl=au}return at}function b(aq,ax,ay,aw,ar,az){function au(aA){if((""+aA===aA)||aA.nodeType>0){try{at=aA.nodeType>0?aA:!F.test(aA)&&E&&E(a.document).find(aA)[0]}catch(aB){}if(at){aA=at.getAttribute(ae);aq=aq||aA;aA=M[aA];if(!aA){aq=aq||"_"+ap++;at.setAttribute(ae,aq);aA=M[aq]=b(aq,at.innerHTML,ay,aw,ar,az)}}return aA}}var av,at;ax=ax||"";av=au(ax);az=az||(ax.markup?ax:{});az.tmplName=aq;if(ay){az._parentTmpl=ay}if(!av&&ax.markup&&(av=au(ax.markup))){if(av.fn&&(av.debug!==ax.debug||av.allowCode!==ax.allowCode)){av=av.markup}}if(av!==v){if(aq&&!ay){X[aq]=function(){return ax.render.apply(ax,arguments)}}if(av.fn||ax.fn){if(av.fn){if(aq&&aq!==av.tmplName){ax=aj(az,av)}else{ax=av}}}else{ax=j(av,az);J(av,ax)}q(az);return ax}}function j(au,av){var aq,ar=ac.wrapMap||{},at=B({markup:au,tmpls:[],links:{},tags:{},bnds:[],_is:"template",render:r},av);if(!av.htmlTag){aq=x.exec(au);at.htmlTag=aq?aq[1].toLowerCase():""}aq=ar[at.htmlTag];if(aq&&aq!==ar.div){at.markup=T.trim(at.markup);at._elCnt=true}return at}function f(at,ar){function au(av,ax,aB){var aw,aA,az,ay;if(av&&""+av!==av&&!av.nodeType&&!av.markup){for(az in av){au(az,av[az],ax)}return U}ay=aB?aB[aq]=aB[aq]||{}:au;if(ax===v){ax=av;av=v}aA=ar.compile;if(aw=ad.onBeforeStoreItem){aA=aw(ay,av,ax,aA)||aA}if(!av){ax=aA(v,ax)}else{if(""+av===av){if(ax===null){delete ay[av]}else{ay[av]=aA?(ax=aA(av,ax,aB,at,ar)):ax}}}if(ax){ax._is=at}if(aw=ad.onStoreItem){aw(ay,av,ax,aA)}return ax}var aq=at+"s";U[aq]=au;aa[at]=ar}function r(aL,at,au,aM,aw,av){var aG,aF,ay,aI,aK,aD,aC,az,ar,aJ,aH,aq,ax,aE=this,aB=!aE.attr||aE.attr==="html",aA="";if(aM===true){aC=true;aM=0}if(aE.tag){az=aE;aE=aE.tag;aJ=aE._;aq=aE.tagName;ax=az.tmpl;at=aj(at,aE.ctx);ar=az.content;if(az.props.link===false){at=at||{};at.link=false}au=au||az.view;aL=aL===v?au:aL}else{ax=aE.jquery&&(aE[0]||N('Unknown template: "'+aE.selector+'"'))||aE}if(ax){if(!au&&aL&&aL._is==="view"){au=aL}if(au){ar=ar||au.content;av=av||au._.onRender;if(aL===au){aL=au.data;aw=true}at=aj(at,au.ctx)}if(!au||au.data===v){(at=at||{}).root=aL}if(!ax.fn){ax=M[ax]||M(ax)}if(ax){av=(at&&at.link)!==false&&aB&&av;aH=av;if(av===true){aH=v;av=au._.onRender}if(T.isArray(aL)&&!aw){aI=aC?au:(aM!==v&&au)||al(at,"array",au,aL,ax,aM,ar,av);for(aG=0,aF=aL.length;aG<aF;aG++){ay=aL[aG];aK=al(at,"item",aI,ay,ax,(aM||0)+aG,ar,av);aD=ax.fn(ay,aK,U);aA+=aI._.onRender?aI._.onRender(aD,aK):aD}}else{aI=aC?au:al(at,aq||"data",au,aL,ax,aM,ar,av);if(aJ&&!aE.flow){aI.tag=aE}aA+=ax.fn(aL,aI,U)}return aH?aH(aA,aI):aA}}return""}function N(aq){if(ac.debugMode){throw new U.sub.Error(aq)}}function Z(aq){N("Syntax error\n"+aq)}function J(aE,aA,aD,aw){function at(aF){aF-=av;if(aF){ay.push(aE.substr(av,aF).replace(ab,"\\n"))}}function aC(aF){aF&&Z('Unmatched or missing tag: "{{/'+aF+'}}" in template:\n'+aE)}function aq(aJ,aX,aK,aU,aS,aN,aH,aR,aT,aP,aW,aL){if(aN){aS=":";aU="html"}aP=aP||aD;var aF,aO,aV=aX&&[],aG="",aI="",aQ="",aM=!aP&&!aS&&!aH;aK=aK||aS;at(aL);av=aL+aJ.length;if(aR){if(au){ay.push(["*","\n"+aT.replace(g,"$1")+"\n"])}}else{if(aK){if(aK==="else"){if(p.test(aT)){Z('for "{{else if expr}}" use "{{else expr}}"')}aV=ax[6];ax[7]=aE.substring(ax[7],aL);ax=az.pop();ay=ax[3];aM=true}if(aT){aT=aT.replace(ab," ");aG=D(aT,aV).replace(u,function(aY,aZ,a0){if(aZ){aQ+=a0+","}else{aI+=a0+","}return""})}aI=aI.slice(0,-1);aG=aG.slice(0,-1);aF=aI&&(aI.indexOf("noerror:true")+1)&&aI||"";aB=[aK,aU||!!aw||"",aG,aM&&[],'params:"'+aT+'",props:{'+aI+"}"+(aQ?",ctx:{"+aQ.slice(0,-1)+"}":""),aF,aV||0];ay.push(aB);if(aM){az.push(ax);ax=aB;ax[7]=av}}else{if(aW){aO=ax[0];aC(aW!==aO&&aO!=="else"&&aW);ax[7]=aE.substring(ax[7],aL);ax=az.pop()}}}aC(!ax&&aW);ay=ax[3]}var aB,au=aA&&aA.allowCode,ar=[],av=0,az=[],ay=ar,ax=[,,,ar];aE=aE.replace(am,"\\$1");aC(az[0]&&az[0][3].pop()[0]);aE.replace(A,aq);at(aE.length);if(av=ar[ar.length-1]){aC(""+av!==av&&(+av[7]===av[7])&&av[0])}return I(ar,aA||aE,aD)}function I(aq,aD,ax){var aX,aJ,aE,aH,at,aR,aW,aK,au,aY,aQ,aG,ay,aB,aC,aO,av,aI,aN,az,aP,ar,a1,aL,a0,aF,aM,aU,aA=0,aw="",aS="",aV={},aT=aq.length;if(""+aD===aD){aO=ax?'data-link="'+aD.replace(ab," ").slice(1,-1)+'"':aD;aD=0}else{aO=aD.tmplName||"unnamed";if(aN=aD.allowCode){aV.allowCode=true}if(aD.debug){aV.debug=true}aQ=aD.bnds;aC=aD.tmpls}for(aX=0;aX<aT;aX++){aJ=aq[aX];if(""+aJ===aJ){aw+='\nret+="'+aJ+'";'}else{aE=aJ[0];if(aE==="*"){aw+=""+aJ[1]}else{aH=aJ[1];at=aJ[2];az=aJ[3];aR=aJ[4];aS=aJ[5];aP=aJ[7];if(!(a0=aE==="else")){aA=0;if(aQ&&(aG=aJ[6])){aA=aQ.push(aG)}}if(aF=aE===":"){if(aH){aE=aH==="html"?">":aH+aE}if(aS){aM="prm"+aX;aS="try{var "+aM+"=["+at+"][0];}catch(e){"+aM+'="";}\n';at=aM}}else{if(az){av=j(aP,aV);av.tmplName=aO+"/"+aE;I(az,av);aC.push(av)}if(!a0){aI=aE;aL=aw;aw="";ay=aX}a1=aq[aX+1];a1=a1&&a1[0]==="else"}aR+=",args:["+at+"]}";if(aF&&aG||aH&&aE!==">"){aU=new Function("data,view,j,u"," // "+aO+" "+aA+" "+aE+"\n"+aS+"return {"+aR+";");aU.paths=aG;aU._ctxs=aE;if(ax){return aU}aY=true}aw+=(aF?"\n"+(aG?"":aS)+(ax?"return ":"ret+=")+(aY?(aY=true,'c("'+aH+'",view,'+(aG?((aQ[aA-1]=aU),aA):"{"+aR)+");"):aE===">"?(aK=true,"h("+at+");"):(au=true,"(v="+at+")!="+(ax?"=":"")+'u?v:"";')):(aW=true,"{tmpl:"+(az?aC.length:"0")+","+aR+","));if(aI&&!a1){aw="["+aw.slice(0,-1)+"]";if(ax||aG){aw=new Function("data,view,j,u"," // "+aO+" "+aA+" "+aI+"\nreturn "+aw+";");if(aG){(aQ[aA-1]=aw).paths=aG}aw._ctxs=aE;if(ax){return aw}}aw=aL+'\nret+=t("'+aI+'",view,this,'+(aA||aw)+");";aG=0;aI=0}}}}aw="// "+aO+"\nvar j=j||"+(E?"jQuery.":"js")+"views"+(au?",v":"")+(aW?",t=j._tag":"")+(aY?",c=j._cnvt":"")+(aK?",h=j.converters.html":"")+(ax?";\n":',ret="";\n')+(ac.tryCatch?"try{\n":"")+(aV.debug?"debugger;":"")+aw+(ax?"\n":"\nreturn ret;\n")+(ac.tryCatch?"\n}catch(e){return j._err(e);}":"");try{aw=new Function("data,view,j,u",aw)}catch(aZ){Z("Compiled template code:\n\n"+aw,aZ)}if(aD){aD.fn=aw}return aw}function D(av,ar){function aA(aC,aU,aE,aM,aJ,aF,aV,aB,aK,aT,aS,aO,aR,aH,aP,aD,aQ,aG,aI){aJ=aJ||"";aE=aE||aU||aS;aM=aM||aB;if(ar&&aP){ar.push({_jsvOb:aI.slice(az[at-1]+1,aG+1)})}aK=aK||aD||"";function aN(aZ,aY,a1,aW,a3,a2,a0){if(aY){ar&&!ax&&ar.push(aM);if(aY!=="."){var aX=(a1?'view.hlp("'+a1+'")':aW?"view":"data")+(a0?(a3?"."+a3:a1?"":(aW?"":"."+aY))+(a2||""):(a0=a1?"":aW?a3||"":aY,""));aX=aX+(a0?"."+a0:"");return aX.slice(0,9)==="view.data"?aX.slice(5):aX}}return aZ}if(aF){Z(av)}else{var aL=(ay?(ay=!aO,(ay?aC:'"')):au?(au=!aR,(au?aC:'"')):((aE?(at++,az[at]=aG,aE):"")+(aQ?(at?"":aw?(aw=ax=false,"\b"):","):aV?(at&&Z(av),aw=aM,ax=aM.charAt(0)==="~","\b"+aM+":"):aM?(aM.split("^").join(".").replace(G,aN)+(aK?(aq[++at]=true,aK):aJ)):aJ?aJ:aH?((aq[at--]=false,aH)+(aK?(aq[++at]=true,aK):"")):aT?(aq[at]||Z(av),","):aU?"":(ay=aO,au=aR,'"'))));return aL}}var aw,ax,aq={},az={0:-1},at=0,au=false,ay=false;return(av+" ").replace(ah,aA)}function aj(ar,aq){return ar&&ar!==aq?(aq?B(B({},aq),ar):ar):aq&&B({},aq)}for(ak in aa){f(ak,aa[ak])}var M=U.templates,ai=U.converters,K=U.helpers,Y=U.tags,ad=U.sub,ac=U.settings;if(E){T=E;T.fn.render=r}else{T=a.jsviews={};T.isArray=Array&&Array.isArray||function(aq){return Object.prototype.toString.call(aq)==="[object Array]"}}T.render=X;T.views=U;T.templates=M=U.templates;Y({"else":function(){},"if":{render:function(at){var aq=this,ar=(aq.rendering.done||!at&&(arguments.length||!aq.tagCtx.index))?"":(aq.rendering.done=true,aq.selected=aq.tagCtx.index,aq.tagCtx.render());return ar},onUpdate:function(av,au,at){var ar,aq,aw;for(ar=0;(aq=this.tagCtxs[ar])&&aq.args.length;ar++){aq=aq.args[0];aw=!aq!==!at[ar].args[0];if(!!aq||aw){return aw}}return false},flow:true},"for":{render:function(ay){var ax,ar,av=this,au=av.tagCtx,aw=!arguments.length,aq="",at=aw||0;if(!av.rendering.done){if(aw){aq=v}else{if(ay!==v){aq+=au.render(ay);at+=T.isArray(ay)?ay.length:1}}if(av.rendering.done=at){av.selected=au.index}}return aq},onUpdate:function(at,ar,aq){},onArrayChange:function(au,ar){var at,aq=this,av=ar.change;if(this.tagCtxs[1]&&(av==="insert"&&au.target.length===ar.items.length||av==="remove"&&!au.target.length||av==="refresh"&&!ar.oldItems.length!==!au.target.length)){this.refresh()}else{for(at in aq._.arrVws){at=aq._.arrVws[at];if(at.data===au.target){at._.onArrayChange.apply(at,arguments)}}}au.done=true},flow:true},include:{flow:true},"*":{render:function(aq){return aq},flow:true}});function k(aq){return S[aq]}ai({html:function(aq){return aq!=v?String(aq).replace(R,k):""},attr:function(aq){return aq!=v?String(aq).replace(W,k):aq===null?null:""},url:function(aq){return aq!=v?encodeURI(String(aq)):aq===null?null:""}});C()})(this,this.jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
 * This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.searchfield",a.an.inputfield,{_create:function(){a.an.inputfield.prototype._create.apply(this,arguments);this.element.addClass("an-searchfield")},_createControl:function(){a.an.inputfield.prototype._createControl.apply(this,arguments);if(this.options.mobile){this.input.attr("data-type","search");var e=this.element.find(".content").eq(0);e.removeClass("ui-input-text");e.addClass("ui-input-search ui-icon-search ui-icon-searchfield")}},_makeResizable:function(){},_browser:function(){a.an.inputfield.prototype._browser.apply(this,arguments)},_edit:function(){this.input.detach().val(this.options.value).appendTo(this.content.empty(),arguments);if(this.options.mobile){var e=this;var f='<a style="position: absolute;right: 20px; top: 17px;display:none;" class="ui-input-clear ui-btn ui-shadow ui-btn-corner-all ui-fullsize ui-btn-icon-notext ui-btn-up-c" href="#" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="delete" data-iconpos="notext" data-theme="c" data-mini="false">					<span class="ui-btn-inner">					<span class="ui-btn-text">clear text</span>					<span class="ui-icon ui-icon-delete ui-icon-shadow">&nbsp;</span>					</span></a>';a(f).bind("click",function(g){e.input.val("");a(this).hide()}).appendTo(this.content);this.input.bind("keyup.inputfield",function(g){a(a(g.target).siblings()).show()}).bind("keydown.inputfield",function(g){a(a(g.target).siblings()).show()})}},_design:function(){a.an.inputfield.prototype._design.apply(this,arguments)},_handleChange:function(f,g,e){a.an.inputfield.prototype._handleChange.apply(this,arguments)},highlight:function(e){(this.options.mode=="edit"?this.input:this.element).toggleClass("an-state-hover",e)},destroy:function(){this.input&&this.input.unbind(".inputfield").remove();this.element.removeClass("an-inputfield");return a.an.field.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.sliderfield",a.an.inputfield,{_create:function(){a.an.inputfield.prototype._create.apply(this,arguments);this.element.addClass("an-sliderfield")},_createControl:function(){var f=this.options,e=this;if(!f.min){f.min=1}if(!f.max){f.max=100}this.input=a("<input type='text'/>").attr({name:f.id}).attr({min:f.min,max:f.max}).bind("change.inputfield keyup.inputfield",function(i){var h=e.input.val(),g=f.value;if(h!=g){f.value=h;e._trigger("optionchanged",null,{key:"value",value:h,oldValue:g,isTransient:f.isTransient})}}).addClass("content ui-shadow-inset ui-corner-all ui-btn-shadow ui-body-c ui-input-text")},_edit:function(){this.input.appendTo(this.content).slider(this.options)},_makeResizable:function(){},_design:function(){if(!this.linkStr){this.linkStr=a('<input type="text" disabled="disabled" class="content ui-shadow-inset ui-corner-all ui-btn-shadow ui-body-c ui-input-text ui-slider-input"><div role="application" class="ui-slider-track ui-btn-down-c ui-btn-corner-all">			<a href="#"			class="ui-slider-handle ui-btn ui-shadow ui-btn-corner-all ui-btn-up-c"			data-corners="true" data-shadow="true" data-iconshadow="true"			data-wrapperels="span" data-theme="c" role="slider" aria-valuemin="0"			aria-valuemax="100" aria-valuenow="0" aria-valuetext="0" title="0"			aria-labelledby="slider1-label" style="left: 50%;">			<span class="ui-btn-inner">				<span class="ui-btn-text"></span>			</span>		</a>	</div>');this.linkStr.appendTo(this.content.removeClass("content"))}},destroy:function(){return a.an.inputfield.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.collapsiblewidget",a.an.widget,{_create:function(){a.an.widget.prototype._create.apply(this,arguments);var f=this.options,g={};f.mobile=true;if(f.mobile){f.content_theme=f.content_theme||"";this.element.addClass("an-collapsiblewidget");var e=this.element.children(".content");e.attr("data-content-theme",f.content_theme);this.header=a("<h3>"+f.headerText+"</h3>");this.contentDiv=a("<div></div>");e.prepend(this.header);if(f.link!="raw"){e.append(this.contentDiv)}if(f.collapsedIcon){g.collapsedIcon=f.collapsedIcon}if(f.collapsed){g.collapsed=false}if(f.expandedIcon){g.expandedIcon=f.expandedIcon}if(f.iconpos){g.iconpos=f.iconpos}if(f.theme){g.theme=f.theme}this.opts=g}},_browser:function(){this._edit()},_edit:function(){var g=this.options,f=g.link;var e=this.element.children(".content");this.option("contextmenu2",false);this.content[0].contentEditable=false;e.collapsible&&e.collapsible(this.opts);if(f&&f!="raw"){this.contentDiv.box({hideTitleBar:true,link:g.link,odbId:g.dbId,targetId:g.targetId,mode:"browser"});this.contentDiv.css("border","0 none")}else{this.contentDiv.append(g.contentText)}},_design:function(){var g=this.options,f=g.link;this.option("contextmenu2",true);this.header.addClass("ui-collapsible-heading").html('<a href="#" class="ui-collapsible-heading-toggle ui-btn ui-fullsize ui-btn-icon-right ui-btn-up-c" data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-icon="arrow-u" data-iconpos="right" data-theme="c" data-mini="false"><span class="ui-btn-inner"><span class="ui-btn-text">'+g.headerText+'<span class="ui-collapsible-heading-status"> click to collapse contents</span></span><span class="ui-icon ui-icon-shadow ui-icon-arrow-d">&nbsp;</span></span></a>');var e=false;if(f&&f!="raw"){this.contentDiv.box({hideTitleBar:true,link:g.link,odbId:g.dbId,targetId:g.targetId,mode:"design"})}else{e=true;this.contentDiv.append(g.contentText)}this.content[0].contentEditable=e},destroy:function(){var f=this.options,e=f.link;if(e&&e!="raw"){this.content.remove()}else{this.content.removeAttr("contenteditable");this.content.removeAttr("data-content-theme");this.header.remove()}this.element.removeClass("an-collapsiblewidget");this.element.unbind("collapsiblewidget");return a.an.widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.togglefield",a.an.sliderfield,{_create:function(){a.an.sliderfield.prototype._create.apply(this,arguments);this.element.addClass("an-togglefield");this.element.unbind("change.widget")},_createControl:function(){var g=this.options,e=this;var f=this.element;g.ontext=g.ontext||"On";g.offtext=g.offtext||"Off";this.input=a('<select >		    <option value="no">'+g.ontext+'</option>		    <option value="yes">'+g.offtext+"</option>		  </select>").attr({name:g.id});g.stop=function(k,j){var i=e.input.val(),h=g.value;if(i!=h){g.value=i;e._trigger("optionchanged",null,{key:"value",value:i,oldValue:h,isTransient:g.isTransient})}if(a(k.target).closest(".widget")[0]==e.element[0]){setTimeout(function(){f.trigger(a.Event(k,{type:"widgetchange"}),e)},20)}};e._trigger("optionchanged",null,{key:"value",value:"no",oldValue:"",isTransient:g.isTransient})},_edit:function(){var f=this.options,e=this;this.input.appendTo(this.content).slider(this.options)},_browser:function(){var g=this.options,e=this;var f=g.value=="no"?g.ontext:g.offtext;this.input.detach();this.content.empty().append(a('<span style="height:32px;line-height:32px;margin:.5em 0;width: 5.8em;display:inline-block;">'+f+"</span>"))},_makeResizable:function(){},_design:function(){if(!this.select){var h=this.options;if(h.mobile){var f=this.element.find(".content").eq(0);f.addClass("codiqa-control ui-field-contain ui-body ui-br");this.select=a("<select />").attr({id:h.id,name:h.id,value:this.value}).addClass("ui-slider-switch").appendTo(f);var g=a("<div />").addClass("ui-slider ui-slider-switch ui-btn-down-c ui-btn-corner-all").appendTo(f);g.html('<span class="ui-slider-label ui-slider-label-a ui-btn-active ui-btn-corner-all" role="img" style="width: 0%;">On</span><span class="ui-slider-label ui-slider-label-b ui-btn-down-c ui-btn-corner-all" role="img" style="width: 100%;">Off</span>');var e=a("<div />").addClass("ui-slider-inneroffset").appendTo(g);a("<a />").addClass("ui-slider-handle ui-slider-handle-snapping ui-btn ui-btn-up-c ui-shadow ui-btn-corner-all").html('<span class="ui-btn-inner"><span class="ui-btn-text"></span></span>').appendTo(e);this.content.removeClass("content")}}},destroy:function(){return a.an.sliderfield.prototype.destroy.apply(this,arguments)}})})(jQuery);var SWFUpload;if(SWFUpload==undefined){SWFUpload=function(a){this.initSWFUpload(a)}}SWFUpload.prototype.initSWFUpload=function(b){try{this.customSettings={};this.settings=b;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(a){delete SWFUpload.instances[this.movieName];throw a}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.completeURL=function(a){if(typeof(a)!=="string"||a.match(/^https?:\/\//i)||a.match(/^\//)){return a}var e=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var b=window.location.pathname.lastIndexOf("/");if(b<=0){path="/"}else{path=window.location.pathname.substr(0,b)+"/"}return path+a};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(b,a){this.settings[b]=(this.settings[b]==undefined)?a:this.settings[b]};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime()}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){var a,b;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}a=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(a==undefined){throw"Could not find the placeholder element: "+this.settings.button_placeholder_id}b=document.createElement("div");b.innerHTML=this.getFlashHTML();a.parentNode.replaceChild(b.firstChild,a);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement()}};SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var b=this.buildParamString();var a=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(a),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(b),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var e=this.settings.post_params;var b=[];if(typeof(e)==="object"){for(var a in e){if(e.hasOwnProperty(a)){b.push(encodeURIComponent(a.toString())+"="+encodeURIComponent(e[a].toString()))}}}return b.join("&amp;")};SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,false);var a=null;a=this.getMovieElement();if(a&&typeof(a.CallFunction)==="unknown"){for(var e in a){try{if(typeof(a[e])==="function"){a[e]=null}}catch(g){}}try{a.parentNode.removeChild(a)}catch(b){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true}catch(f){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))};SWFUpload.prototype.addSetting=function(b,e,a){if(e==undefined){return(this.settings[b]=a)}else{return(this.settings[b]=e)}};SWFUpload.prototype.getSetting=function(a){if(this.settings[a]!=undefined){return this.settings[a]}return""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement();var returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(a){this.callFlash("StartUpload",[a])};SWFUpload.prototype.cancelUpload=function(a,b){if(b!==false){b=true}this.callFlash("CancelUpload",[a,b])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(a){this.callFlash("SetStats",[a])};SWFUpload.prototype.getFile=function(a){if(typeof(a)==="number"){return this.callFlash("GetFileByIndex",[a])}else{return this.callFlash("GetFile",[a])}};SWFUpload.prototype.addFileParam=function(a,b,e){return this.callFlash("AddFileParam",[a,b,e])};SWFUpload.prototype.removeFileParam=function(a,b){this.callFlash("RemoveFileParam",[a,b])};SWFUpload.prototype.setUploadURL=function(a){this.settings.upload_url=a.toString();this.callFlash("SetUploadURL",[a])};SWFUpload.prototype.setPostParams=function(a){this.settings.post_params=a;this.callFlash("SetPostParams",[a])};SWFUpload.prototype.addPostParam=function(a,b){this.settings.post_params[a]=b;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(a){delete this.settings.post_params[a];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(a,b){this.settings.file_types=a;this.settings.file_types_description=b;this.callFlash("SetFileTypes",[a,b])};SWFUpload.prototype.setFileSizeLimit=function(a){this.settings.file_size_limit=a;this.callFlash("SetFileSizeLimit",[a])};SWFUpload.prototype.setFileUploadLimit=function(a){this.settings.file_upload_limit=a;this.callFlash("SetFileUploadLimit",[a])};SWFUpload.prototype.setFileQueueLimit=function(a){this.settings.file_queue_limit=a;this.callFlash("SetFileQueueLimit",[a])};SWFUpload.prototype.setFilePostName=function(a){this.settings.file_post_name=a;this.callFlash("SetFilePostName",[a])};SWFUpload.prototype.setUseQueryString=function(a){this.settings.use_query_string=a;this.callFlash("SetUseQueryString",[a])};SWFUpload.prototype.setRequeueOnError=function(a){this.settings.requeue_on_error=a;this.callFlash("SetRequeueOnError",[a])};SWFUpload.prototype.setHTTPSuccess=function(a){if(typeof a==="string"){a=a.replace(" ","").split(",")}this.settings.http_success=a;this.callFlash("SetHTTPSuccess",[a])};SWFUpload.prototype.setAssumeSuccessTimeout=function(a){this.settings.assume_success_timeout=a;this.callFlash("SetAssumeSuccessTimeout",[a])};SWFUpload.prototype.setDebugEnabled=function(a){this.settings.debug_enabled=a;this.callFlash("SetDebugEnabled",[a])};SWFUpload.prototype.setButtonImageURL=function(a){if(a==undefined){a=""}this.settings.button_image_url=a;this.callFlash("SetButtonImageURL",[a])};SWFUpload.prototype.setButtonDimensions=function(e,a){this.settings.button_width=e;this.settings.button_height=a;var b=this.getMovieElement();if(b!=undefined){b.style.width=e+"px";b.style.height=a+"px"}this.callFlash("SetButtonDimensions",[e,a])};SWFUpload.prototype.setButtonText=function(a){this.settings.button_text=a;this.callFlash("SetButtonText",[a])};SWFUpload.prototype.setButtonTextPadding=function(b,a){this.settings.button_text_top_padding=a;this.settings.button_text_left_padding=b;this.callFlash("SetButtonTextPadding",[b,a])};SWFUpload.prototype.setButtonTextStyle=function(a){this.settings.button_text_style=a;this.callFlash("SetButtonTextStyle",[a])};SWFUpload.prototype.setButtonDisabled=function(a){this.settings.button_disabled=a;this.callFlash("SetButtonDisabled",[a])};SWFUpload.prototype.setButtonAction=function(a){this.settings.button_action=a;this.callFlash("SetButtonAction",[a])};SWFUpload.prototype.setButtonCursor=function(a){this.settings.button_cursor=a;this.callFlash("SetButtonCursor",[a])};SWFUpload.prototype.queueEvent=function(b,e){if(e==undefined){e=[]}else{if(!(e instanceof Array)){e=[e]}}var a=this;if(typeof this.settings[b]==="function"){this.eventQueue.push(function(){this.settings[b].apply(this,e)});setTimeout(function(){a.executeNextEvent()},0)}else{if(this.settings[b]!==null){throw"Event handler "+b+" is unknown or is not a function"}}};SWFUpload.prototype.executeNextEvent=function(){var a=this.eventQueue?this.eventQueue.shift():null;if(typeof(a)==="function"){a.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(e){var g=/[$]([0-9a-f]{4})/i;var h={};var f;if(e!=undefined){for(var a in e.post){if(e.post.hasOwnProperty(a)){f=a;var b;while((b=g.exec(f))!==null){f=f.replace(b[0],String.fromCharCode(parseInt("0x"+b[1],16)))}h[f]=e.post[a]}}e.post=h}return e};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(a){return false}};SWFUpload.prototype.flashReady=function(){var a=this.getMovieElement();if(!a){this.debug("Flash called back ready but the flash movie can't be found.");return}this.cleanUp(a);this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(a){try{if(this.movieElement&&typeof(a.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var e in a){try{if(typeof(a[e])==="function"){a[e]=null}}catch(b){}}}}catch(f){}window.__flash__removeCallback=function(g,h){try{if(g){g[h]=null}}catch(i){}}};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("file_queued_handler",a)};SWFUpload.prototype.fileQueueError=function(a,e,b){a=this.unescapeFilePostParams(a);this.queueEvent("file_queue_error_handler",[a,e,b])};SWFUpload.prototype.fileDialogComplete=function(b,e,a){this.queueEvent("file_dialog_complete_handler",[b,e,a])};SWFUpload.prototype.uploadStart=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("return_upload_start_handler",a)};SWFUpload.prototype.returnUploadStart=function(a){var b;if(typeof this.settings.upload_start_handler==="function"){a=this.unescapeFilePostParams(a);b=this.settings.upload_start_handler.call(this,a)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(b===undefined){b=true}b=!!b;this.callFlash("ReturnUploadStart",[b])};SWFUpload.prototype.uploadProgress=function(a,e,b){a=this.unescapeFilePostParams(a);this.queueEvent("upload_progress_handler",[a,e,b])};SWFUpload.prototype.uploadError=function(a,e,b){a=this.unescapeFilePostParams(a);this.queueEvent("upload_error_handler",[a,e,b])};SWFUpload.prototype.uploadSuccess=function(b,a,e){b=this.unescapeFilePostParams(b);this.queueEvent("upload_success_handler",[b,a,e])};SWFUpload.prototype.uploadComplete=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("upload_complete_handler",a)};SWFUpload.prototype.debug=function(a){this.queueEvent("debug_handler",a)};SWFUpload.prototype.debugMessage=function(e){if(this.settings.debug){var a,f=[];if(typeof e==="object"&&typeof e.name==="string"&&typeof e.message==="string"){for(var b in e){if(e.hasOwnProperty(b)){f.push(b+": "+e[b])}}a=f.join("\n")||"";f=a.split("\n");a="EXCEPTION: "+f.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(a)}else{SWFUpload.Console.writeLine(e)}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(f){var b,a;try{b=document.getElementById("SWFUpload_Console");if(!b){a=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(a);b=document.createElement("textarea");b.id="SWFUpload_Console";b.style.fontFamily="monospace";b.setAttribute("wrap","off");b.wrap="off";b.style.overflow="auto";b.style.width="700px";b.style.height="350px";b.style.margin="5px";a.appendChild(b)}b.value+=f+"\n";b.scrollTop=b.scrollHeight-b.clientHeight}catch(e){alert("Exception: "+e.name+" Message: "+e.message)}};var SWFUpload;if(typeof(SWFUpload)==="function"){SWFUpload.queue={};SWFUpload.prototype.initSettings=(function(a){return function(){if(typeof(a)==="function"){a.call(this)}this.queueSettings={};this.queueSettings.queue_cancelled_flag=false;this.queueSettings.queue_upload_count=0;this.queueSettings.user_upload_complete_handler=this.settings.upload_complete_handler;this.queueSettings.user_upload_start_handler=this.settings.upload_start_handler;this.settings.upload_complete_handler=SWFUpload.queue.uploadCompleteHandler;this.settings.upload_start_handler=SWFUpload.queue.uploadStartHandler;this.settings.queue_complete_handler=this.settings.queue_complete_handler||null}})(SWFUpload.prototype.initSettings);SWFUpload.prototype.startUpload=function(a){this.queueSettings.queue_cancelled_flag=false;this.callFlash("StartUpload",[a])};SWFUpload.prototype.cancelQueue=function(){this.queueSettings.queue_cancelled_flag=true;this.stopUpload();var a=this.getStats();while(a.files_queued>0){this.cancelUpload();a=this.getStats()}};SWFUpload.queue.uploadStartHandler=function(a){var b;if(typeof(this.queueSettings.user_upload_start_handler)==="function"){b=this.queueSettings.user_upload_start_handler.call(this,a)}b=(b===false)?false:true;this.queueSettings.queue_cancelled_flag=!b;return b};SWFUpload.queue.uploadCompleteHandler=function(b){var e=this.queueSettings.user_upload_complete_handler;var f;if(b.filestatus===SWFUpload.FILE_STATUS.COMPLETE){this.queueSettings.queue_upload_count++}if(typeof(e)==="function"){f=(e.call(this,b)===false)?false:true}else{if(b.filestatus===SWFUpload.FILE_STATUS.QUEUED){f=false}else{f=true}}if(f){var a=this.getStats();if(a.files_queued>0&&this.queueSettings.queue_cancelled_flag===false){this.startUpload()}else{if(this.queueSettings.queue_cancelled_flag===false){this.queueEvent("queue_complete_handler",[this.queueSettings.queue_upload_count]);this.queueSettings.queue_upload_count=0}else{this.queueSettings.queue_cancelled_flag=false;this.queueSettings.queue_upload_count=0}}}}}function FileProgress(e,a){this.fileProgressID=e.id;this.opacity=100;this.height=0;this.fileProgressWrapper=document.getElementById(this.fileProgressID);if(!this.fileProgressWrapper){this.fileProgressWrapper=document.createElement("div");this.fileProgressWrapper.className="progressWrapper";this.fileProgressWrapper.id=this.fileProgressID;this.fileProgressElement=document.createElement("div");this.fileProgressElement.className="progressContainer";var h=document.createElement("a");h.className="progressCancel";h.href="#";h.style.visibility="hidden";h.appendChild(document.createTextNode(" "));var b=document.createElement("div");b.className="progressName";b.appendChild(document.createTextNode(e.name));var g=document.createElement("div");g.className="progressBarInProgress";var f=document.createElement("div");f.className="progressBarStatus";f.innerHTML="&nbsp;";this.fileProgressElement.appendChild(h);this.fileProgressElement.appendChild(b);this.fileProgressElement.appendChild(f);this.fileProgressElement.appendChild(g);this.fileProgressWrapper.appendChild(this.fileProgressElement);document.getElementById(a).appendChild(this.fileProgressWrapper)}else{this.fileProgressElement=this.fileProgressWrapper.firstChild;this.reset()}this.height=this.fileProgressWrapper.offsetHeight;this.setTimer(null)}FileProgress.prototype.setTimer=function(a){this.fileProgressElement.FP_TIMER=a};FileProgress.prototype.getTimer=function(a){return this.fileProgressElement.FP_TIMER||null};FileProgress.prototype.reset=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[2].innerHTML="&nbsp;";this.fileProgressElement.childNodes[2].className="progressBarStatus";this.fileProgressElement.childNodes[3].className="progressBarInProgress";this.fileProgressElement.childNodes[3].style.width="0%";this.appear()};FileProgress.prototype.setProgress=function(a){this.fileProgressElement.className="progressContainer green";this.fileProgressElement.childNodes[3].className="progressBarInProgress";this.fileProgressElement.childNodes[3].style.width=a+"%";this.appear()};FileProgress.prototype.setComplete=function(){this.fileProgressElement.className="progressContainer blue";this.fileProgressElement.childNodes[3].className="progressBarComplete";this.fileProgressElement.childNodes[3].style.width="";var a=this;this.setTimer(setTimeout(function(){a.disappear()},10000))};FileProgress.prototype.setError=function(){this.fileProgressElement.className="progressContainer red";this.fileProgressElement.childNodes[3].className="progressBarError";this.fileProgressElement.childNodes[3].style.width="";var a=this;this.setTimer(setTimeout(function(){a.disappear()},5000))};FileProgress.prototype.setCancelled=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[3].className="progressBarError";this.fileProgressElement.childNodes[3].style.width="";var a=this;this.setTimer(setTimeout(function(){a.disappear()},2000))};FileProgress.prototype.setStatus=function(a){this.fileProgressElement.childNodes[2].innerHTML=a};FileProgress.prototype.toggleCancel=function(b,e){this.fileProgressElement.childNodes[0].style.visibility=b?"visible":"hidden";if(e){var a=this.fileProgressID;this.fileProgressElement.childNodes[0].onclick=function(){e.cancelUpload(a);return false}}};FileProgress.prototype.appear=function(){if(this.getTimer()!==null){clearTimeout(this.getTimer());this.setTimer(null)}if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=100}catch(a){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)"}}else{this.fileProgressWrapper.style.opacity=1}this.fileProgressWrapper.style.height="";this.height=this.fileProgressWrapper.offsetHeight;this.opacity=100;this.fileProgressWrapper.style.display=""};FileProgress.prototype.disappear=function(){var h=15;var f=4;var b=30;if(this.opacity>0){this.opacity-=h;if(this.opacity<0){this.opacity=0}if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=this.opacity}catch(g){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+this.opacity+")"}}else{this.fileProgressWrapper.style.opacity=this.opacity/100}}if(this.height>0){this.height-=f;if(this.height<0){this.height=0}this.fileProgressWrapper.style.height=this.height+"px"}if(this.height>0||this.opacity>0){var a=this;this.setTimer(setTimeout(function(){a.disappear()},b))}else{this.fileProgressWrapper.style.display="none";this.setTimer(null)}};function fileQueued(e){try{var a=new FileProgress(e,this.customSettings.progressTarget);a.setStatus("Pending...");a.toggleCancel(true,this)}catch(b){this.debug(b)}}function fileQueueError(e,g,f){try{if(g===SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){alert("You have attempted to queue too many files.\n"+(f===0?"You have reached the upload limit.":"You may select "+(f>1?"up to "+f+" files.":"one file.")));return}var a=new FileProgress(e,this.customSettings.progressTarget);a.setError();a.toggleCancel(false);switch(g){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:a.setStatus("File is too big.");this.debug("Error Code: File too big, File name: "+e.name+", File size: "+e.size+", Message: "+f);break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:a.setStatus("Cannot upload Zero Byte files.");this.debug("Error Code: Zero byte file, File name: "+e.name+", File size: "+e.size+", Message: "+f);break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:a.setStatus("Invalid File Type.");this.debug("Error Code: Invalid File Type, File name: "+e.name+", File size: "+e.size+", Message: "+f);break;default:if(e!==null){a.setStatus("Unhandled Error")}this.debug("Error Code: "+g+", File name: "+e.name+", File size: "+e.size+", Message: "+f);break}}catch(b){this.debug(b)}}function fileDialogComplete(a,e){try{if(a>0){document.getElementById(this.customSettings.cancelButtonId).disabled=false}this.startUpload()}catch(b){this.debug(b)}}function uploadStart(e){try{var a=new FileProgress(e,this.customSettings.progressTarget);a.setStatus("Uploading...");a.toggleCancel(true,this)}catch(b){}return true}function uploadProgress(e,h,g){try{var f=Math.ceil((h/g)*100);var a=new FileProgress(e,this.customSettings.progressTarget);a.setProgress(f);a.setStatus("Uploading...")}catch(b){this.debug(b)}}function uploadSuccess(f,b){try{var a=new FileProgress(f,this.customSettings.progressTarget);a.setComplete();a.setStatus("Complete.");a.toggleCancel(false)}catch(e){this.debug(e)}}function uploadError(e,g,f){try{var a=new FileProgress(e,this.customSettings.progressTarget);a.setError();a.toggleCancel(false);switch(g){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:a.setStatus("Upload Error: "+f);this.debug("Error Code: HTTP Error, File name: "+e.name+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:a.setStatus("Upload Failed.");this.debug("Error Code: Upload Failed, File name: "+e.name+", File size: "+e.size+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:a.setStatus("Server (IO) Error");this.debug("Error Code: IO Error, File name: "+e.name+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:a.setStatus("Security Error");this.debug("Error Code: Security Error, File name: "+e.name+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:a.setStatus("Upload limit exceeded.");this.debug("Error Code: Upload Limit Exceeded, File name: "+e.name+", File size: "+e.size+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:a.setStatus("Failed Validation.  Upload skipped.");this.debug("Error Code: File Validation Failed, File name: "+e.name+", File size: "+e.size+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:if(this.getStats().files_queued===0){document.getElementById(this.customSettings.cancelButtonId).disabled=true}a.setStatus("Cancelled");a.setCancelled();break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:a.setStatus("Stopped");break;default:a.setStatus("Unhandled Error: "+g);this.debug("Error Code: "+g+", File name: "+e.name+", File size: "+e.size+", Message: "+f);break}}catch(b){this.debug(b)}}function uploadComplete(a){if(this.getStats().files_queued===0){document.getElementById(this.customSettings.cancelButtonId).disabled=true}}function queueComplete(b){var a=document.getElementById("divStatus");a.innerHTML=b+" file"+(b===1?"":"s")+" uploaded."}
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.navbarwidget",a.an.widget,{_create:function(){var g=this.options;a.an.widget.prototype._create.apply(this,arguments);if(g.mobile){try{this.content.navbar({iconpos:g.iconpos})}catch(f){}}},_makeResizable:function(){},_browser:function(){var e=this.content.find(".an-navbarwidget");a(e).each(function(g,f){a(f).remove()});this.content.find(".c li").css("clear","none")},_edit:function(){var e=this.content.find(".an-navbarwidget");a(e).each(function(g,f){a(f).remove()});this.content.find(".c li").css("clear","none")},_design:function(){var i=this.options;if(i.mobile){var h=a("<div data-role='navbar'/>").attr("id",i.id);var f=a("<ul class='c' />"),g;var e=i.selectItems.length;a(i.selectItems).each(function(q,p){var r=a("<a/>"),s="ui-btn ";var j=a("<span style='display:none;' class='an-navbarwidget' />");j.addClass(i.iconpos||"");if(p.data_transition){r.attr("data-transition",p.data_transition)}if(p.data_icon){j.addClass("ui-icon ui-icon-"+p.data_icon);j.css("display","block");r.attr("data-icon",p.data_icon)}if(i.iconpos){j.addClass("ui-btn-icon-"+i.iconpos)}if(p.data_theme){s+=" ui-btn-up-"+p.data_theme;r.attr("data-theme",p.data_theme)}if(p.data_inline){s+=" ui-btn-inline";r.attr("data-inline",true)}if(p.isMini){s+=" ui-mini";r.attr("data-mini",true)}if(p.href){r.attr("link",p.href)}if(e<=5){g=100/e}else{g="33.33"}if(i.iconpos&&i.iconpos!="bottom"){r.append(j).addClass(s)}r.append(p.label||"Button");if(i.iconpos&&i.iconpos=="bottom"){r.append(j).addClass(s)}f.append(a("<li style='width:"+g+"%;'/>").addClass("ui-block-a").append(r))});h.append(f);this.content.html(h.html())}},destroy:function(){return a.an.widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.listviewfield",a.an.field,{options:{mode:"browser",value:[]},_create:function(){a.an.field.prototype._create.apply(this,arguments);this.element.addClass("an-listviewfield")},_createControl:function(){var f=this,h=this.options,g=this.element;if(h.mobile){var e=this.element.find(".content").eq(0);this.ul_element=a('<ul name="'+h.id+'" data-role="listview" />').appendTo(e);if(h.isInset){this.ul_element.attr("data-inset","true")}if(h.label_theme){this.ul_element.attr("data-divider-theme",h.label_theme)}if(h.data_theme){this.ul_element.attr("data-theme",h.data_theme)}if(h.splitIcon){this.ul_element.attr("data-split-icon",h.splitIcon);this.ul_element.attr("data-split-theme","d")}}},_createLabel:function(){},_makeResizable:function(){},_notify:function(e,f){var g=this.options;if(f!=e){g.value=f;this._trigger("optionchanged",null,{key:"value",value:f,oldValue:e,isTransient:g.isTransient})}},appendValue:function(f){var g=this.options,e=[].concat(g.value);g.value.push(f);this.refresh();this._notify(e,g.value)},insertValue:function(f,g){var h=this.options,e=[].concat(h.value);h.value.splice(f,1,g);this.refresh();this._notify(e,h.value)},delValue:function(f){var g=this.options,e=[].concat(g.value);g.value.splice(f,1);this.refresh();this._notify(e,g.value)},getValue:function(e){var f=this.options;return f.value[e]},replaceValue:function(f,g){var h=this.options,e=[].concat(h.value);h.value[f]=g;this.refresh();this._notify(e,h.value)},_browser:function(){var f=this.options,e="";this.ul_element.empty();f.value=[];a.each(f.selectItems||[],function(h,g){f.value.push(f.selectItems[h].value);e+="<li><a>"+this.label+"</a></li>"});if(f.label){this.ul_element.append('<li data-role="list-divider"><a>'+f.label+"</a></li>")}this.ul_element.append(e);this.ul_element.listview();this.ul_element.data("mobileListview").refresh()},_edit:function(){var f=this.options,e="";this.ul_element.empty();f.value=[];a.each(f.selectItems||[],function(h,g){f.value.push(f.selectItems[h].value);if(f.splitIcon){e+="<li><a>"+this.label+'</a><a href="javascript:;">'+f.splitText+"</a></li>"}else{e+="<li><a>"+this.label+"</a></li>"}});if(f.value.length>0){this._trigger("optionchanged",null,{key:"value",value:f.value,oldValue:[],isTransient:f.isTransient})}if(f.label){this.ul_element.append('<li data-role="list-divider"><a>'+f.label+"</a></li>")}this.ul_element.append(e);if(this.ul_element.listview){this.ul_element.listview();this.ul_element.data("mobileListview").refresh()}},_design:function(){var g=this,i=this.options,f=this.content;if(f.is(".ui-resizable")){c.resizable("destroy")}f.html("");var e=a("<ul />").addClass("codiqa-control ui-listview").appendTo(f);if(!i.label_theme){i.label_theme="c"}if(i.label){e.html('<li data-role="list-divider"><a>'+i.label+"</a></li>")}var h=a("<li />").addClass("ui-li ui-li-divider ui-bar-"+i.label_theme+" ui-first-child").html(i.label).appendTo(e);a.each(i.selectItems||[],function(p,j){button_li=a("<li class='ui-btn ui-btn-icon-right ui-li-has-arrow ui-li' />").appendTo(e);a('<div class="ui-btn-inner ui-li" />').html('<div class="ui-btn-text"><a class="ui-link-inherit" >'+this.label+'</a></div><span class="ui-icon ui-icon-arrow-r ui-icon-shadow"> </span>').appendTo(button_li);if(p==i.selectItems.length-1){button_li.addClass("ui-last-child")}if(i.isInset){e.addClass("ui-listview-inset ui-corner-all ui-shadow")}button_li.addClass("ui-btn-up-"+i.data_theme)})},destroy:function(){this.element.removeClass("an-listviewfield");return a.an.field.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.customhtmlfield",a.an.field,{_create:function(){a.an.field.prototype._create.apply(this,arguments);this.element.addClass("an-customhtmlfield")},_createControl:function(){var g=this,j=this.options,h=this.element;if(j.mobile){try{var f=this.element.find(".content").eq(0);var k="";k+=j.customhtml;f.html(k);this.element.context.lastElementChild.lastElementChild.className="customhtml";if(a(".customhtml").listview){a(".customhtml").listview()}}catch(i){}}},_createLabel:function(){this.element.find("label").remove()},_makeResizable:function(){},_browser:function(){},_edit:function(){},_design:function(){var e=this},destroy:function(){this.element.removeClass("an-customhtmlfield");return a.an.field.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function($,undefined){$.widget("an.mobilelistview",$.an.view,{options:{printable:false,pagerPosition:"bottom"},_create:function(){$.an.view.prototype._create.apply(this,arguments);var o=this.options,el=this.element;el.addClass("an-mobilelistbview");o.templateTemp=o.view.templateTemp;o.templateSelector=o.view.templateSelector;o.templateConverts=o.view.templateConverts;o.templateContent=o.view.templateContent;this.documents=$(o.templateContent).prependTo(el);if(o.templateTemp){o.templateTemp=$.templates(o.templateTemp)}if(o.templateConverts&&typeof o.templateConverts=="string"){o.templateConverts=eval("("+o.templateConverts+")");$.views.converters(o.templateConverts)}},_showDocuments:function(){var self=this,o=this.options,html="";if(o.templateTemp){html=o.templateTemp.render(self.docs);$(o.templateSelector,this.documents).html(html)}if($(o.templateSelector).listview){$(o.templateSelector).listview()}else{if(o.templateTemp){$(o.templateSelector,this.documents).attr("data-role","listview").mlist()}}if(o.templateConverts&&typeof o.templateConverts=="string"){o.templateConverts=eval("("+o.templateConverts+")");$.views.converters(o.templateConverts)}},_docsLoaded:function(){this.refresh()},_design:function(){this._showDocuments()},_browser:function(){this._showDocuments();if($(this.options.templateSelector).listview){$(this.options.templateSelector).listview("refresh")}},save:function(){var value={};$.extend(this.options.view.options,value);return $.an.view.prototype.save.apply(this,arguments)},print:function(){var o=this.options,loc=window.location,url=loc.protocol+"//"+loc.host+"/pdfs?dbid="+o.dbId+"&viewid="+o.view._id;print(url)},destroy:function(){this.element.unbind(".formview").removeClass("an-formview show-pager");$.an.view.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.mobiledatefield",a.an.inputfield,{options:{theme:"jqm",lang:"en",display:"bottom",mode:"scroller",dateFormat:"yy-mm-dd",dateOrder:"yy mmD dd",dateOrder:"yymmdd",minDate:"",maxDate:"",},_create:function(){a.an.inputfield.prototype._create.apply(this,arguments);this.element.addClass("an-mobiledatetimefield")},_edit:function(){var i,k,e=this,j=this.options;var g=new Date(),f=window.database.local,h={theme:j.theme,lang:j.lang,display:j.display,mode:j.mode,dateFormat:j.dateFormat,dateOrder:j.dateOrder,};i=j.minDate=="now"?g:new Date(j.minDate);i.toString()!="Invalid Date"&&(h.minDate=i);k=j.maxDate=="now"?g:new Date(j.maxDate);k.toString()!="Invalid Date"&&(h.maxDate=k);a.an.inputfield.prototype._edit.apply(this,arguments);h.onSelect=function(p){e.input.trigger("keyup")};this.input.mobiscroll().date(h)},destroy:function(){this.input.mobiscroll&&this.input.mobiscroll("destroy");this.input.removeAttr("readony");this.element.removeClass("an-mobiledatetimefield");return a.an.inputfield.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.swipewidget",a.an.widget,{options:{swipeContent:"<li>no content</li>",swipeIcon:'<b class="swipe-icon-active"></b>',swipeindex:0,swipeContent:"<li>no content</li>",swipeduration:false,swipeduration:2000,width:"100"},_create:function(){a.an.widget.prototype._create.apply(this,arguments);var i=this.options;if(i.mobile){var f=this;this.element.addClass("an-swipewidget");var h=a('<div class="swipeBox"></div>'),e=a('<ul class="swipeList c"></ul>'),g=a('<div class="iconList"></div>');e.append(i.swipeContent);e.find("li").each(function(k){var p="<b></b>";if(k==i.swipeindex){p='<b class="swipe-icon-active"></b>'}g.append(a(p))});e.width(i.width*e.find("li").length+"%");e.find("li").width(i.width/e.find("li").length+"%");h.append(e).append(g).appendTo(this.element.find(".content"));f.pos={};var j=f.pos;j.t=null;j.index=i.swipeindex;j.itemLen=e.find("li").length;j.itemWidth=e.find("li").eq(0).outerWidth(true);this.element.bind("touchstart.swipewidget",function(k){var k=k.originalEvent.touches[0];j.x=k.pageX;j.y=k.pageY;j.dx=0;j.dy=0;j.Left=e.offset().left;j.target=k.target.tagName.toLowerCase()=="li"?k.target:a(k.target).closest("li");j.index=e.find("li").index(a(j.target));j.itemWidth=a(j.target).outerWidth(true);clearTimeout(j.t);j.t=null});this.element.bind("touchmove.swipewidget",function(k){k.preventDefault();var k=k.originalEvent.touches[0];j.dx=k.pageX-j.x;j.dy=k.pageY-j.y;e.css({left:parseInt(j.dx+j.Left)+"px"})});this.element.bind("touchend.swipewidget",function(q){var k=0,p=0;if(j.index==0&&j.dx>0){k=0;p=0}else{if(j.index==j.itemLen-1&&j.dx<0){k=-j.itemWidth*j.index;p=j.index}else{if(Math.abs(j.dx)>=j.itemWidth/2){if(j.dx>0){k=-j.itemWidth*(j.index-1);p=j.index-1}else{if(j.dx<0){k=-j.itemWidth*(j.index+1);p=j.index+1}}}else{k=-j.itemWidth*(j.index);p=j.index}}}f._setActive(e,k,p);if(i.autoSwipe&&i.mode!="design"){j.t=setTimeout(function(){f.autoRun(e,k,p)},i.swipeduration)}})}},_setActive:function(h,e,g){var f=this;h.css({left:-g*100+"%"});setTimeout(function(){f.element.find(".iconList b").eq(g).addClass("swipe-icon-active").siblings().removeClass("swipe-icon-active")},100)},autoRun:function(h,e,g){var f=this,i=this.options,j=this.pos;if(g<=0||g>(j.itemLen-1)){g=0}e=-j.itemWidth*g;f._setActive(h,e,g);g++;j.index++;j.t=setTimeout(function(){f.autoRun(h,e,g)},i.swipeduration)},_browser:function(){var e=this.options;if(e.autoSwipe){this.autoRun(this.element.find(".swipeList"),0,0)}},_edit:function(){var e=this.options;if(e.autoSwipe){this.autoRun(this.element.find(".swipeList"),0,0)}},_design:function(){var e=this.options},destroy:function(){this.element.removeClass("an-swipewidget");this.element.unbind("swipewidget");this.content.remove();return a.an.widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.loading",{options:{trans:"0.6",fullscreen:false,msg:""},_create:function(){var f=this.options,e=this;this.wrap=a('<div class="loading" style="width:100%;height:100%;position:absolute;left:0;top:0;z-index:9997;vertical-align:middle;"><div style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:9998;background:#fff;"></div></div>');this.wrap.children().eq(0).css("opacity",f.trans);this.wrap.append(a('<span style="background:url(images/large-loading.gif) center center no-repeat;width:32px;height:32px;position:absolute;left:49%;top:49%;z-index:9999;padding-top:32px;">'+f.msg+"</span>"));if(!f.fullscreen){this.oldPos=this.element.css("postion");this.element.css("postion","relatvie").append(this.wrap)}else{this.wrap.css("position","fixed").appendTo(a("body"))}},open:function(){this.wrap&&this.wrap.show()},close:function(){this.wrap&&this.wrap.hide()},destroy:function(){if(this.oldPos){this.element.css("postion",this.oldPos)}this.wrap&&this.wrap.remove();delete this.pager;a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);window.CodeMirror=(function(){var bJ=/gecko\/\d/i.test(navigator.userAgent);var cA=/MSIE \d/.test(navigator.userAgent);var bG=cA&&(document.documentMode==null||document.documentMode<8);var bF=cA&&(document.documentMode==null||document.documentMode<9);var b9=/WebKit\//.test(navigator.userAgent);var cD=b9&&/Qt\/\d+\.\d+/.test(navigator.userAgent);var ch=/Chrome\//.test(navigator.userAgent);var dV=/Opera\//.test(navigator.userAgent);var al=/Apple Computer/.test(navigator.vendor);var aJ=/KHTML\//.test(navigator.userAgent);var bU=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent);var ce=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent);var dS=/PhantomJS/.test(navigator.userAgent);var du=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var cV=du||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var bs=du||/Mac/.test(navigator.platform);var au=/windows/i.test(navigator.platform);var c7=dV&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);if(c7){c7=Number(c7[1])}var bh=bs&&(cD||dV&&(c7==null||c7<12.11));var bY=bJ||(cA&&!bF);var ei=false,aG=false;function G(en,eo){if(!(this instanceof G)){return new G(en,eo)}this.options=eo=eo||{};for(var ep in dw){if(!eo.hasOwnProperty(ep)&&dw.hasOwnProperty(ep)){eo[ep]=dw[ep]}}bA(eo);var et=typeof eo.value=="string"?0:eo.value.first;var es=this.display=h(en,et);es.wrapper.CodeMirror=this;cR(this);if(eo.autofocus&&!cV){da(this)}this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,focused:false,suppressEdits:false,pasteIncoming:false,draggingText:false,highlight:new em()};b3(this);if(eo.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}var er=eo.value;if(typeof er=="string"){er=new af(eo.value,eo.mode)}ca(this,cQ)(this,er);if(cA){setTimeout(bP(dO,this,true),20)}d8(this);var eu;try{eu=(document.activeElement==es.input)}catch(eq){}if(eu||(eo.autofocus&&!cV)){setTimeout(bP(bT,this),20)}else{az(this)}ca(this,function(){for(var ew in aM){if(aM.propertyIsEnumerable(ew)){aM[ew](this,eo[ew],by)}}for(var ev=0;ev<aH.length;++ev){aH[ev](this)}})()}function h(en,ep){var eq={};var eo=eq.input=ed("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;");if(b9){eo.style.width="1000px"}else{eo.setAttribute("wrap","off")}if(du){eo.style.border="1px solid black"}eo.setAttribute("autocorrect","off");eo.setAttribute("autocapitalize","off");eo.setAttribute("spellcheck","false");eq.inputDiv=ed("div",[eo],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");eq.scrollbarH=ed("div",[ed("div",null,null,"height: 1px")],"CodeMirror-hscrollbar");eq.scrollbarV=ed("div",[ed("div",null,null,"width: 1px")],"CodeMirror-vscrollbar");eq.scrollbarFiller=ed("div",null,"CodeMirror-scrollbar-filler");eq.gutterFiller=ed("div",null,"CodeMirror-gutter-filler");eq.lineDiv=ed("div",null,"CodeMirror-code");eq.selectionDiv=ed("div",null,null,"position: relative; z-index: 1");eq.cursor=ed("div","\u00a0","CodeMirror-cursor");eq.otherCursor=ed("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor");eq.measure=ed("div",null,"CodeMirror-measure");eq.lineSpace=ed("div",[eq.measure,eq.selectionDiv,eq.lineDiv,eq.cursor,eq.otherCursor],null,"position: relative; outline: none");eq.mover=ed("div",[ed("div",[eq.lineSpace],"CodeMirror-lines")],null,"position: relative");eq.sizer=ed("div",[eq.mover],"CodeMirror-sizer");eq.heightForcer=ed("div",null,null,"position: absolute; height: "+aQ+"px; width: 1px;");eq.gutters=ed("div",null,"CodeMirror-gutters");eq.lineGutter=null;eq.scroller=ed("div",[eq.sizer,eq.heightForcer,eq.gutters],"CodeMirror-scroll");eq.scroller.setAttribute("tabIndex","-1");eq.wrapper=ed("div",[eq.inputDiv,eq.scrollbarH,eq.scrollbarV,eq.scrollbarFiller,eq.gutterFiller,eq.scroller],"CodeMirror");if(bG){eq.gutters.style.zIndex=-1;eq.scroller.style.paddingRight=0}if(en.appendChild){en.appendChild(eq.wrapper)}else{en(eq.wrapper)}if(du){eo.style.width="0px"}if(!b9){eq.scroller.draggable=true}if(aJ){eq.inputDiv.style.height="1px";eq.inputDiv.style.position="absolute"}else{if(bG){eq.scrollbarH.style.minWidth=eq.scrollbarV.style.minWidth="18px"}}eq.viewOffset=eq.lastSizeC=0;eq.showingFrom=eq.showingTo=ep;eq.lineNumWidth=eq.lineNumInnerWidth=eq.lineNumChars=null;eq.prevInput="";eq.alignWidgets=false;eq.pollingFast=false;eq.poll=new em();eq.cachedCharWidth=eq.cachedTextHeight=null;eq.measureLineCache=[];eq.measureLineCachePos=0;eq.inaccurateSelection=false;eq.maxLine=null;eq.maxLineLength=0;eq.maxLineChanged=false;eq.wheelDX=eq.wheelDY=eq.wheelStartX=eq.wheelStartY=null;return eq}function aZ(en){en.doc.mode=G.getMode(en.options,en.doc.modeOption);en.doc.iter(function(eo){if(eo.stateAfter){eo.stateAfter=null}if(eo.styles){eo.styles=null}});en.doc.frontier=en.doc.first;cU(en,100);en.state.modeGen++;if(en.curOp){V(en)}}function di(en){if(en.options.lineWrapping){en.display.wrapper.className+=" CodeMirror-wrap";en.display.sizer.style.minWidth=""}else{en.display.wrapper.className=en.display.wrapper.className.replace(" CodeMirror-wrap","");ef(en)}Q(en);V(en);Y(en);setTimeout(function(){ds(en)},100)}function aL(en){var ep=aB(en.display),eo=en.options.lineWrapping;var eq=eo&&Math.max(5,en.display.scroller.clientWidth/cy(en.display)-3);return function(er){if(dT(en.doc,er)){return 0}else{if(eo){return(Math.ceil(er.text.length/eq)||1)*ep}else{return ep}}}}function Q(en){var ep=en.doc,eo=aL(en);ep.iter(function(eq){var er=eo(eq);if(er!=eq.height){eg(eq,er)}})}function el(en){var ep=dA[en.options.keyMap],eo=ep.style;en.display.wrapper.className=en.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(eo?" cm-keymap-"+eo:"");en.state.disableInput=ep.disableInput}function b3(en){en.display.wrapper.className=en.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+en.options.theme.replace(/(^|\s)\s*/g," cm-s-");Y(en)}function ct(en){cR(en);V(en);setTimeout(function(){de(en)},20)}function cR(en){var eo=en.display.gutters,es=en.options.gutters;cK(eo);for(var ep=0;ep<es.length;++ep){var eq=es[ep];var er=eo.appendChild(ed("div",null,"CodeMirror-gutter "+eq));if(eq=="CodeMirror-linenumbers"){en.display.lineGutter=er;er.style.width=(en.display.lineNumWidth||1)+"px"}}eo.style.display=ep?"":"none"}function cZ(er,ep){if(ep.height==0){return 0}var eo=ep.text.length,en,es=ep;while(en=dl(es)){var eq=en.find();es=dD(er,eq.from.line);eo+=eq.from.ch-eq.to.ch}es=ep;while(en=c4(es)){var eq=en.find();eo-=es.text.length-eq.from.ch;es=dD(er,eq.to.line);eo+=es.text.length-eq.to.ch}return eo}function ef(en){var ep=en.display,eo=en.doc;ep.maxLine=dD(eo,eo.first);ep.maxLineLength=cZ(eo,ep.maxLine);ep.maxLineChanged=true;eo.iter(function(er){var eq=cZ(eo,er);if(eq>ep.maxLineLength){ep.maxLineLength=eq;ep.maxLine=er}})}function bA(en){var ep=false;for(var eo=0;eo<en.gutters.length;++eo){if(en.gutters[eo]=="CodeMirror-linenumbers"){if(en.lineNumbers){ep=true}else{en.gutters.splice(eo--,1)}}}if(!ep&&en.lineNumbers){en.gutters.push("CodeMirror-linenumbers")}}function ds(en){var et=en.display,eo=en.doc.height;var eq=eo+ba(et);et.sizer.style.minHeight=et.heightForcer.style.top=eq+"px";et.gutters.style.height=Math.max(eq,et.scroller.clientHeight-aQ)+"px";var er=Math.max(eq,et.scroller.scrollHeight);var es=et.scroller.scrollWidth>(et.scroller.clientWidth+1);var ep=er>(et.scroller.clientHeight+1);if(ep){et.scrollbarV.style.display="block";et.scrollbarV.style.bottom=es?k(et.measure)+"px":"0";et.scrollbarV.firstChild.style.height=(er-et.scroller.clientHeight+et.scrollbarV.clientHeight)+"px"}else{et.scrollbarV.style.display=""}if(es){et.scrollbarH.style.display="block";et.scrollbarH.style.right=ep?k(et.measure)+"px":"0";et.scrollbarH.firstChild.style.width=(et.scroller.scrollWidth-et.scroller.clientWidth+et.scrollbarH.clientWidth)+"px"}else{et.scrollbarH.style.display=""}if(es&&ep){et.scrollbarFiller.style.display="block";et.scrollbarFiller.style.height=et.scrollbarFiller.style.width=k(et.measure)+"px"}else{et.scrollbarFiller.style.display=""}if(es&&en.options.coverGutterNextToScrollbar&&en.options.fixedGutter){et.gutterFiller.style.display="block";et.gutterFiller.style.height=k(et.measure)+"px";et.gutterFiller.style.width=et.gutters.offsetWidth+"px"}else{et.gutterFiller.style.display=""}if(bU&&k(et.measure)===0){et.scrollbarV.style.minWidth=et.scrollbarH.style.minHeight=ce?"18px":"12px"}}function br(es,er,eq){var ep=es.scroller.scrollTop,en=es.wrapper.clientHeight;if(typeof eq=="number"){ep=eq}else{if(eq){ep=eq.top;en=eq.bottom-eq.top}}ep=Math.floor(ep-dy(es));var eo=Math.ceil(ep+en);return{from:a8(er,ep),to:a8(er,eo)}}function de(en){var et=en.display;if(!et.alignWidgets&&(!et.gutters.firstChild||!en.options.fixedGutter)){return}var eq=cJ(et)-et.scroller.scrollLeft+en.doc.scrollLeft;var es=et.gutters.offsetWidth,ep=eq+"px";for(var eu=et.lineDiv.firstChild;eu;eu=eu.nextSibling){if(eu.alignable){for(var er=0,eo=eu.alignable;er<eo.length;++er){eo[er].style.left=ep}}}if(en.options.fixedGutter){et.gutters.style.left=(eq+es)+"px"}}function cM(en){if(!en.options.lineNumbers){return false}var es=en.doc,eo=c2(en.options,es.first+es.size-1),er=en.display;if(eo.length!=er.lineNumChars){var et=er.measure.appendChild(ed("div",[ed("div",eo)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var ep=et.firstChild.offsetWidth,eq=et.offsetWidth-ep;er.lineGutter.style.width="";er.lineNumInnerWidth=Math.max(ep,er.lineGutter.offsetWidth-eq);er.lineNumWidth=er.lineNumInnerWidth+eq;er.lineNumChars=er.lineNumInnerWidth?eo.length:-1;er.lineGutter.style.width=er.lineNumWidth+"px";return true}return false}function c2(en,eo){return String(en.lineNumberFormatter(eo+en.firstLineNumber))}function cJ(en){return at(en.scroller).left-at(en.sizer).left}function cB(en,eq,er){var ep=en.display.showingFrom,et=en.display.showingTo,eo;var es=br(en.display,en.doc,er);for(;;){if(!ck(en,eq,es)){break}eo=true;a5(en);ds(en);if(er){er=Math.min(en.display.scroller.scrollHeight-en.display.scroller.clientHeight,typeof er=="number"?er:er.top)}es=br(en.display,en.doc,er);if(es.from>=en.display.showingFrom&&es.to<=en.display.showingTo){break}eq=[]}if(eo){T(en,"update",en);if(en.display.showingFrom!=ep||en.display.showingTo!=et){T(en,"viewportChange",en,en.display.showingFrom,en.display.showingTo)}}return eo}function ck(es,eL,eo){var eE=es.display,eM=es.doc;if(!eE.wrapper.clientWidth){eE.showingFrom=eE.showingTo=eM.first;eE.viewOffset=0;return}if(eL.length==0&&eo.from>eE.showingFrom&&eo.to<eE.showingTo){return}if(cM(es)){eL=[{from:eM.first,to:eM.first+eM.size}]}var eJ=eE.sizer.style.marginLeft=eE.gutters.offsetWidth+"px";eE.scrollbarH.style.left=es.options.fixedGutter?eJ:"0";var ep=Infinity;if(es.options.lineNumbers){for(var eF=0;eF<eL.length;++eF){if(eL[eF].diff){ep=eL[eF].from;break}}}var eq=eM.first+eM.size;var eD=Math.max(eo.from-es.options.viewportMargin,eM.first);var en=Math.min(eq,eo.to+es.options.viewportMargin);if(eE.showingFrom<eD&&eD-eE.showingFrom<20){eD=Math.max(eM.first,eE.showingFrom)}if(eE.showingTo>en&&eE.showingTo-en<20){en=Math.min(eq,eE.showingTo)}if(aG){eD=bf(A(eM,dD(eM,eD)));while(en<eq&&dT(eM,dD(eM,en))){++en}}var eH=[{from:Math.max(eE.showingFrom,eM.first),to:Math.min(eE.showingTo,eq)}];if(eH[0].from>=eH[0].to){eH=[]}else{eH=dN(eH,eL)}if(aG){for(var eF=0;eF<eH.length;++eF){var ex=eH[eF],eI;while(eI=c4(dD(eM,ex.to-1))){var eK=eI.find().from.line;if(eK>ex.from){ex.to=eK}else{eH.splice(eF--,1);break}}}}var eA=0;for(var eF=0;eF<eH.length;++eF){var ex=eH[eF];if(ex.from<eD){ex.from=eD}if(ex.to>en){ex.to=en}if(ex.from>=ex.to){eH.splice(eF--,1)}else{eA+=ex.to-ex.from}}if(eA==en-eD&&eD==eE.showingFrom&&en==eE.showingTo){j(es);return}eH.sort(function(eO,eN){return eO.from-eN.from});try{var et=document.activeElement}catch(eG){}if(eA<(en-eD)*0.7){eE.lineDiv.style.display="none"}bH(es,eD,en,eH,ep);eE.lineDiv.style.display="";if(et&&document.activeElement!=et&&et.offsetHeight){et.focus()}var ey=eD!=eE.showingFrom||en!=eE.showingTo||eE.lastSizeC!=eE.wrapper.clientHeight;if(ey){eE.lastSizeC=eE.wrapper.clientHeight;cU(es,400)}eE.showingFrom=eD;eE.showingTo=en;var er=eE.lineDiv.offsetTop;for(var eC=eE.lineDiv.firstChild,ez;eC;eC=eC.nextSibling){if(eC.lineObj){if(bG){var ew=eC.offsetTop+eC.offsetHeight;ez=ew-er;er=ew}else{var eu=at(eC);ez=eu.bottom-eu.top}var ev=eC.lineObj.height-ez;if(ez<2){ez=aB(eE)}if(ev>0.001||ev<-0.001){eg(eC.lineObj,ez);var eB=eC.lineObj.widgets;if(eB){for(var eF=0;eF<eB.length;++eF){eB[eF].height=eB[eF].node.offsetHeight}}}}}j(es);return true}function j(en){var eo=en.display.viewOffset=be(en,dD(en.doc,en.display.showingFrom));en.display.mover.style.top=eo+"px"}function dN(ew,eu){for(var er=0,ep=eu.length||0;er<ep;++er){var et=eu[er],en=[],ev=et.diff||0;for(var eq=0,eo=ew.length;eq<eo;++eq){var es=ew[eq];if(et.to<=es.from&&et.diff){en.push({from:es.from+ev,to:es.to+ev})}else{if(et.to<=es.from||et.from>=es.to){en.push(es)}else{if(et.from>es.from){en.push({from:es.from,to:et.from})}if(et.to<es.to){en.push({from:et.to+ev,to:es.to+ev})}}}}ew=en}return ew}function dB(en){var er=en.display,eq={},ep={};for(var es=er.gutters.firstChild,eo=0;es;es=es.nextSibling,++eo){eq[en.options.gutters[eo]]=es.offsetLeft;ep[en.options.gutters[eo]]=es.offsetWidth}return{fixedPos:cJ(er),gutterTotalWidth:er.gutters.offsetWidth,gutterLeft:eq,gutterWidth:ep,wrapperWidth:er.wrapper.clientWidth}}function bH(ew,et,eu,ez,eo){var ev=dB(ew);var es=ew.display,ey=ew.options.lineNumbers;if(!ez.length&&(!b9||!ew.display.currentWheelTarget)){cK(es.lineDiv)}var en=es.lineDiv,ex=en.firstChild;function er(eB){var eA=eB.nextSibling;if(b9&&bs&&ew.display.currentWheelTarget==eB){eB.style.display="none";eB.lineObj=null}else{eB.parentNode.removeChild(eB)}return eA}var ep=ez.shift(),eq=et;ew.doc.iter(et,eu,function(eJ){if(ep&&ep.to==eq){ep=ez.shift()}if(dT(ew.doc,eJ)){if(eJ.height!=0){eg(eJ,0)}if(eJ.widgets&&ex.previousSibling){for(var eE=0;eE<eJ.widgets.length;++eE){var eG=eJ.widgets[eE];if(eG.showIfHidden){var eC=ex.previousSibling;if(/pre/i.test(eC.nodeName)){var eB=ed("div",null,null,"position: relative");eC.parentNode.replaceChild(eB,eC);eB.appendChild(eC);eC=eB}var eH=eC.appendChild(ed("div",[eG.node],"CodeMirror-linewidget"));if(!eG.handleMouseEvents){eH.ignoreEvents=true}a7(eG,eH,eC,ev)}}}}else{if(ep&&ep.from<=eq&&ep.to>eq){while(ex.lineObj!=eJ){ex=er(ex)}if(ey&&eo<=eq&&ex.lineNumber){t(ex.lineNumber,c2(ew.options,eq))}ex=ex.nextSibling}else{if(eJ.widgets){for(var eD=0,eI=ex,eF;eI&&eD<20;++eD,eI=eI.nextSibling){if(eI.lineObj==eJ&&/div/i.test(eI.nodeName)){eF=eI;break}}}var eA=an(ew,eJ,eq,ev,eF);if(eA!=eF){en.insertBefore(eA,ex)}else{while(ex!=eF){ex=er(ex)}ex=ex.nextSibling}eA.lineObj=eJ}}++eq});while(ex){ex=er(ex)}}function an(es,eu,ev,ey,eo){var eE=cE(es,eu);var eH=eu.gutterMarkers,eF=es.display,et;if(!es.options.lineNumbers&&!eH&&!eu.bgClass&&!eu.wrapClass&&!eu.widgets){return eE}if(eo){eo.alignable=null;var eI=true,eq=0,ep=null;for(var eA=eo.firstChild,ez;eA;eA=ez){ez=eA.nextSibling;if(!/\bCodeMirror-linewidget\b/.test(eA.className)){eo.removeChild(eA)}else{for(var eG=0;eG<eu.widgets.length;++eG){var er=eu.widgets[eG];if(er.node==eA.firstChild){if(!er.above&&!ep){ep=eA}a7(er,eA,eo,ey);++eq;break}}if(eG==eu.widgets.length){eI=false;break}}}eo.insertBefore(eE,ep);if(eI&&eq==eu.widgets.length){et=eo;eo.className=eu.wrapClass||""}}if(!et){et=ed("div",null,eu.wrapClass,"position: relative");et.appendChild(eE)}if(eu.bgClass){et.insertBefore(ed("div",null,eu.bgClass+" CodeMirror-linebackground"),et.firstChild)}if(es.options.lineNumbers||eH){var eC=et.insertBefore(ed("div",null,null,"position: absolute; left: "+(es.options.fixedGutter?ey.fixedPos:-ey.gutterTotalWidth)+"px"),et.firstChild);if(es.options.fixedGutter){(et.alignable||(et.alignable=[])).push(eC)}if(es.options.lineNumbers&&(!eH||!eH["CodeMirror-linenumbers"])){et.lineNumber=eC.appendChild(ed("div",c2(es.options,ev),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+ey.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+eF.lineNumInnerWidth+"px"))}if(eH){for(var eD=0;eD<es.options.gutters.length;++eD){var ex=es.options.gutters[eD],ew=eH.hasOwnProperty(ex)&&eH[ex];if(ew){eC.appendChild(ed("div",[ew],"CodeMirror-gutter-elt","left: "+ey.gutterLeft[ex]+"px; width: "+ey.gutterWidth[ex]+"px"))}}}}if(bG){et.style.zIndex=2}if(eu.widgets&&et!=eo){for(var eG=0,en=eu.widgets;eG<en.length;++eG){var er=en[eG],eB=ed("div",[er.node],"CodeMirror-linewidget");if(!er.handleMouseEvents){eB.ignoreEvents=true}a7(er,eB,et,ey);if(er.above){et.insertBefore(eB,es.options.lineNumbers&&eu.height!=0?eC:eE)}else{et.appendChild(eB)}T(er,"redraw")}}return et}function a7(eq,ep,eo,er){if(eq.noHScroll){(eo.alignable||(eo.alignable=[])).push(ep);var en=er.wrapperWidth;ep.style.left=er.fixedPos+"px";if(!eq.coverGutter){en-=er.gutterTotalWidth;ep.style.paddingLeft=er.gutterTotalWidth+"px"}ep.style.width=en+"px"}if(eq.coverGutter){ep.style.zIndex=5;ep.style.position="relative";if(!eq.noHScroll){ep.style.marginLeft=-er.gutterTotalWidth+"px"}}}function a5(en){var eq=en.display;var er=d2(en.doc.sel.from,en.doc.sel.to);if(er||en.options.showCursorWhenSelecting){H(en)}else{eq.cursor.style.display=eq.otherCursor.style.display="none"}if(!er){aa(en)}else{eq.selectionDiv.style.display="none"}if(en.options.moveInputWithCursor){var es=cH(en,en.doc.sel.head,"div");var eo=at(eq.wrapper),ep=at(eq.lineDiv);eq.inputDiv.style.top=Math.max(0,Math.min(eq.wrapper.clientHeight-10,es.top+ep.top-eo.top))+"px";eq.inputDiv.style.left=Math.max(0,Math.min(eq.wrapper.clientWidth-10,es.left+ep.left-eo.left))+"px"}}function H(en){var eo=en.display,ep=cH(en,en.doc.sel.head,"div");eo.cursor.style.left=ep.left+"px";eo.cursor.style.top=ep.top+"px";eo.cursor.style.height=Math.max(0,ep.bottom-ep.top)*en.options.cursorHeight+"px";eo.cursor.style.display="";if(ep.other){eo.otherCursor.style.display="";eo.otherCursor.style.left=ep.other.left+"px";eo.otherCursor.style.top=ep.other.top+"px";eo.otherCursor.style.height=(ep.other.bottom-ep.other.top)*0.85+"px"}else{eo.otherCursor.style.display="none"}}function aa(ey){var et=ey.display,ex=ey.doc,en=ey.doc.sel;var er=document.createDocumentFragment();var ew=et.lineSpace.offsetWidth,ep=aA(ey.display);function eA(eE,eD,eC,eB){if(eD<0){eD=0}er.appendChild(ed("div",null,"CodeMirror-selected","position: absolute; left: "+eE+"px; top: "+eD+"px; width: "+(eC==null?ew-eE:eC)+"px; height: "+(eB-eD)+"px"))}function ev(eC,eE,eH){var eD=dD(ex,eC);var eF=eD.text.length;var eI,eB;function eG(eK,eJ){return b0(ey,P(eC,eK),"div",eD,eJ)}cL(a(eD),eE||0,eH==null?eF:eH,function(eQ,eP,eJ){var eM=eG(eQ,"left"),eN,eO,eL;if(eQ==eP){eN=eM;eO=eL=eM.left}else{eN=eG(eP-1,"right");if(eJ=="rtl"){var eK=eM;eM=eN;eN=eK}eO=eM.left;eL=eN.right}if(eE==null&&eQ==0){eO=ep}if(eN.top-eM.top>3){eA(eO,eM.top,null,eM.bottom);eO=ep;if(eM.bottom<eN.top){eA(eO,eM.bottom,null,eN.top)}}if(eH==null&&eP==eF){eL=ew}if(!eI||eM.top<eI.top||eM.top==eI.top&&eM.left<eI.left){eI=eM}if(!eB||eN.bottom>eB.bottom||eN.bottom==eB.bottom&&eN.right>eB.right){eB=eN}if(eO<ep+1){eO=ep}eA(eO,eN.top,eL-eO,eN.bottom)});return{start:eI,end:eB}}if(en.from.line==en.to.line){ev(en.from.line,en.from.ch,en.to.ch)}else{var eq=dD(ex,en.from.line),eo=dD(ex,en.to.line);var es=A(ex,eq)==A(ex,eo);var ez=ev(en.from.line,en.from.ch,es?eq.text.length:null).end;var eu=ev(en.to.line,es?0:null,en.to.ch).start;if(es){if(ez.top<eu.top-2){eA(ez.right,ez.top,null,ez.bottom);eA(ep,eu.top,eu.left,eu.bottom)}else{eA(ez.right,ez.top,eu.left-ez.right,ez.bottom)}}if(ez.bottom<eu.top){eA(ep,ez.bottom,null,eu.top)}}bj(et.selectionDiv,er);et.selectionDiv.style.display=""}function r(en){if(!en.state.focused){return}var ep=en.display;clearInterval(ep.blinker);var eo=true;ep.cursor.style.visibility=ep.otherCursor.style.visibility="";ep.blinker=setInterval(function(){ep.cursor.style.visibility=ep.otherCursor.style.visibility=(eo=!eo)?"":"hidden"},en.options.cursorBlinkRate)}function cU(en,eo){if(en.doc.mode.startState&&en.doc.frontier<en.display.showingTo){en.state.highlight.set(eo,bP(b4,en))}}function b4(en){var eq=en.doc;if(eq.frontier<eq.first){eq.frontier=eq.first}if(eq.frontier>=en.display.showingTo){return}var eo=+new Date+en.options.workTime;var ep=bq(eq.mode,cw(en,eq.frontier));var es=[],er;eq.iter(eq.frontier,Math.min(eq.first+eq.size,en.display.showingTo+500),function(et){if(eq.frontier>=en.display.showingFrom){var ev=et.styles;et.styles=dY(en,et,ep);var ew=!ev||ev.length!=et.styles.length;for(var eu=0;!ew&&eu<ev.length;++eu){ew=ev[eu]!=et.styles[eu]}if(ew){if(er&&er.end==eq.frontier){er.end++}else{es.push(er={start:eq.frontier,end:eq.frontier+1})}}et.stateAfter=bq(eq.mode,ep)}else{cu(en,et,ep);et.stateAfter=eq.frontier%5==0?bq(eq.mode,ep):null}++eq.frontier;if(+new Date>eo){cU(en,en.options.workDelay);return true}});if(es.length){ca(en,function(){for(var et=0;et<es.length;++et){V(this,es[et].start,es[et].end)}})()}}function bR(et,en,eq){var eo,er,es=et.doc;for(var ew=en,ep=en-100;ew>ep;--ew){if(ew<=es.first){return es.first}var ev=dD(es,ew-1);if(ev.stateAfter&&(!eq||ew<=es.frontier)){return ew}var eu=bi(ev.text,null,et.options.tabSize);if(er==null||eo>eu){er=ew-1;eo=eu}}return er}function cw(en,et,eo){var er=en.doc,eq=en.display;if(!er.mode.startState){return true}var es=bR(en,et,eo),ep=es>er.first&&dD(er,es-1).stateAfter;if(!ep){ep=bp(er.mode)}else{ep=bq(er.mode,ep)}er.iter(es,et,function(eu){cu(en,eu,ep);var ev=es==et-1||es%5==0||es>=eq.showingFrom&&es<eq.showingTo;eu.stateAfter=ev?bq(er.mode,ep):null;++es});return ep}function dy(en){return en.lineSpace.offsetTop}function ba(en){return en.mover.offsetHeight-en.lineSpace.offsetHeight}function aA(eo){var en=bj(eo.measure,ed("pre",null,null,"text-align: left")).appendChild(ed("span","x"));return en.offsetLeft}function cW(en,eo,er,et,ep){var eq=-1;et=et||bb(en,eo);for(var eu=er;;eu+=eq){var es=et[eu];if(es){break}if(eq<0&&eu==0){eq=1}}ep=eu>er?"left":eu<er?"right":ep;if(ep=="left"&&es.leftSide){es=es.leftSide}else{if(ep=="right"&&es.rightSide){es=es.rightSide}}return{left:eu<er?es.right:es.left,right:eu>er?es.left:es.right,top:es.top,bottom:es.bottom}}function dx(en,eo){var eq=en.display.measureLineCache;for(var er=0;er<eq.length;++er){var ep=eq[er];if(ep.text==eo.text&&ep.markedSpans==eo.markedSpans&&en.display.scroller.clientWidth==ep.width&&ep.classes==eo.textClass+"|"+eo.bgClass+"|"+eo.wrapClass){return ep}}}function d6(en,eo){var ep=dx(en,eo);if(ep){ep.text=ep.measure=ep.markedSpans=null}}function bb(en,eo){var es=dx(en,eo);if(es){return es.measure}var er=cj(en,eo);var eq=en.display.measureLineCache;var ep={text:eo.text,width:en.display.scroller.clientWidth,markedSpans:eo.markedSpans,measure:er,classes:eo.textClass+"|"+eo.bgClass+"|"+eo.wrapClass};if(eq.length==16){eq[++en.display.measureLineCachePos%16]=ep}else{eq.push(ep)}return er}function cj(eu,ew){var eC=eu.display,es=Z(ew.text.length);var ez=cE(eu,ew,es);if(cA&&!bG&&!eu.options.lineWrapping&&ez.childNodes.length>100){var ep=document.createDocumentFragment();var ex=10,eA=ez.childNodes.length;for(var eE=0,ey=Math.ceil(eA/ex);eE<ey;++eE){var ev=ed("div",null,null,"display: inline-block");for(var eD=0;eD<ex&&eA;++eD){ev.appendChild(ez.firstChild);--eA}ep.appendChild(ev)}ez.appendChild(ep)}bj(eC.measure,ez);var eo=at(eC.lineDiv);var en=[],eH=Z(ew.text.length),eG=ez.offsetHeight;if(bF&&eC.measure.first!=ez){bj(eC.measure,ez)}function eF(eK){var eM=eK.top-eo.top,eO=eK.bottom-eo.top;if(eO>eG){eO=eG}if(eM<0){eM=0}for(var eJ=en.length-2;eJ>=0;eJ-=2){var eL=en[eJ],eN=en[eJ+1];if(eL>eO||eN<eM){continue}if(eL<=eM&&eN>=eO||eM<=eL&&eO>=eN||Math.min(eO,eN)-Math.max(eM,eL)>=(eO-eM)>>1){en[eJ]=Math.min(eM,eL);en[eJ+1]=Math.max(eO,eN);break}}if(eJ<0){eJ=en.length;en.push(eM,eO)}return{left:eK.left-eo.left,right:eK.right-eo.left,top:eJ,bottom:null}}function eI(eJ){eJ.bottom=en[eJ.top+1];eJ.top=en[eJ.top]}for(var eE=0,er;eE<es.length;++eE){if(er=es[eE]){var eB=er,eq=null;if(/\bCodeMirror-widget\b/.test(er.className)&&er.getClientRects){if(er.firstChild.nodeType==1){eB=er.firstChild}var et=eB.getClientRects();if(et.length>1){eq=eH[eE]=eF(et[0]);eq.rightSide=eF(et[et.length-1])}}if(!eq){eq=eH[eE]=eF(at(eB))}if(er.measureRight){eq.right=at(er.measureRight).left}if(er.leftSide){eq.leftSide=eF(at(er.leftSide))}}}for(var eE=0,er;eE<eH.length;++eE){if(er=eH[eE]){eI(er);if(er.leftSide){eI(er.leftSide)}if(er.rightSide){eI(er.rightSide)}}}return eH}function df(en,ep){var eu=false;if(ep.markedSpans){for(var eq=0;eq<ep.markedSpans;++eq){var es=ep.markedSpans[eq];if(es.collapsed&&(es.to==null||es.to==ep.text.length)){eu=true}}}var er=!eu&&dx(en,ep);if(er){return cW(en,ep,ep.text.length,er.measure,"right").right}var et=cE(en,ep);var eo=et.appendChild(aW(en.display.measure));bj(en.display.measure,et);return at(eo).right-at(en.display.lineDiv).left}function Y(en){en.display.measureLineCache.length=en.display.measureLineCachePos=0;en.display.cachedCharWidth=en.display.cachedTextHeight=null;if(!en.options.lineWrapping){en.display.maxLineChanged=true}en.display.lineNumChars=null}function bO(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function bN(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function dm(et,eq,es,eo){if(eq.widgets){for(var ep=0;ep<eq.widgets.length;++ep){if(eq.widgets[ep].above){var ev=b7(eq.widgets[ep]);es.top+=ev;es.bottom+=ev}}}if(eo=="line"){return es}if(!eo){eo="local"}var er=be(et,eq);if(eo=="local"){er+=dy(et.display)}else{er-=et.display.viewOffset}if(eo=="page"||eo=="window"){var en=at(et.display.lineSpace);er+=en.top+(eo=="window"?0:bN());var eu=en.left+(eo=="window"?0:bO());es.left+=eu;es.right+=eu}es.top+=er;es.bottom+=er;return es}function ek(eo,er,ep){if(ep=="div"){return er}var et=er.left,es=er.top;if(ep=="page"){et-=bO();es-=bN()}else{if(ep=="local"||!ep){var eq=at(eo.display.sizer);et+=eq.left;es+=eq.top}}var en=at(eo.display.lineSpace);return{left:et-en.left,top:es-en.top}}function b0(en,er,eq,ep,eo){if(!ep){ep=dD(en.doc,er.line)}return dm(en,ep,cW(en,ep,er.ch,null,eo),eq)}function cH(ew,ev,ep,eu,es){eu=eu||dD(ew.doc,ev.line);if(!es){es=bb(ew,eu)}function er(eA,ez){var ey=cW(ew,eu,eA,es,ez?"right":"left");if(ez){ey.left=ey.right}else{ey.right=ey.left}return dm(ew,eu,ey,ep)}function ex(eB,ey){var ez=et[ey],eA=ez.level%2;if(eB==cv(ez)&&ey&&ez.level<et[ey-1].level){ez=et[--ey];eB=ej(ez)-(ez.level%2?0:1);eA=true}else{if(eB==ej(ez)&&ey<et.length-1&&ez.level<et[ey+1].level){ez=et[++ey];eB=cv(ez)-ez.level%2;eA=false}}if(eA&&eB==ez.to&&eB>ez.from){return er(eB-1)}return er(eB,eA)}var et=a(eu),en=ev.ch;if(!et){return er(en)}var eo=ao(et,en);var eq=ex(en,eo);if(dv!=null){eq.other=ex(en,dv)}return eq}function ec(en,eo,ep,er){var eq=new P(en,eo);eq.xRel=er;if(ep){eq.outside=true}return eq}function d7(eu,er,eq){var et=eu.doc;eq+=eu.display.viewOffset;if(eq<0){return ec(et.first,0,true,-1)}var eo=a8(et,eq),ev=et.first+et.size-1;if(eo>ev){return ec(et.first+et.size-1,dD(et,ev).text.length,true,1)}if(er<0){er=0}for(;;){var ep=dD(et,eo);var ew=b8(eu,ep,eo,er,eq);var es=c4(ep);var en=es&&es.find();if(es&&(ew.ch>en.from.ch||ew.ch==en.from.ch&&ew.xRel>0)){eo=en.to.line}else{return ew}}}function b8(ex,ep,eA,ez,ey){var ew=ey-be(ex,ep);var et=false,eG=2*ex.display.wrapper.clientWidth;var eF=bb(ex,ep);function eK(eM){var eN=cH(ex,P(eA,eM),"line",ep,eF);et=true;if(ew>eN.bottom){return eN.left-eG}else{if(ew<eN.top){return eN.left+eG}else{et=false}}return eN.left}var eC=a(ep),eE=ep.text.length;var eH=bV(ep),eq=b5(ep);var eD=eK(eH),en=et,eo=eK(eq),es=et;if(ez>eo){return ec(eA,eq,es,1)}for(;;){if(eC?eq==eH||eq==w(ep,eH,1):eq-eH<=1){var eB=ez<eD||ez-eD<=eo-ez?eH:eq;var eJ=ez-(eB==eH?eD:eo);while(dP.test(ep.text.charAt(eB))){++eB}var ev=ec(eA,eB,eB==eH?en:es,eJ<0?-1:eJ?1:0);return ev}var eu=Math.ceil(eE/2),eL=eH+eu;if(eC){eL=eH;for(var eI=0;eI<eu;++eI){eL=w(ep,eL,1)}}var er=eK(eL);if(er>ez){eq=eL;eo=er;if(es=et){eo+=1000}eE=eu}else{eH=eL;eD=er;en=et;eE-=eu}}}var ap;function aB(ep){if(ep.cachedTextHeight!=null){return ep.cachedTextHeight}if(ap==null){ap=ed("pre");for(var eo=0;eo<49;++eo){ap.appendChild(document.createTextNode("x"));ap.appendChild(ed("br"))}ap.appendChild(document.createTextNode("x"))}bj(ep.measure,ap);var en=ap.offsetHeight/50;if(en>3){ep.cachedTextHeight=en}cK(ep.measure);return en||1}function cy(eq){if(eq.cachedCharWidth!=null){return eq.cachedCharWidth}var en=ed("span","x");var ep=ed("pre",[en]);bj(eq.measure,ep);var eo=en.offsetWidth;if(eo>2){eq.cachedCharWidth=eo}return eo||10}var cO=0;function bZ(en){en.curOp={changes:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:false,cursorActivity:false,updateMaxLine:false,updateScrollPos:false,id:++cO};if(!bM++){aV=[]}}function ab(ez){var eu=ez.curOp,ey=ez.doc,ev=ez.display;ez.curOp=null;if(eu.updateMaxLine){ef(ez)}if(ev.maxLineChanged&&!ez.options.lineWrapping&&ev.maxLine){var eo=df(ez,ev.maxLine);ev.sizer.style.minWidth=Math.max(0,eo+3+aQ)+"px";ev.maxLineChanged=false;var ew=Math.max(0,ev.sizer.offsetLeft+ev.sizer.offsetWidth-ev.scroller.clientWidth);if(ew<ey.scrollLeft&&!eu.updateScrollPos){a6(ez,Math.min(ev.scroller.scrollLeft,ew),true)}}var ep,es;if(eu.updateScrollPos){ep=eu.updateScrollPos}else{if(eu.selectionChanged&&ev.scroller.clientHeight){var ex=cH(ez,ey.sel.head);ep=F(ez,ex.left,ex.top,ex.left,ex.bottom)}}if(eu.changes.length||ep&&ep.scrollTop!=null){es=cB(ez,eu.changes,ep&&ep.scrollTop);if(ez.display.scroller.offsetHeight){ez.doc.scrollTop=ez.display.scroller.scrollTop}}if(!es&&eu.selectionChanged){a5(ez)}if(eu.updateScrollPos){ev.scroller.scrollTop=ev.scrollbarV.scrollTop=ey.scrollTop=ep.scrollTop;ev.scroller.scrollLeft=ev.scrollbarH.scrollLeft=ey.scrollLeft=ep.scrollLeft;de(ez);if(eu.scrollToPos){C(ez,d3(ez.doc,eu.scrollToPos),eu.scrollToPosMargin)}}else{if(ep){aj(ez)}}if(eu.selectionChanged){r(ez)}if(ez.state.focused&&eu.updateInput){dO(ez,eu.userSelChange)}var et=eu.maybeHiddenMarkers,en=eu.maybeUnhiddenMarkers;if(et){for(var er=0;er<et.length;++er){if(!et[er].lines.length){am(et[er],"hide")}}}if(en){for(var er=0;er<en.length;++er){if(en[er].lines.length){am(en[er],"unhide")}}}var eq;if(!--bM){eq=aV;aV=null}if(eu.textChanged){am(ez,"change",ez,eu.textChanged)}if(eu.cursorActivity){am(ez,"cursorActivity",ez)}if(eq){for(var er=0;er<eq.length;++er){eq[er]()}}}function ca(en,eo){return function(){var eq=en||this,er=!eq.curOp;if(er){bZ(eq)}try{var ep=eo.apply(eq,arguments)}finally{if(er){ab(eq)}}return ep}}function dX(en){return function(){var ep=this.cm&&!this.cm.curOp,eo;if(ep){bZ(this.cm)}try{eo=en.apply(this,arguments)}finally{if(ep){ab(this.cm)}}return eo}}function b2(eo,eq){var ep=!eo.curOp,en;if(ep){bZ(eo)}try{en=eq()}finally{if(ep){ab(eo)}}return en}function V(en,eq,ep,eo){if(eq==null){eq=en.doc.first}if(ep==null){ep=en.doc.first+en.doc.size}en.curOp.changes.push({from:eq,to:ep,diff:eo})}function aU(en){if(en.display.pollingFast){return}en.display.poll.set(en.options.pollInterval,function(){bC(en);if(en.state.focused){aU(en)}})}function B(en){var eo=false;en.display.pollingFast=true;function ep(){var eq=bC(en);if(!eq&&!eo){eo=true;en.display.poll.set(60,ep)}else{en.display.pollingFast=false;aU(en)}}en.display.poll.set(20,ep)}function bC(ey){var et=ey.display.input,eq=ey.display.prevInput,ex=ey.doc,en=ex.sel;if(!ey.state.focused||a0(et)||X(ey)||ey.state.disableInput){return false}var ez=et.value;if(ez==eq&&d2(en.from,en.to)){return false}if(cA&&!bF&&ey.display.inputHasSelection===ez){dO(ey,true);return false}var ep=!ey.curOp;if(ep){bZ(ey)}en.shift=false;var es=0,eo=Math.min(eq.length,ez.length);while(es<eo&&eq.charCodeAt(es)==ez.charCodeAt(es)){++es}var ew=en.from,ev=en.to;if(es<eq.length){ew=P(ew.line,ew.ch-(eq.length-es))}else{if(ey.state.overwrite&&d2(ew,ev)&&!ey.state.pasteIncoming){ev=P(ev.line,Math.min(dD(ex,ev.line).text.length,ev.ch+(ez.length-es)))}}var er=ey.curOp.updateInput;var eu={from:ew,to:ev,text:aD(ez.slice(es)),origin:ey.state.pasteIncoming?"paste":"+input"};aN(ey.doc,eu,"end");ey.curOp.updateInput=er;T(ey,"inputRead",ey,eu);if(ez.length>1000||ez.indexOf("\n")>-1){et.value=ey.display.prevInput=""}else{ey.display.prevInput=ez}if(ep){ab(ey)}ey.state.pasteIncoming=false;return true}function dO(en,ep){var eo,eq,es=en.doc;if(!d2(es.sel.from,es.sel.to)){en.display.prevInput="";eo=cg&&(es.sel.to.line-es.sel.from.line>100||(eq=en.getSelection()).length>1000);var er=eo?"-":eq||en.getSelection();en.display.input.value=er;if(en.state.focused){cC(en.display.input)}if(cA&&!bF){en.display.inputHasSelection=er}}else{if(ep){en.display.prevInput=en.display.input.value="";if(cA&&!bF){en.display.inputHasSelection=null}}}en.display.inaccurateSelection=eo}function da(en){if(en.options.readOnly!="nocursor"&&(!cV||document.activeElement!=en.display.input)){en.display.input.focus()}}function X(en){return en.options.readOnly||en.doc.cantEdit}function d8(eo){var et=eo.display;bn(et.scroller,"mousedown",ca(eo,c3));if(cA){bn(et.scroller,"dblclick",ca(eo,function(ew){if(ax(eo,ew)){return}var ex=bI(eo,ew);if(!ex||q(eo,ew)||aI(eo.display,ew)){return}bW(ew);var ev=ag(dD(eo.doc,ex.line).text,ex);ea(eo.doc,ev.from,ev.to)}))}else{bn(et.scroller,"dblclick",function(ev){ax(eo,ev)||bW(ev)})}bn(et.lineSpace,"selectstart",function(ev){if(!aI(et,ev)){bW(ev)}});if(!bY){bn(et.scroller,"contextmenu",function(ev){ai(eo,ev)})}bn(et.scroller,"scroll",function(){if(et.scroller.clientHeight){K(eo,et.scroller.scrollTop);a6(eo,et.scroller.scrollLeft,true);am(eo,"scroll",eo)}});bn(et.scrollbarV,"scroll",function(){if(et.scroller.clientHeight){K(eo,et.scrollbarV.scrollTop)}});bn(et.scrollbarH,"scroll",function(){if(et.scroller.clientHeight){a6(eo,et.scrollbarH.scrollLeft)}});bn(et.scroller,"mousewheel",function(ev){b(eo,ev)});bn(et.scroller,"DOMMouseScroll",function(ev){b(eo,ev)});function eu(){if(eo.state.focused){setTimeout(bP(da,eo),0)}}bn(et.scrollbarH,"mousedown",eu);bn(et.scrollbarV,"mousedown",eu);bn(et.wrapper,"scroll",function(){et.wrapper.scrollTop=et.wrapper.scrollLeft=0});var en;function er(){if(en==null){en=setTimeout(function(){en=null;et.cachedCharWidth=et.cachedTextHeight=c5=null;Y(eo);b2(eo,bP(V,eo))},100)}}bn(window,"resize",er);function eq(){for(var ev=et.wrapper.parentNode;ev&&ev!=document.body;ev=ev.parentNode){}if(ev){setTimeout(eq,5000)}else{cT(window,"resize",er)}}setTimeout(eq,5000);bn(et.input,"keyup",ca(eo,function(ev){if(ax(eo,ev)||eo.options.onKeyEvent&&eo.options.onKeyEvent(eo,ad(ev))){return}if(ev.keyCode==16){eo.doc.sel.shift=false}}));bn(et.input,"input",bP(B,eo));bn(et.input,"keydown",ca(eo,s));bn(et.input,"keypress",ca(eo,bQ));bn(et.input,"focus",bP(bT,eo));bn(et.input,"blur",bP(az,eo));function ep(ev){if(ax(eo,ev)||eo.options.onDragEvent&&eo.options.onDragEvent(eo,ad(ev))){return}c1(ev)}if(eo.options.dragDrop){bn(et.scroller,"dragstart",function(ev){N(eo,ev)});bn(et.scroller,"dragenter",ep);bn(et.scroller,"dragover",ep);bn(et.scroller,"drop",ca(eo,aP))}bn(et.scroller,"paste",function(ev){if(aI(et,ev)){return}da(eo);B(eo)});bn(et.input,"paste",function(){eo.state.pasteIncoming=true;B(eo)});function es(){if(et.inaccurateSelection){et.prevInput="";et.inaccurateSelection=false;et.input.value=eo.getSelection();cC(et.input)}}bn(et.input,"cut",es);bn(et.input,"copy",es);if(aJ){bn(et.sizer,"mouseup",function(){if(document.activeElement==et.input){et.input.blur()}da(eo)})}}function aI(eo,en){for(var ep=I(en);ep!=eo.wrapper;ep=ep.parentNode){if(!ep||ep.ignoreEvents||ep.parentNode==eo.sizer&&ep!=eo.mover){return true}}}function bI(eo,et,eq){var es=eo.display;if(!eq){var er=I(et);if(er==es.scrollbarH||er==es.scrollbarH.firstChild||er==es.scrollbarV||er==es.scrollbarV.firstChild||er==es.scrollbarFiller||er==es.gutterFiller){return null}}var en,eu,ep=at(es.lineSpace);try{en=et.clientX;eu=et.clientY}catch(et){return null}return d7(eo,en-ep.left,eu-ep.top)}var cn,ci;function c3(eF){if(ax(this,eF)){return}var eq=this,eA=eq.display,eH=eq.doc,ey=eH.sel;ey.shift=eF.shiftKey;if(aI(eA,eF)){if(!b9){eA.scroller.draggable=false;setTimeout(function(){eA.scroller.draggable=true},100)}return}if(q(eq,eF)){return}var ep=bI(eq,eF);switch(d5(eF)){case 3:if(bY){ai.call(eq,eq,eF)}return;case 2:if(ep){ea(eq.doc,ep)}setTimeout(bP(da,eq),20);bW(eF);return}if(!ep){if(I(eF)==eA.scroller){bW(eF)}return}if(!eq.state.focused){bT(eq)}var en=+new Date,eo="single";if(ci&&ci.time>en-400&&d2(ci.pos,ep)){eo="triple";bW(eF);setTimeout(bP(da,eq),20);aS(eq,ep.line)}else{if(cn&&cn.time>en-400&&d2(cn.pos,ep)){eo="double";ci={time:en,pos:ep};bW(eF);var eC=ag(dD(eH,ep.line).text,ep);ea(eq.doc,eC.from,eC.to)}else{cn={time:en,pos:ep}}}var er=ep;if(eq.options.dragDrop&&dk&&!X(eq)&&!d2(ey.from,ey.to)&&!dE(ep,ey.from)&&!dE(ey.to,ep)&&eo=="single"){var eB=ca(eq,function(eI){if(b9){eA.scroller.draggable=false}eq.state.draggingText=false;cT(document,"mouseup",eB);cT(eA.scroller,"drop",eB);if(Math.abs(eF.clientX-eI.clientX)+Math.abs(eF.clientY-eI.clientY)<10){bW(eI);ea(eq.doc,ep);da(eq)}});if(b9){eA.scroller.draggable=true}eq.state.draggingText=eB;if(eA.scroller.dragDrop){eA.scroller.dragDrop()}bn(document,"mouseup",eB);bn(eA.scroller,"drop",eB);return}bW(eF);if(eo=="single"){ea(eq.doc,d3(eH,ep))}var eG=ey.from,ev=ey.to,ez=ep;function eD(eJ){if(d2(ez,eJ)){return}ez=eJ;if(eo=="single"){ea(eq.doc,d3(eH,ep),eJ);return}eG=d3(eH,eG);ev=d3(eH,ev);if(eo=="double"){var eI=ag(dD(eH,eJ.line).text,eJ);if(dE(eJ,eG)){ea(eq.doc,eI.from,ev)}else{ea(eq.doc,eG,eI.to)}}else{if(eo=="triple"){if(dE(eJ,eG)){ea(eq.doc,ev,d3(eH,P(eJ.line,0)))}else{ea(eq.doc,eG,d3(eH,P(eJ.line+1,0)))}}}}var ew=at(eA.wrapper);var es=0;function eE(eK){var eI=++es;var eM=bI(eq,eK,true);if(!eM){return}if(!d2(eM,er)){if(!eq.state.focused){bT(eq)}er=eM;eD(eM);var eL=br(eA,eH);if(eM.line>=eL.to||eM.line<eL.from){setTimeout(ca(eq,function(){if(es==eI){eE(eK)}}),150)}}else{var eJ=eK.clientY<ew.top?-20:eK.clientY>ew.bottom?20:0;if(eJ){setTimeout(ca(eq,function(){if(es!=eI){return}eA.scroller.scrollTop+=eJ;eE(eK)}),50)}}}function eu(eI){es=Infinity;bW(eI);da(eq);cT(document,"mousemove",ex);cT(document,"mouseup",et)}var ex=ca(eq,function(eI){if(!cA&&!d5(eI)){eu(eI)}else{eE(eI)}});var et=ca(eq,eu);bn(document,"mousemove",ex);bn(document,"mouseup",et)}function q(ev,et){var eu=ev.display;try{var eo=et.clientX,en=et.clientY}catch(et){return false}if(eo>=Math.floor(at(eu.gutters).right)){return false}bW(et);if(!dJ(ev,"gutterClick")){return true}var es=at(eu.lineDiv);if(en>es.bottom){return true}en-=es.top-eu.viewOffset;for(var eq=0;eq<ev.options.gutters.length;++eq){var er=eu.gutters.childNodes[eq];if(er&&at(er).right>=eo){var ew=a8(ev.doc,en);var ep=ev.options.gutters[eq];T(ev,"gutterClick",ev,ew,ep,et);break}}return true}var U=0;function aP(et){var ev=this;if(ax(ev,et)||aI(ev.display,et)||(ev.options.onDragEvent&&ev.options.onDragEvent(ev,ad(et)))){return}bW(et);if(cA){U=+new Date}var eu=bI(ev,et,true),en=et.dataTransfer.files;if(!eu||X(ev)){return}if(en&&en.length&&window.FileReader&&window.File){var ep=en.length,ex=Array(ep),eo=0;var eq=function(eA,ez){var ey=new FileReader;ey.onload=function(){ex[ez]=ey.result;if(++eo==ep){eu=d3(ev.doc,eu);aN(ev.doc,{from:eu,to:eu,text:aD(ex.join("\n")),origin:"paste"},"around")}};ey.readAsText(eA)};for(var er=0;er<ep;++er){eq(en[er],er)}}else{if(ev.state.draggingText&&!(dE(eu,ev.doc.sel.from)||dE(ev.doc.sel.to,eu))){ev.state.draggingText(et);setTimeout(bP(da,ev),20);return}try{var ex=et.dataTransfer.getData("Text");if(ex){var ew=ev.doc.sel.from,es=ev.doc.sel.to;bk(ev.doc,eu,eu);if(ev.state.draggingText){aE(ev.doc,"",ew,es,"paste")}ev.replaceSelection(ex,null,"paste");da(ev);bT(ev)}}catch(et){}}}function N(eo,eq){if(cA&&(!eo.state.draggingText||+new Date-U<100)){c1(eq);return}if(ax(eo,eq)||aI(eo.display,eq)){return}var en=eo.getSelection();eq.dataTransfer.setData("Text",en);if(eq.dataTransfer.setDragImage&&!al){var ep=ed("img",null,null,"position: fixed; left: 0; top: 0;");if(dV){ep.width=ep.height=1;eo.display.wrapper.appendChild(ep);ep._top=ep.offsetTop}eq.dataTransfer.setDragImage(ep,0,0);if(dV){ep.parentNode.removeChild(ep)}}}function K(en,eo){if(Math.abs(en.doc.scrollTop-eo)<2){return}en.doc.scrollTop=eo;if(!bJ){cB(en,[],eo)}if(en.display.scroller.scrollTop!=eo){en.display.scroller.scrollTop=eo}if(en.display.scrollbarV.scrollTop!=eo){en.display.scrollbarV.scrollTop=eo}if(bJ){cB(en,[])}cU(en,100)}function a6(en,ep,eo){if(eo?ep==en.doc.scrollLeft:Math.abs(en.doc.scrollLeft-ep)<2){return}ep=Math.min(ep,en.display.scroller.scrollWidth-en.display.scroller.clientWidth);en.doc.scrollLeft=ep;de(en);if(en.display.scroller.scrollLeft!=ep){en.display.scroller.scrollLeft=ep}if(en.display.scrollbarH.scrollLeft!=ep){en.display.scrollbarH.scrollLeft=ep}}var dK=0,bB=null;if(cA){bB=-0.53}else{if(bJ){bB=15}else{if(ch){bB=-0.7}else{if(al){bB=-1/3}}}}function b(et,eo){var ew=eo.wheelDeltaX,ev=eo.wheelDeltaY;if(ew==null&&eo.detail&&eo.axis==eo.HORIZONTAL_AXIS){ew=eo.detail}if(ev==null&&eo.detail&&eo.axis==eo.VERTICAL_AXIS){ev=eo.detail}else{if(ev==null){ev=eo.wheelDelta}}var eq=et.display,es=eq.scroller;if(!(ew&&es.scrollWidth>es.clientWidth||ev&&es.scrollHeight>es.clientHeight)){return}if(ev&&bs&&b9){for(var eu=eo.target;eu!=es;eu=eu.parentNode){if(eu.lineObj){et.display.currentWheelTarget=eu;break}}}if(ew&&!bJ&&!dV&&bB!=null){if(ev){K(et,Math.max(0,Math.min(es.scrollTop+ev*bB,es.scrollHeight-es.clientHeight)))}a6(et,Math.max(0,Math.min(es.scrollLeft+ew*bB,es.scrollWidth-es.clientWidth)));bW(eo);eq.wheelStartX=null;return}if(ev&&bB!=null){var en=ev*bB;var er=et.doc.scrollTop,ep=er+eq.wrapper.clientHeight;if(en<0){er=Math.max(0,er+en-50)}else{ep=Math.min(et.doc.height,ep+en+50)}cB(et,[],{top:er,bottom:ep})}if(dK<20){if(eq.wheelStartX==null){eq.wheelStartX=es.scrollLeft;eq.wheelStartY=es.scrollTop;eq.wheelDX=ew;eq.wheelDY=ev;setTimeout(function(){if(eq.wheelStartX==null){return}var ex=es.scrollLeft-eq.wheelStartX;var ez=es.scrollTop-eq.wheelStartY;var ey=(ez&&eq.wheelDY&&ez/eq.wheelDY)||(ex&&eq.wheelDX&&ex/eq.wheelDX);eq.wheelStartX=eq.wheelStartY=null;if(!ey){return}bB=(bB*dK+ey)/(dK+1);++dK},200)}else{eq.wheelDX+=ew;eq.wheelDY+=ev}}}function d9(eo,er,en){if(typeof er=="string"){er=dc[er];if(!er){return false}}if(eo.display.pollingFast&&bC(eo)){eo.display.pollingFast=false}var es=eo.doc,eq=es.sel.shift,ep=false;try{if(X(eo)){eo.state.suppressEdits=true}if(en){es.sel.shift=false}ep=er(eo)!=bx}finally{es.sel.shift=eq;eo.state.suppressEdits=false}return ep}function cr(en){var eo=en.state.keyMaps.slice(0);if(en.options.extraKeys){eo.push(en.options.extraKeys)}eo.push(en.options.keyMap);return eo}var ae;function dH(en,et){var eo=eb(en.options.keyMap),er=eo.auto;clearTimeout(ae);if(er&&!db(et)){ae=setTimeout(function(){if(eb(en.options.keyMap)==eo){en.options.keyMap=(er.call?er.call(null,en):er);el(en)}},50)}var eq=dQ(et,true),es=false;if(!eq){return false}var ep=cr(en);if(et.shiftKey){es=i("Shift-"+eq,ep,function(eu){return d9(en,eu,true)})||i(eq,ep,function(eu){if(typeof eu=="string"?/^go[A-Z]/.test(eu):eu.motion){return d9(en,eu)}})}else{es=i(eq,ep,function(eu){return d9(en,eu)})}if(es){bW(et);r(en);if(bF){et.oldKeyCode=et.keyCode;et.keyCode=0}T(en,"keyHandled",en,eq,et)}return es}function cX(en,eq,eo){var ep=i("'"+eo+"'",cr(en),function(er){return d9(en,er,true)});if(ep){bW(eq);r(en);T(en,"keyHandled",en,"'"+eo+"'",eq)}return ep}var cm=null;function s(eq){var en=this;if(!en.state.focused){bT(en)}if(cA&&eq.keyCode==27){eq.returnValue=false}if(ax(en,eq)||en.options.onKeyEvent&&en.options.onKeyEvent(en,ad(eq))){return}var eo=eq.keyCode;en.doc.sel.shift=eo==16||eq.shiftKey;var ep=dH(en,eq);if(dV){cm=ep?eo:null;if(!ep&&eo==88&&!cg&&(bs?eq.metaKey:eq.ctrlKey)){en.replaceSelection("")}}}function bQ(er){var en=this;if(ax(en,er)||en.options.onKeyEvent&&en.options.onKeyEvent(en,ad(er))){return}var eq=er.keyCode,eo=er.charCode;if(dV&&eq==cm){cm=null;bW(er);return}if(((dV&&(!er.which||er.which<10))||aJ)&&dH(en,er)){return}var ep=String.fromCharCode(eo==null?eq:eo);if(this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!X(this)&&this.doc.mode.electricChars.indexOf(ep)>-1){setTimeout(ca(en,function(){S(en,en.doc.sel.to.line,"smart")}),75)}if(cX(en,er,ep)){return}if(cA&&!bF){en.display.inputHasSelection=null}B(en)}function bT(en){if(en.options.readOnly=="nocursor"){return}if(!en.state.focused){am(en,"focus",en);en.state.focused=true;if(en.display.wrapper.className.search(/\bCodeMirror-focused\b/)==-1){en.display.wrapper.className+=" CodeMirror-focused"}dO(en,true)}aU(en);r(en)}function az(en){if(en.state.focused){am(en,"blur",en);en.state.focused=false;en.display.wrapper.className=en.display.wrapper.className.replace(" CodeMirror-focused","")}clearInterval(en.display.blinker);setTimeout(function(){if(!en.state.focused){en.doc.sel.shift=false}},150)}var dZ;function ai(ew,er){var et=ew.display,eo=ew.doc.sel;if(aI(et,er)){return}var ev=bI(ew,er),en=et.scroller.scrollTop;if(!ev||dV){return}if(d2(eo.from,eo.to)||dE(ev,eo.from)||!dE(ev,eo.to)){ca(ew,bk)(ew.doc,ev,ev)}var es=et.input.style.cssText;et.inputDiv.style.position="absolute";et.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(er.clientY-5)+"px; left: "+(er.clientX-5)+"px; z-index: 1000; background: white; outline: none;border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);";da(ew);dO(ew,true);if(d2(eo.from,eo.to)){et.input.value=et.prevInput=" "}function eq(){if(et.input.selectionStart!=null){var ex=et.input.value=" "+(d2(eo.from,eo.to)?"":et.input.value);et.prevInput=" ";et.input.selectionStart=1;et.input.selectionEnd=ex.length}}function eu(){et.inputDiv.style.position="relative";et.input.style.cssText=es;if(bF){et.scrollbarV.scrollTop=et.scroller.scrollTop=en}aU(ew);if(et.input.selectionStart!=null){if(!cA||bF){eq()}clearTimeout(dZ);var ex=0,ey=function(){if(et.prevInput==" "&&et.input.selectionStart==0){ca(ew,dc.selectAll)(ew)}else{if(ex++<10){dZ=setTimeout(ey,500)}else{dO(ew)}}};dZ=setTimeout(ey,200)}}if(cA&&!bF){eq()}if(bY){c1(er);var ep=function(){cT(window,"mouseup",ep);setTimeout(eu,20)};bn(window,"mouseup",ep)}else{setTimeout(eu,50)}}var b6=G.changeEnd=function(en){if(!en.text){return en.to}return P(en.from.line+en.text.length-1,d1(en.text).length+(en.text.length==1?en.from.ch:0))};function dd(er,et,es){if(!dE(et.from,es)){return d3(er,es)}var eq=(et.text.length-1)-(et.to.line-et.from.line);if(es.line>et.to.line+eq){var ep=es.line-eq,eo=er.first+er.size-1;if(ep>eo){return P(eo,dD(er,eo).text.length)}return dR(es,dD(er,ep).text.length)}if(es.line==et.to.line+eq){return dR(es,d1(et.text).length+(et.text.length==1?et.from.ch:0)+dD(er,et.to.line).text.length-et.to.ch)}var en=es.line-et.from.line;return dR(es,et.text[en].length+(en?0:et.from.ch))}function dI(eo,er,ep){if(ep&&typeof ep=="object"){return{anchor:dd(eo,er,ep.anchor),head:dd(eo,er,ep.head)}}if(ep=="start"){return{anchor:er.from,head:er.from}}var en=b6(er);if(ep=="around"){return{anchor:er.from,head:en}}if(ep=="end"){return{anchor:en,head:en}}var eq=function(eu){if(dE(eu,er.from)){return eu}if(!dE(er.to,eu)){return en}var es=eu.line+er.text.length-(er.to.line-er.from.line)-1,et=eu.ch;if(eu.line==er.to.line){et+=en.ch-er.to.ch}return P(es,et)};return{anchor:eq(eo.sel.anchor),head:eq(eo.sel.head)}}function cG(eo,eq,ep){var en={canceled:false,from:eq.from,to:eq.to,text:eq.text,origin:eq.origin,cancel:function(){this.canceled=true}};if(ep){en.update=function(eu,et,es,er){if(eu){this.from=d3(eo,eu)}if(et){this.to=d3(eo,et)}if(es){this.text=es}if(er!==undefined){this.origin=er}}}am(eo,"beforeChange",eo,en);if(eo.cm){am(eo.cm,"beforeChange",eo.cm,en)}if(en.canceled){return null}return{from:en.from,to:en.to,text:en.text,origin:en.origin}}function aN(eq,es,er,ep){if(eq.cm){if(!eq.cm.curOp){return ca(eq.cm,aN)(eq,es,er,ep)}if(eq.cm.state.suppressEdits){return}}if(dJ(eq,"beforeChange")||eq.cm&&dJ(eq.cm,"beforeChange")){es=cG(eq,es,true);if(!es){return}}var eo=ei&&!ep&&bX(eq,es.from,es.to);if(eo){for(var en=eo.length-1;en>=1;--en){av(eq,{from:eo[en].from,to:eo[en].to,text:[""]})}if(eo.length){av(eq,{from:eo[0].from,to:eo[0].to,text:es.text},er)}}else{av(eq,es,er)}}function av(ep,er,eq){var eo=dI(ep,er,eq);dh(ep,er,eo,ep.cm?ep.cm.curOp.id:NaN);cS(ep,er,eo,cY(ep,er));var en=[];cN(ep,function(et,es){if(!es&&cl(en,et.history)==-1){cz(et.history,er);en.push(et.history)}cS(et,er,null,cY(et,er))})}function bu(ew,et){if(ew.cm&&ew.cm.state.suppressEdits){return}var es=ew.history;var eo=(et=="undo"?es.done:es.undone).pop();if(!eo){return}var eu={changes:[],anchorBefore:eo.anchorAfter,headBefore:eo.headAfter,anchorAfter:eo.anchorBefore,headAfter:eo.headBefore,generation:es.generation};(et=="undo"?es.undone:es.done).push(eu);es.generation=eo.generation||++es.maxGeneration;var ep=dJ(ew,"beforeChange")||ew.cm&&dJ(ew.cm,"beforeChange");for(var eq=eo.changes.length-1;eq>=0;--eq){var ev=eo.changes[eq];ev.origin=et;if(ep&&!cG(ew,ev,false)){(et=="undo"?es.done:es.undone).length=0;return}eu.changes.push(cs(ew,ev));var en=eq?dI(ew,ev,null):{anchor:eo.anchorBefore,head:eo.headBefore};cS(ew,ev,en,cP(ew,ev));var er=[];cN(ew,function(ey,ex){if(!ex&&cl(er,ey.history)==-1){cz(ey.history,ev);er.push(ey.history)}cS(ey,ev,null,cP(ey,ev))})}}function dL(en,ep){function eo(eq){return P(eq.line+ep,eq.ch)}en.first+=ep;if(en.cm){V(en.cm,en.first,en.first,ep)}en.sel.head=eo(en.sel.head);en.sel.anchor=eo(en.sel.anchor);en.sel.from=eo(en.sel.from);en.sel.to=eo(en.sel.to)}function cS(er,es,eq,eo){if(er.cm&&!er.cm.curOp){return ca(er.cm,cS)(er,es,eq,eo)}if(es.to.line<er.first){dL(er,es.text.length-1-(es.to.line-es.from.line));return}if(es.from.line>er.lastLine()){return}if(es.from.line<er.first){var en=es.text.length-1-(er.first-es.from.line);dL(er,en);es={from:P(er.first,0),to:P(es.to.line+en,es.to.ch),text:[d1(es.text)],origin:es.origin}}var ep=er.lastLine();if(es.to.line>ep){es={from:es.from,to:P(ep,dD(er,ep).text.length),text:[es.text[0]],origin:es.origin}}es.removed=ee(er,es.from,es.to);if(!eq){eq=dI(er,es,null)}if(er.cm){aq(er.cm,es,eo,eq)}else{dW(er,es,eo,eq)}}function aq(ex,et,eq,en){var ew=ex.doc,es=ex.display,eu=et.from,ev=et.to;var eo=false,ep=eu.line;if(!ex.options.lineWrapping){ep=bf(A(ew,dD(ew,eu.line)));ew.iter(ep,ev.line+1,function(eA){if(eA==es.maxLine){eo=true;return true}})}if(!dE(ew.sel.head,et.from)&&!dE(et.to,ew.sel.head)){ex.curOp.cursorActivity=true}dW(ew,et,eq,en,aL(ex));if(!ex.options.lineWrapping){ew.iter(ep,eu.line+et.text.length,function(eB){var eA=cZ(ew,eB);if(eA>es.maxLineLength){es.maxLine=eB;es.maxLineLength=eA;es.maxLineChanged=true;eo=false}});if(eo){ex.curOp.updateMaxLine=true}}ew.frontier=Math.min(ew.frontier,eu.line);cU(ex,400);var ez=et.text.length-(ev.line-eu.line)-1;V(ex,eu.line,ev.line+1,ez);if(dJ(ex,"change")){var er={from:eu,to:ev,text:et.text,removed:et.removed,origin:et.origin};if(ex.curOp.textChanged){for(var ey=ex.curOp.textChanged;ey.next;ey=ey.next){}ey.next=er}else{ex.curOp.textChanged=er}}}function aE(eq,ep,es,er,en){if(!er){er=es}if(dE(er,es)){var eo=er;er=es;es=eo}if(typeof ep=="string"){ep=aD(ep)}aN(eq,{from:es,to:er,text:ep,origin:en},null)}function P(en,eo){if(!(this instanceof P)){return new P(en,eo)}this.line=en;this.ch=eo}G.Pos=P;function d2(eo,en){return eo.line==en.line&&eo.ch==en.ch}function dE(eo,en){return eo.line<en.line||(eo.line==en.line&&eo.ch<en.ch)}function bD(en){return P(en.line,en.ch)}function cc(en,eo){return Math.max(en.first,Math.min(eo,en.first+en.size-1))}function d3(eo,ep){if(ep.line<eo.first){return P(eo.first,0)}var en=eo.first+eo.size-1;if(ep.line>en){return P(en,dD(eo,en).text.length)}return dR(ep,dD(eo,ep.line).text.length)}function dR(ep,eo){var en=ep.ch;if(en==null||en>eo){return P(ep.line,eo)}else{if(en<0){return P(ep.line,0)}else{return ep}}}function bv(eo,en){return en>=eo.first&&en<eo.first+eo.size}function ea(er,es,en,eo){if(er.sel.shift||er.sel.extend){var eq=er.sel.anchor;if(en){var ep=dE(es,eq);if(ep!=dE(en,eq)){eq=es;es=en}else{if(ep!=dE(es,en)){es=en}}}bk(er,eq,es,eo)}else{bk(er,es,en||es,eo)}if(er.cm){er.cm.curOp.userSelChange=true}}function e(eq,en,eo){var ep={anchor:en,head:eo};am(eq,"beforeSelectionChange",eq,ep);if(eq.cm){am(eq.cm,"beforeSelectionChange",eq.cm,ep)}ep.anchor=d3(eq,ep.anchor);ep.head=d3(eq,ep.head);return ep}function bk(eu,er,es,ep,eo){if(!eo&&dJ(eu,"beforeSelectionChange")||eu.cm&&dJ(eu.cm,"beforeSelectionChange")){var eq=e(eu,er,es);es=eq.head;er=eq.anchor}var et=eu.sel;et.goalColumn=null;if(eo||!d2(er,et.anchor)){er=bl(eu,er,ep,eo!="push")}if(eo||!d2(es,et.head)){es=bl(eu,es,ep,eo!="push")}if(d2(et.anchor,er)&&d2(et.head,es)){return}et.anchor=er;et.head=es;var en=dE(es,er);et.from=en?es:er;et.to=en?er:es;if(eu.cm){eu.cm.curOp.updateInput=eu.cm.curOp.selectionChanged=eu.cm.curOp.cursorActivity=true}T(eu,"cursorActivity",eu)}function c6(en){bk(en.doc,en.doc.sel.from,en.doc.sel.to,null,"push")}function bl(ew,ev,es,et){var ex=false,ep=ev;var eq=es||1;ew.cantEdit=false;search:for(;;){var ey=dD(ew,ep.line);if(ey.markedSpans){for(var er=0;er<ey.markedSpans.length;++er){var en=ey.markedSpans[er],eo=en.marker;if((en.from==null||(eo.inclusiveLeft?en.from<=ep.ch:en.from<ep.ch))&&(en.to==null||(eo.inclusiveRight?en.to>=ep.ch:en.to>ep.ch))){if(et){am(eo,"beforeCursorEnter");if(eo.explicitlyCleared){if(!ey.markedSpans){break}else{--er;continue}}}if(!eo.atomic){continue}var eu=eo.find()[eq<0?"from":"to"];if(d2(eu,ep)){eu.ch+=eq;if(eu.ch<0){if(eu.line>ew.first){eu=d3(ew,P(eu.line-1))}else{eu=null}}else{if(eu.ch>ey.text.length){if(eu.line<ew.first+ew.size-1){eu=P(eu.line+1,0)}else{eu=null}}}if(!eu){if(ex){if(!et){return bl(ew,ev,es,true)}ew.cantEdit=true;return P(ew.first,0)}ex=true;eu=ev;eq=-eq}}ep=eu;continue search}}}return ep}}function aj(eo){var er=C(eo,eo.doc.sel.head,eo.options.cursorScrollMargin);if(!eo.state.focused){return}var es=eo.display,ep=at(es.sizer),en=null;if(er.top+ep.top<0){en=true}else{if(er.bottom+ep.top>(window.innerHeight||document.documentElement.clientHeight)){en=false}}if(en!=null&&!dS){var eq=es.cursor.style.display=="none";if(eq){es.cursor.style.display="";es.cursor.style.left=er.left+"px";es.cursor.style.top=(er.top-es.viewOffset)+"px"}es.cursor.scrollIntoView(en);if(eq){es.cursor.style.display="none"}}}function C(en,eu,er){if(er==null){er=0}for(;;){var es=false,eq=cH(en,eu);var et=F(en,eq.left,eq.top-er,eq.left,eq.bottom+er);var eo=en.doc.scrollTop,ep=en.doc.scrollLeft;if(et.scrollTop!=null){K(en,et.scrollTop);if(Math.abs(en.doc.scrollTop-eo)>1){es=true}}if(et.scrollLeft!=null){a6(en,et.scrollLeft);if(Math.abs(en.doc.scrollLeft-ep)>1){es=true}}if(!es){return eq}}}function E(en,ep,er,eo,eq){var es=F(en,ep,er,eo,eq);if(es.scrollTop!=null){K(en,es.scrollTop)}if(es.scrollLeft!=null){a6(en,es.scrollLeft)}}function F(et,eB,eq,eA,ep){var ey=et.display,ex=aB(et.display);if(eq<0){eq=0}var eo=ey.scroller.clientHeight-aQ,ew=ey.scroller.scrollTop,ev={};var eD=et.doc.height+ba(ey);var eE=eq<ex,ez=ep>eD-ex;if(eq<ew){ev.scrollTop=eE?0:eq}else{if(ep>ew+eo){var eu=Math.min(eq,(ez?eD:ep)-eo);if(eu!=ew){ev.scrollTop=eu}}}var es=ey.scroller.clientWidth-aQ,en=ey.scroller.scrollLeft;eB+=ey.gutters.offsetWidth;eA+=ey.gutters.offsetWidth;var er=ey.gutters.offsetWidth;var eC=eB<er+10;if(eB<en+er||eC){if(eC){eB=0}ev.scrollLeft=Math.max(0,eB-10-er)}else{if(eA>es+en-3){ev.scrollLeft=eA+10-es}}return ev}function D(en,ep,eo){en.curOp.updateScrollPos={scrollLeft:ep==null?en.doc.scrollLeft:ep,scrollTop:eo==null?en.doc.scrollTop:eo}}function b1(eo,eq,ep){var er=eo.curOp.updateScrollPos||(eo.curOp.updateScrollPos={scrollLeft:eo.doc.scrollLeft,scrollTop:eo.doc.scrollTop});var en=eo.display.scroller;er.scrollTop=Math.max(0,Math.min(en.scrollHeight-en.clientHeight,er.scrollTop+ep));er.scrollLeft=Math.max(0,Math.min(en.scrollWidth-en.clientWidth,er.scrollLeft+eq))}function S(ez,eq,ey,ep){var ex=ez.doc;if(ey==null){ey="add"}if(ey=="smart"){if(!ez.doc.mode.indent){ey="prev"}else{var eo=cw(ez,eq)}}var et=ez.options.tabSize;var eA=dD(ex,eq),es=bi(eA.text,null,et);var en=eA.text.match(/^\s*/)[0],ev;if(ey=="smart"){ev=ez.doc.mode.indent(eo,eA.text.slice(en.length),eA.text);if(ev==bx){if(!ep){return}ey="prev"}}if(ey=="prev"){if(eq>ex.first){ev=bi(dD(ex,eq-1).text,null,et)}else{ev=0}}else{if(ey=="add"){ev=es+ez.options.indentUnit}else{if(ey=="subtract"){ev=es-ez.options.indentUnit}else{if(typeof ey=="number"){ev=es+ey}}}}ev=Math.max(0,ev);var ew="",eu=0;if(ez.options.indentWithTabs){for(var er=Math.floor(ev/et);er;--er){eu+=et;ew+="\t"}}if(eu<ev){ew+=bK(ev-eu)}if(ew!=en){aE(ez.doc,ew,P(eq,0),P(eq,en.length),"+input")}eA.stateAfter=null}function c8(en,ep,es){var er=ep,eo=ep,eq=en.doc;if(typeof ep=="number"){eo=dD(eq,cc(eq,ep))}else{er=bf(ep)}if(er==null){return null}if(es(eo,er)){V(en,er,er+1)}else{return null}return eo}function a2(eE,eq,ey,ex,es){var ev=eq.line,ew=eq.ch,eD=ey;var en=dD(eE,ev);var eB=true;function eC(){var eF=ev+ey;if(eF<eE.first||eF>=eE.first+eE.size){return(eB=false)}ev=eF;return en=dD(eE,eF)}function eA(eG){var eF=(es?w:W)(en,ew,ey,true);if(eF==null){if(!eG&&eC()){if(es){ew=(ey<0?b5:bV)(en)}else{ew=ey<0?en.text.length:0}}else{return(eB=false)}}else{ew=eF}return true}if(ex=="char"){eA()}else{if(ex=="column"){eA(true)}else{if(ex=="word"||ex=="group"){var ez=null,et=ex=="group";for(var er=true;;er=false){if(ey<0&&!eA(!er)){break}var eo=en.text.charAt(ew)||"\n";var ep=bS(eo)?"w":!et?null:/\s/.test(eo)?null:"p";if(ez&&ez!=ep){if(ey<0){ey=1;eA()}break}if(ep){ez=ep}if(ey>0&&!eA(!er)){break}}}}}var eu=bl(eE,P(ev,ew),eD,true);if(!eB){eu.hitSide=true}return eu}function aY(ev,eq,en,eu){var et=ev.doc,es=eq.left,er;if(eu=="page"){var ep=Math.min(ev.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);er=eq.top+en*(ep-(en<0?1.5:0.5)*aB(ev.display))}else{if(eu=="line"){er=en>0?eq.bottom+3:eq.top-3}}for(;;){var eo=d7(ev,es,er);if(!eo.outside){break}if(en<0?er<=0:er>=et.height){eo.hitSide=true;break}er+=en*5}return eo}function ag(eq,es){var er=es.ch,ep=es.ch;if(eq){if((es.xRel<0||ep==eq.length)&&er){--er}else{++ep}var eo=eq.charAt(er);var en=bS(eo)?bS:/\s/.test(eo)?function(et){return/\s/.test(et)}:function(et){return !/\s/.test(et)&&!bS(et)};while(er>0&&en(eq.charAt(er-1))){--er}while(ep<eq.length&&en(eq.charAt(ep))){++ep}}return{from:P(es.line,er),to:P(es.line,ep)}}function aS(en,eo){ea(en.doc,P(eo,0),d3(en.doc,P(eo+1,0)))}G.prototype={constructor:G,focus:function(){window.focus();da(this);bT(this);B(this)},setOption:function(ep,eq){var eo=this.options,en=eo[ep];if(eo[ep]==eq&&ep!="mode"){return}eo[ep]=eq;if(aM.hasOwnProperty(ep)){ca(this,aM[ep])(this,eq,en)}},getOption:function(en){return this.options[en]},getDoc:function(){return this.doc},addKeyMap:function(eo,en){this.state.keyMaps[en?"push":"unshift"](eo)},removeKeyMap:function(eo){var ep=this.state.keyMaps;for(var en=0;en<ep.length;++en){if((typeof eo=="string"?ep[en].name:ep[en])==eo){ep.splice(en,1);return true}}},addOverlay:ca(null,function(en,eo){var ep=en.token?en:G.getMode(this.options,en);if(ep.startState){throw new Error("Overlays may not be stateful.")}this.state.overlays.push({mode:ep,modeSpec:en,opaque:eo&&eo.opaque});this.state.modeGen++;V(this)}),removeOverlay:ca(null,function(en){var ep=this.state.overlays;for(var eo=0;eo<ep.length;++eo){var eq=ep[eo].modeSpec;if(eq==en||typeof en=="string"&&eq.name==en){ep.splice(eo,1);this.state.modeGen++;V(this);return}}}),indentLine:ca(null,function(ep,en,eo){if(typeof en!="string"&&typeof en!="number"){if(en==null){en=this.options.smartIndent?"smart":"prev"}else{en=en?"add":"subtract"}}if(bv(this.doc,ep)){S(this,ep,en,eo)}}),indentSelection:ca(null,function(eo){var ep=this.doc.sel;if(d2(ep.from,ep.to)){return S(this,ep.from.line,eo)}var eq=ep.to.line-(ep.to.ch?0:1);for(var en=ep.from.line;en<=eq;++en){S(this,en,eo)}}),getTokenAt:function(eu,eo){var er=this.doc;eu=d3(er,eu);var eq=cw(this,eu.line,eo),et=this.doc.mode;var en=dD(er,eu.line);var es=new dp(en.text,this.options.tabSize);while(es.pos<eu.ch&&!es.eol()){es.start=es.pos;var ep=et.token(es,eq)}return{start:es.start,end:es.pos,string:es.current(),className:ep||null,type:ep||null,state:eq}},getTokenTypeAt:function(es){es=d3(this.doc,es);var ep=cf(this,dD(this.doc,es.line));var eq=0,er=(ep.length-1)/2,eo=es.ch;if(eo==0){return ep[2]}for(;;){var en=(eq+er)>>1;if((en?ep[en*2-1]:0)>=eo){er=en}else{if(ep[en*2+1]<eo){eq=en+1}else{return ep[en*2+2]}}}},getModeAt:function(eo){var en=this.doc.mode;if(!en.innerMode){return en}return G.innerMode(en,this.getTokenAt(eo).state).mode},getHelper:function(eq,eo){if(!dM.hasOwnProperty(eo)){return}var en=dM[eo],ep=this.getModeAt(eq);return ep[eo]&&en[ep[eo]]||ep.helperType&&en[ep.helperType]||en[ep.name]},getStateAfter:function(eo,en){var ep=this.doc;eo=cc(ep,eo==null?ep.first+ep.size-1:eo);return cw(this,eo+1,en)},cursorCoords:function(eq,eo){var ep,en=this.doc.sel;if(eq==null){ep=en.head}else{if(typeof eq=="object"){ep=d3(this.doc,eq)}else{ep=eq?en.from:en.to}}return cH(this,ep,eo||"page")},charCoords:function(eo,en){return b0(this,d3(this.doc,eo),en||"page")},coordsChar:function(en,eo){en=ek(this,en,eo||"page");return d7(this,en.left,en.top)},lineAtHeight:function(en,eo){en=ek(this,{top:en,left:0},eo||"page").top;return a8(this.doc,en+this.display.viewOffset)},heightAtLine:function(eo,er){var en=false,eq=this.doc.first+this.doc.size-1;if(eo<this.doc.first){eo=this.doc.first}else{if(eo>eq){eo=eq;en=true}}var ep=dD(this.doc,eo);return dm(this,dD(this.doc,eo),{top:0,left:0},er||"page").top+(en?ep.height:0)},defaultTextHeight:function(){return aB(this.display)},defaultCharWidth:function(){return cy(this.display)},setGutterMarker:ca(null,function(en,eo,ep){return c8(this,en,function(eq){var er=eq.gutterMarkers||(eq.gutterMarkers={});er[eo]=ep;if(!ep&&dq(er)){eq.gutterMarkers=null}return true})}),clearGutter:ca(null,function(ep){var en=this,eq=en.doc,eo=eq.first;eq.iter(function(er){if(er.gutterMarkers&&er.gutterMarkers[ep]){er.gutterMarkers[ep]=null;V(en,eo,eo+1);if(dq(er.gutterMarkers)){er.gutterMarkers=null}}++eo})}),addLineClass:ca(null,function(ep,eo,en){return c8(this,ep,function(eq){var er=eo=="text"?"textClass":eo=="background"?"bgClass":"wrapClass";if(!eq[er]){eq[er]=en}else{if(new RegExp("(?:^|\\s)"+en+"(?:$|\\s)").test(eq[er])){return false}else{eq[er]+=" "+en}}return true})}),removeLineClass:ca(null,function(ep,eo,en){return c8(this,ep,function(er){var eu=eo=="text"?"textClass":eo=="background"?"bgClass":"wrapClass";var et=er[eu];if(!et){return false}else{if(en==null){er[eu]=null}else{var es=et.match(new RegExp("(?:^|\\s+)"+en+"(?:$|\\s+)"));if(!es){return false}var eq=es.index+es[0].length;er[eu]=et.slice(0,es.index)+(!es.index||eq==et.length?"":" ")+et.slice(eq)||null}}return true})}),addLineWidget:ca(null,function(ep,eo,en){return a9(this,ep,eo,en)}),removeLineWidget:function(en){en.clear()},lineInfo:function(en){if(typeof en=="number"){if(!bv(this.doc,en)){return null}var eo=en;en=dD(this.doc,en);if(!en){return null}}else{var eo=bf(en);if(eo==null){return null}}return{line:eo,handle:en,text:en.text,gutterMarkers:en.gutterMarkers,textClass:en.textClass,bgClass:en.bgClass,wrapClass:en.wrapClass,widgets:en.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(es,ep,eu,eq,ew){var er=this.display;es=cH(this,d3(this.doc,es));var et=es.bottom,eo=es.left;ep.style.position="absolute";er.sizer.appendChild(ep);if(eq=="over"){et=es.top}else{if(eq=="above"||eq=="near"){var en=Math.max(er.wrapper.clientHeight,this.doc.height),ev=Math.max(er.sizer.clientWidth,er.lineSpace.clientWidth);if((eq=="above"||es.bottom+ep.offsetHeight>en)&&es.top>ep.offsetHeight){et=es.top-ep.offsetHeight}else{if(es.bottom+ep.offsetHeight<=en){et=es.bottom}}if(eo+ep.offsetWidth>ev){eo=ev-ep.offsetWidth}}}ep.style.top=et+"px";ep.style.left=ep.style.right="";if(ew=="right"){eo=er.sizer.clientWidth-ep.offsetWidth;ep.style.right="0px"}else{if(ew=="left"){eo=0}else{if(ew=="middle"){eo=(er.sizer.clientWidth-ep.offsetWidth)/2}}ep.style.left=eo+"px"}if(eu){E(this,eo,et,eo+ep.offsetWidth,et+ep.offsetHeight)}},triggerOnKeyDown:ca(null,s),execCommand:function(en){return dc[en](this)},findPosH:function(et,eq,er,eo){var en=1;if(eq<0){en=-1;eq=-eq}for(var ep=0,es=d3(this.doc,et);ep<eq;++ep){es=a2(this.doc,es,en,er,eo);if(es.hitSide){break}}return es},moveH:ca(null,function(en,eo){var ep=this.doc.sel,eq;if(ep.shift||ep.extend||d2(ep.from,ep.to)){eq=a2(this.doc,ep.head,en,eo,this.options.rtlMoveVisually)}else{eq=en<0?ep.from:ep.to}ea(this.doc,eq,eq,en)}),deleteH:ca(null,function(en,eo){var ep=this.doc.sel;if(!d2(ep.from,ep.to)){aE(this.doc,"",ep.from,ep.to,"+delete")}else{aE(this.doc,"",ep.from,a2(this.doc,ep.head,en,eo,false),"+delete")}this.curOp.userSelChange=true}),findPosV:function(es,ep,et,ev){var en=1,er=ev;if(ep<0){en=-1;ep=-ep}for(var eo=0,eu=d3(this.doc,es);eo<ep;++eo){var eq=cH(this,eu,"div");if(er==null){er=eq.left}else{eq.left=er}eu=aY(this,eq,en,et);if(eu.hitSide){break}}return eu},moveV:ca(null,function(en,eo){var ep=this.doc.sel;var er=cH(this,ep.head,"div");if(ep.goalColumn!=null){er.left=ep.goalColumn}var eq=aY(this,er,en,eo);if(eo=="page"){b1(this,0,b0(this,eq,"div").top-er.top)}ea(this.doc,eq,eq,en);ep.goalColumn=er.left}),toggleOverwrite:function(en){if(en!=null&&en==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){this.display.cursor.className+=" CodeMirror-overwrite"}else{this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite","")}},hasFocus:function(){return this.state.focused},scrollTo:ca(null,function(en,eo){D(this,en,eo)}),getScrollInfo:function(){var en=this.display.scroller,eo=aQ;return{left:en.scrollLeft,top:en.scrollTop,height:en.scrollHeight-eo,width:en.scrollWidth-eo,clientHeight:en.clientHeight-eo,clientWidth:en.clientWidth-eo}},scrollIntoView:ca(null,function(eq,ep){if(typeof eq=="number"){eq=P(eq,0)}if(!ep){ep=0}var eo=eq;if(!eq||eq.line!=null){this.curOp.scrollToPos=eq?d3(this.doc,eq):this.doc.sel.head;this.curOp.scrollToPosMargin=ep;eo=cH(this,this.curOp.scrollToPos)}var en=F(this,eo.left,eo.top-ep,eo.right,eo.bottom+ep);D(this,en.scrollLeft,en.scrollTop)}),setSize:function(ep,en){function eo(eq){return typeof eq=="number"||/^\d+$/.test(String(eq))?eq+"px":eq}if(ep!=null){this.display.wrapper.style.width=eo(ep)}if(en!=null){this.display.wrapper.style.height=eo(en)}this.refresh()},on:function(en,eo){bn(this,en,eo)},off:function(en,eo){cT(this,en,eo)},operation:function(en){return b2(this,en)},refresh:ca(null,function(){Y(this);D(this,this.doc.scrollLeft,this.doc.scrollTop);V(this)}),swapDoc:ca(null,function(eo){var en=this.doc;en.cm=null;cQ(this,eo);Y(this);dO(this,true);D(this,eo.scrollLeft,eo.scrollTop);return en}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var aM=G.optionHandlers={};var dw=G.defaults={};function u(en,eq,ep,eo){G.defaults[en]=eq;if(ep){aM[en]=eo?function(er,et,es){if(es!=by){ep(er,et,es)}}:ep}}var by=G.Init={toString:function(){return"CodeMirror.Init"}};u("value","",function(en,eo){en.setValue(eo)},true);u("mode",null,function(en,eo){en.doc.modeOption=eo;aZ(en)},true);u("indentUnit",2,aZ,true);u("indentWithTabs",false);u("smartIndent",true);u("tabSize",4,function(en){aZ(en);Y(en);V(en)},true);u("electricChars",true);u("rtlMoveVisually",!au);u("theme","default",function(en){b3(en);ct(en)},true);u("keyMap","default",el);u("extraKeys",null);u("onKeyEvent",null);u("onDragEvent",null);u("lineWrapping",false,di,true);u("gutters",[],function(en){bA(en.options);ct(en)},true);u("fixedGutter",true,function(en,eo){en.display.gutters.style.left=eo?cJ(en.display)+"px":"0";en.refresh()},true);u("coverGutterNextToScrollbar",false,ds,true);u("lineNumbers",false,function(en){bA(en.options);ct(en)},true);u("firstLineNumber",1,ct,true);u("lineNumberFormatter",function(en){return en},ct,true);u("showCursorWhenSelecting",false,a5,true);u("readOnly",false,function(en,eo){if(eo=="nocursor"){az(en);en.display.input.blur()}else{if(!eo){dO(en,true)}}});u("dragDrop",true);u("cursorBlinkRate",530);u("cursorScrollMargin",0);u("cursorHeight",1);u("workTime",100);u("workDelay",100);u("flattenSpans",true);u("pollInterval",100);u("undoDepth",40,function(en,eo){en.doc.history.undoDepth=eo});u("historyEventDelay",500);u("viewportMargin",10,function(en){en.refresh()},true);u("maxHighlightLength",10000,function(en){aZ(en);en.refresh()},true);u("moveInputWithCursor",true,function(en,eo){if(!eo){en.display.inputDiv.style.top=en.display.inputDiv.style.left=0}});u("tabindex",null,function(en,eo){en.display.input.tabIndex=eo||""});u("autofocus",null);var cq=G.modes={},ay=G.mimeModes={};G.defineMode=function(en,ep){if(!G.defaults.mode&&en!="null"){G.defaults.mode=en}if(arguments.length>2){ep.dependencies=[];for(var eo=2;eo<arguments.length;++eo){ep.dependencies.push(arguments[eo])}}cq[en]=ep};G.defineMIME=function(eo,en){ay[eo]=en};G.resolveMode=function(en){if(typeof en=="string"&&ay.hasOwnProperty(en)){en=ay[en]}else{if(en&&typeof en.name=="string"&&ay.hasOwnProperty(en.name)){var eo=ay[en.name];en=bE(eo,en);en.name=eo.name}else{if(typeof en=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(en)){return G.resolveMode("application/xml")}}}if(typeof en=="string"){return{name:en}}else{return en||{name:"null"}}};G.getMode=function(eo,en){var en=G.resolveMode(en);var eq=cq[en.name];if(!eq){return G.getMode(eo,"text/plain")}var er=eq(eo,en);if(co.hasOwnProperty(en.name)){var ep=co[en.name];for(var es in ep){if(!ep.hasOwnProperty(es)){continue}if(er.hasOwnProperty(es)){er["_"+es]=er[es]}er[es]=ep[es]}}er.name=en.name;return er};G.defineMode("null",function(){return{token:function(en){en.skipToEnd()}}});G.defineMIME("text/plain","null");var co=G.modeExtensions={};G.extendMode=function(ep,eo){var en=co.hasOwnProperty(ep)?co[ep]:(co[ep]={});ar(eo,en)};G.defineExtension=function(en,eo){G.prototype[en]=eo};G.defineDocExtension=function(en,eo){af.prototype[en]=eo};G.defineOption=u;var aH=[];G.defineInitHook=function(en){aH.push(en)};var dM=G.helpers={};G.registerHelper=function(eo,en,ep){if(!dM.hasOwnProperty(eo)){dM[eo]=G[eo]={}}dM[eo][en]=ep};function bq(eq,en){if(en===true){return en}if(eq.copyState){return eq.copyState(en)}var ep={};for(var er in en){var eo=en[er];if(eo instanceof Array){eo=eo.concat([])}ep[er]=eo}return ep}G.copyState=bq;function bp(ep,eo,en){return ep.startState?ep.startState(eo,en):true}G.startState=bp;G.innerMode=function(ep,en){while(ep.innerMode){var eo=ep.innerMode(en);en=eo.state;ep=eo.mode}return eo||{mode:ep,state:en}};var dc=G.commands={selectAll:function(en){en.setSelection(P(en.firstLine(),0),P(en.lastLine()))},killLine:function(en){var eq=en.getCursor(true),ep=en.getCursor(false),eo=!d2(eq,ep);if(!eo&&en.getLine(eq.line).length==eq.ch){en.replaceRange("",eq,P(eq.line+1,0),"+delete")}else{en.replaceRange("",eq,eo?ep:P(eq.line),"+delete")}},deleteLine:function(en){var eo=en.getCursor().line;en.replaceRange("",P(eo,0),P(eo),"+delete")},delLineLeft:function(en){var eo=en.getCursor();en.replaceRange("",P(eo.line,0),eo,"+delete")},undo:function(en){en.undo()},redo:function(en){en.redo()},goDocStart:function(en){en.extendSelection(P(en.firstLine(),0))},goDocEnd:function(en){en.extendSelection(P(en.lastLine()))},goLineStart:function(en){en.extendSelection(a1(en,en.getCursor().line))},goLineStartSmart:function(eo){var es=eo.getCursor(),et=a1(eo,es.line);var ep=eo.getLineHandle(et.line);var en=a(ep);if(!en||en[0].level==0){var er=Math.max(0,ep.text.search(/\S/));var eq=es.line==et.line&&es.ch<=er&&es.ch;eo.extendSelection(P(et.line,eq?0:er))}else{eo.extendSelection(et)}},goLineEnd:function(en){en.extendSelection(cF(en,en.getCursor().line))},goLineRight:function(en){var eo=en.charCoords(en.getCursor(),"div").top+5;en.extendSelection(en.coordsChar({left:en.display.lineDiv.offsetWidth+100,top:eo},"div"))},goLineLeft:function(en){var eo=en.charCoords(en.getCursor(),"div").top+5;en.extendSelection(en.coordsChar({left:0,top:eo},"div"))},goLineUp:function(en){en.moveV(-1,"line")},goLineDown:function(en){en.moveV(1,"line")},goPageUp:function(en){en.moveV(-1,"page")},goPageDown:function(en){en.moveV(1,"page")},goCharLeft:function(en){en.moveH(-1,"char")},goCharRight:function(en){en.moveH(1,"char")},goColumnLeft:function(en){en.moveH(-1,"column")},goColumnRight:function(en){en.moveH(1,"column")},goWordLeft:function(en){en.moveH(-1,"word")},goGroupRight:function(en){en.moveH(1,"group")},goGroupLeft:function(en){en.moveH(-1,"group")},goWordRight:function(en){en.moveH(1,"word")},delCharBefore:function(en){en.deleteH(-1,"char")},delCharAfter:function(en){en.deleteH(1,"char")},delWordBefore:function(en){en.deleteH(-1,"word")},delWordAfter:function(en){en.deleteH(1,"word")},delGroupBefore:function(en){en.deleteH(-1,"group")},delGroupAfter:function(en){en.deleteH(1,"group")},indentAuto:function(en){en.indentSelection("smart")},indentMore:function(en){en.indentSelection("add")},indentLess:function(en){en.indentSelection("subtract")},insertTab:function(en){en.replaceSelection("\t","end","+input")},defaultTab:function(en){if(en.somethingSelected()){en.indentSelection("add")}else{en.replaceSelection("\t","end","+input")}},transposeChars:function(en){var ep=en.getCursor(),eo=en.getLine(ep.line);if(ep.ch>0&&ep.ch<eo.length-1){en.replaceRange(eo.charAt(ep.ch)+eo.charAt(ep.ch-1),P(ep.line,ep.ch-1),P(ep.line,ep.ch+1))}},newlineAndIndent:function(en){ca(en,function(){en.replaceSelection("\n","end","+input");en.indentLine(en.getCursor().line,null,true)})()},toggleOverwrite:function(en){en.toggleOverwrite()}};var dA=G.keyMap={};dA.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"};dA.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"};dA.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft",fallthrough:["basic","emacsy"]};dA["default"]=bs?dA.macDefault:dA.pcDefault;dA.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};function eb(en){if(typeof en=="string"){return dA[en]}else{return en}}function i(eo,es,eq){function er(ey){ey=eb(ey);var ew=ey[eo];if(ew===false){return"stop"}if(ew!=null&&eq(ew)){return true}if(ey.nofallthrough){return"stop"}var ev=ey.fallthrough;if(ev==null){return false}if(Object.prototype.toString.call(ev)!="[object Array]"){return er(ev)}for(var eu=0,ex=ev.length;eu<ex;++eu){var et=er(ev[eu]);if(et){return et}}return false}for(var ep=0;ep<es.length;++ep){var en=er(es[ep]);if(en){return en!="stop"}}}function db(eo){var en=dF[eo.keyCode];return en=="Ctrl"||en=="Alt"||en=="Shift"||en=="Mod"}function dQ(eo,ep){if(dV&&eo.keyCode==34&&eo["char"]){return false}var en=dF[eo.keyCode];if(en==null||eo.altGraphKey){return false}if(eo.altKey){en="Alt-"+en}if(bh?eo.metaKey:eo.ctrlKey){en="Ctrl-"+en}if(bh?eo.ctrlKey:eo.metaKey){en="Cmd-"+en}if(!ep&&eo.shiftKey){en="Shift-"+en}return en}G.lookupKey=i;G.isModifierKey=db;G.keyName=dQ;G.fromTextArea=function(eu,ev){if(!ev){ev={}}ev.value=eu.value;if(!ev.tabindex&&eu.tabindex){ev.tabindex=eu.tabindex}if(!ev.placeholder&&eu.placeholder){ev.placeholder=eu.placeholder}if(ev.autofocus==null){var en=document.body;try{en=document.activeElement}catch(ep){}ev.autofocus=en==eu||eu.getAttribute("autofocus")!=null&&en==document.body}function er(){eu.value=et.getValue()}if(eu.form){bn(eu.form,"submit",er);if(!ev.leaveSubmitMethodAlone){var eo=eu.form,es=eo.submit;try{var eq=eo.submit=function(){er();eo.submit=es;eo.submit();eo.submit=eq}}catch(ep){}}}eu.style.display="none";var et=G(function(ew){eu.parentNode.insertBefore(ew,eu.nextSibling)},ev);et.save=er;et.getTextArea=function(){return eu};et.toTextArea=function(){er();eu.parentNode.removeChild(et.getWrapperElement());eu.style.display="";if(eu.form){cT(eu.form,"submit",er);if(typeof eu.form.submit=="function"){eu.form.submit=es}}};return et};function dp(en,eo){this.pos=this.start=0;this.string=en;this.tabSize=eo||8;this.lastColumnPos=this.lastColumnValue=0}dp.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(en){var ep=this.string.charAt(this.pos);if(typeof en=="string"){var eo=ep==en}else{var eo=ep&&(en.test?en.test(ep):en(ep))}if(eo){++this.pos;return ep}},eatWhile:function(en){var eo=this.pos;while(this.eat(en)){}return this.pos>eo},eatSpace:function(){var en=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>en},skipToEnd:function(){this.pos=this.string.length},skipTo:function(en){var eo=this.string.indexOf(en,this.pos);if(eo>-1){this.pos=eo;return true}},backUp:function(en){this.pos-=en},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=bi(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue},indentation:function(){return bi(this.string,null,this.tabSize)},match:function(er,eo,en){if(typeof er=="string"){var es=function(et){return en?et.toLowerCase():et};var eq=this.string.substr(this.pos,er.length);if(es(eq)==es(er)){if(eo!==false){this.pos+=er.length}return true}}else{var ep=this.string.slice(this.pos).match(er);if(ep&&ep.index>0){return null}if(ep&&eo!==false){this.pos+=ep[0].length}return ep}},current:function(){return this.string.slice(this.start,this.pos)}};G.StringStream=dp;function M(eo,en){this.lines=[];this.type=en;this.doc=eo}G.TextMarker=M;M.prototype.clear=function(){if(this.explicitlyCleared){return}var eu=this.doc.cm,eo=eu&&!eu.curOp;if(eo){bZ(eu)}var ep=null,es=null;for(var eq=0;eq<this.lines.length;++eq){var ev=this.lines[eq];var et=dz(ev.markedSpans,this);if(et.to!=null){es=bf(ev)}ev.markedSpans=dj(ev.markedSpans,et);if(et.from!=null){ep=bf(ev)}else{if(this.collapsed&&!dT(this.doc,ev)&&eu){eg(ev,aB(eu.display))}}}if(eu&&this.collapsed&&!eu.options.lineWrapping){for(var eq=0;eq<this.lines.length;++eq){var en=A(eu.doc,this.lines[eq]),er=cZ(eu.doc,en);if(er>eu.display.maxLineLength){eu.display.maxLine=en;eu.display.maxLineLength=er;eu.display.maxLineChanged=true}}}if(ep!=null&&eu){V(eu,ep,es+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(eu){c6(eu)}}if(eo){ab(eu)}T(this,"clear")};M.prototype.find=function(){var es,er;for(var eo=0;eo<this.lines.length;++eo){var en=this.lines[eo];var ep=dz(en.markedSpans,this);if(ep.from!=null||ep.to!=null){var eq=bf(en);if(ep.from!=null){es=P(eq,ep.from)}if(ep.to!=null){er=P(eq,ep.to)}}}if(this.type=="bookmark"){return es}return es&&{from:es,to:er}};M.prototype.changed=function(){var eq=this.find(),en=this.doc.cm;if(!eq||!en){return}var eo=dD(this.doc,eq.from.line);d6(en,eo);if(eq.from.line>=en.display.showingFrom&&eq.from.line<en.display.showingTo){for(var ep=en.display.lineDiv.firstChild;ep;ep=ep.nextSibling){if(ep.lineObj==eo){if(ep.offsetHeight!=eo.height){eg(eo,ep.offsetHeight)}break}}b2(en,function(){en.curOp.selectionChanged=true})}};M.prototype.attachLine=function(en){if(!this.lines.length&&this.doc.cm){var eo=this.doc.cm.curOp;if(!eo.maybeHiddenMarkers||cl(eo.maybeHiddenMarkers,this)==-1){(eo.maybeUnhiddenMarkers||(eo.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(en)};M.prototype.detachLine=function(en){this.lines.splice(cl(this.lines,en),1);if(!this.lines.length&&this.doc.cm){var eo=this.doc.cm.curOp;(eo.maybeHiddenMarkers||(eo.maybeHiddenMarkers=[])).push(this)}};function dg(ew,eu,ev,ey,es){if(ey&&ey.shared){return L(ew,eu,ev,ey,es)}if(ew.cm&&!ew.cm.curOp){return ca(ew.cm,dg)(ew,eu,ev,ey,es)}var er=new M(ew,es);if(es=="range"&&!dE(eu,ev)){return er}if(ey){ar(ey,er)}if(er.replacedWith){er.collapsed=true;er.replacedWith=ed("span",[er.replacedWith],"CodeMirror-widget");if(!ey.handleMouseEvents){er.replacedWith.ignoreEvents=true}}if(er.collapsed){aG=true}if(er.addToHistory){dh(ew,{from:eu,to:ev,origin:"markText"},{head:ew.sel.head,anchor:ew.sel.anchor},NaN)}var eo=eu.line,ex=0,eq,ep,et=ew.cm,en;ew.iter(eo,ev.line+1,function(ez){if(et&&er.collapsed&&!et.options.lineWrapping&&A(ew,ez)==et.display.maxLine){en=true}var eA={from:null,to:null,marker:er};ex+=ez.text.length;if(eo==eu.line){eA.from=eu.ch;ex-=eu.ch}if(eo==ev.line){eA.to=ev.ch;ex-=ez.text.length-ev.ch}if(er.collapsed){if(eo==ev.line){ep=a3(ez,ev.ch)}if(eo==eu.line){eq=a3(ez,eu.ch)}else{eg(ez,0)}}bz(ez,eA);++eo});if(er.collapsed){ew.iter(eu.line,ev.line+1,function(ez){if(dT(ew,ez)){eg(ez,0)}})}if(er.clearOnEnter){bn(er,"beforeCursorEnter",function(){er.clear()})}if(er.readOnly){ei=true;if(ew.history.done.length||ew.history.undone.length){ew.clearHistory()}}if(er.collapsed){if(eq!=ep){throw new Error("Inserting collapsed marker overlapping an existing one")}er.size=ex;er.atomic=true}if(et){if(en){et.curOp.updateMaxLine=true}if(er.className||er.startStyle||er.endStyle||er.collapsed){V(et,eu.line,ev.line+1)}if(er.atomic){c6(et)}}return er}function z(eq,eo){this.markers=eq;this.primary=eo;for(var en=0,ep=this;en<eq.length;++en){eq[en].parent=this;bn(eq[en],"clear",function(){ep.clear()})}}G.SharedTextMarker=z;z.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var en=0;en<this.markers.length;++en){this.markers[en].clear()}T(this,"clear")};z.prototype.find=function(){return this.primary.find()};function L(er,eu,et,en,ep){en=ar(en);en.shared=false;var es=[dg(er,eu,et,en,ep)],eo=es[0];var eq=en.replacedWith;cN(er,function(ew){if(eq){en.replacedWith=eq.cloneNode(true)}es.push(dg(ew,d3(ew,eu),d3(ew,et),en,ep));for(var ev=0;ev<ew.linked.length;++ev){if(ew.linked[ev].isParent){return}}eo=d1(es)});return new z(es,eo)}function dz(ep,en){if(ep){for(var eo=0;eo<ep.length;++eo){var eq=ep[eo];if(eq.marker==en){return eq}}}}function dj(eo,ep){for(var eq,en=0;en<eo.length;++en){if(eo[en]!=ep){(eq||(eq=[])).push(eo[en])}}return eq}function bz(en,eo){en.markedSpans=en.markedSpans?en.markedSpans.concat([eo]):[eo];eo.marker.attachLine(en)}function aw(eo,ep,et){if(eo){for(var er=0,eu;er<eo.length;++er){var ev=eo[er],es=ev.marker;var en=ev.from==null||(es.inclusiveLeft?ev.from<=ep:ev.from<ep);if(en||es.type=="bookmark"&&ev.from==ep&&(!et||!ev.marker.insertLeft)){var eq=ev.to==null||(es.inclusiveRight?ev.to>=ep:ev.to>ep);(eu||(eu=[])).push({from:ev.from,to:eq?null:ev.to,marker:es})}}}return eu}function ak(eo,eq,et){if(eo){for(var er=0,eu;er<eo.length;++er){var ev=eo[er],es=ev.marker;var ep=ev.to==null||(es.inclusiveRight?ev.to>=eq:ev.to>eq);if(ep||es.type=="bookmark"&&ev.from==eq&&(!et||ev.marker.insertLeft)){var en=ev.from==null||(es.inclusiveLeft?ev.from<=eq:ev.from<eq);(eu||(eu=[])).push({from:en?null:ev.from-eq,to:ev.to==null?null:ev.to-eq,marker:es})}}}return eu}function cY(ez,ew){var ev=bv(ez,ew.from.line)&&dD(ez,ew.from.line).markedSpans;var eC=bv(ez,ew.to.line)&&dD(ez,ew.to.line).markedSpans;if(!ev&&!eC){return null}var eo=ew.from.ch,er=ew.to.ch,eu=d2(ew.from,ew.to);var et=aw(ev,eo,eu);var eB=ak(eC,er,eu);var eA=ew.text.length==1,ep=d1(ew.text).length+(eA?eo:0);if(et){for(var eq=0;eq<et.length;++eq){var ey=et[eq];if(ey.to==null){var eD=dz(eB,ey.marker);if(!eD){ey.to=eo}else{if(eA){ey.to=eD.to==null?null:eD.to+ep}}}}}if(eB){for(var eq=0;eq<eB.length;++eq){var ey=eB[eq];if(ey.to!=null){ey.to+=ep}if(ey.from==null){var eD=dz(et,ey.marker);if(!eD){ey.from=ep;if(eA){(et||(et=[])).push(ey)}}}else{ey.from+=ep;if(eA){(et||(et=[])).push(ey)}}}}if(eA&&et){for(var eq=0;eq<et.length;++eq){if(et[eq].from!=null&&et[eq].from==et[eq].to&&et[eq].marker.type!="bookmark"){et.splice(eq--,1)}}if(!et.length){et=null}}var es=[et];if(!eA){var ex=ew.text.length-2,en;if(ex>0&&et){for(var eq=0;eq<et.length;++eq){if(et[eq].to==null){(en||(en=[])).push({from:null,to:null,marker:et[eq].marker})}}}for(var eq=0;eq<ex;++eq){es.push(en)}es.push(eB)}return es}function cP(ev,et){var en=bt(ev,et);var ew=cY(ev,et);if(!en){return ew}if(!ew){return en}for(var eq=0;eq<en.length;++eq){var er=en[eq],es=ew[eq];if(er&&es){spans:for(var ep=0;ep<es.length;++ep){var eu=es[ep];for(var eo=0;eo<er.length;++eo){if(er[eo].marker==eu.marker){continue spans}}er.push(eu)}}else{if(es){en[eq]=es}}}return en}function bX(ex,ev,ew){var eq=null;ex.iter(ev.line,ew.line+1,function(ey){if(ey.markedSpans){for(var ez=0;ez<ey.markedSpans.length;++ez){var eA=ey.markedSpans[ez].marker;if(eA.readOnly&&(!eq||cl(eq,eA)==-1)){(eq||(eq=[])).push(eA)}}}});if(!eq){return null}var er=[{from:ev,to:ew}];for(var es=0;es<eq.length;++es){var et=eq[es],eo=et.find();for(var ep=0;ep<er.length;++ep){var en=er[ep];if(dE(en.to,eo.from)||dE(eo.to,en.from)){continue}var eu=[ep,1];if(dE(en.from,eo.from)||!et.inclusiveLeft&&d2(en.from,eo.from)){eu.push({from:en.from,to:eo.from})}if(dE(eo.to,en.to)||!et.inclusiveRight&&d2(en.to,eo.to)){eu.push({from:eo.to,to:en.to})}er.splice.apply(er,eu);ep+=eu.length-1}}return er}function a3(eo,eq){var en=aG&&eo.markedSpans,es;if(en){for(var er,ep=0;ep<en.length;++ep){er=en[ep];if(!er.marker.collapsed){continue}if((er.from==null||er.from<eq)&&(er.to==null||er.to>eq)&&(!es||es.width<er.marker.width)){es=er.marker}}}return es}function dl(en){return a3(en,-1)}function c4(en){return a3(en,en.text.length+1)}function A(ep,eo){var en;while(en=dl(eo)){eo=dD(ep,en.find().from.line)}return eo}function dT(er,eo){var en=aG&&eo.markedSpans;if(en){for(var eq,ep=0;ep<en.length;++ep){eq=en[ep];if(!eq.marker.collapsed){continue}if(eq.from==null){return true}if(eq.marker.replacedWith){continue}if(eq.from==0&&eq.marker.inclusiveLeft&&O(er,eo,eq)){return true}}}}function O(et,eo,eq){if(eq.to==null){var en=eq.marker.find().to,er=dD(et,en.line);return O(et,er,dz(er.markedSpans,eq.marker))}if(eq.marker.inclusiveRight&&eq.to==eo.text.length){return true}for(var es,ep=0;ep<eo.markedSpans.length;++ep){es=eo.markedSpans[ep];if(es.marker.collapsed&&!es.marker.replacedWith&&es.from==eq.to&&(es.marker.inclusiveLeft||eq.marker.inclusiveRight)&&O(et,eo,es)){return true}}}function eh(en){var ep=en.markedSpans;if(!ep){return}for(var eo=0;eo<ep.length;++eo){ep[eo].marker.detachLine(en)}en.markedSpans=null}function cb(en,ep){if(!ep){return}for(var eo=0;eo<ep.length;++eo){ep[eo].marker.attachLine(en)}en.markedSpans=ep}var cx=G.LineWidget=function(en,eq,eo){if(eo){for(var ep in eo){if(eo.hasOwnProperty(ep)){this[ep]=eo[ep]}}}this.cm=en;this.node=eq};function J(en){return function(){var ep=!this.cm.curOp;if(ep){bZ(this.cm)}try{var eo=en.apply(this,arguments)}finally{if(ep){ab(this.cm)}}return eo}}cx.prototype.clear=J(function(){var eo=this.line.widgets,eq=bf(this.line);if(eq==null||!eo){return}for(var ep=0;ep<eo.length;++ep){if(eo[ep]==this){eo.splice(ep--,1)}}if(!eo.length){this.line.widgets=null}var en=be(this.cm,this.line)<this.cm.doc.scrollTop;eg(this.line,Math.max(0,this.line.height-b7(this)));if(en){b1(this.cm,0,-this.height)}V(this.cm,eq,eq+1)});cx.prototype.changed=J(function(){var en=this.height;this.height=null;var eo=b7(this)-en;if(!eo){return}eg(this.line,this.line.height+eo);var ep=bf(this.line);V(this.cm,ep,ep+1)});function b7(en){if(en.height!=null){return en.height}if(!en.node.parentNode||en.node.parentNode.nodeType!=1){bj(en.cm.display.measure,ed("div",[en.node],null,"position: relative"))}return en.height=en.node.offsetHeight}function a9(en,er,ep,eo){var eq=new cx(en,ep,eo);if(eq.noHScroll){en.display.alignWidgets=true}c8(en,er,function(et){var eu=et.widgets||(et.widgets=[]);if(eq.insertAt==null){eu.push(eq)}else{eu.splice(Math.max(eu.length-1,eq.insertAt),0,eq)}eq.line=et;if(!dT(en.doc,et)||eq.showIfHidden){var es=be(en,et)<en.doc.scrollTop;eg(et,et.height+b7(eq));if(es){b1(en,0,eq.height)}}return true});return eq}function aT(eq,ep,en){var eo={text:eq};cb(eo,ep);eo.height=en?en(eo):1;return eo}function c0(eo,er,ep,en){eo.text=er;if(eo.stateAfter){eo.stateAfter=null}if(eo.styles){eo.styles=null}if(eo.order!=null){eo.order=null}eh(eo);cb(eo,ep);var eq=en?en(eo):1;if(eq!=eo.height){eg(eo,eq)}}function a4(en){en.parent=null;eh(en)}function x(eu,ew,eq,eo,er){var ep=eq.flattenSpans;if(ep==null){ep=eu.options.flattenSpans}var et=0,es=null;var ev=new dp(ew,eu.options.tabSize),en;if(ew==""&&eq.blankLine){eq.blankLine(eo)}while(!ev.eol()){if(ev.pos>eu.options.maxHighlightLength){ep=false;ev.pos=Math.min(ew.length,ev.start+50000);en=null}else{en=eq.token(ev,eo)}if(!ep||es!=en){if(et<ev.start){er(ev.start,es)}et=ev.start;es=en}ev.start=ev.pos}if(et<ev.pos){er(ev.pos,es)}}function dY(eo,ep,et){var er=[eo.state.modeGen];x(eo,ep.text,eo.doc.mode,et,function(ev,ew){er.push(ev,ew)});for(var eu=0;eu<eo.state.overlays.length;++eu){var eq=eo.state.overlays[eu],es=1,en=0;x(eo,ep.text,eq.mode,true,function(ev,ex){var ez=es;while(en<ev){var ew=er[es];if(ew>ev){er.splice(es,1,ev,er[es+1],ew)}es+=2;en=Math.min(ev,ew)}if(!ex){return}if(eq.opaque){er.splice(ez,es-ez,ev,ex);es=ez+2}else{for(;ez<es;ez+=2){var ey=er[ez+1];er[ez+1]=ey?ey+" "+ex:ex}}})}return er}function cf(en,eo){if(!eo.styles||eo.styles[0]!=en.state.modeGen){eo.styles=dY(en,eo,eo.stateAfter=cw(en,bf(eo)))}return eo.styles}function cu(en,eo,ep){var er=en.doc.mode;var eq=new dp(eo.text,en.options.tabSize);if(eo.text==""&&er.blankLine){er.blankLine(ep)}while(!eq.eol()&&eq.pos<=en.options.maxHighlightLength){er.token(eq,ep);eq.start=eq.pos}}var cI={};function p(en){if(!en){return null}return cI[en]||(cI[en]="cm-"+en.replace(/ +/g," cm-"))}function cE(ev,ey,en){var ew,ez=ey,es=true;while(ew=dl(ez)){ez=dD(ev.doc,ew.find().from.line)}var et={pre:ed("pre"),col:0,pos:0,display:!en,measure:null,measuredSomething:false,cm:ev};if(ez.textClass){et.pre.className=ez.textClass}do{if(ez.text){es=false}et.measure=ez==ey&&en;et.pos=0;et.addToken=et.measure?g:v;if((cA||b9)&&ev.getOption("lineWrapping")){et.addToken=d0(et.addToken)}var er=aX(ez,et,cf(ev,ez));if(en&&ez==ey&&!et.measuredSomething){en[0]=et.pre.appendChild(aW(ev.display.measure));et.measuredSomething=true}if(er){ez=dD(ev.doc,er.to.line)}}while(er);if(en&&!et.measuredSomething&&!en[0]){en[0]=et.pre.appendChild(es?ed("span","\u00a0"):aW(ev.display.measure))}if(!et.pre.firstChild&&!dT(ev.doc,ey)){et.pre.appendChild(document.createTextNode("\u00a0"))}var eo;if(en&&cA&&(eo=a(ez))){var eq=eo.length-1;if(eo[eq].from==eo[eq].to){--eq}var ex=eo[eq],ep=eo[eq-1];if(ex.from+1==ex.to&&ep&&ex.level<ep.level){var eu=en[et.pos-1];if(eu){eu.parentNode.insertBefore(eu.measureRight=aW(ev.display.measure),eu.nextSibling)}}}am(ev,"renderLine",ev,ey,et.pre);return et.pre}var cd=/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\uFEFF]/g;function v(er,ey,en,eq,ez){if(!ey){return}if(!cd.test(ey)){er.col+=ey.length;var eu=document.createTextNode(ey)}else{var eu=document.createDocumentFragment(),ew=0;while(true){cd.lastIndex=ew;var eo=cd.exec(ey);var et=eo?eo.index-ew:ey.length-ew;if(et){eu.appendChild(document.createTextNode(ey.slice(ew,ew+et)));er.col+=et}if(!eo){break}ew+=et+1;if(eo[0]=="\t"){var es=er.cm.options.tabSize,ev=es-er.col%es;eu.appendChild(ed("span",bK(ev),"cm-tab"));er.col+=ev}else{var ep=ed("span","\u2022","cm-invalidchar");ep.title="\\u"+eo[0].charCodeAt(0).toString(16);eu.appendChild(ep);er.col+=1}}}if(en||eq||ez||er.measure){var ex=en||"";if(eq){ex+=eq}if(ez){ex+=ez}return er.pre.appendChild(ed("span",[eu],ex))}er.pre.appendChild(eu)}function g(eu,ew,eo,er,ex){var et=eu.cm.options.lineWrapping;for(var es=0;es<ew.length;++es){var en=ew.charAt(es),ep=es==0;if(en>="\ud800"&&en<"\udbff"&&es<ew.length-1){en=ew.slice(es,es+2);++es}else{if(es&&et&&bw(ew,es)){eu.pre.appendChild(ed("wbr"))}}var eq=eu.measure[eu.pos];var ev=eu.measure[eu.pos]=v(eu,en,eo,ep&&er,es==ew.length-1&&ex);if(eq){ev.leftSide=eq.leftSide||eq}if(cA&&et&&en==" "&&es&&!/\s/.test(ew.charAt(es-1))&&es<ew.length-1&&!/\s/.test(ew.charAt(es+1))){ev.style.whiteSpace="normal"}eu.pos+=en.length}if(ew.length){eu.measuredSomething=true}}function d0(en){function eo(ep){var eq=" ";for(var er=0;er<ep.length-2;++er){eq+=er%2?" ":"\u00a0"}eq+=" ";return eq}return function(eq,et,er,ep,es){return en(eq,et.replace(/ {3,}/,eo),er,ep,es)}}function R(eo,er,en,eq){var es=!eq&&en.replacedWith;if(es){if(!eo.display){es=es.cloneNode(true)}eo.pre.appendChild(es);if(eo.measure){if(er){eo.measure[eo.pos]=es}else{var ep=eo.measure[eo.pos]=aW(eo.cm.display.measure);if(en.type!="bookmark"||en.insertLeft){eo.pre.insertBefore(ep,es)}else{eo.pre.appendChild(ep)}}eo.measuredSomething=true}}eo.pos+=er}function aX(ev,eC,eu){var es=ev.markedSpans,et=ev.text,eA=0;if(!es){for(var eF=1;eF<eu.length;eF+=2){eC.addToken(eC,et.slice(eA,eA=eu[eF]),p(eu[eF+1]))}return}var eG=et.length,er=0,eF=1,ey="",eH;var eJ=0,en,eI,ez,ep;for(;;){if(eJ==er){en=eI=ez="";ep=null;eJ=Infinity;var ew=null;for(var eD=0;eD<es.length;++eD){var eE=es[eD],eB=eE.marker;if(eE.from<=er&&(eE.to==null||eE.to>er)){if(eE.to!=null&&eJ>eE.to){eJ=eE.to;eI=""}if(eB.className){en+=" "+eB.className}if(eB.startStyle&&eE.from==er){ez+=" "+eB.startStyle}if(eB.endStyle&&eE.to==eJ){eI+=" "+eB.endStyle}if(eB.collapsed&&(!ep||ep.marker.size<eB.size)){ep=eE}}else{if(eE.from>er&&eJ>eE.from){eJ=eE.from}}if(eB.type=="bookmark"&&eE.from==er&&eB.replacedWith){ew=eB}}if(ep&&(ep.from||0)==er){R(eC,(ep.to==null?eG:ep.to)-er,ep.marker,ep.from==null);if(ep.to==null){return ep.marker.find()}}if(ew&&!ep){R(eC,0,ew)}}if(er>=eG){break}var ex=Math.min(eG,eJ);while(true){if(ey){var eo=er+ey.length;if(!ep){var eq=eo>ex?ey.slice(0,ex-er):ey;eC.addToken(eC,eq,eH?eH+en:en,ez,er+eq.length==eJ?eI:"")}if(eo>=ex){ey=ey.slice(ex-er);er=ex;break}er=eo;ez=""}ey=et.slice(eA,eA=eu[eF++]);eH=p(eu[eF++])}}}function dW(eE,ev,er,ez,et){function eq(eF){return er?er[eF]:null}function eu(eF,eH,eG){c0(eF,eH,eG,et);T(eF,"change",eF,ev)}var eA=ev.from,eo=ev.to,ex=ev.text;var ew=dD(eE,eA.line),en=dD(eE,eo.line);var ep=d1(ex),eC=eq(ex.length-1),ey=eo.line-eA.line;if(eA.ch==0&&eo.ch==0&&ep==""){for(var eB=0,eD=ex.length-1,es=[];eB<eD;++eB){es.push(aT(ex[eB],eq(eB),et))}eu(en,en.text,eC);if(ey){eE.remove(eA.line,ey)}if(es.length){eE.insert(eA.line,es)}}else{if(ew==en){if(ex.length==1){eu(ew,ew.text.slice(0,eA.ch)+ep+ew.text.slice(eo.ch),eC)}else{for(var es=[],eB=1,eD=ex.length-1;eB<eD;++eB){es.push(aT(ex[eB],eq(eB),et))}es.push(aT(ep+ew.text.slice(eo.ch),eC,et));eu(ew,ew.text.slice(0,eA.ch)+ex[0],eq(0));eE.insert(eA.line+1,es)}}else{if(ex.length==1){eu(ew,ew.text.slice(0,eA.ch)+ex[0]+en.text.slice(eo.ch),eq(0));eE.remove(eA.line+1,ey)}else{eu(ew,ew.text.slice(0,eA.ch)+ex[0],eq(0));eu(en,ep+en.text.slice(eo.ch),eC);for(var eB=1,eD=ex.length-1,es=[];eB<eD;++eB){es.push(aT(ex[eB],eq(eB),et))}if(ey>1){eE.remove(eA.line+1,ey-1)}eE.insert(eA.line+1,es)}}}T(eE,"change",eE,ev);bk(eE,ez.anchor,ez.head,null,true)}function dt(eo){this.lines=eo;this.parent=null;for(var ep=0,eq=eo.length,en=0;ep<eq;++ep){eo[ep].parent=this;en+=eo[ep].height}this.height=en}dt.prototype={chunkSize:function(){return this.lines.length},removeInner:function(en,er){for(var ep=en,eq=en+er;ep<eq;++ep){var eo=this.lines[ep];this.height-=eo.height;a4(eo);T(eo,"delete")}this.lines.splice(en,er)},collapse:function(en){en.splice.apply(en,[en.length,0].concat(this.lines))},insertInner:function(eo,ep,en){this.height+=en;this.lines=this.lines.slice(0,eo).concat(ep).concat(this.lines.slice(eo));for(var eq=0,er=ep.length;eq<er;++eq){ep[eq].parent=this}},iterN:function(en,eq,ep){for(var eo=en+eq;en<eo;++en){if(ep(this.lines[en])){return true}}}};function dU(eq){this.children=eq;var ep=0,en=0;for(var eo=0,es=eq.length;eo<es;++eo){var er=eq[eo];ep+=er.chunkSize();en+=er.height;er.parent=this}this.size=ep;this.height=en;this.parent=null}dU.prototype={chunkSize:function(){return this.size},removeInner:function(en,eu){this.size-=eu;for(var ep=0;ep<this.children.length;++ep){var et=this.children[ep],er=et.chunkSize();if(en<er){var eq=Math.min(eu,er-en),es=et.height;et.removeInner(en,eq);this.height-=es-et.height;if(er==eq){this.children.splice(ep--,1);et.parent=null}if((eu-=eq)==0){break}en=0}else{en-=er}}if(this.size-eu<25){var eo=[];this.collapse(eo);this.children=[new dt(eo)];this.children[0].parent=this}},collapse:function(en){for(var eo=0,ep=this.children.length;eo<ep;++eo){this.children[eo].collapse(en)}},insertInner:function(eo,ev,eu){this.size+=ev.length;this.height+=eu;for(var ep=0,er=this.children.length;ep<er;++ep){var en=this.children[ep],es=en.chunkSize();if(eo<=es){en.insertInner(eo,ev,eu);if(en.lines&&en.lines.length>50){while(en.lines.length>50){var eq=en.lines.splice(en.lines.length-25,25);var et=new dt(eq);en.height-=et.height;this.children.splice(ep+1,0,et);et.parent=this}this.maybeSpill()}break}eo-=es}},maybeSpill:function(){if(this.children.length<=10){return}var eq=this;do{var eo=eq.children.splice(eq.children.length-5,5);var ep=new dU(eo);if(!eq.parent){var er=new dU(eq.children);er.parent=eq;eq.children=[er,ep];eq=er}else{eq.size-=ep.size;eq.height-=ep.height;var en=cl(eq.parent.children,eq);eq.parent.children.splice(en+1,0,ep)}ep.parent=eq.parent}while(eq.children.length>10);eq.parent.maybeSpill()},iterN:function(en,eu,et){for(var eo=0,er=this.children.length;eo<er;++eo){var es=this.children[eo],eq=es.chunkSize();if(en<eq){var ep=Math.min(eu,eq-en);if(es.iterN(en,ep,et)){return true}if((eu-=ep)==0){break}en=0}else{en-=eq}}}};var bL=0;var af=G.Doc=function(ep,eo,en){if(!(this instanceof af)){return new af(ep,eo,en)}if(en==null){en=0}dU.call(this,[new dt([aT("",null)])]);this.first=en;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.history=ah();this.cleanGeneration=1;this.frontier=en;var eq=P(en,0);this.sel={from:eq,to:eq,head:eq,anchor:eq,shift:false,extend:false,goalColumn:null};this.id=++bL;this.modeOption=eo;if(typeof ep=="string"){ep=aD(ep)}dW(this,{from:eq,to:eq,text:ep},null,{head:eq,anchor:eq})};af.prototype=bE(dU.prototype,{constructor:af,iter:function(ep,eo,en){if(en){this.iterN(ep-this.first,eo-ep,en)}else{this.iterN(this.first,this.first+this.size,ep)}},insert:function(eo,ep){var en=0;for(var eq=0,er=ep.length;eq<er;++eq){en+=ep[eq].height}this.insertInner(eo-this.first,ep,en)},remove:function(en,eo){this.removeInner(en-this.first,eo)},getValue:function(eo){var en=aF(this,this.first,this.first+this.size);if(eo===false){return en}return en.join(eo||"\n")},setValue:function(eo){var ep=P(this.first,0),en=this.first+this.size-1;aN(this,{from:ep,to:P(en,dD(this,en).text.length),text:aD(eo),origin:"setValue"},{head:ep,anchor:ep},true)},replaceRange:function(eo,eq,ep,en){eq=d3(this,eq);ep=ep?d3(this,ep):eq;aE(this,eo,eq,ep,en)},getRange:function(eq,ep,eo){var en=ee(this,d3(this,eq),d3(this,ep));if(eo===false){return en}return en.join(eo||"\n")},getLine:function(eo){var en=this.getLineHandle(eo);return en&&en.text},setLine:function(en,eo){if(bv(this,en)){aE(this,eo,P(en,0),d3(this,P(en)))}},removeLine:function(en){if(en){aE(this,"",d3(this,P(en-1)),d3(this,P(en)))}else{aE(this,"",P(0,0),d3(this,P(1,0)))}},getLineHandle:function(en){if(bv(this,en)){return dD(this,en)}},getLineNumber:function(en){return bf(en)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(en){return d3(this,en)},getCursor:function(ep){var en=this.sel,eo;if(ep==null||ep=="head"){eo=en.head}else{if(ep=="anchor"){eo=en.anchor}else{if(ep=="end"||ep===false){eo=en.to}else{eo=en.from}}}return bD(eo)},somethingSelected:function(){return !d2(this.sel.head,this.sel.anchor)},setCursor:dX(function(en,eo,eq){var ep=d3(this,typeof en=="number"?P(en,eo||0):en);if(eq){ea(this,ep)}else{bk(this,ep,ep)}}),setSelection:dX(function(en,eo){bk(this,d3(this,en),d3(this,eo||en))}),extendSelection:dX(function(eo,en){ea(this,d3(this,eo),en&&d3(this,en))}),getSelection:function(en){return this.getRange(this.sel.from,this.sel.to,en)},replaceSelection:function(eo,ep,en){aN(this,{from:this.sel.from,to:this.sel.to,text:aD(eo),origin:en},ep||"around")},undo:dX(function(){bu(this,"undo")}),redo:dX(function(){bu(this,"redo")}),setExtending:function(en){this.sel.extend=en},historySize:function(){var en=this.history;return{undo:en.done.length,redo:en.undone.length}},clearHistory:function(){this.history=ah(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration()},changeGeneration:function(){this.history.lastOp=this.history.lastOrigin=null;return this.history.generation},isClean:function(en){return this.history.generation==(en||this.cleanGeneration)},getHistory:function(){return{done:bg(this.history.done),undone:bg(this.history.undone)}},setHistory:function(eo){var en=this.history=ah(this.history.maxGeneration);en.done=eo.done.slice(0);en.undone=eo.undone.slice(0)},markText:function(ep,eo,en){return dg(this,d3(this,ep),d3(this,eo),en,"range")},setBookmark:function(ep,en){var eo={replacedWith:en&&(en.nodeType==null?en.widget:en),insertLeft:en&&en.insertLeft};ep=d3(this,ep);return dg(this,ep,ep,eo,"bookmark")},findMarksAt:function(er){er=d3(this,er);var eq=[],eo=dD(this,er.line).markedSpans;if(eo){for(var en=0;en<eo.length;++en){var ep=eo[en];if((ep.from==null||ep.from<=er.ch)&&(ep.to==null||ep.to>=er.ch)){eq.push(ep.marker.parent||ep.marker)}}}return eq},getAllMarks:function(){var en=[];this.iter(function(ep){var eo=ep.markedSpans;if(eo){for(var eq=0;eq<eo.length;++eq){if(eo[eq].from!=null){en.push(eo[eq].marker)}}}});return en},posFromIndex:function(eo){var en,ep=this.first;this.iter(function(eq){var er=eq.text.length+1;if(er>eo){en=eo;return true}eo-=er;++ep});return d3(this,P(ep,en))},indexFromPos:function(eo){eo=d3(this,eo);var en=eo.ch;if(eo.line<this.first||eo.ch<0){return 0}this.iter(this.first,eo.line,function(ep){en+=ep.text.length+1});return en},copy:function(en){var eo=new af(aF(this,this.first,this.first+this.size),this.modeOption,this.first);eo.scrollTop=this.scrollTop;eo.scrollLeft=this.scrollLeft;eo.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:false,goalColumn:this.sel.goalColumn};if(en){eo.history.undoDepth=this.history.undoDepth;eo.setHistory(this.getHistory())}return eo},linkedDoc:function(en){if(!en){en={}}var eq=this.first,ep=this.first+this.size;if(en.from!=null&&en.from>eq){eq=en.from}if(en.to!=null&&en.to<ep){ep=en.to}var eo=new af(aF(this,eq,ep),en.mode||this.modeOption,eq);if(en.sharedHist){eo.history=this.history}(this.linked||(this.linked=[])).push({doc:eo,sharedHist:en.sharedHist});eo.linked=[{doc:this,isParent:true,sharedHist:en.sharedHist}];return eo},unlinkDoc:function(eo){if(eo instanceof G){eo=eo.doc}if(this.linked){for(var ep=0;ep<this.linked.length;++ep){var eq=this.linked[ep];if(eq.doc!=eo){continue}this.linked.splice(ep,1);eo.unlinkDoc(this);break}}if(eo.history==this.history){var en=[eo.id];cN(eo,function(er){en.push(er.id)},true);eo.history=ah();eo.history.done=bg(this.history.done,en);eo.history.undone=bg(this.history.undone,en)}},iterLinkedDocs:function(en){cN(this,en)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});af.prototype.eachLine=af.prototype.iter;var f="iter insert remove copy getEditor".split(" ");for(var bc in af.prototype){if(af.prototype.hasOwnProperty(bc)&&cl(f,bc)<0){G.prototype[bc]=(function(en){return function(){return en.apply(this.doc,arguments)}})(af.prototype[bc])}}function cN(eq,ep,eo){function en(ew,eu,es){if(ew.linked){for(var et=0;et<ew.linked.length;++et){var er=ew.linked[et];if(er.doc==eu){continue}var ev=es&&er.sharedHist;if(eo&&!ev){continue}ep(er.doc,ev);en(er.doc,ew,ev)}}}en(eq,null,true)}function cQ(en,eo){if(eo.cm){throw new Error("This document is already in use.")}en.doc=eo;eo.cm=en;Q(en);aZ(en);if(!en.options.lineWrapping){ef(en)}en.options.mode=eo.modeOption;V(en)}function dD(en,er){er-=en.first;while(!en.lines){for(var eo=0;;++eo){var eq=en.children[eo],ep=eq.chunkSize();if(er<ep){en=eq;break}er-=ep}}return en.lines[er]}function ee(ep,er,en){var eo=[],eq=er.line;ep.iter(er.line,en.line+1,function(es){var et=es.text;if(eq==en.line){et=et.slice(0,en.ch)}if(eq==er.line){et=et.slice(er.ch)}eo.push(et);++eq});return eo}function aF(eo,eq,ep){var en=[];eo.iter(eq,ep,function(er){en.push(er.text)});return en}function eg(eo,en){var ep=en-eo.height;for(var eq=eo;eq;eq=eq.parent){eq.height+=ep}}function bf(en){if(en.parent==null){return null}var er=en.parent,eq=cl(er.lines,en);for(var eo=er.parent;eo;er=eo,eo=eo.parent){for(var ep=0;;++ep){if(eo.children[ep]==er){break}eq+=eo.children[ep].chunkSize()}}return eq+er.first}function a8(et,er){var ep=et.first;outer:do{for(var eq=0,es=et.children.length;eq<es;++eq){var eo=et.children[eq],en=eo.height;if(er<en){et=eo;continue outer}er-=en;ep+=eo.chunkSize()}return ep}while(!et.lines);for(var eq=0,es=et.lines.length;eq<es;++eq){var ev=et.lines[eq],eu=ev.height;if(er<eu){break}er-=eu}return ep+eq}function be(en,eq){eq=A(en.doc,eq);var es=0,ep=eq.parent;for(var er=0;er<ep.lines.length;++er){var eo=ep.lines[er];if(eo==eq){break}else{es+=eo.height}}for(var et=ep.parent;et;ep=et,et=ep.parent){for(var er=0;er<et.children.length;++er){var eu=et.children[er];if(eu==ep){break}else{es+=eu.height}}}return es}function a(eo){var en=eo.order;if(en==null){en=eo.order=aO(eo.text)}return en}function ah(en){return{done:[],undone:[],undoDepth:Infinity,lastTime:0,lastOp:null,lastOrigin:null,generation:en||1,maxGeneration:en||1}}function bo(eo,es,er,eq){var en=es["spans_"+eo.id],ep=0;eo.iter(Math.max(eo.first,er),Math.min(eo.first+eo.size,eq),function(et){if(et.markedSpans){(en||(en=es["spans_"+eo.id]={}))[ep]=et.markedSpans}++ep})}function cs(en,eq){var ep={line:eq.from.line,ch:eq.from.ch};var eo={from:ep,to:b6(eq),text:ee(en,eq.from,eq.to)};bo(en,eo,eq.from.line,eq.to.line+1);cN(en,function(er){bo(er,eo,eq.from.line,eq.to.line+1)},true);return eo}function dh(es,eu,er,en){var eq=es.history;eq.undone.length=0;var ep=+new Date,et=d1(eq.done);if(et&&(eq.lastOp==en||eq.lastOrigin==eu.origin&&eu.origin&&((eu.origin.charAt(0)=="+"&&es.cm&&eq.lastTime>ep-es.cm.options.historyEventDelay)||eu.origin.charAt(0)=="*"))){var eo=d1(et.changes);if(d2(eu.from,eu.to)&&d2(eu.from,eo.to)){eo.to=b6(eu)}else{et.changes.push(cs(es,eu))}et.anchorAfter=er.anchor;et.headAfter=er.head}else{et={changes:[cs(es,eu)],generation:eq.generation,anchorBefore:es.sel.anchor,headBefore:es.sel.head,anchorAfter:er.anchor,headAfter:er.head};eq.done.push(et);eq.generation=++eq.maxGeneration;while(eq.done.length>eq.undoDepth){eq.done.shift()}}eq.lastTime=ep;eq.lastOp=en;eq.lastOrigin=eu.origin}function aR(ep){if(!ep){return null}for(var eo=0,en;eo<ep.length;++eo){if(ep[eo].marker.explicitlyCleared){if(!en){en=ep.slice(0,eo)}}else{if(en){en.push(ep[eo])}}}return !en?ep:en.length?en:null}function bt(eq,er){var ep=er["spans_"+eq.id];if(!ep){return null}for(var eo=0,en=[];eo<er.text.length;++eo){en.push(aR(ep[eo]))}return en}function bg(ex,eq){for(var et=0,eo=[];et<ex.length;++et){var ep=ex[et],ev=ep.changes,ew=[];eo.push({changes:ew,anchorBefore:ep.anchorBefore,headBefore:ep.headBefore,anchorAfter:ep.anchorAfter,headAfter:ep.headAfter});for(var es=0;es<ev.length;++es){var eu=ev[es],er;ew.push({from:eu.from,to:eu.to,text:eu.text});if(eq){for(var en in eu){if(er=en.match(/^spans_(\d+)$/)){if(cl(eq,Number(er[1]))>-1){d1(ew)[en]=eu[en];delete eu[en]}}}}}}return eo}function dr(eq,ep,eo,en){if(eo<eq.line){eq.line+=en}else{if(ep<eq.line){eq.line=ep;eq.ch=0}}}function dG(eq,es,et,eu){for(var ep=0;ep<eq.length;++ep){var en=eq[ep],er=true;for(var eo=0;eo<en.changes.length;++eo){var ev=en.changes[eo];if(!en.copied){ev.from=bD(ev.from);ev.to=bD(ev.to)}if(et<ev.from.line){ev.from.line+=eu;ev.to.line+=eu}else{if(es<=ev.to.line){er=false;break}}}if(!en.copied){en.anchorBefore=bD(en.anchorBefore);en.headBefore=bD(en.headBefore);en.anchorAfter=bD(en.anchorAfter);en.readAfter=bD(en.headAfter);en.copied=true}if(!er){eq.splice(0,ep+1);ep=0}else{dr(en.anchorBefore);dr(en.headBefore);dr(en.anchorAfter);dr(en.headAfter)}}}function cz(eo,er){var eq=er.from.line,ep=er.to.line,en=er.text.length-(ep-eq)-1;dG(eo.done,eq,ep,en);dG(eo.undone,eq,ep,en)}function dn(){c1(this)}function ad(en){if(!en.stop){en.stop=dn}return en}function bW(en){if(en.preventDefault){en.preventDefault()}else{en.returnValue=false}}function cp(en){if(en.stopPropagation){en.stopPropagation()}else{en.cancelBubble=true}}function bd(en){return en.defaultPrevented!=null?en.defaultPrevented:en.returnValue==false}function c1(en){bW(en);cp(en)}G.e_stop=c1;G.e_preventDefault=bW;G.e_stopPropagation=cp;function I(en){return en.target||en.srcElement}function d5(eo){var en=eo.which;if(en==null){if(eo.button&1){en=1}else{if(eo.button&2){en=3}else{if(eo.button&4){en=2}}}}if(bs&&eo.ctrlKey&&en==1){en=3}return en}function bn(eq,eo,ep){if(eq.addEventListener){eq.addEventListener(eo,ep,false)}else{if(eq.attachEvent){eq.attachEvent("on"+eo,ep)}else{var er=eq._handlers||(eq._handlers={});var en=er[eo]||(er[eo]=[]);en.push(ep)}}}function cT(er,ep,eq){if(er.removeEventListener){er.removeEventListener(ep,eq,false)}else{if(er.detachEvent){er.detachEvent("on"+ep,eq)}else{var en=er._handlers&&er._handlers[ep];if(!en){return}for(var eo=0;eo<en.length;++eo){if(en[eo]==eq){en.splice(eo,1);break}}}}}function am(er,eq){var en=er._handlers&&er._handlers[eq];if(!en){return}var eo=Array.prototype.slice.call(arguments,2);for(var ep=0;ep<en.length;++ep){en[ep].apply(null,eo)}}var aV,bM=0;function T(es,er){var en=es._handlers&&es._handlers[er];if(!en){return}var ep=Array.prototype.slice.call(arguments,2);if(!aV){++bM;aV=[];setTimeout(c9,0)}function eo(et){return function(){et.apply(null,ep)}}for(var eq=0;eq<en.length;++eq){aV.push(eo(en[eq]))}}function ax(en,eo){am(en,eo.type,en,eo);return bd(eo)}function c9(){--bM;var en=aV;aV=null;for(var eo=0;eo<en.length;++eo){en[eo]()}}function dJ(ep,eo){var en=ep._handlers&&ep._handlers[eo];return en&&en.length>0}G.on=bn;G.off=cT;G.signal=am;var aQ=30;var bx=G.Pass={toString:function(){return"CodeMirror.Pass"}};function em(){this.id=null}em.prototype={set:function(en,eo){clearTimeout(this.id);this.id=setTimeout(eo,en)}};function bi(ep,en,er,es,eo){if(en==null){en=ep.search(/[^\s\u00a0]/);if(en==-1){en=ep.length}}for(var eq=es||0,et=eo||0;eq<en;++eq){if(ep.charAt(eq)=="\t"){et+=er-(et%er)}else{++et}}return et}G.countColumn=bi;var aC=[""];function bK(en){while(aC.length<=en){aC.push(d1(aC)+" ")}return aC[en]}function d1(en){return en[en.length-1]}function cC(eo){if(du){eo.selectionStart=0;eo.selectionEnd=eo.value.length}else{try{eo.select()}catch(en){}}}function cl(eq,en){if(eq.indexOf){return eq.indexOf(en)}for(var eo=0,ep=eq.length;eo<ep;++eo){if(eq[eo]==en){return eo}}return -1}function bE(eq,eo){function en(){}en.prototype=eq;var ep=new en();if(eo){ar(eo,ep)}return ep}function ar(eo,en){if(!en){en={}}for(var ep in eo){if(eo.hasOwnProperty(ep)){en[ep]=eo[ep]}}return en}function Z(ep){for(var en=[],eo=0;eo<ep;++eo){en.push(undefined)}return en}function bP(eo){var en=Array.prototype.slice.call(arguments,1);return function(){return eo.apply(null,en)}}var aK=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function bS(en){return/\w/.test(en)||en>"\x80"&&(en.toUpperCase()!=en.toLowerCase()||aK.test(en))}function dq(en){for(var eo in en){if(en.hasOwnProperty(eo)&&en[eo]){return false}}return true}var dP=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/;function ed(en,er,eq,ep){var es=document.createElement(en);if(eq){es.className=eq}if(ep){es.style.cssText=ep}if(typeof er=="string"){t(es,er)}else{if(er){for(var eo=0;eo<er.length;++eo){es.appendChild(er[eo])}}}return es}function cK(eo){for(var en=eo.childNodes.length;en>0;--en){eo.removeChild(eo.firstChild)}return eo}function bj(en,eo){return cK(en).appendChild(eo)}function t(en,eo){if(bF){en.innerHTML="";en.appendChild(document.createTextNode(eo))}else{en.textContent=eo}}function at(en){return en.getBoundingClientRect()}G.replaceGetRect=function(en){at=en};var dk=function(){if(bF){return false}var en=ed("div");return"draggable" in en||"dragDrop" in en}();function bw(){return false}if(bJ){bw=function(eo,en){return eo.charCodeAt(en-1)==36&&eo.charCodeAt(en)==39}}else{if(al&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent)){bw=function(eo,en){return/\-[^ \-?]|\?[^ !\'\"\),.\-\/:;\?\]\}]/.test(eo.slice(en-1,en+1))}}else{if(b9){bw=function(eo,en){if(en>1&&eo.charCodeAt(en-1)==45&&/\w/.test(eo.charAt(en-2))&&/[^\-?\.]/.test(eo.charAt(en))){return true}return/[~!#%&*)=+}\]|\"\.>,:;][({[<]|-[^\-?\.\u2010-\u201f\u2026]|\?[\w~`@#$%\^&*(_=+{[|><]|[\w~`@#$%\^&*(_=+{[><]/.test(eo.slice(en-1,en+1))}}}}var c5;function k(en){if(c5!=null){return c5}var eo=ed("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");bj(en,eo);if(eo.offsetWidth){c5=eo.offsetHeight-eo.clientHeight}return c5||0}var d4;function aW(en){if(d4==null){var eo=ed("span","\u200b");bj(en,ed("span",[eo,document.createTextNode("x")]));if(en.firstChild.offsetHeight!=0){d4=eo.offsetWidth<=1&&eo.offsetHeight>2&&!bG}}if(d4){return ed("span","\u200b")}else{return ed("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px")}}var aD="\n\nb".split(/\n/).length!=3?function(es){var et=0,en=[],er=es.length;while(et<=er){var eq=es.indexOf("\n",et);if(eq==-1){eq=es.length}var ep=es.slice(et,es.charAt(eq-1)=="\r"?eq-1:eq);var eo=ep.indexOf("\r");if(eo!=-1){en.push(ep.slice(0,eo));et+=eo+1}else{en.push(ep);et=eq+1}}return en}:function(en){return en.split(/\r\n?|\n/)};G.splitLines=aD;var a0=window.getSelection?function(eo){try{return eo.selectionStart!=eo.selectionEnd}catch(en){return false}}:function(ep){try{var en=ep.ownerDocument.selection.createRange()}catch(eo){}if(!en||en.parentElement()!=ep){return false}return en.compareEndPoints("StartToEnd",en)!=0};var cg=(function(){var en=ed("div");if("oncopy" in en){return true}en.setAttribute("oncopy","return;");return typeof en.oncopy=="function"})();var dF={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};G.keyNames=dF;(function(){for(var en=0;en<10;en++){dF[en+48]=String(en)}for(var en=65;en<=90;en++){dF[en]=String.fromCharCode(en)}for(var en=1;en<=12;en++){dF[en+111]=dF[en+63235]="F"+en}})();function cL(en,es,er,eq){if(!en){return eq(es,er,"ltr")}for(var ep=0;ep<en.length;++ep){var eo=en[ep];if(eo.from<er&&eo.to>es||es==er&&eo.to==es){eq(Math.max(eo.from,es),Math.min(eo.to,er),eo.level==1?"rtl":"ltr")}}}function cv(en){return en.level%2?en.to:en.from}function ej(en){return en.level%2?en.from:en.to}function bV(eo){var en=a(eo);return en?cv(en[0]):0}function b5(eo){var en=a(eo);if(!en){return eo.text.length}return ej(d1(en))}function a1(eo,er){var ep=dD(eo.doc,er);var es=A(eo.doc,ep);if(es!=ep){er=bf(es)}var en=a(es);var eq=!en?0:en[0].level%2?b5(es):bV(es);return P(er,eq)}function cF(ep,es){var eo,eq;while(eo=c4(eq=dD(ep.doc,es))){es=eo.find().to.line}var en=a(eq);var er=!en?eq.text.length:en[0].level%2?bV(eq):b5(eq);return P(es,er)}function ac(eo,ep,en){var eq=eo[0].level;if(ep==eq){return true}if(en==eq){return false}return ep<en}var dv;function ao(en,er){for(var eo=0,ep;eo<en.length;++eo){var eq=en[eo];if(eq.from<er&&eq.to>er){dv=null;return eo}if(eq.from==er||eq.to==er){if(ep==null){ep=eo}else{if(ac(en,eq.level,en[ep].level)){dv=ep;return eo}else{dv=eo;return ep}}}}dv=null;return ep}function dC(en,eq,eo,ep){if(!ep){return eq+eo}do{eq+=eo}while(eq>0&&dP.test(en.text.charAt(eq)));return eq}function w(en,eu,ep,eq){var er=a(en);if(!er){return W(en,eu,ep,eq)}var et=ao(er,eu),eo=er[et];var es=dC(en,eu,eo.level%2?-ep:ep,eq);for(;;){if(es>eo.from&&es<eo.to){return es}if(es==eo.from||es==eo.to){if(ao(er,es)==et){return es}eo=er[et+=ep];return(ep>0)==eo.level%2?eo.to:eo.from}else{eo=er[et+=ep];if(!eo){return null}if((ep>0)==eo.level%2){es=dC(en,eo.to,-1,eq)}else{es=dC(en,eo.from,1,eq)}}}}function W(en,er,eo,ep){var eq=er+eo;if(ep){while(eq>0&&dP.test(en.text.charAt(eq))){eq+=eo}}return eq<0||eq>en.text.length?null:eq}var aO=(function(){var et="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL";var er="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr";function eq(ew){if(ew<=255){return et.charAt(ew)}else{if(1424<=ew&&ew<=1524){return"R"}else{if(1536<=ew&&ew<=1791){return er.charAt(ew-1536)}else{if(1792<=ew&&ew<=2220){return"r"}else{return"L"}}}}}var en=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var ev=/[stwN]/,ep=/[LRr]/,eo=/[Lb1n]/,es=/[1n]/;var eu="L";return function(eG){if(!en.test(eG)){return false}var eM=eG.length,eC=[];for(var eL=0,ey;eL<eM;++eL){eC.push(ey=eq(eG.charCodeAt(eL)))}for(var eL=0,eF=eu;eL<eM;++eL){var ey=eC[eL];if(ey=="m"){eC[eL]=eF}else{eF=ey}}for(var eL=0,ew=eu;eL<eM;++eL){var ey=eC[eL];if(ey=="1"&&ew=="r"){eC[eL]="n"}else{if(ep.test(ey)){ew=ey;if(ey=="r"){eC[eL]="R"}}}}for(var eL=1,eF=eC[0];eL<eM-1;++eL){var ey=eC[eL];if(ey=="+"&&eF=="1"&&eC[eL+1]=="1"){eC[eL]="1"}else{if(ey==","&&eF==eC[eL+1]&&(eF=="1"||eF=="n")){eC[eL]=eF}}eF=ey}for(var eL=0;eL<eM;++eL){var ey=eC[eL];if(ey==","){eC[eL]="N"}else{if(ey=="%"){for(var ez=eL+1;ez<eM&&eC[ez]=="%";++ez){}var eN=(eL&&eC[eL-1]=="!")||(ez<eM-1&&eC[ez]=="1")?"1":"N";for(var eJ=eL;eJ<ez;++eJ){eC[eJ]=eN}eL=ez-1}}}for(var eL=0,ew=eu;eL<eM;++eL){var ey=eC[eL];if(ew=="L"&&ey=="1"){eC[eL]="L"}else{if(ep.test(ey)){ew=ey}}}for(var eL=0;eL<eM;++eL){if(ev.test(eC[eL])){for(var ez=eL+1;ez<eM&&ev.test(eC[ez]);++ez){}var eD=(eL?eC[eL-1]:eu)=="L";var ex=(ez<eM-1?eC[ez]:eu)=="L";var eN=eD||ex?"L":"R";for(var eJ=eL;eJ<ez;++eJ){eC[eJ]=eN}eL=ez-1}}var eK=[],eH;for(var eL=0;eL<eM;){if(eo.test(eC[eL])){var eA=eL;for(++eL;eL<eM&&eo.test(eC[eL]);++eL){}eK.push({from:eA,to:eL,level:0})}else{var eB=eL,eE=eK.length;for(++eL;eL<eM&&eC[eL]!="L";++eL){}for(var eJ=eB;eJ<eL;){if(es.test(eC[eJ])){if(eB<eJ){eK.splice(eE,0,{from:eB,to:eJ,level:1})}var eI=eJ;for(++eJ;eJ<eL&&es.test(eC[eJ]);++eJ){}eK.splice(eE,0,{from:eI,to:eJ,level:2});eB=eJ}else{++eJ}}if(eB<eL){eK.splice(eE,0,{from:eB,to:eL,level:1})}}}if(eK[0].level==1&&(eH=eG.match(/^\s+/))){eK[0].from=eH[0].length;eK.unshift({from:0,to:eH[0].length,level:0})}if(d1(eK).level==1&&(eH=eG.match(/\s+$/))){d1(eK).to-=eH[0].length;eK.push({from:eM-eH[0].length,to:eM,level:0})}if(eK[0].level!=d1(eK).level){eK.push({from:eM,to:eM,level:eK[0].level})}return eK}})();G.version="3.14.1";return G})();CodeMirror.defineMode("javascript",function(W,ab){var E=W.indentUnit;var ag=ab.statementIndent;var af=ab.json;var I=ab.typescript;var b=function(){function at(av){return{type:av,style:"keyword"}}var an=at("keyword a"),al=at("keyword b"),ak=at("keyword c");var am=at("operator"),aq={type:"atom",style:"atom"};var ao={"if":at("if"),"while":an,"with":an,"else":al,"do":al,"try":al,"finally":al,"return":ak,"break":ak,"continue":ak,"new":ak,"delete":ak,"throw":ak,"var":at("var"),"const":at("var"),let:at("var"),"function":at("function"),"catch":at("catch"),"for":at("for"),"switch":at("switch"),"case":at("case"),"default":at("default"),"in":am,"typeof":am,"instanceof":am,"true":aq,"false":aq,"null":aq,"undefined":aq,"NaN":aq,"Infinity":aq,"this":at("this")};if(I){var au={type:"variable",style:"variable-3"};var ap={"interface":at("interface"),"class":at("class"),"extends":at("extends"),constructor:at("constructor"),"public":at("public"),"private":at("private"),"protected":at("protected"),"static":at("static"),"super":at("super"),string:au,number:au,bool:au,any:au};for(var ar in ap){ao[ar]=ap[ar]}}return ao}();var ac=/[+\-*&%=<>!?|~^]/;function ai(am,al,ak){al.tokenize=ak;return ak(am,al)}function j(an,ak){var am=false,al;while((al=an.next())!=null){if(al==ak&&!am){return false}am=!am&&al=="\\"}return am}var aj,w;function P(am,al,ak){aj=am;w=ak;return al}function s(ao,am){var ak=ao.next();if(ak=='"'||ak=="'"){return ai(ao,am,J(ak))}else{if(/[\[\]{}\(\),;\:\.]/.test(ak)){return P(ak)}else{if(ak=="0"&&ao.eat(/x/i)){ao.eatWhile(/[\da-f]/i);return P("number","number")}else{if(/\d/.test(ak)||ak=="-"&&ao.eat(/\d/)){ao.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/);return P("number","number")}else{if(ak=="/"){if(ao.eat("*")){return ai(ao,am,h)}else{if(ao.eat("/")){ao.skipToEnd();return P("comment","comment")}else{if(am.lastType=="operator"||am.lastType=="keyword c"||/^[\[{}\(,;:]$/.test(am.lastType)){j(ao,"/");ao.eatWhile(/[gimy]/);return P("regexp","string-2")}else{ao.eatWhile(ac);return P("operator",null,ao.current())}}}}else{if(ak=="#"){ao.skipToEnd();return P("error","error")}else{if(ac.test(ak)){ao.eatWhile(ac);return P("operator",null,ao.current())}else{ao.eatWhile(/[\w\$_]/);var an=ao.current(),al=b.propertyIsEnumerable(an)&&b[an];return(al&&am.lastType!=".")?P(al.type,al.style,an):P("variable","variable",an)}}}}}}}}function J(ak){return function(am,al){if(!j(am,ak)){al.tokenize=s}return P("string","string")}}function h(an,am){var ak=false,al;while(al=an.next()){if(al=="/"&&ak){am.tokenize=s;break}ak=(al=="*")}return P("comment","comment")}var r={atom:true,number:true,variable:true,string:true,regexp:true,"this":true};function C(ap,al,ak,ao,am,an){this.indented=ap;this.column=al;this.type=ak;this.prev=am;this.info=an;if(ao!=null){this.align=ao}}function F(am,al){for(var ak=am.localVars;ak;ak=ak.next){if(ak.name==al){return true}}}function R(ao,al,ak,an,ap){var aq=ao.cc;D.state=ao;D.stream=ap;D.marked=null,D.cc=aq;if(!ao.lexical.hasOwnProperty("align")){ao.lexical.align=true}while(true){var am=aq.length?aq.pop():af?G:H;if(am(ak,an)){while(aq.length&&aq[aq.length-1].lex){aq.pop()()}if(D.marked){return D.marked}if(ak=="variable"&&F(ao,an)){return"variable-2"}return al}}}var D={state:null,column:null,marked:null,cc:null};function a(){for(var ak=arguments.length-1;ak>=0;ak--){D.cc.push(arguments[ak])}}function U(){a.apply(null,arguments);return true}function t(al){function ak(ao){for(var an=ao;an;an=an.next){if(an.name==al){return true}}return false}var am=D.state;if(am.context){D.marked="def";if(ak(am.localVars)){return}am.localVars={name:al,next:am.localVars}}else{if(ak(am.globalVars)){return}am.globalVars={name:al,next:am.globalVars}}}var Q={name:"this",next:{name:"arguments"}};function B(){D.state.context={prev:D.state.context,vars:D.state.localVars};D.state.localVars=Q}function A(){D.state.localVars=D.state.context.vars;D.state.context=D.state.context.prev}function q(al,am){var ak=function(){var ao=D.state,an=ao.indented;if(ao.lexical.type=="stat"){an=ao.lexical.indented}ao.lexical=new C(an,D.stream.column(),al,null,ao.lexical,am)};ak.lex=true;return ak}function T(){var ak=D.state;if(ak.lexical.prev){if(ak.lexical.type==")"){ak.indented=ak.lexical.indented}ak.lexical=ak.lexical.prev}}T.lex=true;function e(ak){return function(al){if(al==ak){return U()}else{if(ak==";"){return a()}else{return U(arguments.callee)}}}}function H(ak){if(ak=="var"){return U(q("vardef"),X,e(";"),T)}if(ak=="keyword a"){return U(q("form"),G,H,T)}if(ak=="keyword b"){return U(q("form"),H,T)}if(ak=="{"){return U(q("}"),u,T)}if(ak==";"){return U()}if(ak=="if"){return U(q("form"),G,H,T,S(D.state.indented))}if(ak=="function"){return U(k)}if(ak=="for"){return U(q("form"),e("("),q(")"),i,e(")"),T,H,T)}if(ak=="variable"){return U(q("stat"),O)}if(ak=="switch"){return U(q("form"),G,q("}","switch"),e("{"),u,T,T)}if(ak=="case"){return U(G,e(":"))}if(ak=="default"){return U(e(":"))}if(ak=="catch"){return U(q("form"),B,e("("),x,e(")"),H,T,A)}return a(q("stat"),G,e(";"),T)}function G(ak){return Z(ak,false)}function aa(ak){return Z(ak,true)}function Z(ak,am){var al=am?p:M;if(r.hasOwnProperty(ak)){return U(al)}if(ak=="function"){return U(k)}if(ak=="keyword c"){return U(am?L:N)}if(ak=="("){return U(q(")"),N,e(")"),T,al)}if(ak=="operator"){return U(am?aa:G)}if(ak=="["){return U(q("]"),ad(aa,"]"),T,al)}if(ak=="{"){return U(q("}"),ad(v,"}"),T,al)}return U()}function N(ak){if(ak.match(/[;\}\)\],]/)){return a()}return a(G)}function L(ak){if(ak.match(/[;\}\)\],]/)){return a()}return a(aa)}function M(ak,al){if(ak==","){return U(G)}return p(ak,al,M)}function p(ak,am,al){if(!al){al=p}if(ak=="operator"){if(/\+\+|--/.test(am)){return U(al)}if(am=="?"){return U(G,e(":"),G)}return U(G)}if(ak==";"){return}if(ak=="("){return U(q(")","call"),ad(aa,")"),T,al)}if(ak=="."){return U(ae,al)}if(ak=="["){return U(q("]"),G,e("]"),T,al)}}function O(ak){if(ak==":"){return U(T,H)}return a(M,e(";"),T)}function ae(ak){if(ak=="variable"){D.marked="property";return U()}}function v(ak,al){if(ak=="variable"){D.marked="property";if(al=="get"||al=="set"){return U(K)}}else{if(ak=="number"||ak=="string"){D.marked=ak+" property"}}if(r.hasOwnProperty(ak)){return U(e(":"),aa)}}function K(ak){if(ak==":"){return U(G)}if(ak!="variable"){return U(e(":"),G)}D.marked="property";return U(k)}function ad(am,ak){function al(ao){if(ao==","){var an=D.state.lexical;if(an.info=="call"){an.pos=(an.pos||0)+1}return U(am,al)}if(ao==ak){return U()}return U(e(ak))}return function(an){if(an==ak){return U()}else{return a(am,al)}}}function u(ak){if(ak=="}"){return U()}return a(H,u)}function z(ak){if(ak==":"){return U(ah)}return a()}function ah(ak){if(ak=="variable"){D.marked="variable-3";return U()}return a()}function X(ak,al){if(ak=="variable"){t(al);return I?U(z,V):U(V)}return a()}function V(ak,al){if(al=="="){return U(aa,V)}if(ak==","){return U(X)}}function S(ak){return function(al,am){if(al=="keyword b"&&am=="else"){D.state.lexical=new C(ak,0,"form",null,D.state.lexical);return U(H,T)}return a()}}function i(ak){if(ak=="var"){return U(X,e(";"),g)}if(ak==";"){return U(g)}if(ak=="variable"){return U(Y)}return a(G,e(";"),g)}function Y(ak,al){if(al=="in"){return U(G)}return U(M,g)}function g(ak,al){if(ak==";"){return U(f)}if(al=="in"){return U(G)}return a(G,e(";"),f)}function f(ak){if(ak!=")"){U(G)}}function k(ak,al){if(ak=="variable"){t(al);return U(k)}if(ak=="("){return U(q(")"),B,ad(x,")"),T,H,A)}}function x(ak,al){if(ak=="variable"){t(al);return I?U(z):U()}}return{startState:function(ak){return{tokenize:s,lastType:null,cc:[],lexical:new C((ak||0)-E,0,"block",false),localVars:ab.localVars,globalVars:ab.globalVars,context:ab.localVars&&{vars:ab.localVars},indented:0}},token:function(am,al){if(am.sol()){if(!al.lexical.hasOwnProperty("align")){al.lexical.align=false}al.indented=am.indentation()}if(al.tokenize!=h&&am.eatSpace()){return null}var ak=al.tokenize(am,al);if(aj=="comment"){return ak}al.lastType=aj=="operator"&&(w=="++"||w=="--")?"incdec":aj;return R(al,ak,aj,w,am)},indent:function(ap,ak){if(ap.tokenize==h){return CodeMirror.Pass}if(ap.tokenize!=s){return 0}var ao=ak&&ak.charAt(0),am=ap.lexical;if(am.type=="stat"&&ao=="}"){am=am.prev}if(ag&&am.type==")"&&am.prev.type=="stat"){am=am.prev}var an=am.type,al=ao==an;if(an=="vardef"){return am.indented+(ap.lastType=="operator"||ap.lastType==","?4:0)}else{if(an=="form"&&ao=="{"){return am.indented}else{if(an=="form"){return am.indented+E}else{if(an=="stat"){return am.indented+(ap.lastType=="operator"||ap.lastType==","?ag||E:0)}else{if(am.info=="switch"&&!al&&ab.doubleIndentSwitch!=false){return am.indented+(/^(?:case|default)\b/.test(ak)?E:2*E)}else{if(am.align){return am.column+(al?0:1)}else{return am.indented+(al?0:E)}}}}}}},electricChars:":{}",blockCommentStart:af?null:"/*",blockCommentEnd:af?null:"*/",lineComment:af?null:"//",jsonMode:af}});CodeMirror.defineMIME("text/javascript","javascript");CodeMirror.defineMIME("text/ecmascript","javascript");CodeMirror.defineMIME("application/javascript","javascript");CodeMirror.defineMIME("application/ecmascript","javascript");CodeMirror.defineMIME("application/json",{name:"javascript",json:true});CodeMirror.defineMIME("application/x-json",{name:"javascript",json:true});CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:true});CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:true});CodeMirror.defineMode("css",function(a){return CodeMirror.getMode(a,"text/css")});CodeMirror.defineMode("css-base",function(b,f){var g=b.indentUnit,u=f.hooks||{},t=f.atMediaTypes||{},q=f.atMediaFeatures||{},p=f.propertyKeywords||{},r=f.colorKeywords||{},j=f.valueKeywords||{},a=!!f.allowNested,k=null;function i(v,w){k=w;return v}function e(z,x){var w=z.next();if(u[w]){var v=u[w](z,x);if(v!==false){return v}}if(w=="@"){z.eatWhile(/[\w\\\-]/);return i("def",z.current())}else{if(w=="="){i(null,"compare")}else{if((w=="~"||w=="|")&&z.eat("=")){return i(null,"compare")}else{if(w=='"'||w=="'"){x.tokenize=s(w);return x.tokenize(z,x)}else{if(w=="#"){z.eatWhile(/[\w\\\-]/);return i("atom","hash")}else{if(w=="!"){z.match(/^\s*\w*/);return i("keyword","important")}else{if(/\d/.test(w)){z.eatWhile(/[\w.%]/);return i("number","unit")}else{if(w==="-"){if(/\d/.test(z.peek())){z.eatWhile(/[\w.%]/);return i("number","unit")}else{if(z.match(/^[^-]+-/)){return i("meta","meta")}}}else{if(/[,+>*\/]/.test(w)){return i(null,"select-op")}else{if(w=="."&&z.match(/^-?[_a-z][_a-z0-9-]*/i)){return i("qualifier","qualifier")}else{if(w==":"){return i("operator",w)}else{if(/[;{}\[\]\(\)]/.test(w)){return i(null,w)}else{if(w=="u"&&z.match("rl(")){z.backUp(1);x.tokenize=h;return i("property","variable")}else{z.eatWhile(/[\w\\\-]/);return i("property","variable")}}}}}}}}}}}}}}function s(v,w){return function(B,z){var A=false,x;while((x=B.next())!=null){if(x==v&&!A){break}A=!A&&x=="\\"}if(!A){if(w){B.backUp(1)}z.tokenize=e}return i("string","string")}}function h(w,v){w.next();if(!w.match(/\s*[\"\']/,false)){v.tokenize=s(")",true)}else{v.tokenize=e}return i(null,"(")}return{startState:function(v){return{tokenize:e,baseIndent:v||0,stack:[]}},token:function(B,z){z.tokenize=z.tokenize||e;if(z.tokenize==e&&B.eatSpace()){return null}var x=z.tokenize(B,z);if(x&&typeof x!="string"){x=i(x[0],x[1])}var w=z.stack[z.stack.length-1];if(x=="variable"){if(k=="variable-definition"){z.stack.push("propertyValue")}return"variable-2"}else{if(x=="property"){var A=B.current().toLowerCase();if(w=="propertyValue"){if(j.hasOwnProperty(A)){x="string-2"}else{if(r.hasOwnProperty(A)){x="keyword"}else{x="variable-2"}}}else{if(w=="rule"){if(!p.hasOwnProperty(A)){x+=" error"}}else{if(w=="block"){if(p.hasOwnProperty(A)){x="property"}else{if(r.hasOwnProperty(A)){x="keyword"}else{if(j.hasOwnProperty(A)){x="string-2"}else{x="tag"}}}}else{if(!w||w=="@media{"){x="tag"}else{if(w=="@media"){if(t[B.current()]){x="attribute"}else{if(/^(only|not)$/.test(A)){x="keyword"}else{if(A=="and"){x="error"}else{if(q.hasOwnProperty(A)){x="error"}else{x="attribute error"}}}}}else{if(w=="@mediaType"){if(t.hasOwnProperty(A)){x="attribute"}else{if(A=="and"){x="operator"}else{if(/^(only|not)$/.test(A)){x="error"}else{x="error"}}}}else{if(w=="@mediaType("){if(p.hasOwnProperty(A)){}else{if(t.hasOwnProperty(A)){x="error"}else{if(A=="and"){x="operator"}else{if(/^(only|not)$/.test(A)){x="error"}else{x+=" error"}}}}}else{if(w=="@import"){x="tag"}else{x="error"}}}}}}}}}else{if(x=="atom"){if(!w||w=="@media{"||w=="block"){x="builtin"}else{if(w=="propertyValue"){if(!/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(B.current())){x+=" error"}}else{x="error"}}}else{if(w=="@media"&&k=="{"){x="error"}}}}if(k=="{"){if(w=="@media"||w=="@mediaType"){z.stack.pop();z.stack[z.stack.length-1]="@media{"}else{var C=a?"block":"rule";z.stack.push(C)}}else{if(k=="}"){var v=z.stack[z.stack.length-1];if(v=="interpolation"){x="operator"}z.stack.pop();if(w=="propertyValue"){z.stack.pop()}}else{if(k=="interpolation"){z.stack.push("interpolation")}else{if(k=="@media"){z.stack.push("@media")}else{if(k=="@import"){z.stack.push("@import")}else{if(w=="@media"&&/\b(keyword|attribute)\b/.test(x)){z.stack.push("@mediaType")}else{if(w=="@mediaType"&&B.current()==","){z.stack.pop()}else{if(w=="@mediaType"&&k=="("){z.stack.push("@mediaType(")}else{if(w=="@mediaType("&&k==")"){z.stack.pop()}else{if((w=="rule"||w=="block")&&k==":"){z.stack.push("propertyValue")}else{if(w=="propertyValue"&&k==";"){z.stack.pop()}else{if(w=="@import"&&k==";"){z.stack.pop()}}}}}}}}}}}}return x},indent:function(w,v){var x=w.stack.length;if(/^\}/.test(v)){x-=w.stack[w.stack.length-1]=="propertyValue"?2:1}return w.baseIndent+x*g},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/"}});(function(){function b(p){var k={};for(var j=0;j<p.length;++j){k[p[j]]=true}return k}var g=b(["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"]);var i=b(["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid"]);var f=b(["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid-cell","grid-column","grid-column-align","grid-column-sizing","grid-column-span","grid-columns","grid-flow","grid-row","grid-row-align","grid-row-sizing","grid-row-span","grid-rows","grid-template","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-shadow","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-profile","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","kerning","text-anchor","writing-mode"]);var e=b(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"]);var h=b(["above","absolute","activeborder","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","auto","avoid","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break-all","break-word","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","compact","condensed","contain","content","content-box","context-menu","continuous","copy","cover","crop","cross","crosshair","currentcolor","cursive","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","disc","discard","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ew-resize","expanded","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-table","inset","inside","intrinsic","invert","italic","justify","kannada","katakana","katakana-iroha","khmer","landscape","lao","large","larger","left","level","lighter","line-through","linear","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","malayalam","match","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","overlay","overline","padding","padding-box","painted","paused","persian","plus-darker","plus-lighter","pointer","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radio","read-only","read-write","read-write-plaintext-only","relative","repeat","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","round","row-resize","rtl","run-in","running","s-resize","sans-serif","scroll","scrollbar","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","single","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","solid","somali","source-atop","source-in","source-out","source-over","space","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","x-large","x-small","xor","xx-large","xx-small"]);function a(q,p){var j=false,k;while((k=q.next())!=null){if(j&&k=="/"){p.tokenize=null;break}j=(k=="*")}return["comment","comment"]}CodeMirror.defineMIME("text/css",{atMediaTypes:g,atMediaFeatures:i,propertyKeywords:f,colorKeywords:e,valueKeywords:h,hooks:{"<":function(p,k){function j(t,s){var r=0,q;while((q=t.next())!=null){if(r>=2&&q==">"){s.tokenize=null;break}r=(q=="-")?r+1:0}return["comment","comment"]}if(p.eat("!")){k.tokenize=j;return j(p,k)}},"/":function(k,j){if(k.eat("*")){j.tokenize=a;return a(k,j)}return false}},name:"css-base"});CodeMirror.defineMIME("text/x-scss",{atMediaTypes:g,atMediaFeatures:i,propertyKeywords:f,colorKeywords:e,valueKeywords:h,allowNested:true,hooks:{"$":function(j){j.match(/^[\w-]+/);if(j.peek()==":"){return["variable","variable-definition"]}return["variable","variable"]},"/":function(k,j){if(k.eat("/")){k.skipToEnd();return["comment","comment"]}else{if(k.eat("*")){j.tokenize=a;return a(k,j)}else{return["operator","operator"]}}},"#":function(j){if(j.eat("{")){return["operator","interpolation"]}else{j.eatWhile(/[\w\\\-]/);return["atom","hash"]}}},name:"css-base"})})();
/*
 * Agile Notes 1.0
 *
 * Copyright 2013, Sihong Zhu and other contributors
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) version 2 licenses.
* This software is not distributed under version 3 or later of the GPL.
 *
 * http://agilemore.com/agilenotes
 */
(function(a,b){a.widget("an.codeareafield",a.an.field,{options:{lineNumbers:false,modeType:"javascript",codeTheme:"solarized"},_create:function(){a.an.field.prototype._create.apply(this,arguments);this.element.addClass("an-codeareafield")},_createControl:function(){var e=this,g=this.options,f=this.element;this.textarea=a("<textarea type='"+g.type+"' name='"+g.id+"'/>");this.textarea.appendTo(this.content.width("100%").height("100%"))},_makeResizable:function(){},_browser:function(){this.textarea.hide();if(this.codeEdit){this.codeEdit.off("change",function(){});this.codeEdit=null}this.content.find(".CodeMirror").length>0&&this.content.find(".CodeMirror").remove();if(!this.pre){this.pre=a("<pre>"+this.options.value+"</pre>");this.pre.appendTo(this.content)}},_edit:function(){var f=this,g=this.options;this.pre&&this.pre.remove()&&(this.pre=null);if(!f.codeEdit){f.codeEdit=CodeMirror.fromTextArea(f.textarea[0],{lineNumbers:g.lineNumbers,mode:g.modeType,theme:g.codeTheme})}var e=this.content.find(".CodeMirror-gutters");e.css("min-height",e.find(".CodeMirror-linenumbers").outerHeight());a(f.textarea).val(g.value);f.codeEdit.doc.setValue(g.value);f.codeEdit.on("change",function(h){if(f.editTimeout){clearTimeout(f.editTimeout);f.editTimeout=null}f.editTimeout=setTimeout(function(){f.codeEdit&&a(f.textarea).val(f.codeEdit.doc.getValue());a(f.textarea).trigger("change")},800)});this.textarea.bind("change.textareafield keyup.textareafield",function(j){var i=f.textarea.val(),h=g.value;if(i!=h){g.value=i;f._trigger("optionchanged",null,{key:"value",value:i,oldValue:h,isTransient:g.isTransient})}}).bind("dblclick.textareafield",function(h){h.stopImmediatePropagation()})},_design:function(){var e=this;this.textarea.detach()},destroy:function(){if(this.codeEdit){this.codeEdit.off("change",function(){});this.codeEdit=null}this.content.find(".CodeMirror").length>0&&this.content.find(".CodeMirror").remove();this.pre&&this.pre.remove()&&(this.pre=null);this.textarea.unbind(".codeareafield").parent().remove();this.element.removeClass("an-codeareafield");return a.an.field.prototype.destroy.apply(this,arguments)}})})(jQuery);(function(b,e){var a=function(h,f){var g=h.getAttribute(f);return g==="true"?true:g==="false"?false:g===null?e:g};b.fn.buttonMarkup=function(q){var k=this,s="data-",C={};q=(q&&(b.type(q)==="object"))?q:{};for(var x=0;x<k.length;x++){var p=k.eq(x),A=p[0],w=b.extend({},b.fn.buttonMarkup.defaults,{icon:q.icon!==e?q.icon:a(A,s+"icon"),iconpos:q.iconpos!==e?q.iconpos:a(A,s+"iconpos"),theme:q.theme!==e?q.theme:a(A,s+"theme")||"c",inline:q.inline!==e?q.inline:a(A,s+"inline"),shadow:q.shadow!==e?q.shadow:a(A,s+"shadow"),corners:q.corners!==e?q.corners:a(A,s+"corners"),iconshadow:q.iconshadow!==e?q.iconshadow:a(A,s+"iconshadow"),mini:q.mini!==e?q.mini:a(A,s+"mini")},q),u="ui-btn-inner",f="ui-btn-text",v,h,B=false,r="up",j,g,t,z;for(C in w){if(w[C]===e||w[C]===null){p.removeAttr(s+C)}else{A.setAttribute(s+C,w[C])}}if(a(A,s+"rel")==="popup"&&p.attr("href")){A.setAttribute("aria-haspopup",true);A.setAttribute("aria-owns",p.attr("href"))}z=b.data(((A.tagName==="INPUT"||A.tagName==="BUTTON")?A.parentNode:A),"buttonElements");if(z){A=z.outer;p=b(A);j=z.inner;g=z.text;b(z.icon).remove();z.icon=null;B=z.hover;r=z.state}else{j=document.createElement(w.wrapperEls);g=document.createElement(w.wrapperEls)}t=w.icon?document.createElement("span"):null;if(!w.theme){w.theme="c"}v="ui-btn ";v+=(B?"ui-btn-hover-"+w.theme:"");v+=(r?" ui-btn-"+r+"-"+w.theme:"");v+=w.shadow?" ui-shadow":"";v+=w.corners?" ui-btn-corner-all":"";if(w.mini!==e){v+=w.mini===true?" ui-mini":" ui-fullsize"}if(w.inline!==e){v+=w.inline===true?" ui-btn-inline":" ui-btn-block"}if(w.icon){w.icon="ui-icon-"+w.icon;w.iconpos=w.iconpos||"left";h="ui-icon "+w.icon;if(w.iconshadow){h+=" ui-icon-shadow"}}if(w.iconpos){v+=" ui-btn-icon-"+w.iconpos;if(w.iconpos==="notext"&&!p.attr("title")){p.attr("title",p.getEncodedText())}}if(z){p.removeClass(z.bcls||"")}p.removeClass("ui-link").addClass(v);j.className=u;g.className=f;if(!z){j.appendChild(g)}if(t){t.className=h;if(!(z&&z.icon)){t.innerHTML="&#160;";j.appendChild(t)}}while(A.firstChild&&!z){g.appendChild(A.firstChild)}if(!z){A.appendChild(j)}z={hover:B,state:r,bcls:v,outer:A,inner:j,text:g,icon:t};b.data(A,"buttonElements",z);b.data(j,"buttonElements",z);b.data(g,"buttonElements",z);if(t){b.data(t,"buttonElements",z)}}return this};b.fn.buttonMarkup.defaults={corners:true,shadow:true,iconshadow:true,wrapperEls:"span"}})(jQuery);(function(e,g){var f={};var a={_addFirstLastClasses:function(k,j,h){k.removeClass("ui-first-child ui-last-child"),j.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child"),h||this.element.trigger("updatelayout")},_getVisibles:function(k,j){var h;return j?h=k.not(".ui-screen-hidden"):(h=k.filter(":visible"),0===h.length&&(h=k.not(".ui-screen-hidden"))),h}};var b=function(q,k){for(var j,u,h=q[0],r="",p=/ui-(bar|body|overlay)-([a-z])\b/;h&&(j=h.className||"",!(j&&(u=p.exec(j))&&(r=u[2])));){h=h.parentNode}return r||k||"a"};e.widget("an.mlist",e.an.widget,e.extend({options:{theme:null,countTheme:"c",headerTheme:"b",dividerTheme:"b",icon:"arrow-r",splitIcon:"arrow-r",splitTheme:"b",corners:true,shadow:true,inset:false,initSelector:":jqmData(role='listview')"},_create:function(){var i=this,h="";h+=i.options.inset?" ui-listview-inset":"";if(!!i.options.inset){h+=i.options.corners?" ui-corner-all":"";h+=i.options.shadow?" ui-shadow":""}i.element.addClass(function(j,k){return k+" ui-listview"+h});i.refresh(true)},_findFirstElementByTagName:function(k,i,h,j){var p={};p[h]=p[j]=true;while(k){if(p[k.nodeName]){return k}k=k[i]}return null},_getChildrenByTagName:function(k,i,j){var h=[],p={};p[i]=p[j]=true;k=k.firstChild;while(k){if(p[k.nodeName]){h.push(k)}k=k.nextSibling}return e(h)},_addThumbClasses:function(p){var k,j,h=p.length;for(k=0;k<h;k++){j=e(this._findFirstElementByTagName(p[k].firstChild,"nextSibling","img","IMG"));if(j.length){j.addClass("ui-li-thumb");e(this._findFirstElementByTagName(j[0].parentNode,"parentNode","li","LI")).addClass(j.is(".ui-li-icon")?"ui-li-has-icon":"ui-li-has-thumb")}}},refresh:function(C){this.parentPage=this.element.closest(".ui-page");var I=this.options,h=this.element,G=this,O=h.attr("data-divider-theme")||I.dividerTheme,D=h.attr("data-split-theme"),u=h.attr("data-split-icon"),p=h.attr("data-icon"),F=this._getChildrenByTagName(h[0],"li","LI"),E=!!e.nodeName(h[0],"ol"),L=!e.support.cssPseudoElement,s=h.attr("start"),B={},M,i,A,N,z,r,x,q,J,j,K,v,P,t;if(E&&L){h.find(".ui-li-dec").remove()}if(E){if(s||s===0){if(!L){q=parseInt(s,10)-1;h.css("counter-reset","listnumbering "+q)}else{x=parseInt(s,10)}}else{if(L){x=1}}}if(!I.theme){I.theme=b(this.element,"c")}for(var w=0,k=F.length;w<k;w++){M=F.eq(w);i="ui-li";if(C||!M.hasClass("ui-li")){A=M.attr("data-theme")||I.theme;N=this._getChildrenByTagName(M[0],"a","A");var H=(M.attr("data-role")==="list-divider");if(N.length&&!H){K=M.attr("data-icon");M.buttonMarkup({wrapperEls:"div",shadow:false,corners:false,iconpos:"right",icon:N.length>1||K===false?false:K||p||I.icon,theme:A});if((K!==false)&&(N.length===1)){M.addClass("ui-li-has-arrow")}N.first().removeClass("ui-link").addClass("ui-link-inherit");if(N.length>1){i+=" ui-li-has-alt";z=N.last();r=D||z.attr("data-theme")||I.splitTheme;t=z.attr("data-icon");z.appendTo(M).attr("title",e.trim(z.getEncodedText())).addClass("ui-li-link-alt").empty().buttonMarkup({shadow:false,corners:false,theme:A,icon:false,iconpos:"notext"}).find(".ui-btn-inner").append(e(document.createElement("span")).buttonMarkup({shadow:true,corners:true,theme:r,iconpos:"notext",icon:t||K||u||I.splitIcon}))}}else{if(H){i+=" ui-li-divider ui-bar-"+(M.attr("data-theme")||O);M.attr("role","heading");if(E){if(s||s===0){if(!L){J=parseInt(s,10)-1;M.css("counter-reset","listnumbering "+J)}else{x=parseInt(s,10)}}else{if(L){x=1}}}}else{i+=" ui-li-static ui-btn-up-"+A}}}if(E&&L&&i.indexOf("ui-li-divider")<0){j=i.indexOf("ui-li-static")>0?M:M.find(".ui-link-inherit");j.addClass("ui-li-jsnumbering").prepend("<span class='ui-li-dec'>"+(x++)+". </span>")}if(!B[i]){B[i]=[]}B[i].push(M[0])}for(i in B){e(B[i]).addClass(i).children(".ui-btn-inner").addClass(i)}h.find("h1, h2, h3, h4, h5, h6").addClass("ui-li-heading").end().find("p, dl").addClass("ui-li-desc").end().find(".ui-li-aside").each(function(){var Q=e(this);Q.prependTo(Q.parent())}).end().find(".ui-li-count").each(function(){e(this).closest("li").addClass("ui-li-has-count")}).addClass("ui-btn-up-"+(h.attr("data-count-theme")||this.options.countTheme)+" ui-btn-corner-all");this._addThumbClasses(F);this._addThumbClasses(h.find(".ui-link-inherit"));this._addFirstLastClasses(F,this._getVisibles(F,C),C);this._trigger("afterrefresh")}},a))})(jQuery);